(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&n(f)}).observe(document,{childList:!0,subtree:!0});function r(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=r(a);fetch(a.href,l)}})();var ig=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof{}<"u"?{}:typeof self<"u"?self:{};function Lf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function na(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){if(this instanceof n){var a=[null];a.push.apply(a,arguments);var l=Function.bind.apply(t,a);return new l}return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var QE={exports:{}},og={},e2={exports:{}},Gr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rf=Symbol.for("react.element"),fA=Symbol.for("react.portal"),pA=Symbol.for("react.fragment"),mA=Symbol.for("react.strict_mode"),gA=Symbol.for("react.profiler"),yA=Symbol.for("react.provider"),vA=Symbol.for("react.context"),_A=Symbol.for("react.forward_ref"),xA=Symbol.for("react.suspense"),bA=Symbol.for("react.memo"),wA=Symbol.for("react.lazy"),fb=Symbol.iterator;function EA(e){return e===null||typeof e!="object"?null:(e=fb&&e[fb]||e["@@iterator"],typeof e=="function"?e:null)}var t2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},r2=Object.assign,n2={};function Vh(e,t,r){this.props=e,this.context=t,this.refs=n2,this.updater=r||t2}Vh.prototype.isReactComponent={};Vh.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Vh.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function i2(){}i2.prototype=Vh.prototype;function s0(e,t,r){this.props=e,this.context=t,this.refs=n2,this.updater=r||t2}var a0=s0.prototype=new i2;a0.constructor=s0;r2(a0,Vh.prototype);a0.isPureReactComponent=!0;var pb=Array.isArray,o2=Object.prototype.hasOwnProperty,l0={current:null},s2={key:!0,ref:!0,__self:!0,__source:!0};function a2(e,t,r){var n,a={},l=null,f=null;if(t!=null)for(n in t.ref!==void 0&&(f=t.ref),t.key!==void 0&&(l=""+t.key),t)o2.call(t,n)&&!s2.hasOwnProperty(n)&&(a[n]=t[n]);var u=arguments.length-2;if(u===1)a.children=r;else if(1<u){for(var E=Array(u),m=0;m<u;m++)E[m]=arguments[m+2];a.children=E}if(e&&e.defaultProps)for(n in u=e.defaultProps,u)a[n]===void 0&&(a[n]=u[n]);return{$$typeof:Rf,type:e,key:l,ref:f,props:a,_owner:l0.current}}function SA(e,t){return{$$typeof:Rf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function u0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Rf}function TA(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var mb=/\/+/g;function jy(e,t){return typeof e=="object"&&e!==null&&e.key!=null?TA(""+e.key):t.toString(36)}function Wp(e,t,r,n,a){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var f=!1;if(e===null)f=!0;else switch(l){case"string":case"number":f=!0;break;case"object":switch(e.$$typeof){case Rf:case fA:f=!0}}if(f)return f=e,a=a(f),e=n===""?"."+jy(f,0):n,pb(a)?(r="",e!=null&&(r=e.replace(mb,"$&/")+"/"),Wp(a,t,r,"",function(m){return m})):a!=null&&(u0(a)&&(a=SA(a,r+(!a.key||f&&f.key===a.key?"":(""+a.key).replace(mb,"$&/")+"/")+e)),t.push(a)),1;if(f=0,n=n===""?".":n+":",pb(e))for(var u=0;u<e.length;u++){l=e[u];var E=n+jy(l,u);f+=Wp(l,t,r,E,a)}else if(E=EA(e),typeof E=="function")for(e=E.call(e),u=0;!(l=e.next()).done;)l=l.value,E=n+jy(l,u++),f+=Wp(l,t,r,E,a);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return f}function mp(e,t,r){if(e==null)return e;var n=[],a=0;return Wp(e,n,"","",function(l){return t.call(r,l,a++)}),n}function CA(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ls={current:null},Kp={transition:null},IA={ReactCurrentDispatcher:ls,ReactCurrentBatchConfig:Kp,ReactCurrentOwner:l0};Gr.Children={map:mp,forEach:function(e,t,r){mp(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return mp(e,function(){t++}),t},toArray:function(e){return mp(e,function(t){return t})||[]},only:function(e){if(!u0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Gr.Component=Vh;Gr.Fragment=pA;Gr.Profiler=gA;Gr.PureComponent=s0;Gr.StrictMode=mA;Gr.Suspense=xA;Gr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IA;Gr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=r2({},e.props),a=e.key,l=e.ref,f=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,f=l0.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(E in t)o2.call(t,E)&&!s2.hasOwnProperty(E)&&(n[E]=t[E]===void 0&&u!==void 0?u[E]:t[E])}var E=arguments.length-2;if(E===1)n.children=r;else if(1<E){u=Array(E);for(var m=0;m<E;m++)u[m]=arguments[m+2];n.children=u}return{$$typeof:Rf,type:e.type,key:a,ref:l,props:n,_owner:f}};Gr.createContext=function(e){return e={$$typeof:vA,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:yA,_context:e},e.Consumer=e};Gr.createElement=a2;Gr.createFactory=function(e){var t=a2.bind(null,e);return t.type=e,t};Gr.createRef=function(){return{current:null}};Gr.forwardRef=function(e){return{$$typeof:_A,render:e}};Gr.isValidElement=u0;Gr.lazy=function(e){return{$$typeof:wA,_payload:{_status:-1,_result:e},_init:CA}};Gr.memo=function(e,t){return{$$typeof:bA,type:e,compare:t===void 0?null:t}};Gr.startTransition=function(e){var t=Kp.transition;Kp.transition={};try{e()}finally{Kp.transition=t}};Gr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Gr.useCallback=function(e,t){return ls.current.useCallback(e,t)};Gr.useContext=function(e){return ls.current.useContext(e)};Gr.useDebugValue=function(){};Gr.useDeferredValue=function(e){return ls.current.useDeferredValue(e)};Gr.useEffect=function(e,t){return ls.current.useEffect(e,t)};Gr.useId=function(){return ls.current.useId()};Gr.useImperativeHandle=function(e,t,r){return ls.current.useImperativeHandle(e,t,r)};Gr.useInsertionEffect=function(e,t){return ls.current.useInsertionEffect(e,t)};Gr.useLayoutEffect=function(e,t){return ls.current.useLayoutEffect(e,t)};Gr.useMemo=function(e,t){return ls.current.useMemo(e,t)};Gr.useReducer=function(e,t,r){return ls.current.useReducer(e,t,r)};Gr.useRef=function(e){return ls.current.useRef(e)};Gr.useState=function(e){return ls.current.useState(e)};Gr.useSyncExternalStore=function(e,t,r){return ls.current.useSyncExternalStore(e,t,r)};Gr.useTransition=function(){return ls.current.useTransition()};Gr.version="18.2.0";e2.exports=Gr;var ro=e2.exports;const os=Lf(ro);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PA=ro,AA=Symbol.for("react.element"),MA=Symbol.for("react.fragment"),kA=Object.prototype.hasOwnProperty,LA=PA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,RA={key:!0,ref:!0,__self:!0,__source:!0};function l2(e,t,r){var n,a={},l=null,f=null;r!==void 0&&(l=""+r),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(f=t.ref);for(n in t)kA.call(t,n)&&!RA.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:AA,type:e,key:l,ref:f,props:a,_owner:LA.current}}og.Fragment=MA;og.jsx=l2;og.jsxs=l2;QE.exports=og;var Vt=QE.exports,Fv={},u2={exports:{}},ia={},c2={exports:{}},h2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(pt,Nt){var mt=pt.length;pt.push(Nt);e:for(;0<mt;){var gr=mt-1>>>1,Ar=pt[gr];if(0<a(Ar,Nt))pt[gr]=Nt,pt[mt]=Ar,mt=gr;else break e}}function r(pt){return pt.length===0?null:pt[0]}function n(pt){if(pt.length===0)return null;var Nt=pt[0],mt=pt.pop();if(mt!==Nt){pt[0]=mt;e:for(var gr=0,Ar=pt.length,Lr=Ar>>>1;gr<Lr;){var yr=2*(gr+1)-1,Dn=pt[yr],dn=yr+1,ji=pt[dn];if(0>a(Dn,mt))dn<Ar&&0>a(ji,Dn)?(pt[gr]=ji,pt[dn]=mt,gr=dn):(pt[gr]=Dn,pt[yr]=mt,gr=yr);else if(dn<Ar&&0>a(ji,mt))pt[gr]=ji,pt[dn]=mt,gr=dn;else break e}}return Nt}function a(pt,Nt){var mt=pt.sortIndex-Nt.sortIndex;return mt!==0?mt:pt.id-Nt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var f=Date,u=f.now();e.unstable_now=function(){return f.now()-u}}var E=[],m=[],S=1,M=null,z=3,H=!1,q=!1,Y=!1,ye=typeof setTimeout=="function"?setTimeout:null,Q=typeof clearTimeout=="function"?clearTimeout:null,te=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ne(pt){for(var Nt=r(m);Nt!==null;){if(Nt.callback===null)n(m);else if(Nt.startTime<=pt)n(m),Nt.sortIndex=Nt.expirationTime,t(E,Nt);else break;Nt=r(m)}}function Me(pt){if(Y=!1,ne(pt),!q)if(r(E)!==null)q=!0,qr(Ve);else{var Nt=r(m);Nt!==null&&Un(Me,Nt.startTime-pt)}}function Ve(pt,Nt){q=!1,Y&&(Y=!1,Q(ot),ot=-1),H=!0;var mt=z;try{for(ne(Nt),M=r(E);M!==null&&(!(M.expirationTime>Nt)||pt&&!Qt());){var gr=M.callback;if(typeof gr=="function"){M.callback=null,z=M.priorityLevel;var Ar=gr(M.expirationTime<=Nt);Nt=e.unstable_now(),typeof Ar=="function"?M.callback=Ar:M===r(E)&&n(E),ne(Nt)}else n(E);M=r(E)}if(M!==null)var Lr=!0;else{var yr=r(m);yr!==null&&Un(Me,yr.startTime-Nt),Lr=!1}return Lr}finally{M=null,z=mt,H=!1}}var je=!1,Qe=null,ot=-1,Ut=5,st=-1;function Qt(){return!(e.unstable_now()-st<Ut)}function ar(){if(Qe!==null){var pt=e.unstable_now();st=pt;var Nt=!0;try{Nt=Qe(!0,pt)}finally{Nt?Xr():(je=!1,Qe=null)}}else je=!1}var Xr;if(typeof te=="function")Xr=function(){te(ar)};else if(typeof MessageChannel<"u"){var Tr=new MessageChannel,sn=Tr.port2;Tr.port1.onmessage=ar,Xr=function(){sn.postMessage(null)}}else Xr=function(){ye(ar,0)};function qr(pt){Qe=pt,je||(je=!0,Xr())}function Un(pt,Nt){ot=ye(function(){pt(e.unstable_now())},Nt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(pt){pt.callback=null},e.unstable_continueExecution=function(){q||H||(q=!0,qr(Ve))},e.unstable_forceFrameRate=function(pt){0>pt||125<pt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ut=0<pt?Math.floor(1e3/pt):5},e.unstable_getCurrentPriorityLevel=function(){return z},e.unstable_getFirstCallbackNode=function(){return r(E)},e.unstable_next=function(pt){switch(z){case 1:case 2:case 3:var Nt=3;break;default:Nt=z}var mt=z;z=Nt;try{return pt()}finally{z=mt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(pt,Nt){switch(pt){case 1:case 2:case 3:case 4:case 5:break;default:pt=3}var mt=z;z=pt;try{return Nt()}finally{z=mt}},e.unstable_scheduleCallback=function(pt,Nt,mt){var gr=e.unstable_now();switch(typeof mt=="object"&&mt!==null?(mt=mt.delay,mt=typeof mt=="number"&&0<mt?gr+mt:gr):mt=gr,pt){case 1:var Ar=-1;break;case 2:Ar=250;break;case 5:Ar=1073741823;break;case 4:Ar=1e4;break;default:Ar=5e3}return Ar=mt+Ar,pt={id:S++,callback:Nt,priorityLevel:pt,startTime:mt,expirationTime:Ar,sortIndex:-1},mt>gr?(pt.sortIndex=mt,t(m,pt),r(E)===null&&pt===r(m)&&(Y?(Q(ot),ot=-1):Y=!0,Un(Me,mt-gr))):(pt.sortIndex=Ar,t(E,pt),q||H||(q=!0,qr(Ve))),pt},e.unstable_shouldYield=Qt,e.unstable_wrapCallback=function(pt){var Nt=z;return function(){var mt=z;z=Nt;try{return pt.apply(this,arguments)}finally{z=mt}}}})(h2);c2.exports=h2;var OA=c2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d2=ro,ra=OA;function ht(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var f2=new Set,af={};function Dc(e,t){Mh(e,t),Mh(e+"Capture",t)}function Mh(e,t){for(af[e]=t,e=0;e<t.length;e++)f2.add(t[e])}var Zl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nv=Object.prototype.hasOwnProperty,DA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gb={},yb={};function zA(e){return Nv.call(yb,e)?!0:Nv.call(gb,e)?!1:DA.test(e)?yb[e]=!0:(gb[e]=!0,!1)}function FA(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function NA(e,t,r,n){if(t===null||typeof t>"u"||FA(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function us(e,t,r,n,a,l,f){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=f}var xo={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){xo[e]=new us(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];xo[t]=new us(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){xo[e]=new us(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){xo[e]=new us(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){xo[e]=new us(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){xo[e]=new us(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){xo[e]=new us(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){xo[e]=new us(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){xo[e]=new us(e,5,!1,e.toLowerCase(),null,!1,!1)});var c0=/[\-:]([a-z])/g;function h0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(c0,h0);xo[t]=new us(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(c0,h0);xo[t]=new us(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(c0,h0);xo[t]=new us(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){xo[e]=new us(e,1,!1,e.toLowerCase(),null,!1,!1)});xo.xlinkHref=new us("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){xo[e]=new us(e,1,!1,e.toLowerCase(),null,!0,!0)});function d0(e,t,r,n){var a=xo.hasOwnProperty(t)?xo[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(NA(t,r,a,n)&&(r=null),n||a===null?zA(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Yl=d2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,gp=Symbol.for("react.element"),uh=Symbol.for("react.portal"),ch=Symbol.for("react.fragment"),f0=Symbol.for("react.strict_mode"),Bv=Symbol.for("react.profiler"),p2=Symbol.for("react.provider"),m2=Symbol.for("react.context"),p0=Symbol.for("react.forward_ref"),Uv=Symbol.for("react.suspense"),jv=Symbol.for("react.suspense_list"),m0=Symbol.for("react.memo"),vu=Symbol.for("react.lazy"),g2=Symbol.for("react.offscreen"),vb=Symbol.iterator;function Cd(e){return e===null||typeof e!="object"?null:(e=vb&&e[vb]||e["@@iterator"],typeof e=="function"?e:null)}var si=Object.assign,$y;function Nd(e){if($y===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);$y=t&&t[1]||""}return`
`+$y+e}var Vy=!1;function Gy(e,t){if(!e||Vy)return"";Vy=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(m){var n=m}Reflect.construct(e,[],t)}else{try{t.call()}catch(m){n=m}e.call(t.prototype)}else{try{throw Error()}catch(m){n=m}e()}}catch(m){if(m&&n&&typeof m.stack=="string"){for(var a=m.stack.split(`
`),l=n.stack.split(`
`),f=a.length-1,u=l.length-1;1<=f&&0<=u&&a[f]!==l[u];)u--;for(;1<=f&&0<=u;f--,u--)if(a[f]!==l[u]){if(f!==1||u!==1)do if(f--,u--,0>u||a[f]!==l[u]){var E=`
`+a[f].replace(" at new "," at ");return e.displayName&&E.includes("<anonymous>")&&(E=E.replace("<anonymous>",e.displayName)),E}while(1<=f&&0<=u);break}}}finally{Vy=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Nd(e):""}function BA(e){switch(e.tag){case 5:return Nd(e.type);case 16:return Nd("Lazy");case 13:return Nd("Suspense");case 19:return Nd("SuspenseList");case 0:case 2:case 15:return e=Gy(e.type,!1),e;case 11:return e=Gy(e.type.render,!1),e;case 1:return e=Gy(e.type,!0),e;default:return""}}function $v(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ch:return"Fragment";case uh:return"Portal";case Bv:return"Profiler";case f0:return"StrictMode";case Uv:return"Suspense";case jv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case m2:return(e.displayName||"Context")+".Consumer";case p2:return(e._context.displayName||"Context")+".Provider";case p0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case m0:return t=e.displayName||null,t!==null?t:$v(e.type)||"Memo";case vu:t=e._payload,e=e._init;try{return $v(e(t))}catch{}}return null}function UA(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $v(t);case 8:return t===f0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Fu(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function y2(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function jA(e){var t=y2(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,l=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(f){n=""+f,l.call(this,f)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(f){n=""+f},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function yp(e){e._valueTracker||(e._valueTracker=jA(e))}function v2(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=y2(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function dm(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Vv(e,t){var r=t.checked;return si({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function _b(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Fu(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function _2(e,t){t=t.checked,t!=null&&d0(e,"checked",t,!1)}function Gv(e,t){_2(e,t);var r=Fu(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?qv(e,t.type,r):t.hasOwnProperty("defaultValue")&&qv(e,t.type,Fu(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function xb(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function qv(e,t,r){(t!=="number"||dm(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Bd=Array.isArray;function wh(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Fu(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Hv(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ht(91));return si({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function bb(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ht(92));if(Bd(r)){if(1<r.length)throw Error(ht(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Fu(r)}}function x2(e,t){var r=Fu(t.value),n=Fu(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function wb(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function b2(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zv(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?b2(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var vp,w2=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(vp=vp||document.createElement("div"),vp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=vp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function lf(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Gd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$A=["Webkit","ms","Moz","O"];Object.keys(Gd).forEach(function(e){$A.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Gd[t]=Gd[e]})});function E2(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Gd.hasOwnProperty(e)&&Gd[e]?(""+t).trim():t+"px"}function S2(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=E2(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var VA=si({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wv(e,t){if(t){if(VA[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ht(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ht(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ht(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ht(62))}}function Kv(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xv=null;function g0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Jv=null,Eh=null,Sh=null;function Eb(e){if(e=zf(e)){if(typeof Jv!="function")throw Error(ht(280));var t=e.stateNode;t&&(t=cg(t),Jv(e.stateNode,e.type,t))}}function T2(e){Eh?Sh?Sh.push(e):Sh=[e]:Eh=e}function C2(){if(Eh){var e=Eh,t=Sh;if(Sh=Eh=null,Eb(e),t)for(e=0;e<t.length;e++)Eb(t[e])}}function I2(e,t){return e(t)}function P2(){}var qy=!1;function A2(e,t,r){if(qy)return e(t,r);qy=!0;try{return I2(e,t,r)}finally{qy=!1,(Eh!==null||Sh!==null)&&(P2(),C2())}}function uf(e,t){var r=e.stateNode;if(r===null)return null;var n=cg(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ht(231,t,typeof r));return r}var Yv=!1;if(Zl)try{var Id={};Object.defineProperty(Id,"passive",{get:function(){Yv=!0}}),window.addEventListener("test",Id,Id),window.removeEventListener("test",Id,Id)}catch{Yv=!1}function GA(e,t,r,n,a,l,f,u,E){var m=Array.prototype.slice.call(arguments,3);try{t.apply(r,m)}catch(S){this.onError(S)}}var qd=!1,fm=null,pm=!1,Qv=null,qA={onError:function(e){qd=!0,fm=e}};function HA(e,t,r,n,a,l,f,u,E){qd=!1,fm=null,GA.apply(qA,arguments)}function ZA(e,t,r,n,a,l,f,u,E){if(HA.apply(this,arguments),qd){if(qd){var m=fm;qd=!1,fm=null}else throw Error(ht(198));pm||(pm=!0,Qv=m)}}function zc(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function M2(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Sb(e){if(zc(e)!==e)throw Error(ht(188))}function WA(e){var t=e.alternate;if(!t){if(t=zc(e),t===null)throw Error(ht(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var l=a.alternate;if(l===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===r)return Sb(a),e;if(l===n)return Sb(a),t;l=l.sibling}throw Error(ht(188))}if(r.return!==n.return)r=a,n=l;else{for(var f=!1,u=a.child;u;){if(u===r){f=!0,r=a,n=l;break}if(u===n){f=!0,n=a,r=l;break}u=u.sibling}if(!f){for(u=l.child;u;){if(u===r){f=!0,r=l,n=a;break}if(u===n){f=!0,n=l,r=a;break}u=u.sibling}if(!f)throw Error(ht(189))}}if(r.alternate!==n)throw Error(ht(190))}if(r.tag!==3)throw Error(ht(188));return r.stateNode.current===r?e:t}function k2(e){return e=WA(e),e!==null?L2(e):null}function L2(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=L2(e);if(t!==null)return t;e=e.sibling}return null}var R2=ra.unstable_scheduleCallback,Tb=ra.unstable_cancelCallback,KA=ra.unstable_shouldYield,XA=ra.unstable_requestPaint,bi=ra.unstable_now,JA=ra.unstable_getCurrentPriorityLevel,y0=ra.unstable_ImmediatePriority,O2=ra.unstable_UserBlockingPriority,mm=ra.unstable_NormalPriority,YA=ra.unstable_LowPriority,D2=ra.unstable_IdlePriority,sg=null,_l=null;function QA(e){if(_l&&typeof _l.onCommitFiberRoot=="function")try{_l.onCommitFiberRoot(sg,e,void 0,(e.current.flags&128)===128)}catch{}}var rl=Math.clz32?Math.clz32:rM,eM=Math.log,tM=Math.LN2;function rM(e){return e>>>=0,e===0?32:31-(eM(e)/tM|0)|0}var _p=64,xp=4194304;function Ud(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function gm(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,l=e.pingedLanes,f=r&268435455;if(f!==0){var u=f&~a;u!==0?n=Ud(u):(l&=f,l!==0&&(n=Ud(l)))}else f=r&~a,f!==0?n=Ud(f):l!==0&&(n=Ud(l));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,l=t&-t,a>=l||a===16&&(l&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-rl(t),a=1<<r,n|=e[r],t&=~a;return n}function nM(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function iM(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,l=e.pendingLanes;0<l;){var f=31-rl(l),u=1<<f,E=a[f];E===-1?(!(u&r)||u&n)&&(a[f]=nM(u,t)):E<=t&&(e.expiredLanes|=u),l&=~u}}function e_(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function z2(){var e=_p;return _p<<=1,!(_p&4194240)&&(_p=64),e}function Hy(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Of(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-rl(t),e[t]=r}function oM(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-rl(r),l=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~l}}function v0(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-rl(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var yn=0;function F2(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var N2,_0,B2,U2,j2,t_=!1,bp=[],Au=null,Mu=null,ku=null,cf=new Map,hf=new Map,Eu=[],sM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Cb(e,t){switch(e){case"focusin":case"focusout":Au=null;break;case"dragenter":case"dragleave":Mu=null;break;case"mouseover":case"mouseout":ku=null;break;case"pointerover":case"pointerout":cf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":hf.delete(t.pointerId)}}function Pd(e,t,r,n,a,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:l,targetContainers:[a]},t!==null&&(t=zf(t),t!==null&&_0(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function aM(e,t,r,n,a){switch(t){case"focusin":return Au=Pd(Au,e,t,r,n,a),!0;case"dragenter":return Mu=Pd(Mu,e,t,r,n,a),!0;case"mouseover":return ku=Pd(ku,e,t,r,n,a),!0;case"pointerover":var l=a.pointerId;return cf.set(l,Pd(cf.get(l)||null,e,t,r,n,a)),!0;case"gotpointercapture":return l=a.pointerId,hf.set(l,Pd(hf.get(l)||null,e,t,r,n,a)),!0}return!1}function $2(e){var t=xc(e.target);if(t!==null){var r=zc(t);if(r!==null){if(t=r.tag,t===13){if(t=M2(r),t!==null){e.blockedOn=t,j2(e.priority,function(){B2(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xp(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=r_(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Xv=n,r.target.dispatchEvent(n),Xv=null}else return t=zf(r),t!==null&&_0(t),e.blockedOn=r,!1;t.shift()}return!0}function Ib(e,t,r){Xp(e)&&r.delete(t)}function lM(){t_=!1,Au!==null&&Xp(Au)&&(Au=null),Mu!==null&&Xp(Mu)&&(Mu=null),ku!==null&&Xp(ku)&&(ku=null),cf.forEach(Ib),hf.forEach(Ib)}function Ad(e,t){e.blockedOn===t&&(e.blockedOn=null,t_||(t_=!0,ra.unstable_scheduleCallback(ra.unstable_NormalPriority,lM)))}function df(e){function t(a){return Ad(a,e)}if(0<bp.length){Ad(bp[0],e);for(var r=1;r<bp.length;r++){var n=bp[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Au!==null&&Ad(Au,e),Mu!==null&&Ad(Mu,e),ku!==null&&Ad(ku,e),cf.forEach(t),hf.forEach(t),r=0;r<Eu.length;r++)n=Eu[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Eu.length&&(r=Eu[0],r.blockedOn===null);)$2(r),r.blockedOn===null&&Eu.shift()}var Th=Yl.ReactCurrentBatchConfig,ym=!0;function uM(e,t,r,n){var a=yn,l=Th.transition;Th.transition=null;try{yn=1,x0(e,t,r,n)}finally{yn=a,Th.transition=l}}function cM(e,t,r,n){var a=yn,l=Th.transition;Th.transition=null;try{yn=4,x0(e,t,r,n)}finally{yn=a,Th.transition=l}}function x0(e,t,r,n){if(ym){var a=r_(e,t,r,n);if(a===null)rv(e,t,n,vm,r),Cb(e,n);else if(aM(a,e,t,r,n))n.stopPropagation();else if(Cb(e,n),t&4&&-1<sM.indexOf(e)){for(;a!==null;){var l=zf(a);if(l!==null&&N2(l),l=r_(e,t,r,n),l===null&&rv(e,t,n,vm,r),l===a)break;a=l}a!==null&&n.stopPropagation()}else rv(e,t,n,null,r)}}var vm=null;function r_(e,t,r,n){if(vm=null,e=g0(n),e=xc(e),e!==null)if(t=zc(e),t===null)e=null;else if(r=t.tag,r===13){if(e=M2(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return vm=e,null}function V2(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(JA()){case y0:return 1;case O2:return 4;case mm:case YA:return 16;case D2:return 536870912;default:return 16}default:return 16}}var Tu=null,b0=null,Jp=null;function G2(){if(Jp)return Jp;var e,t=b0,r=t.length,n,a="value"in Tu?Tu.value:Tu.textContent,l=a.length;for(e=0;e<r&&t[e]===a[e];e++);var f=r-e;for(n=1;n<=f&&t[r-n]===a[l-n];n++);return Jp=a.slice(e,1<n?1-n:void 0)}function Yp(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function wp(){return!0}function Pb(){return!1}function oa(e){function t(r,n,a,l,f){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=l,this.target=f,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(r=e[u],this[u]=r?r(l):l[u]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?wp:Pb,this.isPropagationStopped=Pb,this}return si(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=wp)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=wp)},persist:function(){},isPersistent:wp}),t}var Gh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},w0=oa(Gh),Df=si({},Gh,{view:0,detail:0}),hM=oa(Df),Zy,Wy,Md,ag=si({},Df,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:E0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Md&&(Md&&e.type==="mousemove"?(Zy=e.screenX-Md.screenX,Wy=e.screenY-Md.screenY):Wy=Zy=0,Md=e),Zy)},movementY:function(e){return"movementY"in e?e.movementY:Wy}}),Ab=oa(ag),dM=si({},ag,{dataTransfer:0}),fM=oa(dM),pM=si({},Df,{relatedTarget:0}),Ky=oa(pM),mM=si({},Gh,{animationName:0,elapsedTime:0,pseudoElement:0}),gM=oa(mM),yM=si({},Gh,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vM=oa(yM),_M=si({},Gh,{data:0}),Mb=oa(_M),xM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function EM(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=wM[e])?!!t[e]:!1}function E0(){return EM}var SM=si({},Df,{key:function(e){if(e.key){var t=xM[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Yp(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?bM[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:E0,charCode:function(e){return e.type==="keypress"?Yp(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Yp(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),TM=oa(SM),CM=si({},ag,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kb=oa(CM),IM=si({},Df,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:E0}),PM=oa(IM),AM=si({},Gh,{propertyName:0,elapsedTime:0,pseudoElement:0}),MM=oa(AM),kM=si({},ag,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),LM=oa(kM),RM=[9,13,27,32],S0=Zl&&"CompositionEvent"in window,Hd=null;Zl&&"documentMode"in document&&(Hd=document.documentMode);var OM=Zl&&"TextEvent"in window&&!Hd,q2=Zl&&(!S0||Hd&&8<Hd&&11>=Hd),Lb=String.fromCharCode(32),Rb=!1;function H2(e,t){switch(e){case"keyup":return RM.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Z2(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var hh=!1;function DM(e,t){switch(e){case"compositionend":return Z2(t);case"keypress":return t.which!==32?null:(Rb=!0,Lb);case"textInput":return e=t.data,e===Lb&&Rb?null:e;default:return null}}function zM(e,t){if(hh)return e==="compositionend"||!S0&&H2(e,t)?(e=G2(),Jp=b0=Tu=null,hh=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return q2&&t.locale!=="ko"?null:t.data;default:return null}}var FM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ob(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!FM[e.type]:t==="textarea"}function W2(e,t,r,n){T2(n),t=_m(t,"onChange"),0<t.length&&(r=new w0("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Zd=null,ff=null;function NM(e){oS(e,0)}function lg(e){var t=ph(e);if(v2(t))return e}function BM(e,t){if(e==="change")return t}var K2=!1;if(Zl){var Xy;if(Zl){var Jy="oninput"in document;if(!Jy){var Db=document.createElement("div");Db.setAttribute("oninput","return;"),Jy=typeof Db.oninput=="function"}Xy=Jy}else Xy=!1;K2=Xy&&(!document.documentMode||9<document.documentMode)}function zb(){Zd&&(Zd.detachEvent("onpropertychange",X2),ff=Zd=null)}function X2(e){if(e.propertyName==="value"&&lg(ff)){var t=[];W2(t,ff,e,g0(e)),A2(NM,t)}}function UM(e,t,r){e==="focusin"?(zb(),Zd=t,ff=r,Zd.attachEvent("onpropertychange",X2)):e==="focusout"&&zb()}function jM(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return lg(ff)}function $M(e,t){if(e==="click")return lg(t)}function VM(e,t){if(e==="input"||e==="change")return lg(t)}function GM(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var il=typeof Object.is=="function"?Object.is:GM;function pf(e,t){if(il(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!Nv.call(t,a)||!il(e[a],t[a]))return!1}return!0}function Fb(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Nb(e,t){var r=Fb(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Fb(r)}}function J2(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?J2(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Y2(){for(var e=window,t=dm();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=dm(e.document)}return t}function T0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function qM(e){var t=Y2(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&J2(r.ownerDocument.documentElement,r)){if(n!==null&&T0(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,l=Math.min(n.start,a);n=n.end===void 0?l:Math.min(n.end,a),!e.extend&&l>n&&(a=n,n=l,l=a),a=Nb(r,l);var f=Nb(r,n);a&&f&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==f.node||e.focusOffset!==f.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),l>n?(e.addRange(t),e.extend(f.node,f.offset)):(t.setEnd(f.node,f.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var HM=Zl&&"documentMode"in document&&11>=document.documentMode,dh=null,n_=null,Wd=null,i_=!1;function Bb(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;i_||dh==null||dh!==dm(n)||(n=dh,"selectionStart"in n&&T0(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Wd&&pf(Wd,n)||(Wd=n,n=_m(n_,"onSelect"),0<n.length&&(t=new w0("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=dh)))}function Ep(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var fh={animationend:Ep("Animation","AnimationEnd"),animationiteration:Ep("Animation","AnimationIteration"),animationstart:Ep("Animation","AnimationStart"),transitionend:Ep("Transition","TransitionEnd")},Yy={},Q2={};Zl&&(Q2=document.createElement("div").style,"AnimationEvent"in window||(delete fh.animationend.animation,delete fh.animationiteration.animation,delete fh.animationstart.animation),"TransitionEvent"in window||delete fh.transitionend.transition);function ug(e){if(Yy[e])return Yy[e];if(!fh[e])return e;var t=fh[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Q2)return Yy[e]=t[r];return e}var eS=ug("animationend"),tS=ug("animationiteration"),rS=ug("animationstart"),nS=ug("transitionend"),iS=new Map,Ub="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ju(e,t){iS.set(e,t),Dc(t,[e])}for(var Qy=0;Qy<Ub.length;Qy++){var ev=Ub[Qy],ZM=ev.toLowerCase(),WM=ev[0].toUpperCase()+ev.slice(1);ju(ZM,"on"+WM)}ju(eS,"onAnimationEnd");ju(tS,"onAnimationIteration");ju(rS,"onAnimationStart");ju("dblclick","onDoubleClick");ju("focusin","onFocus");ju("focusout","onBlur");ju(nS,"onTransitionEnd");Mh("onMouseEnter",["mouseout","mouseover"]);Mh("onMouseLeave",["mouseout","mouseover"]);Mh("onPointerEnter",["pointerout","pointerover"]);Mh("onPointerLeave",["pointerout","pointerover"]);Dc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Dc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Dc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Dc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Dc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Dc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KM=new Set("cancel close invalid load scroll toggle".split(" ").concat(jd));function jb(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,ZA(n,t,void 0,e),e.currentTarget=null}function oS(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var l=void 0;if(t)for(var f=n.length-1;0<=f;f--){var u=n[f],E=u.instance,m=u.currentTarget;if(u=u.listener,E!==l&&a.isPropagationStopped())break e;jb(a,u,m),l=E}else for(f=0;f<n.length;f++){if(u=n[f],E=u.instance,m=u.currentTarget,u=u.listener,E!==l&&a.isPropagationStopped())break e;jb(a,u,m),l=E}}}if(pm)throw e=Qv,pm=!1,Qv=null,e}function Nn(e,t){var r=t[u_];r===void 0&&(r=t[u_]=new Set);var n=e+"__bubble";r.has(n)||(sS(t,e,2,!1),r.add(n))}function tv(e,t,r){var n=0;t&&(n|=4),sS(r,e,n,t)}var Sp="_reactListening"+Math.random().toString(36).slice(2);function mf(e){if(!e[Sp]){e[Sp]=!0,f2.forEach(function(r){r!=="selectionchange"&&(KM.has(r)||tv(r,!1,e),tv(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Sp]||(t[Sp]=!0,tv("selectionchange",!1,t))}}function sS(e,t,r,n){switch(V2(t)){case 1:var a=uM;break;case 4:a=cM;break;default:a=x0}r=a.bind(null,t,r,e),a=void 0,!Yv||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function rv(e,t,r,n,a){var l=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var f=n.tag;if(f===3||f===4){var u=n.stateNode.containerInfo;if(u===a||u.nodeType===8&&u.parentNode===a)break;if(f===4)for(f=n.return;f!==null;){var E=f.tag;if((E===3||E===4)&&(E=f.stateNode.containerInfo,E===a||E.nodeType===8&&E.parentNode===a))return;f=f.return}for(;u!==null;){if(f=xc(u),f===null)return;if(E=f.tag,E===5||E===6){n=l=f;continue e}u=u.parentNode}}n=n.return}A2(function(){var m=l,S=g0(r),M=[];e:{var z=iS.get(e);if(z!==void 0){var H=w0,q=e;switch(e){case"keypress":if(Yp(r)===0)break e;case"keydown":case"keyup":H=TM;break;case"focusin":q="focus",H=Ky;break;case"focusout":q="blur",H=Ky;break;case"beforeblur":case"afterblur":H=Ky;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":H=Ab;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":H=fM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":H=PM;break;case eS:case tS:case rS:H=gM;break;case nS:H=MM;break;case"scroll":H=hM;break;case"wheel":H=LM;break;case"copy":case"cut":case"paste":H=vM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":H=kb}var Y=(t&4)!==0,ye=!Y&&e==="scroll",Q=Y?z!==null?z+"Capture":null:z;Y=[];for(var te=m,ne;te!==null;){ne=te;var Me=ne.stateNode;if(ne.tag===5&&Me!==null&&(ne=Me,Q!==null&&(Me=uf(te,Q),Me!=null&&Y.push(gf(te,Me,ne)))),ye)break;te=te.return}0<Y.length&&(z=new H(z,q,null,r,S),M.push({event:z,listeners:Y}))}}if(!(t&7)){e:{if(z=e==="mouseover"||e==="pointerover",H=e==="mouseout"||e==="pointerout",z&&r!==Xv&&(q=r.relatedTarget||r.fromElement)&&(xc(q)||q[Wl]))break e;if((H||z)&&(z=S.window===S?S:(z=S.ownerDocument)?z.defaultView||z.parentWindow:window,H?(q=r.relatedTarget||r.toElement,H=m,q=q?xc(q):null,q!==null&&(ye=zc(q),q!==ye||q.tag!==5&&q.tag!==6)&&(q=null)):(H=null,q=m),H!==q)){if(Y=Ab,Me="onMouseLeave",Q="onMouseEnter",te="mouse",(e==="pointerout"||e==="pointerover")&&(Y=kb,Me="onPointerLeave",Q="onPointerEnter",te="pointer"),ye=H==null?z:ph(H),ne=q==null?z:ph(q),z=new Y(Me,te+"leave",H,r,S),z.target=ye,z.relatedTarget=ne,Me=null,xc(S)===m&&(Y=new Y(Q,te+"enter",q,r,S),Y.target=ne,Y.relatedTarget=ye,Me=Y),ye=Me,H&&q)t:{for(Y=H,Q=q,te=0,ne=Y;ne;ne=ih(ne))te++;for(ne=0,Me=Q;Me;Me=ih(Me))ne++;for(;0<te-ne;)Y=ih(Y),te--;for(;0<ne-te;)Q=ih(Q),ne--;for(;te--;){if(Y===Q||Q!==null&&Y===Q.alternate)break t;Y=ih(Y),Q=ih(Q)}Y=null}else Y=null;H!==null&&$b(M,z,H,Y,!1),q!==null&&ye!==null&&$b(M,ye,q,Y,!0)}}e:{if(z=m?ph(m):window,H=z.nodeName&&z.nodeName.toLowerCase(),H==="select"||H==="input"&&z.type==="file")var Ve=BM;else if(Ob(z))if(K2)Ve=VM;else{Ve=jM;var je=UM}else(H=z.nodeName)&&H.toLowerCase()==="input"&&(z.type==="checkbox"||z.type==="radio")&&(Ve=$M);if(Ve&&(Ve=Ve(e,m))){W2(M,Ve,r,S);break e}je&&je(e,z,m),e==="focusout"&&(je=z._wrapperState)&&je.controlled&&z.type==="number"&&qv(z,"number",z.value)}switch(je=m?ph(m):window,e){case"focusin":(Ob(je)||je.contentEditable==="true")&&(dh=je,n_=m,Wd=null);break;case"focusout":Wd=n_=dh=null;break;case"mousedown":i_=!0;break;case"contextmenu":case"mouseup":case"dragend":i_=!1,Bb(M,r,S);break;case"selectionchange":if(HM)break;case"keydown":case"keyup":Bb(M,r,S)}var Qe;if(S0)e:{switch(e){case"compositionstart":var ot="onCompositionStart";break e;case"compositionend":ot="onCompositionEnd";break e;case"compositionupdate":ot="onCompositionUpdate";break e}ot=void 0}else hh?H2(e,r)&&(ot="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(ot="onCompositionStart");ot&&(q2&&r.locale!=="ko"&&(hh||ot!=="onCompositionStart"?ot==="onCompositionEnd"&&hh&&(Qe=G2()):(Tu=S,b0="value"in Tu?Tu.value:Tu.textContent,hh=!0)),je=_m(m,ot),0<je.length&&(ot=new Mb(ot,e,null,r,S),M.push({event:ot,listeners:je}),Qe?ot.data=Qe:(Qe=Z2(r),Qe!==null&&(ot.data=Qe)))),(Qe=OM?DM(e,r):zM(e,r))&&(m=_m(m,"onBeforeInput"),0<m.length&&(S=new Mb("onBeforeInput","beforeinput",null,r,S),M.push({event:S,listeners:m}),S.data=Qe))}oS(M,t)})}function gf(e,t,r){return{instance:e,listener:t,currentTarget:r}}function _m(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=uf(e,r),l!=null&&n.unshift(gf(e,l,a)),l=uf(e,t),l!=null&&n.push(gf(e,l,a))),e=e.return}return n}function ih(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function $b(e,t,r,n,a){for(var l=t._reactName,f=[];r!==null&&r!==n;){var u=r,E=u.alternate,m=u.stateNode;if(E!==null&&E===n)break;u.tag===5&&m!==null&&(u=m,a?(E=uf(r,l),E!=null&&f.unshift(gf(r,E,u))):a||(E=uf(r,l),E!=null&&f.push(gf(r,E,u)))),r=r.return}f.length!==0&&e.push({event:t,listeners:f})}var XM=/\r\n?/g,JM=/\u0000|\uFFFD/g;function Vb(e){return(typeof e=="string"?e:""+e).replace(XM,`
`).replace(JM,"")}function Tp(e,t,r){if(t=Vb(t),Vb(e)!==t&&r)throw Error(ht(425))}function xm(){}var o_=null,s_=null;function a_(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var l_=typeof setTimeout=="function"?setTimeout:void 0,YM=typeof clearTimeout=="function"?clearTimeout:void 0,Gb=typeof Promise=="function"?Promise:void 0,QM=typeof queueMicrotask=="function"?queueMicrotask:typeof Gb<"u"?function(e){return Gb.resolve(null).then(e).catch(ek)}:l_;function ek(e){setTimeout(function(){throw e})}function nv(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),df(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);df(t)}function Lu(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function qb(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var qh=Math.random().toString(36).slice(2),vl="__reactFiber$"+qh,yf="__reactProps$"+qh,Wl="__reactContainer$"+qh,u_="__reactEvents$"+qh,tk="__reactListeners$"+qh,rk="__reactHandles$"+qh;function xc(e){var t=e[vl];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Wl]||r[vl]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=qb(e);e!==null;){if(r=e[vl])return r;e=qb(e)}return t}e=r,r=e.parentNode}return null}function zf(e){return e=e[vl]||e[Wl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ph(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ht(33))}function cg(e){return e[yf]||null}var c_=[],mh=-1;function $u(e){return{current:e}}function Bn(e){0>mh||(e.current=c_[mh],c_[mh]=null,mh--)}function On(e,t){mh++,c_[mh]=e.current,e.current=t}var Nu={},Bo=$u(Nu),Ss=$u(!1),Mc=Nu;function kh(e,t){var r=e.type.contextTypes;if(!r)return Nu;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in r)a[l]=t[l];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ts(e){return e=e.childContextTypes,e!=null}function bm(){Bn(Ss),Bn(Bo)}function Hb(e,t,r){if(Bo.current!==Nu)throw Error(ht(168));On(Bo,t),On(Ss,r)}function aS(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(ht(108,UA(e)||"Unknown",a));return si({},r,n)}function wm(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Nu,Mc=Bo.current,On(Bo,e),On(Ss,Ss.current),!0}function Zb(e,t,r){var n=e.stateNode;if(!n)throw Error(ht(169));r?(e=aS(e,t,Mc),n.__reactInternalMemoizedMergedChildContext=e,Bn(Ss),Bn(Bo),On(Bo,e)):Bn(Ss),On(Ss,r)}var jl=null,hg=!1,iv=!1;function lS(e){jl===null?jl=[e]:jl.push(e)}function nk(e){hg=!0,lS(e)}function Vu(){if(!iv&&jl!==null){iv=!0;var e=0,t=yn;try{var r=jl;for(yn=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}jl=null,hg=!1}catch(a){throw jl!==null&&(jl=jl.slice(e+1)),R2(y0,Vu),a}finally{yn=t,iv=!1}}return null}var gh=[],yh=0,Em=null,Sm=0,Ca=[],Ia=0,kc=null,$l=1,Vl="";function gc(e,t){gh[yh++]=Sm,gh[yh++]=Em,Em=e,Sm=t}function uS(e,t,r){Ca[Ia++]=$l,Ca[Ia++]=Vl,Ca[Ia++]=kc,kc=e;var n=$l;e=Vl;var a=32-rl(n)-1;n&=~(1<<a),r+=1;var l=32-rl(t)+a;if(30<l){var f=a-a%5;l=(n&(1<<f)-1).toString(32),n>>=f,a-=f,$l=1<<32-rl(t)+a|r<<a|n,Vl=l+e}else $l=1<<l|r<<a|n,Vl=e}function C0(e){e.return!==null&&(gc(e,1),uS(e,1,0))}function I0(e){for(;e===Em;)Em=gh[--yh],gh[yh]=null,Sm=gh[--yh],gh[yh]=null;for(;e===kc;)kc=Ca[--Ia],Ca[Ia]=null,Vl=Ca[--Ia],Ca[Ia]=null,$l=Ca[--Ia],Ca[Ia]=null}var ta=null,ea=null,Kn=!1,tl=null;function cS(e,t){var r=Aa(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Wb(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ta=e,ea=Lu(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ta=e,ea=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=kc!==null?{id:$l,overflow:Vl}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Aa(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ta=e,ea=null,!0):!1;default:return!1}}function h_(e){return(e.mode&1)!==0&&(e.flags&128)===0}function d_(e){if(Kn){var t=ea;if(t){var r=t;if(!Wb(e,t)){if(h_(e))throw Error(ht(418));t=Lu(r.nextSibling);var n=ta;t&&Wb(e,t)?cS(n,r):(e.flags=e.flags&-4097|2,Kn=!1,ta=e)}}else{if(h_(e))throw Error(ht(418));e.flags=e.flags&-4097|2,Kn=!1,ta=e}}}function Kb(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ta=e}function Cp(e){if(e!==ta)return!1;if(!Kn)return Kb(e),Kn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!a_(e.type,e.memoizedProps)),t&&(t=ea)){if(h_(e))throw hS(),Error(ht(418));for(;t;)cS(e,t),t=Lu(t.nextSibling)}if(Kb(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ht(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ea=Lu(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ea=null}}else ea=ta?Lu(e.stateNode.nextSibling):null;return!0}function hS(){for(var e=ea;e;)e=Lu(e.nextSibling)}function Lh(){ea=ta=null,Kn=!1}function P0(e){tl===null?tl=[e]:tl.push(e)}var ik=Yl.ReactCurrentBatchConfig;function Qa(e,t){if(e&&e.defaultProps){t=si({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}var Tm=$u(null),Cm=null,vh=null,A0=null;function M0(){A0=vh=Cm=null}function k0(e){var t=Tm.current;Bn(Tm),e._currentValue=t}function f_(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ch(e,t){Cm=e,A0=vh=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Es=!0),e.firstContext=null)}function ka(e){var t=e._currentValue;if(A0!==e)if(e={context:e,memoizedValue:t,next:null},vh===null){if(Cm===null)throw Error(ht(308));vh=e,Cm.dependencies={lanes:0,firstContext:e}}else vh=vh.next=e;return t}var bc=null;function L0(e){bc===null?bc=[e]:bc.push(e)}function dS(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,L0(t)):(r.next=a.next,a.next=r),t.interleaved=r,Kl(e,n)}function Kl(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var _u=!1;function R0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fS(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Gl(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ru(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,rn&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Kl(e,r)}return a=n.interleaved,a===null?(t.next=t,L0(n)):(t.next=a.next,a.next=t),n.interleaved=t,Kl(e,r)}function Qp(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,v0(e,r)}}function Xb(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,l=null;if(r=r.firstBaseUpdate,r!==null){do{var f={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};l===null?a=l=f:l=l.next=f,r=r.next}while(r!==null);l===null?a=l=t:l=l.next=t}else a=l=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Im(e,t,r,n){var a=e.updateQueue;_u=!1;var l=a.firstBaseUpdate,f=a.lastBaseUpdate,u=a.shared.pending;if(u!==null){a.shared.pending=null;var E=u,m=E.next;E.next=null,f===null?l=m:f.next=m,f=E;var S=e.alternate;S!==null&&(S=S.updateQueue,u=S.lastBaseUpdate,u!==f&&(u===null?S.firstBaseUpdate=m:u.next=m,S.lastBaseUpdate=E))}if(l!==null){var M=a.baseState;f=0,S=m=E=null,u=l;do{var z=u.lane,H=u.eventTime;if((n&z)===z){S!==null&&(S=S.next={eventTime:H,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var q=e,Y=u;switch(z=t,H=r,Y.tag){case 1:if(q=Y.payload,typeof q=="function"){M=q.call(H,M,z);break e}M=q;break e;case 3:q.flags=q.flags&-65537|128;case 0:if(q=Y.payload,z=typeof q=="function"?q.call(H,M,z):q,z==null)break e;M=si({},M,z);break e;case 2:_u=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,z=a.effects,z===null?a.effects=[u]:z.push(u))}else H={eventTime:H,lane:z,tag:u.tag,payload:u.payload,callback:u.callback,next:null},S===null?(m=S=H,E=M):S=S.next=H,f|=z;if(u=u.next,u===null){if(u=a.shared.pending,u===null)break;z=u,u=z.next,z.next=null,a.lastBaseUpdate=z,a.shared.pending=null}}while(1);if(S===null&&(E=M),a.baseState=E,a.firstBaseUpdate=m,a.lastBaseUpdate=S,t=a.shared.interleaved,t!==null){a=t;do f|=a.lane,a=a.next;while(a!==t)}else l===null&&(a.shared.lanes=0);Rc|=f,e.lanes=f,e.memoizedState=M}}function Jb(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(ht(191,a));a.call(n)}}}var pS=new d2.Component().refs;function p_(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:si({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var dg={isMounted:function(e){return(e=e._reactInternals)?zc(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ss(),a=Du(e),l=Gl(n,a);l.payload=t,r!=null&&(l.callback=r),t=Ru(e,l,a),t!==null&&(nl(t,e,a,n),Qp(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ss(),a=Du(e),l=Gl(n,a);l.tag=1,l.payload=t,r!=null&&(l.callback=r),t=Ru(e,l,a),t!==null&&(nl(t,e,a,n),Qp(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ss(),n=Du(e),a=Gl(r,n);a.tag=2,t!=null&&(a.callback=t),t=Ru(e,a,n),t!==null&&(nl(t,e,n,r),Qp(t,e,n))}};function Yb(e,t,r,n,a,l,f){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,l,f):t.prototype&&t.prototype.isPureReactComponent?!pf(r,n)||!pf(a,l):!0}function mS(e,t,r){var n=!1,a=Nu,l=t.contextType;return typeof l=="object"&&l!==null?l=ka(l):(a=Ts(t)?Mc:Bo.current,n=t.contextTypes,l=(n=n!=null)?kh(e,a):Nu),t=new t(r,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=dg,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=l),t}function Qb(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&dg.enqueueReplaceState(t,t.state,null)}function m_(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs=pS,R0(e);var l=t.contextType;typeof l=="object"&&l!==null?a.context=ka(l):(l=Ts(t)?Mc:Bo.current,a.context=kh(e,l)),a.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(p_(e,t,l,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&dg.enqueueReplaceState(a,a.state,null),Im(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function kd(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ht(309));var n=r.stateNode}if(!n)throw Error(ht(147,e));var a=n,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(f){var u=a.refs;u===pS&&(u=a.refs={}),f===null?delete u[l]:u[l]=f},t._stringRef=l,t)}if(typeof e!="string")throw Error(ht(284));if(!r._owner)throw Error(ht(290,e))}return e}function Ip(e,t){throw e=Object.prototype.toString.call(t),Error(ht(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ew(e){var t=e._init;return t(e._payload)}function gS(e){function t(Q,te){if(e){var ne=Q.deletions;ne===null?(Q.deletions=[te],Q.flags|=16):ne.push(te)}}function r(Q,te){if(!e)return null;for(;te!==null;)t(Q,te),te=te.sibling;return null}function n(Q,te){for(Q=new Map;te!==null;)te.key!==null?Q.set(te.key,te):Q.set(te.index,te),te=te.sibling;return Q}function a(Q,te){return Q=zu(Q,te),Q.index=0,Q.sibling=null,Q}function l(Q,te,ne){return Q.index=ne,e?(ne=Q.alternate,ne!==null?(ne=ne.index,ne<te?(Q.flags|=2,te):ne):(Q.flags|=2,te)):(Q.flags|=1048576,te)}function f(Q){return e&&Q.alternate===null&&(Q.flags|=2),Q}function u(Q,te,ne,Me){return te===null||te.tag!==6?(te=hv(ne,Q.mode,Me),te.return=Q,te):(te=a(te,ne),te.return=Q,te)}function E(Q,te,ne,Me){var Ve=ne.type;return Ve===ch?S(Q,te,ne.props.children,Me,ne.key):te!==null&&(te.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===vu&&ew(Ve)===te.type)?(Me=a(te,ne.props),Me.ref=kd(Q,te,ne),Me.return=Q,Me):(Me=om(ne.type,ne.key,ne.props,null,Q.mode,Me),Me.ref=kd(Q,te,ne),Me.return=Q,Me)}function m(Q,te,ne,Me){return te===null||te.tag!==4||te.stateNode.containerInfo!==ne.containerInfo||te.stateNode.implementation!==ne.implementation?(te=dv(ne,Q.mode,Me),te.return=Q,te):(te=a(te,ne.children||[]),te.return=Q,te)}function S(Q,te,ne,Me,Ve){return te===null||te.tag!==7?(te=Ac(ne,Q.mode,Me,Ve),te.return=Q,te):(te=a(te,ne),te.return=Q,te)}function M(Q,te,ne){if(typeof te=="string"&&te!==""||typeof te=="number")return te=hv(""+te,Q.mode,ne),te.return=Q,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case gp:return ne=om(te.type,te.key,te.props,null,Q.mode,ne),ne.ref=kd(Q,null,te),ne.return=Q,ne;case uh:return te=dv(te,Q.mode,ne),te.return=Q,te;case vu:var Me=te._init;return M(Q,Me(te._payload),ne)}if(Bd(te)||Cd(te))return te=Ac(te,Q.mode,ne,null),te.return=Q,te;Ip(Q,te)}return null}function z(Q,te,ne,Me){var Ve=te!==null?te.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number")return Ve!==null?null:u(Q,te,""+ne,Me);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case gp:return ne.key===Ve?E(Q,te,ne,Me):null;case uh:return ne.key===Ve?m(Q,te,ne,Me):null;case vu:return Ve=ne._init,z(Q,te,Ve(ne._payload),Me)}if(Bd(ne)||Cd(ne))return Ve!==null?null:S(Q,te,ne,Me,null);Ip(Q,ne)}return null}function H(Q,te,ne,Me,Ve){if(typeof Me=="string"&&Me!==""||typeof Me=="number")return Q=Q.get(ne)||null,u(te,Q,""+Me,Ve);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case gp:return Q=Q.get(Me.key===null?ne:Me.key)||null,E(te,Q,Me,Ve);case uh:return Q=Q.get(Me.key===null?ne:Me.key)||null,m(te,Q,Me,Ve);case vu:var je=Me._init;return H(Q,te,ne,je(Me._payload),Ve)}if(Bd(Me)||Cd(Me))return Q=Q.get(ne)||null,S(te,Q,Me,Ve,null);Ip(te,Me)}return null}function q(Q,te,ne,Me){for(var Ve=null,je=null,Qe=te,ot=te=0,Ut=null;Qe!==null&&ot<ne.length;ot++){Qe.index>ot?(Ut=Qe,Qe=null):Ut=Qe.sibling;var st=z(Q,Qe,ne[ot],Me);if(st===null){Qe===null&&(Qe=Ut);break}e&&Qe&&st.alternate===null&&t(Q,Qe),te=l(st,te,ot),je===null?Ve=st:je.sibling=st,je=st,Qe=Ut}if(ot===ne.length)return r(Q,Qe),Kn&&gc(Q,ot),Ve;if(Qe===null){for(;ot<ne.length;ot++)Qe=M(Q,ne[ot],Me),Qe!==null&&(te=l(Qe,te,ot),je===null?Ve=Qe:je.sibling=Qe,je=Qe);return Kn&&gc(Q,ot),Ve}for(Qe=n(Q,Qe);ot<ne.length;ot++)Ut=H(Qe,Q,ot,ne[ot],Me),Ut!==null&&(e&&Ut.alternate!==null&&Qe.delete(Ut.key===null?ot:Ut.key),te=l(Ut,te,ot),je===null?Ve=Ut:je.sibling=Ut,je=Ut);return e&&Qe.forEach(function(Qt){return t(Q,Qt)}),Kn&&gc(Q,ot),Ve}function Y(Q,te,ne,Me){var Ve=Cd(ne);if(typeof Ve!="function")throw Error(ht(150));if(ne=Ve.call(ne),ne==null)throw Error(ht(151));for(var je=Ve=null,Qe=te,ot=te=0,Ut=null,st=ne.next();Qe!==null&&!st.done;ot++,st=ne.next()){Qe.index>ot?(Ut=Qe,Qe=null):Ut=Qe.sibling;var Qt=z(Q,Qe,st.value,Me);if(Qt===null){Qe===null&&(Qe=Ut);break}e&&Qe&&Qt.alternate===null&&t(Q,Qe),te=l(Qt,te,ot),je===null?Ve=Qt:je.sibling=Qt,je=Qt,Qe=Ut}if(st.done)return r(Q,Qe),Kn&&gc(Q,ot),Ve;if(Qe===null){for(;!st.done;ot++,st=ne.next())st=M(Q,st.value,Me),st!==null&&(te=l(st,te,ot),je===null?Ve=st:je.sibling=st,je=st);return Kn&&gc(Q,ot),Ve}for(Qe=n(Q,Qe);!st.done;ot++,st=ne.next())st=H(Qe,Q,ot,st.value,Me),st!==null&&(e&&st.alternate!==null&&Qe.delete(st.key===null?ot:st.key),te=l(st,te,ot),je===null?Ve=st:je.sibling=st,je=st);return e&&Qe.forEach(function(ar){return t(Q,ar)}),Kn&&gc(Q,ot),Ve}function ye(Q,te,ne,Me){if(typeof ne=="object"&&ne!==null&&ne.type===ch&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case gp:e:{for(var Ve=ne.key,je=te;je!==null;){if(je.key===Ve){if(Ve=ne.type,Ve===ch){if(je.tag===7){r(Q,je.sibling),te=a(je,ne.props.children),te.return=Q,Q=te;break e}}else if(je.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===vu&&ew(Ve)===je.type){r(Q,je.sibling),te=a(je,ne.props),te.ref=kd(Q,je,ne),te.return=Q,Q=te;break e}r(Q,je);break}else t(Q,je);je=je.sibling}ne.type===ch?(te=Ac(ne.props.children,Q.mode,Me,ne.key),te.return=Q,Q=te):(Me=om(ne.type,ne.key,ne.props,null,Q.mode,Me),Me.ref=kd(Q,te,ne),Me.return=Q,Q=Me)}return f(Q);case uh:e:{for(je=ne.key;te!==null;){if(te.key===je)if(te.tag===4&&te.stateNode.containerInfo===ne.containerInfo&&te.stateNode.implementation===ne.implementation){r(Q,te.sibling),te=a(te,ne.children||[]),te.return=Q,Q=te;break e}else{r(Q,te);break}else t(Q,te);te=te.sibling}te=dv(ne,Q.mode,Me),te.return=Q,Q=te}return f(Q);case vu:return je=ne._init,ye(Q,te,je(ne._payload),Me)}if(Bd(ne))return q(Q,te,ne,Me);if(Cd(ne))return Y(Q,te,ne,Me);Ip(Q,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"?(ne=""+ne,te!==null&&te.tag===6?(r(Q,te.sibling),te=a(te,ne),te.return=Q,Q=te):(r(Q,te),te=hv(ne,Q.mode,Me),te.return=Q,Q=te),f(Q)):r(Q,te)}return ye}var Rh=gS(!0),yS=gS(!1),Ff={},xl=$u(Ff),vf=$u(Ff),_f=$u(Ff);function wc(e){if(e===Ff)throw Error(ht(174));return e}function O0(e,t){switch(On(_f,t),On(vf,e),On(xl,Ff),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Zv(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Zv(t,e)}Bn(xl),On(xl,t)}function Oh(){Bn(xl),Bn(vf),Bn(_f)}function vS(e){wc(_f.current);var t=wc(xl.current),r=Zv(t,e.type);t!==r&&(On(vf,e),On(xl,r))}function D0(e){vf.current===e&&(Bn(xl),Bn(vf))}var ii=$u(0);function Pm(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ov=[];function z0(){for(var e=0;e<ov.length;e++)ov[e]._workInProgressVersionPrimary=null;ov.length=0}var em=Yl.ReactCurrentDispatcher,sv=Yl.ReactCurrentBatchConfig,Lc=0,oi=null,Ni=null,no=null,Am=!1,Kd=!1,xf=0,ok=0;function Lo(){throw Error(ht(321))}function F0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!il(e[r],t[r]))return!1;return!0}function N0(e,t,r,n,a,l){if(Lc=l,oi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,em.current=e===null||e.memoizedState===null?uk:ck,e=r(n,a),Kd){l=0;do{if(Kd=!1,xf=0,25<=l)throw Error(ht(301));l+=1,no=Ni=null,t.updateQueue=null,em.current=hk,e=r(n,a)}while(Kd)}if(em.current=Mm,t=Ni!==null&&Ni.next!==null,Lc=0,no=Ni=oi=null,Am=!1,t)throw Error(ht(300));return e}function B0(){var e=xf!==0;return xf=0,e}function yl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return no===null?oi.memoizedState=no=e:no=no.next=e,no}function La(){if(Ni===null){var e=oi.alternate;e=e!==null?e.memoizedState:null}else e=Ni.next;var t=no===null?oi.memoizedState:no.next;if(t!==null)no=t,Ni=e;else{if(e===null)throw Error(ht(310));Ni=e,e={memoizedState:Ni.memoizedState,baseState:Ni.baseState,baseQueue:Ni.baseQueue,queue:Ni.queue,next:null},no===null?oi.memoizedState=no=e:no=no.next=e}return no}function bf(e,t){return typeof t=="function"?t(e):t}function av(e){var t=La(),r=t.queue;if(r===null)throw Error(ht(311));r.lastRenderedReducer=e;var n=Ni,a=n.baseQueue,l=r.pending;if(l!==null){if(a!==null){var f=a.next;a.next=l.next,l.next=f}n.baseQueue=a=l,r.pending=null}if(a!==null){l=a.next,n=n.baseState;var u=f=null,E=null,m=l;do{var S=m.lane;if((Lc&S)===S)E!==null&&(E=E.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),n=m.hasEagerState?m.eagerState:e(n,m.action);else{var M={lane:S,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};E===null?(u=E=M,f=n):E=E.next=M,oi.lanes|=S,Rc|=S}m=m.next}while(m!==null&&m!==l);E===null?f=n:E.next=u,il(n,t.memoizedState)||(Es=!0),t.memoizedState=n,t.baseState=f,t.baseQueue=E,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do l=a.lane,oi.lanes|=l,Rc|=l,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function lv(e){var t=La(),r=t.queue;if(r===null)throw Error(ht(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,l=t.memoizedState;if(a!==null){r.pending=null;var f=a=a.next;do l=e(l,f.action),f=f.next;while(f!==a);il(l,t.memoizedState)||(Es=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),r.lastRenderedState=l}return[l,n]}function _S(){}function xS(e,t){var r=oi,n=La(),a=t(),l=!il(n.memoizedState,a);if(l&&(n.memoizedState=a,Es=!0),n=n.queue,U0(ES.bind(null,r,n,e),[e]),n.getSnapshot!==t||l||no!==null&&no.memoizedState.tag&1){if(r.flags|=2048,wf(9,wS.bind(null,r,n,a,t),void 0,null),oo===null)throw Error(ht(349));Lc&30||bS(r,t,a)}return a}function bS(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=oi.updateQueue,t===null?(t={lastEffect:null,stores:null},oi.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function wS(e,t,r,n){t.value=r,t.getSnapshot=n,SS(t)&&TS(e)}function ES(e,t,r){return r(function(){SS(t)&&TS(e)})}function SS(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!il(e,r)}catch{return!0}}function TS(e){var t=Kl(e,1);t!==null&&nl(t,e,1,-1)}function tw(e){var t=yl();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bf,lastRenderedState:e},t.queue=e,e=e.dispatch=lk.bind(null,oi,e),[t.memoizedState,e]}function wf(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=oi.updateQueue,t===null?(t={lastEffect:null,stores:null},oi.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function CS(){return La().memoizedState}function tm(e,t,r,n){var a=yl();oi.flags|=e,a.memoizedState=wf(1|t,r,void 0,n===void 0?null:n)}function fg(e,t,r,n){var a=La();n=n===void 0?null:n;var l=void 0;if(Ni!==null){var f=Ni.memoizedState;if(l=f.destroy,n!==null&&F0(n,f.deps)){a.memoizedState=wf(t,r,l,n);return}}oi.flags|=e,a.memoizedState=wf(1|t,r,l,n)}function rw(e,t){return tm(8390656,8,e,t)}function U0(e,t){return fg(2048,8,e,t)}function IS(e,t){return fg(4,2,e,t)}function PS(e,t){return fg(4,4,e,t)}function AS(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function MS(e,t,r){return r=r!=null?r.concat([e]):null,fg(4,4,AS.bind(null,t,e),r)}function j0(){}function kS(e,t){var r=La();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&F0(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function LS(e,t){var r=La();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&F0(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function RS(e,t,r){return Lc&21?(il(r,t)||(r=z2(),oi.lanes|=r,Rc|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Es=!0),e.memoizedState=r)}function sk(e,t){var r=yn;yn=r!==0&&4>r?r:4,e(!0);var n=sv.transition;sv.transition={};try{e(!1),t()}finally{yn=r,sv.transition=n}}function OS(){return La().memoizedState}function ak(e,t,r){var n=Du(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},DS(e))zS(t,r);else if(r=dS(e,t,r,n),r!==null){var a=ss();nl(r,e,n,a),FS(r,t,n)}}function lk(e,t,r){var n=Du(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(DS(e))zS(t,a);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var f=t.lastRenderedState,u=l(f,r);if(a.hasEagerState=!0,a.eagerState=u,il(u,f)){var E=t.interleaved;E===null?(a.next=a,L0(t)):(a.next=E.next,E.next=a),t.interleaved=a;return}}catch{}finally{}r=dS(e,t,a,n),r!==null&&(a=ss(),nl(r,e,n,a),FS(r,t,n))}}function DS(e){var t=e.alternate;return e===oi||t!==null&&t===oi}function zS(e,t){Kd=Am=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function FS(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,v0(e,r)}}var Mm={readContext:ka,useCallback:Lo,useContext:Lo,useEffect:Lo,useImperativeHandle:Lo,useInsertionEffect:Lo,useLayoutEffect:Lo,useMemo:Lo,useReducer:Lo,useRef:Lo,useState:Lo,useDebugValue:Lo,useDeferredValue:Lo,useTransition:Lo,useMutableSource:Lo,useSyncExternalStore:Lo,useId:Lo,unstable_isNewReconciler:!1},uk={readContext:ka,useCallback:function(e,t){return yl().memoizedState=[e,t===void 0?null:t],e},useContext:ka,useEffect:rw,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,tm(4194308,4,AS.bind(null,t,e),r)},useLayoutEffect:function(e,t){return tm(4194308,4,e,t)},useInsertionEffect:function(e,t){return tm(4,2,e,t)},useMemo:function(e,t){var r=yl();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=yl();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=ak.bind(null,oi,e),[n.memoizedState,e]},useRef:function(e){var t=yl();return e={current:e},t.memoizedState=e},useState:tw,useDebugValue:j0,useDeferredValue:function(e){return yl().memoizedState=e},useTransition:function(){var e=tw(!1),t=e[0];return e=sk.bind(null,e[1]),yl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=oi,a=yl();if(Kn){if(r===void 0)throw Error(ht(407));r=r()}else{if(r=t(),oo===null)throw Error(ht(349));Lc&30||bS(n,t,r)}a.memoizedState=r;var l={value:r,getSnapshot:t};return a.queue=l,rw(ES.bind(null,n,l,e),[e]),n.flags|=2048,wf(9,wS.bind(null,n,l,r,t),void 0,null),r},useId:function(){var e=yl(),t=oo.identifierPrefix;if(Kn){var r=Vl,n=$l;r=(n&~(1<<32-rl(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=xf++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=ok++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ck={readContext:ka,useCallback:kS,useContext:ka,useEffect:U0,useImperativeHandle:MS,useInsertionEffect:IS,useLayoutEffect:PS,useMemo:LS,useReducer:av,useRef:CS,useState:function(){return av(bf)},useDebugValue:j0,useDeferredValue:function(e){var t=La();return RS(t,Ni.memoizedState,e)},useTransition:function(){var e=av(bf)[0],t=La().memoizedState;return[e,t]},useMutableSource:_S,useSyncExternalStore:xS,useId:OS,unstable_isNewReconciler:!1},hk={readContext:ka,useCallback:kS,useContext:ka,useEffect:U0,useImperativeHandle:MS,useInsertionEffect:IS,useLayoutEffect:PS,useMemo:LS,useReducer:lv,useRef:CS,useState:function(){return lv(bf)},useDebugValue:j0,useDeferredValue:function(e){var t=La();return Ni===null?t.memoizedState=e:RS(t,Ni.memoizedState,e)},useTransition:function(){var e=lv(bf)[0],t=La().memoizedState;return[e,t]},useMutableSource:_S,useSyncExternalStore:xS,useId:OS,unstable_isNewReconciler:!1};function Dh(e,t){try{var r="",n=t;do r+=BA(n),n=n.return;while(n);var a=r}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:a,digest:null}}function uv(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function g_(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var dk=typeof WeakMap=="function"?WeakMap:Map;function NS(e,t,r){r=Gl(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Lm||(Lm=!0,C_=n),g_(e,t)},r}function BS(e,t,r){r=Gl(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){g_(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(r.callback=function(){g_(e,t),typeof n!="function"&&(Ou===null?Ou=new Set([this]):Ou.add(this));var f=t.stack;this.componentDidCatch(t.value,{componentStack:f!==null?f:""})}),r}function nw(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new dk;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=Ck.bind(null,e,t,r),t.then(e,e))}function iw(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ow(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Gl(-1,1),t.tag=2,Ru(r,t,1))),r.lanes|=1),e)}var fk=Yl.ReactCurrentOwner,Es=!1;function is(e,t,r,n){t.child=e===null?yS(t,null,r,n):Rh(t,e.child,r,n)}function sw(e,t,r,n,a){r=r.render;var l=t.ref;return Ch(t,a),n=N0(e,t,r,n,l,a),r=B0(),e!==null&&!Es?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Xl(e,t,a)):(Kn&&r&&C0(t),t.flags|=1,is(e,t,n,a),t.child)}function aw(e,t,r,n,a){if(e===null){var l=r.type;return typeof l=="function"&&!K0(l)&&l.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=l,US(e,t,l,n,a)):(e=om(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&a)){var f=l.memoizedProps;if(r=r.compare,r=r!==null?r:pf,r(f,n)&&e.ref===t.ref)return Xl(e,t,a)}return t.flags|=1,e=zu(l,n),e.ref=t.ref,e.return=t,t.child=e}function US(e,t,r,n,a){if(e!==null){var l=e.memoizedProps;if(pf(l,n)&&e.ref===t.ref)if(Es=!1,t.pendingProps=n=l,(e.lanes&a)!==0)e.flags&131072&&(Es=!0);else return t.lanes=e.lanes,Xl(e,t,a)}return y_(e,t,r,n,a)}function jS(e,t,r){var n=t.pendingProps,a=n.children,l=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},On(xh,Ys),Ys|=r;else{if(!(r&1073741824))return e=l!==null?l.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,On(xh,Ys),Ys|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=l!==null?l.baseLanes:r,On(xh,Ys),Ys|=n}else l!==null?(n=l.baseLanes|r,t.memoizedState=null):n=r,On(xh,Ys),Ys|=n;return is(e,t,a,r),t.child}function $S(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function y_(e,t,r,n,a){var l=Ts(r)?Mc:Bo.current;return l=kh(t,l),Ch(t,a),r=N0(e,t,r,n,l,a),n=B0(),e!==null&&!Es?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Xl(e,t,a)):(Kn&&n&&C0(t),t.flags|=1,is(e,t,r,a),t.child)}function lw(e,t,r,n,a){if(Ts(r)){var l=!0;wm(t)}else l=!1;if(Ch(t,a),t.stateNode===null)rm(e,t),mS(t,r,n),m_(t,r,n,a),n=!0;else if(e===null){var f=t.stateNode,u=t.memoizedProps;f.props=u;var E=f.context,m=r.contextType;typeof m=="object"&&m!==null?m=ka(m):(m=Ts(r)?Mc:Bo.current,m=kh(t,m));var S=r.getDerivedStateFromProps,M=typeof S=="function"||typeof f.getSnapshotBeforeUpdate=="function";M||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(u!==n||E!==m)&&Qb(t,f,n,m),_u=!1;var z=t.memoizedState;f.state=z,Im(t,n,f,a),E=t.memoizedState,u!==n||z!==E||Ss.current||_u?(typeof S=="function"&&(p_(t,r,S,n),E=t.memoizedState),(u=_u||Yb(t,r,u,n,z,E,m))?(M||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=E),f.props=n,f.state=E,f.context=m,n=u):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{f=t.stateNode,fS(e,t),u=t.memoizedProps,m=t.type===t.elementType?u:Qa(t.type,u),f.props=m,M=t.pendingProps,z=f.context,E=r.contextType,typeof E=="object"&&E!==null?E=ka(E):(E=Ts(r)?Mc:Bo.current,E=kh(t,E));var H=r.getDerivedStateFromProps;(S=typeof H=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(u!==M||z!==E)&&Qb(t,f,n,E),_u=!1,z=t.memoizedState,f.state=z,Im(t,n,f,a);var q=t.memoizedState;u!==M||z!==q||Ss.current||_u?(typeof H=="function"&&(p_(t,r,H,n),q=t.memoizedState),(m=_u||Yb(t,r,m,n,z,q,E)||!1)?(S||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(n,q,E),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(n,q,E)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||u===e.memoizedProps&&z===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&z===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=q),f.props=n,f.state=q,f.context=E,n=m):(typeof f.componentDidUpdate!="function"||u===e.memoizedProps&&z===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&z===e.memoizedState||(t.flags|=1024),n=!1)}return v_(e,t,r,n,l,a)}function v_(e,t,r,n,a,l){$S(e,t);var f=(t.flags&128)!==0;if(!n&&!f)return a&&Zb(t,r,!1),Xl(e,t,l);n=t.stateNode,fk.current=t;var u=f&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&f?(t.child=Rh(t,e.child,null,l),t.child=Rh(t,null,u,l)):is(e,t,u,l),t.memoizedState=n.state,a&&Zb(t,r,!0),t.child}function VS(e){var t=e.stateNode;t.pendingContext?Hb(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Hb(e,t.context,!1),O0(e,t.containerInfo)}function uw(e,t,r,n,a){return Lh(),P0(a),t.flags|=256,is(e,t,r,n),t.child}var __={dehydrated:null,treeContext:null,retryLane:0};function x_(e){return{baseLanes:e,cachePool:null,transitions:null}}function GS(e,t,r){var n=t.pendingProps,a=ii.current,l=!1,f=(t.flags&128)!==0,u;if((u=f)||(u=e!==null&&e.memoizedState===null?!1:(a&2)!==0),u?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),On(ii,a&1),e===null)return d_(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(f=n.children,e=n.fallback,l?(n=t.mode,l=t.child,f={mode:"hidden",children:f},!(n&1)&&l!==null?(l.childLanes=0,l.pendingProps=f):l=gg(f,n,0,null),e=Ac(e,n,r,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=x_(r),t.memoizedState=__,e):$0(t,f));if(a=e.memoizedState,a!==null&&(u=a.dehydrated,u!==null))return pk(e,t,f,n,u,a,r);if(l){l=n.fallback,f=t.mode,a=e.child,u=a.sibling;var E={mode:"hidden",children:n.children};return!(f&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=E,t.deletions=null):(n=zu(a,E),n.subtreeFlags=a.subtreeFlags&14680064),u!==null?l=zu(u,l):(l=Ac(l,f,r,null),l.flags|=2),l.return=t,n.return=t,n.sibling=l,t.child=n,n=l,l=t.child,f=e.child.memoizedState,f=f===null?x_(r):{baseLanes:f.baseLanes|r,cachePool:null,transitions:f.transitions},l.memoizedState=f,l.childLanes=e.childLanes&~r,t.memoizedState=__,n}return l=e.child,e=l.sibling,n=zu(l,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function $0(e,t){return t=gg({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Pp(e,t,r,n){return n!==null&&P0(n),Rh(t,e.child,null,r),e=$0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function pk(e,t,r,n,a,l,f){if(r)return t.flags&256?(t.flags&=-257,n=uv(Error(ht(422))),Pp(e,t,f,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=n.fallback,a=t.mode,n=gg({mode:"visible",children:n.children},a,0,null),l=Ac(l,a,f,null),l.flags|=2,n.return=t,l.return=t,n.sibling=l,t.child=n,t.mode&1&&Rh(t,e.child,null,f),t.child.memoizedState=x_(f),t.memoizedState=__,l);if(!(t.mode&1))return Pp(e,t,f,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var u=n.dgst;return n=u,l=Error(ht(419)),n=uv(l,n,void 0),Pp(e,t,f,n)}if(u=(f&e.childLanes)!==0,Es||u){if(n=oo,n!==null){switch(f&-f){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|f)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,Kl(e,a),nl(n,e,a,-1))}return W0(),n=uv(Error(ht(421))),Pp(e,t,f,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Ik.bind(null,e),a._reactRetry=t,null):(e=l.treeContext,ea=Lu(a.nextSibling),ta=t,Kn=!0,tl=null,e!==null&&(Ca[Ia++]=$l,Ca[Ia++]=Vl,Ca[Ia++]=kc,$l=e.id,Vl=e.overflow,kc=t),t=$0(t,n.children),t.flags|=4096,t)}function cw(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),f_(e.return,t,r)}function cv(e,t,r,n,a){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=n,l.tail=r,l.tailMode=a)}function qS(e,t,r){var n=t.pendingProps,a=n.revealOrder,l=n.tail;if(is(e,t,n.children,r),n=ii.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&cw(e,r,t);else if(e.tag===19)cw(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(On(ii,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Pm(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),cv(t,!1,a,r,l);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Pm(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}cv(t,!0,r,null,l);break;case"together":cv(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function rm(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Xl(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Rc|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ht(153));if(t.child!==null){for(e=t.child,r=zu(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=zu(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function mk(e,t,r){switch(t.tag){case 3:VS(t),Lh();break;case 5:vS(t);break;case 1:Ts(t.type)&&wm(t);break;case 4:O0(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;On(Tm,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(On(ii,ii.current&1),t.flags|=128,null):r&t.child.childLanes?GS(e,t,r):(On(ii,ii.current&1),e=Xl(e,t,r),e!==null?e.sibling:null);On(ii,ii.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return qS(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),On(ii,ii.current),n)break;return null;case 22:case 23:return t.lanes=0,jS(e,t,r)}return Xl(e,t,r)}var HS,b_,ZS,WS;HS=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};b_=function(){};ZS=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,wc(xl.current);var l=null;switch(r){case"input":a=Vv(e,a),n=Vv(e,n),l=[];break;case"select":a=si({},a,{value:void 0}),n=si({},n,{value:void 0}),l=[];break;case"textarea":a=Hv(e,a),n=Hv(e,n),l=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=xm)}Wv(r,n);var f;r=null;for(m in a)if(!n.hasOwnProperty(m)&&a.hasOwnProperty(m)&&a[m]!=null)if(m==="style"){var u=a[m];for(f in u)u.hasOwnProperty(f)&&(r||(r={}),r[f]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(af.hasOwnProperty(m)?l||(l=[]):(l=l||[]).push(m,null));for(m in n){var E=n[m];if(u=a!=null?a[m]:void 0,n.hasOwnProperty(m)&&E!==u&&(E!=null||u!=null))if(m==="style")if(u){for(f in u)!u.hasOwnProperty(f)||E&&E.hasOwnProperty(f)||(r||(r={}),r[f]="");for(f in E)E.hasOwnProperty(f)&&u[f]!==E[f]&&(r||(r={}),r[f]=E[f])}else r||(l||(l=[]),l.push(m,r)),r=E;else m==="dangerouslySetInnerHTML"?(E=E?E.__html:void 0,u=u?u.__html:void 0,E!=null&&u!==E&&(l=l||[]).push(m,E)):m==="children"?typeof E!="string"&&typeof E!="number"||(l=l||[]).push(m,""+E):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(af.hasOwnProperty(m)?(E!=null&&m==="onScroll"&&Nn("scroll",e),l||u===E||(l=[])):(l=l||[]).push(m,E))}r&&(l=l||[]).push("style",r);var m=l;(t.updateQueue=m)&&(t.flags|=4)}};WS=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ld(e,t){if(!Kn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ro(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function gk(e,t,r){var n=t.pendingProps;switch(I0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ro(t),null;case 1:return Ts(t.type)&&bm(),Ro(t),null;case 3:return n=t.stateNode,Oh(),Bn(Ss),Bn(Bo),z0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Cp(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,tl!==null&&(A_(tl),tl=null))),b_(e,t),Ro(t),null;case 5:D0(t);var a=wc(_f.current);if(r=t.type,e!==null&&t.stateNode!=null)ZS(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ht(166));return Ro(t),null}if(e=wc(xl.current),Cp(t)){n=t.stateNode,r=t.type;var l=t.memoizedProps;switch(n[vl]=t,n[yf]=l,e=(t.mode&1)!==0,r){case"dialog":Nn("cancel",n),Nn("close",n);break;case"iframe":case"object":case"embed":Nn("load",n);break;case"video":case"audio":for(a=0;a<jd.length;a++)Nn(jd[a],n);break;case"source":Nn("error",n);break;case"img":case"image":case"link":Nn("error",n),Nn("load",n);break;case"details":Nn("toggle",n);break;case"input":_b(n,l),Nn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!l.multiple},Nn("invalid",n);break;case"textarea":bb(n,l),Nn("invalid",n)}Wv(r,l),a=null;for(var f in l)if(l.hasOwnProperty(f)){var u=l[f];f==="children"?typeof u=="string"?n.textContent!==u&&(l.suppressHydrationWarning!==!0&&Tp(n.textContent,u,e),a=["children",u]):typeof u=="number"&&n.textContent!==""+u&&(l.suppressHydrationWarning!==!0&&Tp(n.textContent,u,e),a=["children",""+u]):af.hasOwnProperty(f)&&u!=null&&f==="onScroll"&&Nn("scroll",n)}switch(r){case"input":yp(n),xb(n,l,!0);break;case"textarea":yp(n),wb(n);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(n.onclick=xm)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{f=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=b2(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=f.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=f.createElement(r,{is:n.is}):(e=f.createElement(r),r==="select"&&(f=e,n.multiple?f.multiple=!0:n.size&&(f.size=n.size))):e=f.createElementNS(e,r),e[vl]=t,e[yf]=n,HS(e,t,!1,!1),t.stateNode=e;e:{switch(f=Kv(r,n),r){case"dialog":Nn("cancel",e),Nn("close",e),a=n;break;case"iframe":case"object":case"embed":Nn("load",e),a=n;break;case"video":case"audio":for(a=0;a<jd.length;a++)Nn(jd[a],e);a=n;break;case"source":Nn("error",e),a=n;break;case"img":case"image":case"link":Nn("error",e),Nn("load",e),a=n;break;case"details":Nn("toggle",e),a=n;break;case"input":_b(e,n),a=Vv(e,n),Nn("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=si({},n,{value:void 0}),Nn("invalid",e);break;case"textarea":bb(e,n),a=Hv(e,n),Nn("invalid",e);break;default:a=n}Wv(r,a),u=a;for(l in u)if(u.hasOwnProperty(l)){var E=u[l];l==="style"?S2(e,E):l==="dangerouslySetInnerHTML"?(E=E?E.__html:void 0,E!=null&&w2(e,E)):l==="children"?typeof E=="string"?(r!=="textarea"||E!=="")&&lf(e,E):typeof E=="number"&&lf(e,""+E):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(af.hasOwnProperty(l)?E!=null&&l==="onScroll"&&Nn("scroll",e):E!=null&&d0(e,l,E,f))}switch(r){case"input":yp(e),xb(e,n,!1);break;case"textarea":yp(e),wb(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Fu(n.value));break;case"select":e.multiple=!!n.multiple,l=n.value,l!=null?wh(e,!!n.multiple,l,!1):n.defaultValue!=null&&wh(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=xm)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ro(t),null;case 6:if(e&&t.stateNode!=null)WS(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ht(166));if(r=wc(_f.current),wc(xl.current),Cp(t)){if(n=t.stateNode,r=t.memoizedProps,n[vl]=t,(l=n.nodeValue!==r)&&(e=ta,e!==null))switch(e.tag){case 3:Tp(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Tp(n.nodeValue,r,(e.mode&1)!==0)}l&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[vl]=t,t.stateNode=n}return Ro(t),null;case 13:if(Bn(ii),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Kn&&ea!==null&&t.mode&1&&!(t.flags&128))hS(),Lh(),t.flags|=98560,l=!1;else if(l=Cp(t),n!==null&&n.dehydrated!==null){if(e===null){if(!l)throw Error(ht(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(ht(317));l[vl]=t}else Lh(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ro(t),l=!1}else tl!==null&&(A_(tl),tl=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||ii.current&1?Ui===0&&(Ui=3):W0())),t.updateQueue!==null&&(t.flags|=4),Ro(t),null);case 4:return Oh(),b_(e,t),e===null&&mf(t.stateNode.containerInfo),Ro(t),null;case 10:return k0(t.type._context),Ro(t),null;case 17:return Ts(t.type)&&bm(),Ro(t),null;case 19:if(Bn(ii),l=t.memoizedState,l===null)return Ro(t),null;if(n=(t.flags&128)!==0,f=l.rendering,f===null)if(n)Ld(l,!1);else{if(Ui!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(f=Pm(e),f!==null){for(t.flags|=128,Ld(l,!1),n=f.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)l=r,e=n,l.flags&=14680066,f=l.alternate,f===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=f.childLanes,l.lanes=f.lanes,l.child=f.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=f.memoizedProps,l.memoizedState=f.memoizedState,l.updateQueue=f.updateQueue,l.type=f.type,e=f.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return On(ii,ii.current&1|2),t.child}e=e.sibling}l.tail!==null&&bi()>zh&&(t.flags|=128,n=!0,Ld(l,!1),t.lanes=4194304)}else{if(!n)if(e=Pm(f),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ld(l,!0),l.tail===null&&l.tailMode==="hidden"&&!f.alternate&&!Kn)return Ro(t),null}else 2*bi()-l.renderingStartTime>zh&&r!==1073741824&&(t.flags|=128,n=!0,Ld(l,!1),t.lanes=4194304);l.isBackwards?(f.sibling=t.child,t.child=f):(r=l.last,r!==null?r.sibling=f:t.child=f,l.last=f)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=bi(),t.sibling=null,r=ii.current,On(ii,n?r&1|2:r&1),t):(Ro(t),null);case 22:case 23:return Z0(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ys&1073741824&&(Ro(t),t.subtreeFlags&6&&(t.flags|=8192)):Ro(t),null;case 24:return null;case 25:return null}throw Error(ht(156,t.tag))}function yk(e,t){switch(I0(t),t.tag){case 1:return Ts(t.type)&&bm(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Oh(),Bn(Ss),Bn(Bo),z0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return D0(t),null;case 13:if(Bn(ii),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ht(340));Lh()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Bn(ii),null;case 4:return Oh(),null;case 10:return k0(t.type._context),null;case 22:case 23:return Z0(),null;case 24:return null;default:return null}}var Ap=!1,No=!1,vk=typeof WeakSet=="function"?WeakSet:Set,zt=null;function _h(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){di(e,t,n)}else r.current=null}function w_(e,t,r){try{r()}catch(n){di(e,t,n)}}var hw=!1;function _k(e,t){if(o_=ym,e=Y2(),T0(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,l=n.focusNode;n=n.focusOffset;try{r.nodeType,l.nodeType}catch{r=null;break e}var f=0,u=-1,E=-1,m=0,S=0,M=e,z=null;t:for(;;){for(var H;M!==r||a!==0&&M.nodeType!==3||(u=f+a),M!==l||n!==0&&M.nodeType!==3||(E=f+n),M.nodeType===3&&(f+=M.nodeValue.length),(H=M.firstChild)!==null;)z=M,M=H;for(;;){if(M===e)break t;if(z===r&&++m===a&&(u=f),z===l&&++S===n&&(E=f),(H=M.nextSibling)!==null)break;M=z,z=M.parentNode}M=H}r=u===-1||E===-1?null:{start:u,end:E}}else r=null}r=r||{start:0,end:0}}else r=null;for(s_={focusedElem:e,selectionRange:r},ym=!1,zt=t;zt!==null;)if(t=zt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,zt=e;else for(;zt!==null;){t=zt;try{var q=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(q!==null){var Y=q.memoizedProps,ye=q.memoizedState,Q=t.stateNode,te=Q.getSnapshotBeforeUpdate(t.elementType===t.type?Y:Qa(t.type,Y),ye);Q.__reactInternalSnapshotBeforeUpdate=te}break;case 3:var ne=t.stateNode.containerInfo;ne.nodeType===1?ne.textContent="":ne.nodeType===9&&ne.documentElement&&ne.removeChild(ne.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ht(163))}}catch(Me){di(t,t.return,Me)}if(e=t.sibling,e!==null){e.return=t.return,zt=e;break}zt=t.return}return q=hw,hw=!1,q}function Xd(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var l=a.destroy;a.destroy=void 0,l!==void 0&&w_(t,r,l)}a=a.next}while(a!==n)}}function pg(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function E_(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function KS(e){var t=e.alternate;t!==null&&(e.alternate=null,KS(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[vl],delete t[yf],delete t[u_],delete t[tk],delete t[rk])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function XS(e){return e.tag===5||e.tag===3||e.tag===4}function dw(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||XS(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function S_(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=xm));else if(n!==4&&(e=e.child,e!==null))for(S_(e,t,r),e=e.sibling;e!==null;)S_(e,t,r),e=e.sibling}function T_(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(T_(e,t,r),e=e.sibling;e!==null;)T_(e,t,r),e=e.sibling}var yo=null,el=!1;function mu(e,t,r){for(r=r.child;r!==null;)JS(e,t,r),r=r.sibling}function JS(e,t,r){if(_l&&typeof _l.onCommitFiberUnmount=="function")try{_l.onCommitFiberUnmount(sg,r)}catch{}switch(r.tag){case 5:No||_h(r,t);case 6:var n=yo,a=el;yo=null,mu(e,t,r),yo=n,el=a,yo!==null&&(el?(e=yo,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):yo.removeChild(r.stateNode));break;case 18:yo!==null&&(el?(e=yo,r=r.stateNode,e.nodeType===8?nv(e.parentNode,r):e.nodeType===1&&nv(e,r),df(e)):nv(yo,r.stateNode));break;case 4:n=yo,a=el,yo=r.stateNode.containerInfo,el=!0,mu(e,t,r),yo=n,el=a;break;case 0:case 11:case 14:case 15:if(!No&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var l=a,f=l.destroy;l=l.tag,f!==void 0&&(l&2||l&4)&&w_(r,t,f),a=a.next}while(a!==n)}mu(e,t,r);break;case 1:if(!No&&(_h(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(u){di(r,t,u)}mu(e,t,r);break;case 21:mu(e,t,r);break;case 22:r.mode&1?(No=(n=No)||r.memoizedState!==null,mu(e,t,r),No=n):mu(e,t,r);break;default:mu(e,t,r)}}function fw(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new vk),t.forEach(function(n){var a=Pk.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Ka(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var l=e,f=t,u=f;e:for(;u!==null;){switch(u.tag){case 5:yo=u.stateNode,el=!1;break e;case 3:yo=u.stateNode.containerInfo,el=!0;break e;case 4:yo=u.stateNode.containerInfo,el=!0;break e}u=u.return}if(yo===null)throw Error(ht(160));JS(l,f,a),yo=null,el=!1;var E=a.alternate;E!==null&&(E.return=null),a.return=null}catch(m){di(a,t,m)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)YS(t,e),t=t.sibling}function YS(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ka(t,e),ml(e),n&4){try{Xd(3,e,e.return),pg(3,e)}catch(Y){di(e,e.return,Y)}try{Xd(5,e,e.return)}catch(Y){di(e,e.return,Y)}}break;case 1:Ka(t,e),ml(e),n&512&&r!==null&&_h(r,r.return);break;case 5:if(Ka(t,e),ml(e),n&512&&r!==null&&_h(r,r.return),e.flags&32){var a=e.stateNode;try{lf(a,"")}catch(Y){di(e,e.return,Y)}}if(n&4&&(a=e.stateNode,a!=null)){var l=e.memoizedProps,f=r!==null?r.memoizedProps:l,u=e.type,E=e.updateQueue;if(e.updateQueue=null,E!==null)try{u==="input"&&l.type==="radio"&&l.name!=null&&_2(a,l),Kv(u,f);var m=Kv(u,l);for(f=0;f<E.length;f+=2){var S=E[f],M=E[f+1];S==="style"?S2(a,M):S==="dangerouslySetInnerHTML"?w2(a,M):S==="children"?lf(a,M):d0(a,S,M,m)}switch(u){case"input":Gv(a,l);break;case"textarea":x2(a,l);break;case"select":var z=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var H=l.value;H!=null?wh(a,!!l.multiple,H,!1):z!==!!l.multiple&&(l.defaultValue!=null?wh(a,!!l.multiple,l.defaultValue,!0):wh(a,!!l.multiple,l.multiple?[]:"",!1))}a[yf]=l}catch(Y){di(e,e.return,Y)}}break;case 6:if(Ka(t,e),ml(e),n&4){if(e.stateNode===null)throw Error(ht(162));a=e.stateNode,l=e.memoizedProps;try{a.nodeValue=l}catch(Y){di(e,e.return,Y)}}break;case 3:if(Ka(t,e),ml(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{df(t.containerInfo)}catch(Y){di(e,e.return,Y)}break;case 4:Ka(t,e),ml(e);break;case 13:Ka(t,e),ml(e),a=e.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(q0=bi())),n&4&&fw(e);break;case 22:if(S=r!==null&&r.memoizedState!==null,e.mode&1?(No=(m=No)||S,Ka(t,e),No=m):Ka(t,e),ml(e),n&8192){if(m=e.memoizedState!==null,(e.stateNode.isHidden=m)&&!S&&e.mode&1)for(zt=e,S=e.child;S!==null;){for(M=zt=S;zt!==null;){switch(z=zt,H=z.child,z.tag){case 0:case 11:case 14:case 15:Xd(4,z,z.return);break;case 1:_h(z,z.return);var q=z.stateNode;if(typeof q.componentWillUnmount=="function"){n=z,r=z.return;try{t=n,q.props=t.memoizedProps,q.state=t.memoizedState,q.componentWillUnmount()}catch(Y){di(n,r,Y)}}break;case 5:_h(z,z.return);break;case 22:if(z.memoizedState!==null){mw(M);continue}}H!==null?(H.return=z,zt=H):mw(M)}S=S.sibling}e:for(S=null,M=e;;){if(M.tag===5){if(S===null){S=M;try{a=M.stateNode,m?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(u=M.stateNode,E=M.memoizedProps.style,f=E!=null&&E.hasOwnProperty("display")?E.display:null,u.style.display=E2("display",f))}catch(Y){di(e,e.return,Y)}}}else if(M.tag===6){if(S===null)try{M.stateNode.nodeValue=m?"":M.memoizedProps}catch(Y){di(e,e.return,Y)}}else if((M.tag!==22&&M.tag!==23||M.memoizedState===null||M===e)&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===e)break e;for(;M.sibling===null;){if(M.return===null||M.return===e)break e;S===M&&(S=null),M=M.return}S===M&&(S=null),M.sibling.return=M.return,M=M.sibling}}break;case 19:Ka(t,e),ml(e),n&4&&fw(e);break;case 21:break;default:Ka(t,e),ml(e)}}function ml(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(XS(r)){var n=r;break e}r=r.return}throw Error(ht(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(lf(a,""),n.flags&=-33);var l=dw(e);T_(e,l,a);break;case 3:case 4:var f=n.stateNode.containerInfo,u=dw(e);S_(e,u,f);break;default:throw Error(ht(161))}}catch(E){di(e,e.return,E)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function xk(e,t,r){zt=e,QS(e)}function QS(e,t,r){for(var n=(e.mode&1)!==0;zt!==null;){var a=zt,l=a.child;if(a.tag===22&&n){var f=a.memoizedState!==null||Ap;if(!f){var u=a.alternate,E=u!==null&&u.memoizedState!==null||No;u=Ap;var m=No;if(Ap=f,(No=E)&&!m)for(zt=a;zt!==null;)f=zt,E=f.child,f.tag===22&&f.memoizedState!==null?gw(a):E!==null?(E.return=f,zt=E):gw(a);for(;l!==null;)zt=l,QS(l),l=l.sibling;zt=a,Ap=u,No=m}pw(e)}else a.subtreeFlags&8772&&l!==null?(l.return=a,zt=l):pw(e)}}function pw(e){for(;zt!==null;){var t=zt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:No||pg(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!No)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Qa(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&Jb(t,l,n);break;case 3:var f=t.updateQueue;if(f!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Jb(t,f,r)}break;case 5:var u=t.stateNode;if(r===null&&t.flags&4){r=u;var E=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":E.autoFocus&&r.focus();break;case"img":E.src&&(r.src=E.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var m=t.alternate;if(m!==null){var S=m.memoizedState;if(S!==null){var M=S.dehydrated;M!==null&&df(M)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ht(163))}No||t.flags&512&&E_(t)}catch(z){di(t,t.return,z)}}if(t===e){zt=null;break}if(r=t.sibling,r!==null){r.return=t.return,zt=r;break}zt=t.return}}function mw(e){for(;zt!==null;){var t=zt;if(t===e){zt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,zt=r;break}zt=t.return}}function gw(e){for(;zt!==null;){var t=zt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{pg(4,t)}catch(E){di(t,r,E)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(E){di(t,a,E)}}var l=t.return;try{E_(t)}catch(E){di(t,l,E)}break;case 5:var f=t.return;try{E_(t)}catch(E){di(t,f,E)}}}catch(E){di(t,t.return,E)}if(t===e){zt=null;break}var u=t.sibling;if(u!==null){u.return=t.return,zt=u;break}zt=t.return}}var bk=Math.ceil,km=Yl.ReactCurrentDispatcher,V0=Yl.ReactCurrentOwner,Ma=Yl.ReactCurrentBatchConfig,rn=0,oo=null,Oi=null,_o=0,Ys=0,xh=$u(0),Ui=0,Ef=null,Rc=0,mg=0,G0=0,Jd=null,ws=null,q0=0,zh=1/0,Nl=null,Lm=!1,C_=null,Ou=null,Mp=!1,Cu=null,Rm=0,Yd=0,I_=null,nm=-1,im=0;function ss(){return rn&6?bi():nm!==-1?nm:nm=bi()}function Du(e){return e.mode&1?rn&2&&_o!==0?_o&-_o:ik.transition!==null?(im===0&&(im=z2()),im):(e=yn,e!==0||(e=window.event,e=e===void 0?16:V2(e.type)),e):1}function nl(e,t,r,n){if(50<Yd)throw Yd=0,I_=null,Error(ht(185));Of(e,r,n),(!(rn&2)||e!==oo)&&(e===oo&&(!(rn&2)&&(mg|=r),Ui===4&&Su(e,_o)),Cs(e,n),r===1&&rn===0&&!(t.mode&1)&&(zh=bi()+500,hg&&Vu()))}function Cs(e,t){var r=e.callbackNode;iM(e,t);var n=gm(e,e===oo?_o:0);if(n===0)r!==null&&Tb(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Tb(r),t===1)e.tag===0?nk(yw.bind(null,e)):lS(yw.bind(null,e)),QM(function(){!(rn&6)&&Vu()}),r=null;else{switch(F2(n)){case 1:r=y0;break;case 4:r=O2;break;case 16:r=mm;break;case 536870912:r=D2;break;default:r=mm}r=aT(r,eT.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function eT(e,t){if(nm=-1,im=0,rn&6)throw Error(ht(327));var r=e.callbackNode;if(Ih()&&e.callbackNode!==r)return null;var n=gm(e,e===oo?_o:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Om(e,n);else{t=n;var a=rn;rn|=2;var l=rT();(oo!==e||_o!==t)&&(Nl=null,zh=bi()+500,Pc(e,t));do try{Sk();break}catch(u){tT(e,u)}while(1);M0(),km.current=l,rn=a,Oi!==null?t=0:(oo=null,_o=0,t=Ui)}if(t!==0){if(t===2&&(a=e_(e),a!==0&&(n=a,t=P_(e,a))),t===1)throw r=Ef,Pc(e,0),Su(e,n),Cs(e,bi()),r;if(t===6)Su(e,n);else{if(a=e.current.alternate,!(n&30)&&!wk(a)&&(t=Om(e,n),t===2&&(l=e_(e),l!==0&&(n=l,t=P_(e,l))),t===1))throw r=Ef,Pc(e,0),Su(e,n),Cs(e,bi()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(ht(345));case 2:yc(e,ws,Nl);break;case 3:if(Su(e,n),(n&130023424)===n&&(t=q0+500-bi(),10<t)){if(gm(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){ss(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=l_(yc.bind(null,e,ws,Nl),t);break}yc(e,ws,Nl);break;case 4:if(Su(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var f=31-rl(n);l=1<<f,f=t[f],f>a&&(a=f),n&=~l}if(n=a,n=bi()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*bk(n/1960))-n,10<n){e.timeoutHandle=l_(yc.bind(null,e,ws,Nl),n);break}yc(e,ws,Nl);break;case 5:yc(e,ws,Nl);break;default:throw Error(ht(329))}}}return Cs(e,bi()),e.callbackNode===r?eT.bind(null,e):null}function P_(e,t){var r=Jd;return e.current.memoizedState.isDehydrated&&(Pc(e,t).flags|=256),e=Om(e,t),e!==2&&(t=ws,ws=r,t!==null&&A_(t)),e}function A_(e){ws===null?ws=e:ws.push.apply(ws,e)}function wk(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],l=a.getSnapshot;a=a.value;try{if(!il(l(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Su(e,t){for(t&=~G0,t&=~mg,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-rl(t),n=1<<r;e[r]=-1,t&=~n}}function yw(e){if(rn&6)throw Error(ht(327));Ih();var t=gm(e,0);if(!(t&1))return Cs(e,bi()),null;var r=Om(e,t);if(e.tag!==0&&r===2){var n=e_(e);n!==0&&(t=n,r=P_(e,n))}if(r===1)throw r=Ef,Pc(e,0),Su(e,t),Cs(e,bi()),r;if(r===6)throw Error(ht(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,yc(e,ws,Nl),Cs(e,bi()),null}function H0(e,t){var r=rn;rn|=1;try{return e(t)}finally{rn=r,rn===0&&(zh=bi()+500,hg&&Vu())}}function Oc(e){Cu!==null&&Cu.tag===0&&!(rn&6)&&Ih();var t=rn;rn|=1;var r=Ma.transition,n=yn;try{if(Ma.transition=null,yn=1,e)return e()}finally{yn=n,Ma.transition=r,rn=t,!(rn&6)&&Vu()}}function Z0(){Ys=xh.current,Bn(xh)}function Pc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,YM(r)),Oi!==null)for(r=Oi.return;r!==null;){var n=r;switch(I0(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&bm();break;case 3:Oh(),Bn(Ss),Bn(Bo),z0();break;case 5:D0(n);break;case 4:Oh();break;case 13:Bn(ii);break;case 19:Bn(ii);break;case 10:k0(n.type._context);break;case 22:case 23:Z0()}r=r.return}if(oo=e,Oi=e=zu(e.current,null),_o=Ys=t,Ui=0,Ef=null,G0=mg=Rc=0,ws=Jd=null,bc!==null){for(t=0;t<bc.length;t++)if(r=bc[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,l=r.pending;if(l!==null){var f=l.next;l.next=a,n.next=f}r.pending=n}bc=null}return e}function tT(e,t){do{var r=Oi;try{if(M0(),em.current=Mm,Am){for(var n=oi.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Am=!1}if(Lc=0,no=Ni=oi=null,Kd=!1,xf=0,V0.current=null,r===null||r.return===null){Ui=1,Ef=t,Oi=null;break}e:{var l=e,f=r.return,u=r,E=t;if(t=_o,u.flags|=32768,E!==null&&typeof E=="object"&&typeof E.then=="function"){var m=E,S=u,M=S.tag;if(!(S.mode&1)&&(M===0||M===11||M===15)){var z=S.alternate;z?(S.updateQueue=z.updateQueue,S.memoizedState=z.memoizedState,S.lanes=z.lanes):(S.updateQueue=null,S.memoizedState=null)}var H=iw(f);if(H!==null){H.flags&=-257,ow(H,f,u,l,t),H.mode&1&&nw(l,m,t),t=H,E=m;var q=t.updateQueue;if(q===null){var Y=new Set;Y.add(E),t.updateQueue=Y}else q.add(E);break e}else{if(!(t&1)){nw(l,m,t),W0();break e}E=Error(ht(426))}}else if(Kn&&u.mode&1){var ye=iw(f);if(ye!==null){!(ye.flags&65536)&&(ye.flags|=256),ow(ye,f,u,l,t),P0(Dh(E,u));break e}}l=E=Dh(E,u),Ui!==4&&(Ui=2),Jd===null?Jd=[l]:Jd.push(l),l=f;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var Q=NS(l,E,t);Xb(l,Q);break e;case 1:u=E;var te=l.type,ne=l.stateNode;if(!(l.flags&128)&&(typeof te.getDerivedStateFromError=="function"||ne!==null&&typeof ne.componentDidCatch=="function"&&(Ou===null||!Ou.has(ne)))){l.flags|=65536,t&=-t,l.lanes|=t;var Me=BS(l,u,t);Xb(l,Me);break e}}l=l.return}while(l!==null)}iT(r)}catch(Ve){t=Ve,Oi===r&&r!==null&&(Oi=r=r.return);continue}break}while(1)}function rT(){var e=km.current;return km.current=Mm,e===null?Mm:e}function W0(){(Ui===0||Ui===3||Ui===2)&&(Ui=4),oo===null||!(Rc&268435455)&&!(mg&268435455)||Su(oo,_o)}function Om(e,t){var r=rn;rn|=2;var n=rT();(oo!==e||_o!==t)&&(Nl=null,Pc(e,t));do try{Ek();break}catch(a){tT(e,a)}while(1);if(M0(),rn=r,km.current=n,Oi!==null)throw Error(ht(261));return oo=null,_o=0,Ui}function Ek(){for(;Oi!==null;)nT(Oi)}function Sk(){for(;Oi!==null&&!KA();)nT(Oi)}function nT(e){var t=sT(e.alternate,e,Ys);e.memoizedProps=e.pendingProps,t===null?iT(e):Oi=t,V0.current=null}function iT(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=yk(r,t),r!==null){r.flags&=32767,Oi=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ui=6,Oi=null;return}}else if(r=gk(r,t,Ys),r!==null){Oi=r;return}if(t=t.sibling,t!==null){Oi=t;return}Oi=t=e}while(t!==null);Ui===0&&(Ui=5)}function yc(e,t,r){var n=yn,a=Ma.transition;try{Ma.transition=null,yn=1,Tk(e,t,r,n)}finally{Ma.transition=a,yn=n}return null}function Tk(e,t,r,n){do Ih();while(Cu!==null);if(rn&6)throw Error(ht(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ht(177));e.callbackNode=null,e.callbackPriority=0;var l=r.lanes|r.childLanes;if(oM(e,l),e===oo&&(Oi=oo=null,_o=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Mp||(Mp=!0,aT(mm,function(){return Ih(),null})),l=(r.flags&15990)!==0,r.subtreeFlags&15990||l){l=Ma.transition,Ma.transition=null;var f=yn;yn=1;var u=rn;rn|=4,V0.current=null,_k(e,r),YS(r,e),qM(s_),ym=!!o_,s_=o_=null,e.current=r,xk(r),XA(),rn=u,yn=f,Ma.transition=l}else e.current=r;if(Mp&&(Mp=!1,Cu=e,Rm=a),l=e.pendingLanes,l===0&&(Ou=null),QA(r.stateNode),Cs(e,bi()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Lm)throw Lm=!1,e=C_,C_=null,e;return Rm&1&&e.tag!==0&&Ih(),l=e.pendingLanes,l&1?e===I_?Yd++:(Yd=0,I_=e):Yd=0,Vu(),null}function Ih(){if(Cu!==null){var e=F2(Rm),t=Ma.transition,r=yn;try{if(Ma.transition=null,yn=16>e?16:e,Cu===null)var n=!1;else{if(e=Cu,Cu=null,Rm=0,rn&6)throw Error(ht(331));var a=rn;for(rn|=4,zt=e.current;zt!==null;){var l=zt,f=l.child;if(zt.flags&16){var u=l.deletions;if(u!==null){for(var E=0;E<u.length;E++){var m=u[E];for(zt=m;zt!==null;){var S=zt;switch(S.tag){case 0:case 11:case 15:Xd(8,S,l)}var M=S.child;if(M!==null)M.return=S,zt=M;else for(;zt!==null;){S=zt;var z=S.sibling,H=S.return;if(KS(S),S===m){zt=null;break}if(z!==null){z.return=H,zt=z;break}zt=H}}}var q=l.alternate;if(q!==null){var Y=q.child;if(Y!==null){q.child=null;do{var ye=Y.sibling;Y.sibling=null,Y=ye}while(Y!==null)}}zt=l}}if(l.subtreeFlags&2064&&f!==null)f.return=l,zt=f;else e:for(;zt!==null;){if(l=zt,l.flags&2048)switch(l.tag){case 0:case 11:case 15:Xd(9,l,l.return)}var Q=l.sibling;if(Q!==null){Q.return=l.return,zt=Q;break e}zt=l.return}}var te=e.current;for(zt=te;zt!==null;){f=zt;var ne=f.child;if(f.subtreeFlags&2064&&ne!==null)ne.return=f,zt=ne;else e:for(f=te;zt!==null;){if(u=zt,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:pg(9,u)}}catch(Ve){di(u,u.return,Ve)}if(u===f){zt=null;break e}var Me=u.sibling;if(Me!==null){Me.return=u.return,zt=Me;break e}zt=u.return}}if(rn=a,Vu(),_l&&typeof _l.onPostCommitFiberRoot=="function")try{_l.onPostCommitFiberRoot(sg,e)}catch{}n=!0}return n}finally{yn=r,Ma.transition=t}}return!1}function vw(e,t,r){t=Dh(r,t),t=NS(e,t,1),e=Ru(e,t,1),t=ss(),e!==null&&(Of(e,1,t),Cs(e,t))}function di(e,t,r){if(e.tag===3)vw(e,e,r);else for(;t!==null;){if(t.tag===3){vw(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ou===null||!Ou.has(n))){e=Dh(r,e),e=BS(t,e,1),t=Ru(t,e,1),e=ss(),t!==null&&(Of(t,1,e),Cs(t,e));break}}t=t.return}}function Ck(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=ss(),e.pingedLanes|=e.suspendedLanes&r,oo===e&&(_o&r)===r&&(Ui===4||Ui===3&&(_o&130023424)===_o&&500>bi()-q0?Pc(e,0):G0|=r),Cs(e,t)}function oT(e,t){t===0&&(e.mode&1?(t=xp,xp<<=1,!(xp&130023424)&&(xp=4194304)):t=1);var r=ss();e=Kl(e,t),e!==null&&(Of(e,t,r),Cs(e,r))}function Ik(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),oT(e,r)}function Pk(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ht(314))}n!==null&&n.delete(t),oT(e,r)}var sT;sT=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ss.current)Es=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Es=!1,mk(e,t,r);Es=!!(e.flags&131072)}else Es=!1,Kn&&t.flags&1048576&&uS(t,Sm,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;rm(e,t),e=t.pendingProps;var a=kh(t,Bo.current);Ch(t,r),a=N0(null,t,n,e,a,r);var l=B0();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ts(n)?(l=!0,wm(t)):l=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,R0(t),a.updater=dg,t.stateNode=a,a._reactInternals=t,m_(t,n,e,r),t=v_(null,t,n,!0,l,r)):(t.tag=0,Kn&&l&&C0(t),is(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(rm(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=Mk(n),e=Qa(n,e),a){case 0:t=y_(null,t,n,e,r);break e;case 1:t=lw(null,t,n,e,r);break e;case 11:t=sw(null,t,n,e,r);break e;case 14:t=aw(null,t,n,Qa(n.type,e),r);break e}throw Error(ht(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Qa(n,a),y_(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Qa(n,a),lw(e,t,n,a,r);case 3:e:{if(VS(t),e===null)throw Error(ht(387));n=t.pendingProps,l=t.memoizedState,a=l.element,fS(e,t),Im(t,n,null,r);var f=t.memoizedState;if(n=f.element,l.isDehydrated)if(l={element:n,isDehydrated:!1,cache:f.cache,pendingSuspenseBoundaries:f.pendingSuspenseBoundaries,transitions:f.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){a=Dh(Error(ht(423)),t),t=uw(e,t,n,r,a);break e}else if(n!==a){a=Dh(Error(ht(424)),t),t=uw(e,t,n,r,a);break e}else for(ea=Lu(t.stateNode.containerInfo.firstChild),ta=t,Kn=!0,tl=null,r=yS(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Lh(),n===a){t=Xl(e,t,r);break e}is(e,t,n,r)}t=t.child}return t;case 5:return vS(t),e===null&&d_(t),n=t.type,a=t.pendingProps,l=e!==null?e.memoizedProps:null,f=a.children,a_(n,a)?f=null:l!==null&&a_(n,l)&&(t.flags|=32),$S(e,t),is(e,t,f,r),t.child;case 6:return e===null&&d_(t),null;case 13:return GS(e,t,r);case 4:return O0(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Rh(t,null,n,r):is(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Qa(n,a),sw(e,t,n,a,r);case 7:return is(e,t,t.pendingProps,r),t.child;case 8:return is(e,t,t.pendingProps.children,r),t.child;case 12:return is(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,l=t.memoizedProps,f=a.value,On(Tm,n._currentValue),n._currentValue=f,l!==null)if(il(l.value,f)){if(l.children===a.children&&!Ss.current){t=Xl(e,t,r);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var u=l.dependencies;if(u!==null){f=l.child;for(var E=u.firstContext;E!==null;){if(E.context===n){if(l.tag===1){E=Gl(-1,r&-r),E.tag=2;var m=l.updateQueue;if(m!==null){m=m.shared;var S=m.pending;S===null?E.next=E:(E.next=S.next,S.next=E),m.pending=E}}l.lanes|=r,E=l.alternate,E!==null&&(E.lanes|=r),f_(l.return,r,t),u.lanes|=r;break}E=E.next}}else if(l.tag===10)f=l.type===t.type?null:l.child;else if(l.tag===18){if(f=l.return,f===null)throw Error(ht(341));f.lanes|=r,u=f.alternate,u!==null&&(u.lanes|=r),f_(f,r,t),f=l.sibling}else f=l.child;if(f!==null)f.return=l;else for(f=l;f!==null;){if(f===t){f=null;break}if(l=f.sibling,l!==null){l.return=f.return,f=l;break}f=f.return}l=f}is(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Ch(t,r),a=ka(a),n=n(a),t.flags|=1,is(e,t,n,r),t.child;case 14:return n=t.type,a=Qa(n,t.pendingProps),a=Qa(n.type,a),aw(e,t,n,a,r);case 15:return US(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Qa(n,a),rm(e,t),t.tag=1,Ts(n)?(e=!0,wm(t)):e=!1,Ch(t,r),mS(t,n,a),m_(t,n,a,r),v_(null,t,n,!0,e,r);case 19:return qS(e,t,r);case 22:return jS(e,t,r)}throw Error(ht(156,t.tag))};function aT(e,t){return R2(e,t)}function Ak(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Aa(e,t,r,n){return new Ak(e,t,r,n)}function K0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Mk(e){if(typeof e=="function")return K0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===p0)return 11;if(e===m0)return 14}return 2}function zu(e,t){var r=e.alternate;return r===null?(r=Aa(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function om(e,t,r,n,a,l){var f=2;if(n=e,typeof e=="function")K0(e)&&(f=1);else if(typeof e=="string")f=5;else e:switch(e){case ch:return Ac(r.children,a,l,t);case f0:f=8,a|=8;break;case Bv:return e=Aa(12,r,t,a|2),e.elementType=Bv,e.lanes=l,e;case Uv:return e=Aa(13,r,t,a),e.elementType=Uv,e.lanes=l,e;case jv:return e=Aa(19,r,t,a),e.elementType=jv,e.lanes=l,e;case g2:return gg(r,a,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case p2:f=10;break e;case m2:f=9;break e;case p0:f=11;break e;case m0:f=14;break e;case vu:f=16,n=null;break e}throw Error(ht(130,e==null?e:typeof e,""))}return t=Aa(f,r,t,a),t.elementType=e,t.type=n,t.lanes=l,t}function Ac(e,t,r,n){return e=Aa(7,e,n,t),e.lanes=r,e}function gg(e,t,r,n){return e=Aa(22,e,n,t),e.elementType=g2,e.lanes=r,e.stateNode={isHidden:!1},e}function hv(e,t,r){return e=Aa(6,e,null,t),e.lanes=r,e}function dv(e,t,r){return t=Aa(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function kk(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hy(0),this.expirationTimes=Hy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hy(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function X0(e,t,r,n,a,l,f,u,E){return e=new kk(e,t,r,u,E),t===1?(t=1,l===!0&&(t|=8)):t=0,l=Aa(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},R0(l),e}function Lk(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:uh,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function lT(e){if(!e)return Nu;e=e._reactInternals;e:{if(zc(e)!==e||e.tag!==1)throw Error(ht(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ts(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ht(171))}if(e.tag===1){var r=e.type;if(Ts(r))return aS(e,r,t)}return t}function uT(e,t,r,n,a,l,f,u,E){return e=X0(r,n,!0,e,a,l,f,u,E),e.context=lT(null),r=e.current,n=ss(),a=Du(r),l=Gl(n,a),l.callback=t??null,Ru(r,l,a),e.current.lanes=a,Of(e,a,n),Cs(e,n),e}function yg(e,t,r,n){var a=t.current,l=ss(),f=Du(a);return r=lT(r),t.context===null?t.context=r:t.pendingContext=r,t=Gl(l,f),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ru(a,t,f),e!==null&&(nl(e,a,f,l),Qp(e,a,f)),f}function Dm(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function _w(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function J0(e,t){_w(e,t),(e=e.alternate)&&_w(e,t)}function Rk(){return null}var cT=typeof reportError=="function"?reportError:function(e){console.error(e)};function Y0(e){this._internalRoot=e}vg.prototype.render=Y0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ht(409));yg(e,t,null,null)};vg.prototype.unmount=Y0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Oc(function(){yg(null,e,null,null)}),t[Wl]=null}};function vg(e){this._internalRoot=e}vg.prototype.unstable_scheduleHydration=function(e){if(e){var t=U2();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Eu.length&&t!==0&&t<Eu[r].priority;r++);Eu.splice(r,0,e),r===0&&$2(e)}};function Q0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function _g(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function xw(){}function Ok(e,t,r,n,a){if(a){if(typeof n=="function"){var l=n;n=function(){var m=Dm(f);l.call(m)}}var f=uT(t,n,e,0,null,!1,!1,"",xw);return e._reactRootContainer=f,e[Wl]=f.current,mf(e.nodeType===8?e.parentNode:e),Oc(),f}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var u=n;n=function(){var m=Dm(E);u.call(m)}}var E=X0(e,0,!1,null,null,!1,!1,"",xw);return e._reactRootContainer=E,e[Wl]=E.current,mf(e.nodeType===8?e.parentNode:e),Oc(function(){yg(t,E,r,n)}),E}function xg(e,t,r,n,a){var l=r._reactRootContainer;if(l){var f=l;if(typeof a=="function"){var u=a;a=function(){var E=Dm(f);u.call(E)}}yg(t,f,e,a)}else f=Ok(r,t,e,a,n);return Dm(f)}N2=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ud(t.pendingLanes);r!==0&&(v0(t,r|1),Cs(t,bi()),!(rn&6)&&(zh=bi()+500,Vu()))}break;case 13:Oc(function(){var n=Kl(e,1);if(n!==null){var a=ss();nl(n,e,1,a)}}),J0(e,1)}};_0=function(e){if(e.tag===13){var t=Kl(e,134217728);if(t!==null){var r=ss();nl(t,e,134217728,r)}J0(e,134217728)}};B2=function(e){if(e.tag===13){var t=Du(e),r=Kl(e,t);if(r!==null){var n=ss();nl(r,e,t,n)}J0(e,t)}};U2=function(){return yn};j2=function(e,t){var r=yn;try{return yn=e,t()}finally{yn=r}};Jv=function(e,t,r){switch(t){case"input":if(Gv(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=cg(n);if(!a)throw Error(ht(90));v2(n),Gv(n,a)}}}break;case"textarea":x2(e,r);break;case"select":t=r.value,t!=null&&wh(e,!!r.multiple,t,!1)}};I2=H0;P2=Oc;var Dk={usingClientEntryPoint:!1,Events:[zf,ph,cg,T2,C2,H0]},Rd={findFiberByHostInstance:xc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},zk={bundleType:Rd.bundleType,version:Rd.version,rendererPackageName:Rd.rendererPackageName,rendererConfig:Rd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Yl.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=k2(e),e===null?null:e.stateNode},findFiberByHostInstance:Rd.findFiberByHostInstance||Rk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kp.isDisabled&&kp.supportsFiber)try{sg=kp.inject(zk),_l=kp}catch{}}ia.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Dk;ia.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Q0(t))throw Error(ht(200));return Lk(e,t,null,r)};ia.createRoot=function(e,t){if(!Q0(e))throw Error(ht(299));var r=!1,n="",a=cT;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=X0(e,1,!1,null,null,r,!1,n,a),e[Wl]=t.current,mf(e.nodeType===8?e.parentNode:e),new Y0(t)};ia.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ht(188)):(e=Object.keys(e).join(","),Error(ht(268,e)));return e=k2(t),e=e===null?null:e.stateNode,e};ia.flushSync=function(e){return Oc(e)};ia.hydrate=function(e,t,r){if(!_g(t))throw Error(ht(200));return xg(null,e,t,!0,r)};ia.hydrateRoot=function(e,t,r){if(!Q0(e))throw Error(ht(405));var n=r!=null&&r.hydratedSources||null,a=!1,l="",f=cT;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(l=r.identifierPrefix),r.onRecoverableError!==void 0&&(f=r.onRecoverableError)),t=uT(t,null,e,1,r??null,a,!1,l,f),e[Wl]=t.current,mf(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new vg(t)};ia.render=function(e,t,r){if(!_g(t))throw Error(ht(200));return xg(null,e,t,!1,r)};ia.unmountComponentAtNode=function(e){if(!_g(e))throw Error(ht(40));return e._reactRootContainer?(Oc(function(){xg(null,null,e,!1,function(){e._reactRootContainer=null,e[Wl]=null})}),!0):!1};ia.unstable_batchedUpdates=H0;ia.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!_g(r))throw Error(ht(200));if(e==null||e._reactInternals===void 0)throw Error(ht(38));return xg(e,t,r,!1,n)};ia.version="18.2.0-next-9e3b772b8-20220608";function hT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hT)}catch(e){console.error(e)}}hT(),u2.exports=ia;var dT=u2.exports;const Fk=Lf(dT);var bw=dT;Fv.createRoot=bw.createRoot,Fv.hydrateRoot=bw.hydrateRoot;var Nk="Logging",Bk=globalThis&&globalThis.__values||function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},oh=globalThis&&globalThis.__read||function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l},sh=globalThis&&globalThis.__spreadArray||function(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return e.concat(l||Array.prototype.slice.call(t))},ww={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5},Ya;(function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE"})(Ya||(Ya={}));var El=function(){function e(t,r){r===void 0&&(r=Ya.WARN),this.name=t,this.level=r,this._pluggables=[]}return e.prototype._padding=function(t){return t<10?"0"+t:""+t},e.prototype._ts=function(){var t=new Date;return[this._padding(t.getMinutes()),this._padding(t.getSeconds())].join(":")+"."+t.getMilliseconds()},e.prototype.configure=function(t){return t?(this._config=t,this._config):this._config},e.prototype._log=function(t){for(var r,n,a=[],l=1;l<arguments.length;l++)a[l-1]=arguments[l];var f=this.level;e.LOG_LEVEL&&(f=e.LOG_LEVEL),typeof window<"u"&&window.LOG_LEVEL&&(f=window.LOG_LEVEL);var u=ww[f],E=ww[t];if(E>=u){var m=console.log.bind(console);t===Ya.ERROR&&console.error&&(m=console.error.bind(console)),t===Ya.WARN&&console.warn&&(m=console.warn.bind(console));var S="[".concat(t,"] ").concat(this._ts()," ").concat(this.name),M="";if(a.length===1&&typeof a[0]=="string")M="".concat(S," - ").concat(a[0]),m(M);else if(a.length===1)M="".concat(S," ").concat(a[0]),m(S,a[0]);else if(typeof a[0]=="string"){var z=a.slice(1);z.length===1&&(z=z[0]),M="".concat(S," - ").concat(a[0]," ").concat(z),m("".concat(S," - ").concat(a[0]),z)}else M="".concat(S," ").concat(a),m(S,a);try{for(var H=Bk(this._pluggables),q=H.next();!q.done;q=H.next()){var Y=q.value,ye={message:M,timestamp:Date.now()};Y.pushLogs([ye])}}catch(Q){r={error:Q}}finally{try{q&&!q.done&&(n=H.return)&&n.call(H)}finally{if(r)throw r.error}}}},e.prototype.log=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this._log.apply(this,sh([Ya.INFO],oh(t),!1))},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this._log.apply(this,sh([Ya.INFO],oh(t),!1))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this._log.apply(this,sh([Ya.WARN],oh(t),!1))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this._log.apply(this,sh([Ya.ERROR],oh(t),!1))},e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this._log.apply(this,sh([Ya.DEBUG],oh(t),!1))},e.prototype.verbose=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this._log.apply(this,sh([Ya.VERBOSE],oh(t),!1))},e.prototype.addPluggable=function(t){t&&t.getCategoryName()===Nk&&(this._pluggables.push(t),t.configure(this._config))},e.prototype.listPluggables=function(){return this._pluggables},e.LOG_LEVEL=null,e}(),Uk=globalThis&&globalThis.__read||function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l},fv=new El("Amplify"),jk=function(){function e(){this._components=[],this._config={},this._modules={},this.Auth=null,this.Analytics=null,this.API=null,this.Credentials=null,this.Storage=null,this.I18n=null,this.Cache=null,this.PubSub=null,this.Interactions=null,this.Pushnotification=null,this.UI=null,this.XR=null,this.Predictions=null,this.DataStore=null,this.Geo=null,this.Notifications=null,this.Logger=El,this.ServiceWorker=null}return e.prototype.register=function(t){fv.debug("component registered in amplify",t),this._components.push(t),typeof t.getModuleName=="function"?(this._modules[t.getModuleName()]=t,this[t.getModuleName()]=t):fv.debug("no getModuleName method for component",t),t.configure(this._config)},e.prototype.configure=function(t){var r=this;return t?(this._config=Object.assign(this._config,t),fv.debug("amplify config",this._config),Object.entries(this._modules).forEach(function(n){var a=Uk(n,2);a[0];var l=a[1];Object.keys(l).forEach(function(f){r._modules[f]&&(l[f]=r._modules[f])})}),this._components.map(function(n){n.configure(r._config)}),this._config):this._config},e.prototype.addPluggable=function(t){t&&t.getCategory&&typeof t.getCategory=="function"&&this._components.map(function(r){r.addPluggable&&typeof r.addPluggable=="function"&&r.addPluggable(t)})},e}(),bg=new jk,ui;(function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"})(ui||(ui={}));var Ew;(function(e){e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"})(Ew||(Ew={}));var Sw;(function(e){e.Record="1",e.UpdateEndpoint="2"})(Sw||(Sw={}));var Tw;(function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"})(Tw||(Tw={}));var Cw;(function(e){e.FederatedSignIn="30"})(Cw||(Cw={}));var Iw;(function(e){e.Subscribe="1",e.GraphQl="2"})(Iw||(Iw={}));var Pw;(function(e){e.None="0"})(Pw||(Pw={}));var Aw;(function(e){e.None="0"})(Aw||(Aw={}));var Mw;(function(e){e.None="0"})(Mw||(Mw={}));var kw;(function(e){e.Convert="1",e.Identify="2",e.Interpret="3"})(kw||(kw={}));var Lw;(function(e){e.Subscribe="1"})(Lw||(Lw={}));var Rw;(function(e){e.None="0"})(Rw||(Rw={}));var Ow;(function(e){e.Put="1",e.Get="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6"})(Ow||(Ow={}));var fT="5.3.4",wg=function(){return typeof{}<"u"},Hh=function(){return typeof window<"u"},pT=function(){return typeof document<"u"},ex=function(){return typeof process<"u"},Sf=function(e,t){return!!Object.keys(e).find(function(r){return r.startsWith(t)})};function $k(){var e=function(n){return n.startsWith("_react")||n.startsWith("__react")},t=function(n){return Object.keys(n).find(e)},r=function(){return Array.from(document.querySelectorAll("[id]"))};return pT()&&r().some(t)}function Vk(){return ex()&&typeof process.env<"u"&&!!Object.keys(process.env).find(function(e){return e.includes("react")})}function Gk(){return Hh()&&Sf(window,"__VUE")}function qk(){return wg()&&Sf({},"__VUE")}function Hk(){return Hh()&&Sf(window,"__SVELTE")}function Zk(){return ex()&&typeof process.env<"u"&&!!Object.keys(process.env).find(function(e){return e.includes("svelte")})}function Wk(){return Hh()&&window.next&&typeof window.next=="object"}function Kk(){return wg()&&(Sf({},"__next")||Sf({},"__NEXT"))}function Xk(){return Hh()&&(window.__NUXT__!==void 0||window.$nuxt!==void 0)}function Jk(){return wg()&&typeof{}.__NUXT_PATHS__<"u"}function Yk(){var e=!!(pT()&&document.querySelector("[ng-version]")),t=!!(Hh()&&typeof window.ng<"u");return e||t}function Qk(){var e;return ex()&&typeof process.env=="object"&&((e=process.env.npm_lifecycle_script)===null||e===void 0?void 0:e.startsWith("ng "))||!1}function eL(){return typeof navigator<"u"&&typeof navigator.product<"u"&&navigator.product==="ReactNative"}function tL(){return wg()&&typeof{}.expo<"u"}function rL(){return Hh()}var nL=[{platform:ui.Expo,detectionMethod:tL},{platform:ui.ReactNative,detectionMethod:eL},{platform:ui.NextJs,detectionMethod:Wk},{platform:ui.Nuxt,detectionMethod:Xk},{platform:ui.Angular,detectionMethod:Yk},{platform:ui.React,detectionMethod:$k},{platform:ui.VueJs,detectionMethod:Gk},{platform:ui.Svelte,detectionMethod:Hk},{platform:ui.WebUnknown,detectionMethod:rL},{platform:ui.NextJsSSR,detectionMethod:Kk},{platform:ui.NuxtSSR,detectionMethod:Jk},{platform:ui.ReactSSR,detectionMethod:Vk},{platform:ui.VueJsSSR,detectionMethod:qk},{platform:ui.AngularSSR,detectionMethod:Qk},{platform:ui.SvelteSSR,detectionMethod:Zk}];function iL(){var e;return((e=nL.find(function(t){return t.detectionMethod()}))===null||e===void 0?void 0:e.platform)||ui.ServerSideUnknown}var Qd,mT=[],Dw=!1,oL=10,sL=10,aL=1e3,tx=function(){return Qd||(Qd=iL(),mT.forEach(function(e){return e()}),zw(ui.ServerSideUnknown,oL),zw(ui.WebUnknown,sL)),Qd},gT=function(e){mT.push(e)};function lL(){Qd=void 0}function zw(e,t){Qd===e&&!Dw&&setTimeout(function(){lL(),Dw=!0,setTimeout(tx,aL)},t)}var uL=globalThis&&globalThis.__read||function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l},yT="aws-amplify";(function(){function e(){this.userAgent="".concat(yT,"/").concat(fT)}return Object.defineProperty(e.prototype,"framework",{get:function(){return tx()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReactNative",{get:function(){return this.framework===ui.ReactNative||this.framework===ui.Expo},enumerable:!1,configurable:!0}),e.prototype.observeFrameworkChanges=function(t){gT(t)},e})();var Fl=function(e){var t=e===void 0?{}:e,r=t.category,n=t.action;t.framework;var a=[[yT,fT]];return r&&a.push([r,n]),a.push(["framework",tx()]),a},rx=function(e){var t=Fl(e),r=t.map(function(n){var a=uL(n,2),l=a[0],f=a[1];return"".concat(l,"/").concat(f)}).join(" ");return r},ef=globalThis&&globalThis.__assign||function(){return ef=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},ef.apply(this,arguments)},pv=globalThis&&globalThis.__read||function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l},Fw=globalThis&&globalThis.__spreadArray||function(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return e.concat(l||Array.prototype.slice.call(t))},zl=new El("Hub"),cL=typeof Symbol<"u"&&typeof Symbol.for=="function"?Symbol.for("amplify_default"):"@@amplify_default";function hL(e){return e.onHubCapsule!==void 0}var dL=function(){function e(t){this.listeners=[],this.patterns=[],this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=t}return e.prototype._remove=function(t,r){if(t instanceof RegExp){var n=this.patterns.find(function(l){var f=l.pattern;return f.source===t.source});if(!n){zl.warn("No listeners for ".concat(t));return}this.patterns=Fw([],pv(this.patterns.filter(function(l){return l!==n})),!1)}else{var a=this.listeners[t];if(!a){zl.warn("No listeners for ".concat(t));return}this.listeners[t]=Fw([],pv(a.filter(function(l){var f=l.callback;return f!==r})),!1)}},e.prototype.remove=function(t,r){this._remove(t,r)},e.prototype.dispatch=function(t,r,n,a){if(n===void 0&&(n=""),this.protectedChannels.indexOf(t)>-1){var l=a===cL;l||zl.warn("WARNING: ".concat(t," is protected and dispatching on it can have unintended consequences"))}var f={channel:t,payload:ef({},r),source:n,patternInfo:[]};try{this._toListeners(f)}catch(u){zl.error(u)}},e.prototype.listen=function(t,r,n){var a=this;n===void 0&&(n="noname");var l;if(hL(r))zl.warn("WARNING onHubCapsule is Deprecated. Please pass in a callback."),l=r.onHubCapsule.bind(r);else{if(typeof r!="function")throw new Error("No callback supplied to Hub");l=r}if(t instanceof RegExp)this.patterns.push({pattern:t,callback:l});else{var f=this.listeners[t];f||(f=[],this.listeners[t]=f),f.push({name:n,callback:l})}return function(){a._remove(t,l)}},e.prototype._toListeners=function(t){var r=t.channel,n=t.payload,a=this.listeners[r];if(a&&a.forEach(function(f){zl.debug("Dispatching to ".concat(r," with "),n);try{f.callback(t)}catch(u){zl.error(u)}}),this.patterns.length>0){if(!n.message){zl.warn("Cannot perform pattern matching without a message key");return}var l=n.message;this.patterns.forEach(function(f){var u=l.match(f.pattern);if(u){var E=pv(u),m=E.slice(1),S=ef(ef({},t),{patternInfo:m});try{f.callback(S)}catch(M){zl.error(M)}}})}},e}(),vT=new dL("__default__"),fL=function(e){if(e.isResolved)return e;var t=!0,r=!1,n=!1,a=e.then(function(l){return n=!0,t=!1,l},function(l){throw r=!0,t=!1,l});return a.isFullfilled=function(){return n},a.isPending=function(){return t},a.isRejected=function(){return r},a},Eg=function(){var e=typeof window<"u"&&typeof window.document<"u",t=typeof process<"u"&&process.versions!=null&&process.versions.node!=null;return{isBrowser:e,isNode:t}},pL=globalThis&&globalThis.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(n[l]=a[l])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Nw=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})},mv=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},mL=globalThis&&globalThis.__read||function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l},gL=globalThis&&globalThis.__spreadArray||function(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return e.concat(l||Array.prototype.slice.call(t))},Lp=new El("Util"),Ec=function(e){pL(t,e);function t(r){var n=e.call(this,r)||this;return n.nonRetryable=!0,n}return t}(Error),yL=function(e){var t="nonRetryable";return e&&e[t]};function vL(e,t,r,n){return Nw(this,void 0,void 0,function(){var a=this;return mv(this,function(l){if(typeof e!="function")throw Error("functionToRetry must be a function");return[2,new Promise(function(f,u){return Nw(a,void 0,void 0,function(){var E,m,S,M,z,H,q;return mv(this,function(Y){switch(Y.label){case 0:E=0,m=!1,M=function(){},n&&n.then(function(){m=!0,clearTimeout(S),M()}),H=function(){var ye,Q,te,ne;return mv(this,function(Me){switch(Me.label){case 0:E++,Lp.debug("".concat(e.name," attempt #").concat(E," with this vars: ").concat(JSON.stringify(t))),Me.label=1;case 1:return Me.trys.push([1,3,,7]),ye={},Q=f,[4,e.apply(void 0,gL([],mL(t),!1))];case 2:return[2,(ye.value=Q.apply(void 0,[Me.sent()]),ye)];case 3:return te=Me.sent(),z=te,Lp.debug("error on ".concat(e.name),te),yL(te)?(Lp.debug("".concat(e.name," non retryable error"),te),[2,{value:u(te)}]):(ne=r(E,t,te),Lp.debug("".concat(e.name," retrying in ").concat(ne," ms")),ne===!1||m?[2,{value:u(te)}]:[3,4]);case 4:return[4,new Promise(function(Ve){M=Ve,S=setTimeout(M,ne)})];case 5:Me.sent(),Me.label=6;case 6:return[3,7];case 7:return[2]}})},Y.label=1;case 1:return m?[3,3]:[5,H()];case 2:return q=Y.sent(),typeof q=="object"?[2,q.value]:[3,1];case 3:return u(z),[2]}})})})]})})}var _T=5*60*1e3;function xT(e){e===void 0&&(e=_T);var t=100,r=100;return function(n){var a=Math.pow(2,n)*t+r*Math.random();return a>e?!1:a}}var bT=function(e,t,r,n){return r===void 0&&(r=_T),vL(e,t,xT(r),n)},_L=globalThis&&globalThis.__read||function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l},xL=1e3*60*5,vc={clockOffset:0,getDateWithClockOffset:function(){return vc.clockOffset?new Date(new Date().getTime()+vc.clockOffset):new Date},getClockOffset:function(){return vc.clockOffset},getHeaderStringFromDate:function(e){return e===void 0&&(e=vc.getDateWithClockOffset()),e.toISOString().replace(/[:\-]|\.\d{3}/g,"")},getDateFromHeaderString:function(e){var t=_L(e.match(/^(\d{4})(\d{2})(\d{2})T(\d{2})(\d{2})(\d{2}).+/),7),r=t[1],n=t[2],a=t[3],l=t[4],f=t[5],u=t[6];return new Date(Date.UTC(Number(r),Number(n)-1,Number(a),Number(l),Number(f),Number(u)))},isClockSkewed:function(e){return Math.abs(e.getTime()-vc.getDateWithClockOffset().getTime())>=xL},isClockSkewError:function(e){if(!e.response||!e.response.headers)return!1;var t=e.response.headers;return!!(["BadRequestException","InvalidSignatureException"].includes(t["x-amzn-errortype"])&&(t.date||t.Date))},setClockOffset:function(e){vc.clockOffset=e}},wT=function(e){return Object.keys(e).map(function(t){return t.toLowerCase()}).sort().join(";")},bL="X-Amz-Algorithm",ET="X-Amz-Date",wL="X-Amz-Credential",EL="X-Amz-Expires",SL="X-Amz-Signature",TL="X-Amz-SignedHeaders",nx="X-Amz-Security-Token",CL="authorization",M_="host",IL=ET.toLowerCase(),PL=nx.toLowerCase(),ST="aws4_request",ix="AWS4-HMAC-SHA256",AL="AWS4",ML="e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",kL="UNSIGNED-PAYLOAD",LL=function(e,t,r){return"".concat(e,"/").concat(t,"/").concat(r,"/").concat(ST)},RL=function(e){var t=e.toISOString().replace(/[:\-]|\.\d{3}/g,"");return{longDate:t,shortDate:t.slice(0,8)}},TT=function(e){var t=e.credentials,r=e.signingDate,n=r===void 0?new Date:r,a=e.signingRegion,l=e.signingService,f=e.uriEscapePath,u=f===void 0?!0:f,E=t.accessKeyId,m=t.secretAccessKey,S=t.sessionToken,M=RL(n),z=M.longDate,H=M.shortDate,q=LL(H,a,l);return{accessKeyId:E,credentialScope:q,longDate:z,secretAccessKey:m,sessionToken:S,shortDate:H,signingRegion:a,signingService:l,uriEscapePath:u}},CT={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var k_=function(e,t){return k_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},k_(e,t)};function OL(e,t){k_(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Iu=function(){return Iu=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Iu.apply(this,arguments)};function DL(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function zL(e,t,r,n){var a=arguments.length,l=a<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(f=e[u])&&(l=(a<3?f(l):a>3?f(t,r,l):f(t,r))||l);return a>3&&l&&Object.defineProperty(t,r,l),l}function FL(e,t){return function(r,n){t(r,n,e)}}function NL(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function ci(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})}function hi(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}function BL(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function UL(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function L_(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Fh(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l}function IT(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Fh(arguments[t]));return e}function jL(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var l=arguments[t],f=0,u=l.length;f<u;f++,a++)n[a]=l[f];return n}function Tf(e){return this instanceof Tf?(this.v=e,this):new Tf(e)}function $L(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),a,l=[];return a={},f("next"),f("throw"),f("return"),a[Symbol.asyncIterator]=function(){return this},a;function f(z){n[z]&&(a[z]=function(H){return new Promise(function(q,Y){l.push([z,H,q,Y])>1||u(z,H)})})}function u(z,H){try{E(n[z](H))}catch(q){M(l[0][3],q)}}function E(z){z.value instanceof Tf?Promise.resolve(z.value.v).then(m,S):M(l[0][2],z)}function m(z){u("next",z)}function S(z){u("throw",z)}function M(z,H){z(H),l.shift(),l.length&&u(l[0][0],l[0][1])}}function VL(e){var t,r;return t={},n("next"),n("throw",function(a){throw a}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(a,l){t[a]=e[a]?function(f){return(r=!r)?{value:Tf(e[a](f)),done:a==="return"}:l?l(f):f}:l}}function GL(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof L_=="function"?L_(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(l){r[l]=e[l]&&function(f){return new Promise(function(u,E){f=e[l](f),a(u,E,f.done,f.value)})}}function a(l,f,u,E){Promise.resolve(E).then(function(m){l({value:m,done:u})},f)}}function qL(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function HL(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function ZL(e){return e&&e.__esModule?e:{default:e}}function WL(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function KL(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}const XL=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Iu},__asyncDelegator:VL,__asyncGenerator:$L,__asyncValues:GL,__await:Tf,__awaiter:ci,__classPrivateFieldGet:WL,__classPrivateFieldSet:KL,__createBinding:BL,__decorate:zL,__exportStar:UL,__extends:OL,__generator:hi,__importDefault:ZL,__importStar:HL,__makeTemplateObject:qL,__metadata:NL,__param:FL,__read:Fh,__rest:DL,__spread:IT,__spreadArrays:jL,__values:L_},Symbol.toStringTag,{value:"Module"})),PT=na(XL);var Sg={},Qs={};Object.defineProperty(Qs,"__esModule",{value:!0});Qs.MAX_HASHABLE_LENGTH=Qs.INIT=Qs.KEY=Qs.DIGEST_LENGTH=Qs.BLOCK_SIZE=void 0;Qs.BLOCK_SIZE=64;Qs.DIGEST_LENGTH=32;Qs.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);Qs.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];Qs.MAX_HASHABLE_LENGTH=Math.pow(2,53)-1;var Tg={};Object.defineProperty(Tg,"__esModule",{value:!0});Tg.RawSha256=void 0;var Ta=Qs,JL=function(){function e(){this.state=Int32Array.from(Ta.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(t){if(this.finished)throw new Error("Attempted to update an already finished hash.");var r=0,n=t.byteLength;if(this.bytesHashed+=n,this.bytesHashed*8>Ta.MAX_HASHABLE_LENGTH)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=t[r++],n--,this.bufferLength===Ta.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var t=this.bytesHashed*8,r=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(r.setUint8(this.bufferLength++,128),n%Ta.BLOCK_SIZE>=Ta.BLOCK_SIZE-8){for(var a=this.bufferLength;a<Ta.BLOCK_SIZE;a++)r.setUint8(a,0);this.hashBuffer(),this.bufferLength=0}for(var a=this.bufferLength;a<Ta.BLOCK_SIZE-8;a++)r.setUint8(a,0);r.setUint32(Ta.BLOCK_SIZE-8,Math.floor(t/4294967296),!0),r.setUint32(Ta.BLOCK_SIZE-4,t),this.hashBuffer(),this.finished=!0}for(var l=new Uint8Array(Ta.DIGEST_LENGTH),a=0;a<8;a++)l[a*4]=this.state[a]>>>24&255,l[a*4+1]=this.state[a]>>>16&255,l[a*4+2]=this.state[a]>>>8&255,l[a*4+3]=this.state[a]>>>0&255;return l},e.prototype.hashBuffer=function(){for(var t=this,r=t.buffer,n=t.state,a=n[0],l=n[1],f=n[2],u=n[3],E=n[4],m=n[5],S=n[6],M=n[7],z=0;z<Ta.BLOCK_SIZE;z++){if(z<16)this.temp[z]=(r[z*4]&255)<<24|(r[z*4+1]&255)<<16|(r[z*4+2]&255)<<8|r[z*4+3]&255;else{var H=this.temp[z-2],q=(H>>>17|H<<15)^(H>>>19|H<<13)^H>>>10;H=this.temp[z-15];var Y=(H>>>7|H<<25)^(H>>>18|H<<14)^H>>>3;this.temp[z]=(q+this.temp[z-7]|0)+(Y+this.temp[z-16]|0)}var ye=(((E>>>6|E<<26)^(E>>>11|E<<21)^(E>>>25|E<<7))+(E&m^~E&S)|0)+(M+(Ta.KEY[z]+this.temp[z]|0)|0)|0,Q=((a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+(a&l^a&f^l&f)|0;M=S,S=m,m=E,E=u+ye|0,u=f,f=l,l=a,a=ye+Q|0}n[0]+=a,n[1]+=l,n[2]+=f,n[3]+=u,n[4]+=E,n[5]+=m,n[6]+=S,n[7]+=M},e}();Tg.RawSha256=JL;var AT={},Cg={};const YL=e=>{const t=[];for(let r=0,n=e.length;r<n;r++){const a=e.charCodeAt(r);if(a<128)t.push(a);else if(a<2048)t.push(a>>6|192,a&63|128);else if(r+1<e.length&&(a&64512)===55296&&(e.charCodeAt(r+1)&64512)===56320){const l=65536+((a&1023)<<10)+(e.charCodeAt(++r)&1023);t.push(l>>18|240,l>>12&63|128,l>>6&63|128,l&63|128)}else t.push(a>>12|224,a>>6&63|128,a&63|128)}return Uint8Array.from(t)},QL=e=>{let t="";for(let r=0,n=e.length;r<n;r++){const a=e[r];if(a<128)t+=String.fromCharCode(a);else if(192<=a&&a<224){const l=e[++r];t+=String.fromCharCode((a&31)<<6|l&63)}else if(240<=a&&a<365){const f="%"+[a,e[++r],e[++r],e[++r]].map(u=>u.toString(16)).join("%");t+=decodeURIComponent(f)}else t+=String.fromCharCode((a&15)<<12|(e[++r]&63)<<6|e[++r]&63)}return t};function eR(e){return new TextEncoder().encode(e)}function tR(e){return new TextDecoder("utf-8").decode(e)}const rR=e=>typeof TextEncoder=="function"?eR(e):YL(e),nR=e=>typeof TextDecoder=="function"?tR(e):QL(e),iR=Object.freeze(Object.defineProperty({__proto__:null,fromUtf8:rR,toUtf8:nR},Symbol.toStringTag,{value:"Module"})),oR=na(iR);Object.defineProperty(Cg,"__esModule",{value:!0});Cg.convertToBuffer=void 0;var sR=oR,aR=typeof Buffer<"u"&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:sR.fromUtf8;function lR(e){return e instanceof Uint8Array?e:typeof e=="string"?aR(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}Cg.convertToBuffer=lR;var Ig={};Object.defineProperty(Ig,"__esModule",{value:!0});Ig.isEmptyData=void 0;function uR(e){return typeof e=="string"?e.length===0:e.byteLength===0}Ig.isEmptyData=uR;var Pg={};Object.defineProperty(Pg,"__esModule",{value:!0});Pg.numToUint8=void 0;function cR(e){return new Uint8Array([(e&4278190080)>>24,(e&16711680)>>16,(e&65280)>>8,e&255])}Pg.numToUint8=cR;var Ag={};Object.defineProperty(Ag,"__esModule",{value:!0});Ag.uint32ArrayFrom=void 0;function hR(e){if(!Array.from){for(var t=new Uint32Array(e.length),r=0;r<e.length;)t[r]=e[r];return t}return Uint32Array.from(e)}Ag.uint32ArrayFrom=hR;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.uint32ArrayFrom=e.numToUint8=e.isEmptyData=e.convertToBuffer=void 0;var t=Cg;Object.defineProperty(e,"convertToBuffer",{enumerable:!0,get:function(){return t.convertToBuffer}});var r=Ig;Object.defineProperty(e,"isEmptyData",{enumerable:!0,get:function(){return r.isEmptyData}});var n=Pg;Object.defineProperty(e,"numToUint8",{enumerable:!0,get:function(){return n.numToUint8}});var a=Ag;Object.defineProperty(e,"uint32ArrayFrom",{enumerable:!0,get:function(){return a.uint32ArrayFrom}})})(AT);Object.defineProperty(Sg,"__esModule",{value:!0});Sg.Sha256=void 0;var Bw=PT,zm=Qs,R_=Tg,O_=AT,dR=function(){function e(t){if(this.hash=new R_.RawSha256,t){this.outer=new R_.RawSha256;var r=fR(t),n=new Uint8Array(zm.BLOCK_SIZE);n.set(r);for(var a=0;a<zm.BLOCK_SIZE;a++)r[a]^=54,n[a]^=92;this.hash.update(r),this.outer.update(n);for(var a=0;a<r.byteLength;a++)r[a]=0}}return e.prototype.update=function(t){if(!((0,O_.isEmptyData)(t)||this.error))try{this.hash.update((0,O_.convertToBuffer)(t))}catch(r){this.error=r}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return(0,Bw.__awaiter)(this,void 0,void 0,function(){return(0,Bw.__generator)(this,function(t){return[2,this.digestSync()]})})},e}();Sg.Sha256=dR;function fR(e){var t=(0,O_.convertToBuffer)(e);if(t.byteLength>zm.BLOCK_SIZE){var r=new R_.RawSha256;r.update(t),t=r.digest()}var n=new Uint8Array(zm.BLOCK_SIZE);return n.set(t),n}(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=PT;(0,t.__exportStar)(Sg,e)})(CT);var MT={};for(var Rp=0;Rp<256;Rp++){var Op=Rp.toString(16).toLowerCase();Op.length===1&&(Op="0"+Op),MT[Rp]=Op}function pR(e){for(var t="",r=0;r<e.byteLength;r++)t+=MT[e[r]];return t}var $d=function(e,t){var r=new CT.Sha256(e);r.update(t);var n=r.digestSync();return n},D_=function(e,t){var r=$d(e,t);return pR(r)},mR=globalThis&&globalThis.__read||function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l},gR=function(e){return Object.entries(e).map(function(t){var r,n=mR(t,2),a=n[0],l=n[1];return{key:a.toLowerCase(),value:(r=l==null?void 0:l.trim().replace(/\s+/g," "))!==null&&r!==void 0?r:""}}).sort(function(t,r){return t.key<r.key?-1:1}).map(function(t){return"".concat(t.key,":").concat(t.value,`
`)}).join("")},gv=globalThis&&globalThis.__read||function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l},yR=function(e){return Array.from(e).sort(function(t,r){var n=gv(t,2),a=n[0],l=n[1],f=gv(r,2),u=f[0],E=f[1];return a===u?l<E?-1:1:a<u?-1:1}).map(function(t){var r=gv(t,2),n=r[0],a=r[1];return"".concat(Uw(n),"=").concat(Uw(a))}).join("&")},Uw=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,vR)},vR=function(e){return"%".concat(e.charCodeAt(0).toString(16).toUpperCase())},_R=function(e,t){return t===void 0&&(t=!0),e?t?encodeURIComponent(e).replace(/%2F/g,"/"):e:"/"},xR=function(e){if(e==null)return ML;if(bR(e)){var t=D_(null,e);return t}return kL},bR=function(e){return typeof e=="string"||ArrayBuffer.isView(e)||wR(e)},wR=function(e){return typeof ArrayBuffer=="function"&&e instanceof ArrayBuffer||Object.prototype.toString.call(e)==="[object ArrayBuffer]"},ER=function(e,t){var r=e.body,n=e.headers,a=e.method,l=e.url;return t===void 0&&(t=!0),[a,_R(l.pathname,t),yR(l.searchParams),gR(n),wT(n),xR(r)].join(`
`)},SR=function(e,t,r,n){var a="".concat(AL).concat(e),l=$d(a,t),f=$d(l,r),u=$d(f,n),E=$d(u,ST);return E},TR=function(e,t,r){return[ix,e,t,r].join(`
`)},kT=function(e,t){var r=t.credentialScope,n=t.longDate,a=t.secretAccessKey,l=t.shortDate,f=t.signingRegion,u=t.signingService,E=t.uriEscapePath,m=ER(e,E),S=D_(null,m),M=TR(n,r,S),z=D_(SR(a,l,f,u),M);return z},tf=globalThis&&globalThis.__assign||function(){return tf=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},tf.apply(this,arguments)},CR=function(e,t){var r=TT(t),n=r.accessKeyId,a=r.credentialScope,l=r.longDate,f=r.sessionToken,u=tf({},e.headers);u[M_]=e.url.host,u[IL]=l,f&&(u[PL]=f);var E=tf(tf({},e),{headers:u}),m=kT(E,r),S="Credential=".concat(n,"/").concat(a),M="SignedHeaders=".concat(wT(u)),z="Signature=".concat(m);return u[CL]="".concat(ix," ").concat(S,", ").concat(M,", ").concat(z),E},Fm=globalThis&&globalThis.__assign||function(){return Fm=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Fm.apply(this,arguments)},IR=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r},PR=globalThis&&globalThis.__read||function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l},AR=function(e,t){var r,n,a,l,f=e.body,u=e.method,E=u===void 0?"GET":u,m=e.url,S=t.expiration,M=IR(t,["expiration"]),z=TT(M),H=z.accessKeyId,q=z.credentialScope,Y=z.longDate,ye=z.sessionToken,Q=new URL(m);Object.entries(Fm(Fm((r={},r[bL]=ix,r[wL]="".concat(H,"/").concat(q),r[ET]=Y,r[TL]=M_,r),S&&(n={},n[EL]=S.toString(),n)),ye&&(a={},a[nx]=ye,a))).forEach(function(Me){var Ve=PR(Me,2),je=Ve[0],Qe=Ve[1];Q.searchParams.append(je,Qe)});var te={body:f,headers:(l={},l[M_]=m.host,l),method:E,url:Q},ne=kT(te,z);return Q.searchParams.append(SL,ne),Q},Nh=globalThis&&globalThis.__assign||function(){return Nh=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Nh.apply(this,arguments)},MR="iotdevicegateway",kR=/([^\.]+)\.(?:([^\.]*)\.)?amazonaws\.com(.cn)?$/,LR=function(){function e(){}return e.sign=function(t,r,n){if(t.headers=t.headers||{},t.body&&!t.data)throw new Error('The attribute "body" was found on the request object. Please use the attribute "data" instead.');var a=Nh(Nh({},t),{body:t.data,url:new URL(t.url)}),l=jw(a,r,n),f=CR(a,l);return f.url=f.url.toString(),f.headers.Authorization=f.headers.authorization,f.headers["X-Amz-Security-Token"]=f.headers["x-amz-security-token"],delete f.headers.authorization,delete f.headers["x-amz-security-token"],f},e.signUrl=function(t,r,n,a){var l=typeof t=="object"?t.url:t,f=typeof t=="object"?t.method:"GET",u=typeof t=="object"?t.body:void 0,E={body:u,method:f,url:new URL(l)},m=jw(E,r,n,a),S=AR(E,m);return r.session_token&&!LT(m.signingService)&&S.searchParams.append(nx,r.session_token),S.toString()},e}(),jw=function(e,t,r,n){var a=t??{},l=a.access_key,f=a.secret_key,u=a.session_token,E=RR(e.url),m=E.region,S=E.service,M=r??{},z=M.region,H=z===void 0?m:z,q=M.service,Y=q===void 0?S:q,ye=Nh({accessKeyId:l,secretAccessKey:f},LT(Y)?{sessionToken:u}:{});return Nh({credentials:ye,signingDate:vc.getDateWithClockOffset(),signingRegion:H,signingService:Y},n&&{expiration:n})},RR=function(e){var t,r=e.host,n=(t=r.match(kR))!==null&&t!==void 0?t:[],a=n.slice(1,3);return a[1]==="es"&&(a=a.reverse()),{service:a[0],region:a[1]}},LT=function(e){return e!==MR},Nm=globalThis&&globalThis.__assign||function(){return Nm=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Nm.apply(this,arguments)},OR=new El("Parser"),RT=function(e){var t={};if(e.aws_mobile_analytics_app_id){var r={AWSPinpoint:{appId:e.aws_mobile_analytics_app_id,region:e.aws_mobile_analytics_app_region}};t.Analytics=r}(e.aws_cognito_identity_pool_id||e.aws_user_pools_id)&&(t.Auth={userPoolId:e.aws_user_pools_id,userPoolWebClientId:e.aws_user_pools_web_client_id,region:e.aws_cognito_region,identityPoolId:e.aws_cognito_identity_pool_id,identityPoolRegion:e.aws_cognito_region,mandatorySignIn:e.aws_mandatory_sign_in==="enable",signUpVerificationMethod:e.aws_cognito_sign_up_verification_method||"code"});var n;return e.aws_user_files_s3_bucket?n={AWSS3:{bucket:e.aws_user_files_s3_bucket,region:e.aws_user_files_s3_bucket_region,dangerouslyConnectToHttpEndpointForTesting:e.aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing}}:n=e?e.Storage||e:{},e.Logging&&(t.Logging=Nm(Nm({},e.Logging),{region:e.aws_project_region})),e.geo&&(t.Geo=Object.assign({},e.geo),e.geo.amazon_location_service&&(t.Geo={AmazonLocationService:e.geo.amazon_location_service})),t.Analytics=Object.assign({},t.Analytics,e.Analytics),t.Auth=Object.assign({},t.Auth,e.Auth),t.Storage=Object.assign({},n),t.Logging=Object.assign({},t.Logging,e.Logging),OR.debug("parse config",e,"to amplifyconfig",t),t};const DR={};function zR(){return typeof window<"u"?window:typeof self<"u"?self:DR}const FR=Object.freeze(Object.defineProperty({__proto__:null,locateWindow:zR},Symbol.toStringTag,{value:"Module"})),ox=na(FR),NR={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},OT={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},xi={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},ns={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},yu={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class nt{static getFirstMatch(t,r){const n=r.match(t);return n&&n.length>0&&n[1]||""}static getSecondMatch(t,r){const n=r.match(t);return n&&n.length>1&&n[2]||""}static matchAndReturnConst(t,r,n){if(t.test(r))return n}static getWindowsVersionName(t){switch(t){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(t){const r=t.split(".").splice(0,2).map(n=>parseInt(n,10)||0);if(r.push(0),r[0]===10)switch(r[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(t){const r=t.split(".").splice(0,2).map(n=>parseInt(n,10)||0);if(r.push(0),!(r[0]===1&&r[1]<5)){if(r[0]===1&&r[1]<6)return"Cupcake";if(r[0]===1&&r[1]>=6)return"Donut";if(r[0]===2&&r[1]<2)return"Eclair";if(r[0]===2&&r[1]===2)return"Froyo";if(r[0]===2&&r[1]>2)return"Gingerbread";if(r[0]===3)return"Honeycomb";if(r[0]===4&&r[1]<1)return"Ice Cream Sandwich";if(r[0]===4&&r[1]<4)return"Jelly Bean";if(r[0]===4&&r[1]>=4)return"KitKat";if(r[0]===5)return"Lollipop";if(r[0]===6)return"Marshmallow";if(r[0]===7)return"Nougat";if(r[0]===8)return"Oreo";if(r[0]===9)return"Pie"}}static getVersionPrecision(t){return t.split(".").length}static compareVersions(t,r,n=!1){const a=nt.getVersionPrecision(t),l=nt.getVersionPrecision(r);let f=Math.max(a,l),u=0;const E=nt.map([t,r],m=>{const S=f-nt.getVersionPrecision(m),M=m+new Array(S+1).join(".0");return nt.map(M.split("."),z=>new Array(20-z.length).join("0")+z).reverse()});for(n&&(u=f-Math.min(a,l)),f-=1;f>=u;){if(E[0][f]>E[1][f])return 1;if(E[0][f]===E[1][f]){if(f===u)return 0;f-=1}else if(E[0][f]<E[1][f])return-1}}static map(t,r){const n=[];let a;if(Array.prototype.map)return Array.prototype.map.call(t,r);for(a=0;a<t.length;a+=1)n.push(r(t[a]));return n}static find(t,r){let n,a;if(Array.prototype.find)return Array.prototype.find.call(t,r);for(n=0,a=t.length;n<a;n+=1){const l=t[n];if(r(l,n))return l}}static assign(t,...r){const n=t;let a,l;if(Object.assign)return Object.assign(t,...r);for(a=0,l=r.length;a<l;a+=1){const f=r[a];typeof f=="object"&&f!==null&&Object.keys(f).forEach(E=>{n[E]=f[E]})}return t}static getBrowserAlias(t){return NR[t]}static getBrowserTypeByAlias(t){return OT[t]||""}}const kn=/version\/(\d+(\.?_?\d+)+)/i,BR=[{test:[/googlebot/i],describe(e){const t={name:"Googlebot"},r=nt.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||nt.getFirstMatch(kn,e);return r&&(t.version=r),t}},{test:[/opera/i],describe(e){const t={name:"Opera"},r=nt.getFirstMatch(kn,e)||nt.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe(e){const t={name:"Opera"},r=nt.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||nt.getFirstMatch(kn,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe(e){const t={name:"Samsung Internet for Android"},r=nt.getFirstMatch(kn,e)||nt.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe(e){const t={name:"NAVER Whale Browser"},r=nt.getFirstMatch(kn,e)||nt.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe(e){const t={name:"MZ Browser"},r=nt.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||nt.getFirstMatch(kn,e);return r&&(t.version=r),t}},{test:[/focus/i],describe(e){const t={name:"Focus"},r=nt.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||nt.getFirstMatch(kn,e);return r&&(t.version=r),t}},{test:[/swing/i],describe(e){const t={name:"Swing"},r=nt.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||nt.getFirstMatch(kn,e);return r&&(t.version=r),t}},{test:[/coast/i],describe(e){const t={name:"Opera Coast"},r=nt.getFirstMatch(kn,e)||nt.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(e){const t={name:"Opera Touch"},r=nt.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||nt.getFirstMatch(kn,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe(e){const t={name:"Yandex Browser"},r=nt.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||nt.getFirstMatch(kn,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe(e){const t={name:"UC Browser"},r=nt.getFirstMatch(kn,e)||nt.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe(e){const t={name:"Maxthon"},r=nt.getFirstMatch(kn,e)||nt.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe(e){const t={name:"Epiphany"},r=nt.getFirstMatch(kn,e)||nt.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe(e){const t={name:"Puffin"},r=nt.getFirstMatch(kn,e)||nt.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe(e){const t={name:"Sleipnir"},r=nt.getFirstMatch(kn,e)||nt.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe(e){const t={name:"K-Meleon"},r=nt.getFirstMatch(kn,e)||nt.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe(e){const t={name:"WeChat"},r=nt.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||nt.getFirstMatch(kn,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe(e){const t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},r=nt.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||nt.getFirstMatch(kn,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe(e){const t={name:"Internet Explorer"},r=nt.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe(e){const t={name:"Microsoft Edge"},r=nt.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe(e){const t={name:"Microsoft Edge"},r=nt.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe(e){const t={name:"Vivaldi"},r=nt.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe(e){const t={name:"SeaMonkey"},r=nt.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe(e){const t={name:"Sailfish"},r=nt.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe(e){const t={name:"Amazon Silk"},r=nt.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe(e){const t={name:"PhantomJS"},r=nt.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe(e){const t={name:"SlimerJS"},r=nt.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(e){const t={name:"BlackBerry"},r=nt.getFirstMatch(kn,e)||nt.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe(e){const t={name:"WebOS Browser"},r=nt.getFirstMatch(kn,e)||nt.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe(e){const t={name:"Bada"},r=nt.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe(e){const t={name:"Tizen"},r=nt.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||nt.getFirstMatch(kn,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe(e){const t={name:"QupZilla"},r=nt.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||nt.getFirstMatch(kn,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe(e){const t={name:"Firefox"},r=nt.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe(e){const t={name:"Electron"},r=nt.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MiuiBrowser/i],describe(e){const t={name:"Miui"},r=nt.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe(e){const t={name:"Chromium"},r=nt.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||nt.getFirstMatch(kn,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe(e){const t={name:"Chrome"},r=nt.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe(e){const t={name:"Google Search"},r=nt.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test(e){const t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe(e){const t={name:"Android Browser"},r=nt.getFirstMatch(kn,e);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe(e){const t={name:"PlayStation 4"},r=nt.getFirstMatch(kn,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe(e){const t={name:"Safari"},r=nt.getFirstMatch(kn,e);return r&&(t.version=r),t}},{test:[/.*/i],describe(e){const t=/^(.*)\/(.*) /,r=/^(.*)\/(.*)[ \t]\((.*)/,a=e.search("\\(")!==-1?r:t;return{name:nt.getFirstMatch(a,e),version:nt.getSecondMatch(a,e)}}}],UR=[{test:[/Roku\/DVP/],describe(e){const t=nt.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:ns.Roku,version:t}}},{test:[/windows phone/i],describe(e){const t=nt.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:ns.WindowsPhone,version:t}}},{test:[/windows /i],describe(e){const t=nt.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),r=nt.getWindowsVersionName(t);return{name:ns.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(e){const t={name:ns.iOS},r=nt.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return r&&(t.version=r),t}},{test:[/macintosh/i],describe(e){const t=nt.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),r=nt.getMacOSVersionName(t),n={name:ns.MacOS,version:t};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe(e){const t=nt.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:ns.iOS,version:t}}},{test(e){const t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe(e){const t=nt.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),r=nt.getAndroidVersionName(t),n={name:ns.Android,version:t};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe(e){const t=nt.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),r={name:ns.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(e){const t=nt.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||nt.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||nt.getFirstMatch(/\bbb(\d+)/i,e);return{name:ns.BlackBerry,version:t}}},{test:[/bada/i],describe(e){const t=nt.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:ns.Bada,version:t}}},{test:[/tizen/i],describe(e){const t=nt.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:ns.Tizen,version:t}}},{test:[/linux/i],describe(){return{name:ns.Linux}}},{test:[/CrOS/],describe(){return{name:ns.ChromeOS}}},{test:[/PlayStation 4/],describe(e){const t=nt.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:ns.PlayStation4,version:t}}}],jR=[{test:[/googlebot/i],describe(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe(e){const t=nt.getFirstMatch(/(can-l01)/i,e)&&"Nova",r={type:xi.mobile,vendor:"Huawei"};return t&&(r.model=t),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe(){return{type:xi.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe(){return{type:xi.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(){return{type:xi.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe(){return{type:xi.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe(){return{type:xi.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe(){return{type:xi.tablet}}},{test(e){const t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe(e){const t=nt.getFirstMatch(/(ipod|iphone)/i,e);return{type:xi.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe(){return{type:xi.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe(){return{type:xi.mobile}}},{test(e){return e.getBrowserName(!0)==="blackberry"},describe(){return{type:xi.mobile,vendor:"BlackBerry"}}},{test(e){return e.getBrowserName(!0)==="bada"},describe(){return{type:xi.mobile}}},{test(e){return e.getBrowserName()==="windows phone"},describe(){return{type:xi.mobile,vendor:"Microsoft"}}},{test(e){const t=Number(String(e.getOSVersion()).split(".")[0]);return e.getOSName(!0)==="android"&&t>=3},describe(){return{type:xi.tablet}}},{test(e){return e.getOSName(!0)==="android"},describe(){return{type:xi.mobile}}},{test(e){return e.getOSName(!0)==="macos"},describe(){return{type:xi.desktop,vendor:"Apple"}}},{test(e){return e.getOSName(!0)==="windows"},describe(){return{type:xi.desktop}}},{test(e){return e.getOSName(!0)==="linux"},describe(){return{type:xi.desktop}}},{test(e){return e.getOSName(!0)==="playstation 4"},describe(){return{type:xi.tv}}},{test(e){return e.getOSName(!0)==="roku"},describe(){return{type:xi.tv}}}],$R=[{test(e){return e.getBrowserName(!0)==="microsoft edge"},describe(e){if(/\sedg\//i.test(e))return{name:yu.Blink};const r=nt.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:yu.EdgeHTML,version:r}}},{test:[/trident/i],describe(e){const t={name:yu.Trident},r=nt.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test(e){return e.test(/presto/i)},describe(e){const t={name:yu.Presto},r=nt.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test(e){const t=e.test(/gecko/i),r=e.test(/like gecko/i);return t&&!r},describe(e){const t={name:yu.Gecko},r=nt.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(apple)?webkit\/537\.36/i],describe(){return{name:yu.Blink}}},{test:[/(apple)?webkit/i],describe(e){const t={name:yu.WebKit},r=nt.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}}];class $w{constructor(t,r=!1){if(t==null||t==="")throw new Error("UserAgent parameter can't be empty");this._ua=t,this.parsedResult={},r!==!0&&this.parse()}getUA(){return this._ua}test(t){return t.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const t=nt.find(BR,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(n=>this.test(n));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(t){return t?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const t=nt.find(UR,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(n=>this.test(n));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os}getOSName(t){const{name:r}=this.getOS();return t?String(r).toLowerCase()||"":r||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(t=!1){const{type:r}=this.getPlatform();return t?String(r).toLowerCase()||"":r||""}parsePlatform(){this.parsedResult.platform={};const t=nt.find(jR,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(n=>this.test(n));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(t){return t?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const t=nt.find($R,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(n=>this.test(n));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return nt.assign({},this.parsedResult)}satisfies(t){const r={};let n=0;const a={};let l=0;if(Object.keys(t).forEach(u=>{const E=t[u];typeof E=="string"?(a[u]=E,l+=1):typeof E=="object"&&(r[u]=E,n+=1)}),n>0){const u=Object.keys(r),E=nt.find(u,S=>this.isOS(S));if(E){const S=this.satisfies(r[E]);if(S!==void 0)return S}const m=nt.find(u,S=>this.isPlatform(S));if(m){const S=this.satisfies(r[m]);if(S!==void 0)return S}}if(l>0){const u=Object.keys(a),E=nt.find(u,m=>this.isBrowser(m,!0));if(E!==void 0)return this.compareVersion(a[E])}}isBrowser(t,r=!1){const n=this.getBrowserName().toLowerCase();let a=t.toLowerCase();const l=nt.getBrowserTypeByAlias(a);return r&&l&&(a=l.toLowerCase()),a===n}compareVersion(t){let r=[0],n=t,a=!1;const l=this.getBrowserVersion();if(typeof l=="string")return t[0]===">"||t[0]==="<"?(n=t.substr(1),t[1]==="="?(a=!0,n=t.substr(2)):r=[],t[0]===">"?r.push(1):r.push(-1)):t[0]==="="?n=t.substr(1):t[0]==="~"&&(a=!0,n=t.substr(1)),r.indexOf(nt.compareVersions(l,n,a))>-1}isOS(t){return this.getOSName(!0)===String(t).toLowerCase()}isPlatform(t){return this.getPlatformType(!0)===String(t).toLowerCase()}isEngine(t){return this.getEngineName(!0)===String(t).toLowerCase()}is(t,r=!1){return this.isBrowser(t,r)||this.isOS(t)||this.isPlatform(t)}some(t=[]){return t.some(r=>this.is(r))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class DT{static getParser(t,r=!1){if(typeof t!="string")throw new Error("UserAgent should be a string");return new $w(t,r)}static parse(t){return new $w(t).getResult()}static get BROWSER_MAP(){return OT}static get ENGINE_MAP(){return yu}static get OS_MAP(){return ns}static get PLATFORMS_MAP(){return xi}}var VR=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})},GR=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},xu=new El("CognitoCredentials"),qR=new Promise(function(e,t){if(!Eg().isBrowser)return xu.debug("not in the browser, directly resolved"),e();var r=window.gapi&&window.gapi.auth2?window.gapi.auth2:null;if(r)return xu.debug("google api already loaded"),e();setTimeout(function(){return e()},2e3)}),HR=function(){function e(){this.initialized=!1,this.refreshGoogleToken=this.refreshGoogleToken.bind(this),this._refreshGoogleTokenImpl=this._refreshGoogleTokenImpl.bind(this)}return e.prototype.refreshGoogleToken=function(){return VR(this,void 0,void 0,function(){return GR(this,function(t){switch(t.label){case 0:return this.initialized?[3,2]:(xu.debug("need to wait for the Google SDK loaded"),[4,qR]);case 1:t.sent(),this.initialized=!0,xu.debug("finish waiting"),t.label=2;case 2:return[2,this._refreshGoogleTokenImpl()]}})})},e.prototype._refreshGoogleTokenImpl=function(){var t=null;return Eg().isBrowser&&(t=window.gapi&&window.gapi.auth2?window.gapi.auth2:null),t?new Promise(function(r,n){t.getAuthInstance().then(function(a){a||(xu.debug("google Auth undefined"),n(new Ec("google Auth undefined")));var l=a.currentUser.get();l.isSignedIn()?(xu.debug("refreshing the google access token"),l.reloadAuthResponse().then(function(f){var u=f.id_token,E=f.expires_at;r({token:u,expires_at:E})}).catch(function(f){f&&f.error==="network_error"?n("Network error reloading google auth response"):n(new Ec("Failed to reload google auth response"))})):n(new Ec("User is not signed in with Google"))}).catch(function(a){xu.debug("Failed to refresh google token",a),n(new Ec("Failed to refresh google token"))})}):(xu.debug("no gapi auth2 available"),Promise.reject("no gapi auth2 available"))},e}(),ZR=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})},WR=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},_c=new El("CognitoCredentials"),KR=new Promise(function(e,t){if(!Eg().isBrowser)return _c.debug("not in the browser, directly resolved"),e();var r=window.FB;if(r)return _c.debug("FB SDK already loaded"),e();setTimeout(function(){return e()},2e3)}),XR=function(){function e(){this.initialized=!1,this.refreshFacebookToken=this.refreshFacebookToken.bind(this),this._refreshFacebookTokenImpl=this._refreshFacebookTokenImpl.bind(this)}return e.prototype.refreshFacebookToken=function(){return ZR(this,void 0,void 0,function(){return WR(this,function(t){switch(t.label){case 0:return this.initialized?[3,2]:(_c.debug("need to wait for the Facebook SDK loaded"),[4,KR]);case 1:t.sent(),this.initialized=!0,_c.debug("finish waiting"),t.label=2;case 2:return[2,this._refreshFacebookTokenImpl()]}})})},e.prototype._refreshFacebookTokenImpl=function(){var t=null;if(Eg().isBrowser&&(t=window.FB),!t){var r="no fb sdk available";return _c.debug(r),Promise.reject(new Ec(r))}return new Promise(function(n,a){t.getLoginStatus(function(l){if(!l||!l.authResponse){var f="no response from facebook when refreshing the jwt token";_c.debug(f),a(new Ec(f))}else{var u=l.authResponse,E=u.accessToken,m=u.expiresIn,S=new Date,M=m*1e3+S.getTime();if(!E){var f="the jwtToken is undefined";_c.debug(f),a(new Ec(f))}n({token:E,expires_at:M})}},{scope:"public_profile,email"})})},e}(),JR=new HR,YR=new XR,pc={},QR=function(){function e(){}return e.setItem=function(t,r){return pc[t]=r,pc[t]},e.getItem=function(t){return Object.prototype.hasOwnProperty.call(pc,t)?pc[t]:void 0},e.removeItem=function(t){return delete pc[t]},e.clear=function(){return pc={},pc},e}(),eO=function(){function e(){try{this.storageWindow=window.localStorage,this.storageWindow.setItem("aws.amplify.test-ls",1),this.storageWindow.removeItem("aws.amplify.test-ls")}catch{this.storageWindow=QR}}return e.prototype.getStorage=function(){return this.storageWindow},e}(),zT={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-{}"]},tO={partitions:[zT,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-{}"]}]},rO=globalThis&&globalThis.__values||function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},nO=function(e){var t,r,n=tO.partitions;try{for(var a=rO(n),l=a.next();!l.done;l=a.next()){var f=l.value,u=f.regions,E=f.outputs,m=f.regionRegex,S=new RegExp(m);if(u.includes(e)||S.test(e))return E.dnsSuffix}}catch(M){t={error:M}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return zT.outputs.dnsSuffix};function iO(e,t){return t=t||{},new Promise(function(r,n){var a=new XMLHttpRequest,l=[],f=[],u={},E=function(){return{ok:(a.status/100|0)==2,statusText:a.statusText,status:a.status,url:a.responseURL,text:function(){return Promise.resolve(a.responseText)},json:function(){return Promise.resolve(a.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([a.response]))},clone:E,headers:{keys:function(){return l},entries:function(){return f},get:function(S){return u[S.toLowerCase()]},has:function(S){return S.toLowerCase()in u}}}};for(var m in a.open(t.method||"get",e,!0),a.onload=function(){a.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(S,M,z){l.push(M=M.toLowerCase()),f.push([M,z]),u[M]=u[M]?u[M]+","+z:z}),r(E())},a.onerror=n,a.withCredentials=t.credentials=="include",t.headers)a.setRequestHeader(m,t.headers[m]);a.send(t.body||null)})}const oO=Object.freeze(Object.defineProperty({__proto__:null,default:iO},Symbol.toStringTag,{value:"Module"})),Vw=na(oO);self.fetch||(self.fetch=Vw.default||Vw);var yv=function(e){var t;return function(){return t||(t=e()),t}},Bm=globalThis&&globalThis.__assign||function(){return Bm=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Bm.apply(this,arguments)},sO=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})},aO=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},lO=function(e){return!["HEAD","GET","DELETE"].includes(e.toUpperCase())},uO=function(e,t){var r=e.url,n=e.method,a=e.headers,l=e.body,f=t.abortSignal;return sO(void 0,void 0,void 0,function(){var u,E,m,S,M,z,H;return aO(this,function(q){switch(q.label){case 0:return q.trys.push([0,2,,3]),[4,fetch(r,{method:n,headers:a,body:lO(n)?l:void 0,signal:f})];case 1:return u=q.sent(),[3,3];case 2:throw E=q.sent(),E instanceof TypeError?new Error("Network error"):E;case 3:return m={},(z=u.headers)===null||z===void 0||z.forEach(function(Y,ye){m[ye.toLowerCase()]=Y}),S={statusCode:u.status,headers:m,body:null},M=Object.assign((H=u.body)!==null&&H!==void 0?H:{},{text:yv(function(){return u.text()}),blob:yv(function(){return u.blob()}),json:yv(function(){return u.json()})}),[2,Bm(Bm({},S),{body:M})]}})})},Um=globalThis&&globalThis.__assign||function(){return Um=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Um.apply(this,arguments)},cO=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})},hO=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},dO=3,fO=function(e){var t=e.maxAttempts,r=t===void 0?dO:t,n=e.retryDecider,a=e.computeDelay,l=e.abortSignal;if(r<1)throw new Error("maxAttempts must be greater than 0");return function(f,u){return function(m){var S;return cO(this,void 0,void 0,function(){var M,z,H,q,Y,ye;return hO(this,function(Q){switch(Q.label){case 0:z=(S=u.attemptsCount)!==null&&S!==void 0?S:0,q=function(){if(H)return Gw(H,z),H;throw Gw(M,z),M},Q.label=1;case 1:if(!(!(l!=null&&l.aborted)&&z<r))return[3,11];Q.label=2;case 2:return Q.trys.push([2,4,,5]),[4,f(m)];case 3:return H=Q.sent(),M=void 0,[3,5];case 4:return Y=Q.sent(),M=Y,H=void 0,[3,5];case 5:return z=u.attemptsCount>z?u.attemptsCount:z+1,u.attemptsCount=z,[4,n(H,M)];case 6:return Q.sent()?!(l!=null&&l.aborted)&&z<r?(ye=a(z),[4,pO(ye,l)]):[3,8]:[3,9];case 7:Q.sent(),Q.label=8;case 8:return[3,1];case 9:return[2,q()];case 10:return[3,1];case 11:if(l!=null&&l.aborted)throw new Error("Request aborted.");return[2,q()]}})})}}},pO=function(e,t){if(t!=null&&t.aborted)return Promise.resolve();var r,n,a=new Promise(function(l){n=l,r=setTimeout(l,e)});return t==null||t.addEventListener("abort",function l(f){clearTimeout(r),t==null||t.removeEventListener("abort",l),n()}),a},Gw=function(e,t){var r;Object.prototype.toString.call(e)==="[object Object]"&&(e.$metadata=Um(Um({},(r=e.$metadata)!==null&&r!==void 0?r:{}),{attempts:t}))},qw=5*60*1e3,mO=function(e){var t=xT(qw),r=t(e);return r===!1?qw:r},gO=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],yO=function(e){return gO.includes(e)},vO=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})},_O=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},xO=function(e){return function(t,r){return vO(void 0,void 0,void 0,function(){var n,a,l,f;return _O(this,function(u){switch(u.label){case 0:return r==null?[3,1]:(a=r,[3,3]);case 1:return[4,e(t)];case 2:a=u.sent(),u.label=3;case 3:return n=((f=a)!==null&&f!==void 0?f:{}).name,l=t==null?void 0:t.statusCode,[2,SO(r)||EO(l,n)||yO(n)||TO(l,n)]}})})}},bO=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],wO=["TimeoutError","RequestTimeout","RequestTimeoutException"],EO=function(e,t){return e===429||bO.includes(t)},SO=function(e){return(e==null?void 0:e.name)==="Network error"},TO=function(e,t){return[500,502,503,504].includes(e)||wO.includes(t)},CO=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})},IO=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},PO=function(e){var t=e.userAgentHeader,r=t===void 0?"x-amz-user-agent":t,n=e.userAgentValue,a=n===void 0?"":n;return function(l){return function(u){return CO(this,void 0,void 0,function(){var E,m,S;return IO(this,function(M){switch(M.label){case 0:return a.trim().length!==0?[3,2]:[4,l(u)];case 1:return E=M.sent(),[2,E];case 2:return m=r.toLowerCase(),u.headers[m]=u.headers[m]?"".concat(u.headers[m]," ").concat(a):a,[4,l(u)];case 3:return S=M.sent(),[2,S]}})})}}},FT=function(e,t){return function(r,n){for(var a={},l=function(m){return e(m,n)},f=t.length-1;f>=0;f--){var u=t[f],E=u(n);l=E(l,a)}return l(r)}},AO=FT(uO,[PO,fO]),jm=globalThis&&globalThis.__assign||function(){return jm=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},jm.apply(this,arguments)},Mg=function(e){var t,r,n=e.headers,a=e.statusCode;return jm(jm({},MO(e)?e.$metadata:{}),{httpStatusCode:a,requestId:(r=(t=n["x-amzn-requestid"])!==null&&t!==void 0?t:n["x-amzn-request-id"])!==null&&r!==void 0?r:n["x-amz-request-id"],extendedRequestId:n["x-amz-id-2"],cfId:n["x-amz-cf-id"]})},MO=function(e){return typeof(e==null?void 0:e.$metadata)=="object"},NT=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})},BT=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},kO=globalThis&&globalThis.__read||function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l},sx=function(e){return NT(void 0,void 0,void 0,function(){var t,r,n,a,l,f,u,E,m,S;return BT(this,function(M){switch(M.label){case 0:return!e||e.statusCode<300?[2]:[4,ax(e)];case 1:return t=M.sent(),r=function(z){var H=kO(z.toString().split(/[\,\:]+/),1),q=H[0];return q.includes("#")?q.split("#")[1]:q},n=r((E=(u=(f=e.headers["x-amzn-errortype"])!==null&&f!==void 0?f:t.code)!==null&&u!==void 0?u:t.__type)!==null&&E!==void 0?E:"UnknownError"),a=(S=(m=t.message)!==null&&m!==void 0?m:t.Message)!==null&&S!==void 0?S:"Unknown error",l=new Error(a),[2,Object.assign(l,{name:n,$metadata:Mg(e)})]}})})},ax=function(e){return NT(void 0,void 0,void 0,function(){var t;return BT(this,function(r){switch(r.label){case 0:if(!e.body)throw new Error("Missing response payload");return[4,e.body.json()];case 1:return t=r.sent(),[2,Object.assign(t,{$metadata:Mg(e)})]}})})},LO=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})},RO=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},OO="cognito-identity",DO=function(e){var t=e.region;return{url:new URL("https://cognito-identity.".concat(t,".").concat(nO(t)))}},zO=function(){return function(e,t){return function(n){return LO(this,void 0,void 0,function(){return RO(this,function(a){return n.headers["cache-control"]="no-store",[2,e(n)]})})}}},UT=FT(AO,[zO]),lx={service:OO,endpointResolver:DO,retryDecider:xO(sx),computeDelay:mO,userAgentValue:rx()};gT(function(){lx.userAgentValue=rx()});var jT=function(e){return{"content-type":"application/x-amz-json-1.1","x-amz-target":"AWSCognitoIdentityService.".concat(e)}},$T=function(e,t,r){var n=e.url;return{headers:t,url:n,body:r,method:"POST"}},rf=globalThis&&globalThis.__assign||function(){return rf=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},rf.apply(this,arguments)},FO=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})},NO=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},VT=function(e,t,r,n){return function(a,l){return FO(void 0,void 0,void 0,function(){var f,u,E,m;return NO(this,function(S){switch(S.label){case 0:return f=rf(rf({},n),a),[4,f.endpointResolver(f,l)];case 1:return u=S.sent(),[4,t(l,u)];case 2:return E=S.sent(),[4,e(E,rf({},f))];case 3:return m=S.sent(),[4,r(m)];case 4:return[2,S.sent()]}})})}},BO=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})},UO=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},jO=function(e,t){var r=jT("GetId"),n=JSON.stringify(e);return $T(t,r,n)},$O=function(e){return BO(void 0,void 0,void 0,function(){var t,r;return UO(this,function(n){switch(n.label){case 0:return e.statusCode>=300?[4,sx(e)]:[3,2];case 1:throw t=n.sent(),t;case 2:return[4,ax(e)];case 3:return r=n.sent(),[2,{IdentityId:r.IdentityId,$metadata:Mg(e)}]}})})},Dp=VT(UT,jO,$O,lx),VO=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})},GO=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},qO=function(e,t){var r=jT("GetCredentialsForIdentity"),n=JSON.stringify(e);return $T(t,r,n)},HO=function(e){return VO(void 0,void 0,void 0,function(){var t,r;return GO(this,function(n){switch(n.label){case 0:return e.statusCode>=300?[4,sx(e)]:[3,2];case 1:throw t=n.sent(),t;case 2:return[4,ax(e)];case 3:return r=n.sent(),[2,{IdentityId:r.IdentityId,Credentials:ZO(r.Credentials),$metadata:Mg(e)}]}})})},ZO=function(e){return e===void 0&&(e={}),{AccessKeyId:e.AccessKeyId,SecretKey:e.SecretKey,SessionToken:e.SessionToken,Expiration:new Date(e.Expiration*1e3)}},zp=VT(UT,qO,HO,lx),$m=globalThis&&globalThis.__assign||function(){return $m=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},$m.apply(this,arguments)},Oo=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})},Do=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},Dr=new El("Credentials"),WO=50*60*1e3,KO="CognitoIdentityId-",XO=typeof Symbol<"u"&&typeof Symbol.for=="function"?Symbol.for("amplify_default"):"@@amplify_default",JO=function(e,t,r){vT.dispatch("core",{event:e,data:t,message:r},"Credentials",XO)},YO=function(){function e(t){this._gettingCredPromise=null,this._refreshHandlers={},this.Auth=void 0,this.configure(t),this._refreshHandlers.google=JR.refreshGoogleToken,this._refreshHandlers.facebook=YR.refreshFacebookToken}return e.prototype.getModuleName=function(){return"Credentials"},e.prototype.getCredSource=function(){return this._credentials_source},e.prototype.configure=function(t){if(!t)return this._config||{};this._config=Object.assign({},this._config,t);var r=this._config.refreshHandlers;return r&&(this._refreshHandlers=$m($m({},this._refreshHandlers),r)),this._storage=this._config.storage,this._storage||(this._storage=new eO().getStorage()),this._storageSync=Promise.resolve(),typeof this._storage.sync=="function"&&(this._storageSync=this._storage.sync()),JO("credentials_configured",null,"Credentials has been configured successfully"),this._config},e.prototype.get=function(){return Dr.debug("getting credentials"),this._pickupCredentials()},e.prototype._getCognitoIdentityIdStorageKey=function(t){return"".concat(KO).concat(t)},e.prototype._pickupCredentials=function(){return Dr.debug("picking up credentials"),!this._gettingCredPromise||!this._gettingCredPromise.isPending()?(Dr.debug("getting new cred promise"),this._gettingCredPromise=fL(this._keepAlive())):Dr.debug("getting old cred promise"),this._gettingCredPromise},e.prototype._keepAlive=function(){return Oo(this,void 0,void 0,function(){var t,r,n,a,l,f,u,E;return Do(this,function(m){switch(m.label){case 0:if(Dr.debug("checking if credentials exists and not expired"),t=this._credentials,t&&!this._isExpired(t)&&!this._isPastTTL())return Dr.debug("credentials not changed and not expired, directly return"),[2,Promise.resolve(t)];if(Dr.debug("need to get a new credential or refresh the existing one"),r=this.Auth,n=r===void 0?bg.Auth:r,!n||typeof n.currentUserCredentials!="function")return[2,this._setCredentialsForGuest()];if(!(!this._isExpired(t)&&this._isPastTTL()))return[3,6];Dr.debug("ttl has passed but token is not yet expired"),m.label=1;case 1:return m.trys.push([1,5,,6]),[4,n.currentUserPoolUser()];case 2:return a=m.sent(),[4,n.currentSession()];case 3:return l=m.sent(),f=l.refreshToken,u=new Promise(function(S,M){a.refreshSession(f,function(z,H){return z?M(z):S(H)})}),[4,u];case 4:return m.sent(),[3,6];case 5:return E=m.sent(),Dr.debug("Error attempting to refreshing the session",E),[3,6];case 6:return[2,n.currentUserCredentials()]}})})},e.prototype.refreshFederatedToken=function(t){Dr.debug("Getting federated credentials");var r=t.provider,n=t.user,a=t.token,l=t.identity_id,f=t.expires_at;f=new Date(f).getFullYear()===1970?f*1e3:f;var u=this;return Dr.debug("checking if federated jwt token expired"),f>new Date().getTime()?(Dr.debug("token not expired"),this._setCredentialsFromFederation({provider:r,token:a,user:n,identity_id:l,expires_at:f})):u._refreshHandlers[r]&&typeof u._refreshHandlers[r]=="function"?(Dr.debug("getting refreshed jwt token from federation provider"),this._providerRefreshWithRetry({refreshHandler:u._refreshHandlers[r],provider:r,user:n})):(Dr.debug("no refresh handler for provider:",r),this.clear(),Promise.reject("no refresh handler for provider"))},e.prototype._providerRefreshWithRetry=function(t){var r=this,n=t.refreshHandler,a=t.provider,l=t.user,f=10*1e3;return bT(n,[],f).then(function(u){return Dr.debug("refresh federated token sucessfully",u),r._setCredentialsFromFederation({provider:a,token:u.token,user:l,identity_id:u.identity_id,expires_at:u.expires_at})}).catch(function(u){var E=typeof u=="string"&&u.toLowerCase().lastIndexOf("network error",u.length)===0;return E||r.clear(),Dr.debug("refresh federated token failed",u),Promise.reject("refreshing federation token failed: "+u)})},e.prototype._isExpired=function(t){if(!t)return Dr.debug("no credentials for expiration check"),!0;Dr.debug("are these credentials expired?",t);var r=Date.now(),n=t.expiration;return n.getTime()<=r},e.prototype._isPastTTL=function(){return this._nextCredentialsRefresh<=Date.now()},e.prototype._setCredentialsForGuest=function(){var t;return Oo(this,void 0,void 0,function(){var r,n,a,l,f,u,E,m,S,M,z=this;return Do(this,function(H){switch(H.label){case 0:return Dr.debug("setting credentials for guest"),!((t=this._config)===null||t===void 0)&&t.identityPoolId||(this._config=Object.assign({},this._config,RT(this._config||{}).Auth)),r=this._config,n=r.identityPoolId,a=r.region,l=r.mandatorySignIn,f=r.identityPoolRegion,l?[2,Promise.reject("cannot get guest credentials when mandatory signin enabled")]:n?!f&&!a?(Dr.debug("region is not configured for getting the credentials"),[2,Promise.reject("region is not configured for getting the credentials")]):(E=this,[4,this._getGuestIdentityId()]):(Dr.debug("No Cognito Identity pool provided for unauthenticated access"),[2,Promise.reject("No Cognito Identity pool provided for unauthenticated access")]);case 1:return u=E._identityId=H.sent(),m={region:f??a},S=function(){return Oo(z,void 0,void 0,function(){var q,Y;return Do(this,function(ye){switch(ye.label){case 0:return u?[3,2]:[4,Dp(m,{IdentityPoolId:n})];case 1:q=ye.sent().IdentityId,this._identityId=q,ye.label=2;case 2:return[4,zp(m,{IdentityId:this._identityId})];case 3:return Y=ye.sent().Credentials,[2,{identityId:this._identityId,accessKeyId:Y.AccessKeyId,secretAccessKey:Y.SecretKey,sessionToken:Y.SessionToken,expiration:Y.Expiration}]}})})},M=S().catch(function(q){return Oo(z,void 0,void 0,function(){return Do(this,function(Y){throw q})})}),[2,this._loadCredentials(M,"guest",!1,null).then(function(q){return q}).catch(function(q){return Oo(z,void 0,void 0,function(){var Y,ye=this;return Do(this,function(Q){switch(Q.label){case 0:return q.name==="ResourceNotFoundException"&&q.message==="Identity '".concat(u,"' not found.")?(Dr.debug("Failed to load guest credentials"),[4,this._removeGuestIdentityId()]):[3,2];case 1:return Q.sent(),Y=function(){return Oo(ye,void 0,void 0,function(){var te,ne;return Do(this,function(Me){switch(Me.label){case 0:return[4,Dp(m,{IdentityPoolId:n})];case 1:return te=Me.sent().IdentityId,this._identityId=te,[4,zp(m,{IdentityId:te})];case 2:return ne=Me.sent().Credentials,[2,{identityId:te,accessKeyId:ne.AccessKeyId,secretAccessKey:ne.SecretKey,sessionToken:ne.SessionToken,expiration:ne.Expiration}]}})})},M=Y().catch(function(te){return Oo(ye,void 0,void 0,function(){return Do(this,function(ne){throw te})})}),[2,this._loadCredentials(M,"guest",!1,null)];case 2:return[2,q]}})})})]}})})},e.prototype._setCredentialsFromFederation=function(t){var r=this,n=t.provider,a=t.token,l=t.identity_id,f={google:"accounts.google.com",facebook:"graph.facebook.com",amazon:"www.amazon.com",developer:"cognito-identity.amazonaws.com"},u=f[n]||n;if(!u)return Promise.reject("You must specify a federated provider");var E={};E[u]=a;var m=this._config,S=m.identityPoolId,M=m.region,z=m.identityPoolRegion;if(!S)return Dr.debug("No Cognito Federated Identity pool provided"),Promise.reject("No Cognito Federated Identity pool provided");if(!z&&!M)return Dr.debug("region is not configured for getting the credentials"),Promise.reject("region is not configured for getting the credentials");var H={region:z??M},q=function(){return Oo(r,void 0,void 0,function(){var ye,Q;return Do(this,function(te){switch(te.label){case 0:return l?[3,2]:[4,Dp(H,{IdentityPoolId:S,Logins:E})];case 1:ye=te.sent().IdentityId,l=ye,te.label=2;case 2:return[4,zp(H,{IdentityId:l,Logins:E})];case 3:return Q=te.sent().Credentials,[2,{identityId:l,accessKeyId:Q.AccessKeyId,secretAccessKey:Q.SecretKey,sessionToken:Q.SessionToken,expiration:Q.Expiration}]}})})},Y=q().catch(function(ye){return Oo(r,void 0,void 0,function(){return Do(this,function(Q){throw ye})})});return this._loadCredentials(Y,"federated",!0,t)},e.prototype._setCredentialsFromSession=function(t){var r=this;Dr.debug("set credentials from session");var n=t.getIdToken().getJwtToken(),a=this._config,l=a.region,f=a.userPoolId,u=a.identityPoolId,E=a.identityPoolRegion;if(!u)return Dr.debug("No Cognito Federated Identity pool provided"),Promise.reject("No Cognito Federated Identity pool provided");if(!E&&!l)return Dr.debug("region is not configured for getting the credentials"),Promise.reject("region is not configured for getting the credentials");var m="cognito-idp."+l+".amazonaws.com/"+f,S={};S[m]=n;var M={region:E??l},z=function(){return Oo(r,void 0,void 0,function(){var q,Y,ye,Q,te,ne,Me,Ve,je,Qe;return Do(this,function(ot){switch(ot.label){case 0:return[4,this._getGuestIdentityId()];case 1:return q=ot.sent(),q?[3,3]:[4,Dp(M,{IdentityPoolId:u,Logins:S})];case 2:ye=ot.sent().IdentityId,Y=ye,ot.label=3;case 3:return[4,zp(M,{IdentityId:q||Y,Logins:S})];case 4:return Q=ot.sent(),te=Q.Credentials,ne=te.AccessKeyId,Me=te.Expiration,Ve=te.SecretKey,je=te.SessionToken,Qe=Q.IdentityId,this._identityId=Qe,q?(Dr.debug("The guest identity ".concat(q," has been successfully linked to the logins")),q===Qe&&Dr.debug("The guest identity ".concat(q," has become the primary identity")),[4,this._removeGuestIdentityId()]):[3,6];case 5:ot.sent(),ot.label=6;case 6:return[2,{accessKeyId:ne,secretAccessKey:Ve,sessionToken:je,expiration:Me,identityId:Qe}]}})})},H=z().catch(function(q){return Oo(r,void 0,void 0,function(){return Do(this,function(Y){throw q})})});return this._loadCredentials(H,"userPool",!0,null)},e.prototype._loadCredentials=function(t,r,n,a){var l=this,f=this;return new Promise(function(u,E){t.then(function(m){return Oo(l,void 0,void 0,function(){var S,M,z,H,q;return Do(this,function(Y){switch(Y.label){case 0:if(Dr.debug("Load credentials successfully",m),this._identityId&&!m.identityId&&(m.identityId=this._identityId),f._credentials=m,f._credentials.authenticated=n,f._credentials_source=r,f._nextCredentialsRefresh=new Date().getTime()+WO,r==="federated"){S=Object.assign({id:this._credentials.identityId},a.user),M=a.provider,z=a.token,H=a.expires_at,q=a.identity_id;try{this._storage.setItem("aws-amplify-federatedInfo",JSON.stringify({provider:M,token:z,user:S,expires_at:H,identity_id:q}))}catch(ye){Dr.debug("Failed to put federated info into auth storage",ye)}}return r!=="guest"?[3,2]:[4,this._setGuestIdentityId(m.identityId)];case 1:Y.sent(),Y.label=2;case 2:return u(f._credentials),[2]}})})}).catch(function(m){if(m){Dr.debug("Failed to load credentials",t),Dr.debug("Error loading credentials",m),E(m);return}})})},e.prototype.set=function(t,r){return r==="session"?this._setCredentialsFromSession(t):r==="federation"?this._setCredentialsFromFederation(t):r==="guest"?this._setCredentialsForGuest():(Dr.debug("no source specified for setting credentials"),Promise.reject("invalid source"))},e.prototype.clear=function(){return Oo(this,void 0,void 0,function(){return Do(this,function(t){return this._credentials=null,this._credentials_source=null,Dr.debug("removing aws-amplify-federatedInfo from storage"),this._storage.removeItem("aws-amplify-federatedInfo"),[2]})})},e.prototype._getGuestIdentityId=function(){return Oo(this,void 0,void 0,function(){var t,r;return Do(this,function(n){switch(n.label){case 0:t=this._config.identityPoolId,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this._storageSync];case 2:return n.sent(),[2,this._storage.getItem(this._getCognitoIdentityIdStorageKey(t))];case 3:return r=n.sent(),Dr.debug("Failed to get the cached guest identityId",r),[3,4];case 4:return[2]}})})},e.prototype._setGuestIdentityId=function(t){return Oo(this,void 0,void 0,function(){var r,n;return Do(this,function(a){switch(a.label){case 0:r=this._config.identityPoolId,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._storageSync];case 2:return a.sent(),this._storage.setItem(this._getCognitoIdentityIdStorageKey(r),t),[3,4];case 3:return n=a.sent(),Dr.debug("Failed to cache guest identityId",n),[3,4];case 4:return[2]}})})},e.prototype._removeGuestIdentityId=function(){return Oo(this,void 0,void 0,function(){var t;return Do(this,function(r){return t=this._config.identityPoolId,Dr.debug("removing ".concat(this._getCognitoIdentityIdStorageKey(t)," from storage")),this._storage.removeItem(this._getCognitoIdentityIdStorageKey(t)),[2]})})},e.prototype.shear=function(t){return{accessKeyId:t.accessKeyId,sessionToken:t.sessionToken,secretAccessKey:t.secretAccessKey,identityId:t.identityId,authenticated:t.authenticated}},e}(),Cf=new YO(null);bg.register(Cf);var ux={exports:{}};const GT=e=>typeof e=="object"&&e!==null,qT=Symbol("skip"),Hw=e=>GT(e)&&!(e instanceof RegExp)&&!(e instanceof Error)&&!(e instanceof Date),z_=(e,t,r,n=new WeakMap)=>{if(r={deep:!1,target:{},...r},n.has(e))return n.get(e);n.set(e,r.target);const{target:a}=r;delete r.target;const l=f=>f.map(u=>Hw(u)?z_(u,t,r,n):u);if(Array.isArray(e))return l(e);for(const[f,u]of Object.entries(e)){const E=t(f,u,e);if(E===qT)continue;let[m,S,{shouldRecurse:M=!0}={}]=E;m!=="__proto__"&&(r.deep&&M&&Hw(S)&&(S=Array.isArray(S)?l(S):z_(S,t,r,n)),a[m]=S)}return a};ux.exports=(e,t,r)=>{if(!GT(e))throw new TypeError(`Expected an object, got \`${e}\` (${typeof e})`);return z_(e,t,r)};ux.exports.mapObjectSkip=qT;var QO=ux.exports,cx={exports:{}};const e3=e=>{let t=!1,r=!1,n=!1;for(let a=0;a<e.length;a++){const l=e[a];t&&/[a-zA-Z]/.test(l)&&l.toUpperCase()===l?(e=e.slice(0,a)+"-"+e.slice(a),t=!1,n=r,r=!0,a++):r&&n&&/[a-zA-Z]/.test(l)&&l.toLowerCase()===l?(e=e.slice(0,a-1)+"-"+e.slice(a-1),n=r,r=!1,t=!0):(t=l.toLowerCase()===l&&l.toUpperCase()!==l,n=r,r=l.toUpperCase()===l&&l.toLowerCase()!==l)}return e},HT=(e,t)=>{if(!(typeof e=="string"||Array.isArray(e)))throw new TypeError("Expected the input to be `string | string[]`");t=Object.assign({pascalCase:!1},t);const r=a=>t.pascalCase?a.charAt(0).toUpperCase()+a.slice(1):a;return Array.isArray(e)?e=e.map(a=>a.trim()).filter(a=>a.length).join("-"):e=e.trim(),e.length===0?"":e.length===1?t.pascalCase?e.toUpperCase():e.toLowerCase():(e!==e.toLowerCase()&&(e=e3(e)),e=e.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,(a,l)=>l.toUpperCase()).replace(/\d+(\w|$)/g,a=>a.toUpperCase()),r(e))};cx.exports=HT;cx.exports.default=HT;var t3=cx.exports;class r3{constructor(t={}){if(!(t.maxSize&&t.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=t.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(t,r){this.cache.set(t,r),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}get(t){if(this.cache.has(t))return this.cache.get(t);if(this.oldCache.has(t)){const r=this.oldCache.get(t);return this.oldCache.delete(t),this._set(t,r),r}}set(t,r){return this.cache.has(t)?this.cache.set(t,r):this._set(t,r),this}has(t){return this.cache.has(t)||this.oldCache.has(t)}peek(t){if(this.cache.has(t))return this.cache.get(t);if(this.oldCache.has(t))return this.oldCache.get(t)}delete(t){const r=this.cache.delete(t);return r&&this._size--,this.oldCache.delete(t)||r}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(const[t]of this)yield t}*values(){for(const[,t]of this)yield t}*[Symbol.iterator](){for(const t of this.cache)yield t;for(const t of this.oldCache){const[r]=t;this.cache.has(r)||(yield t)}}get size(){let t=0;for(const r of this.oldCache.keys())this.cache.has(r)||t++;return this._size+t}}var n3=r3;const Zw=QO,i3=t3,o3=n3,s3=(e,t)=>e.some(r=>typeof r=="string"?r===t:(r.lastIndex=0,r.test(t))),vv=new o3({maxSize:1e5}),Ww=e=>typeof e=="object"&&e!==null&&!(e instanceof RegExp)&&!(e instanceof Error)&&!(e instanceof Date),Kw=(e,t)=>{if(!Ww(e))return e;t={deep:!1,pascalCase:!1,...t};const{exclude:r,pascalCase:n,stopPaths:a,deep:l}=t,f=new Set(a),u=E=>(m,S)=>{if(l&&Ww(S)){const M=E===void 0?m:`${E}.${m}`;f.has(M)||(S=Zw(S,u(M)))}if(!(r&&s3(r,m))){const M=n?`${m}_`:m;if(vv.has(M))m=vv.get(M);else{const z=i3(m,{pascalCase:n});m.length<100&&vv.set(M,z),m=z}}return[m,S]};return Zw(e,u(void 0))};var a3=(e,t)=>Array.isArray(e)?Object.keys(e).map(r=>Kw(e[r],t)):Kw(e,t);const _v=Lf(a3);var F_=function(e,t){return F_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},F_(e,t)};function Di(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");F_(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var De=function(){return De=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},De.apply(this,arguments)};function ZT(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Yt(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})}function Xt(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}function kg(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Bi(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l}function Pa(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return e.concat(l||Array.prototype.slice.call(t))}var l3=function(e,t){return function(r,n){return function(a){return Yt(void 0,void 0,void 0,function(){var l,f,u;return Xt(this,function(E){switch(E.label){case 0:return[4,r(a)];case 1:l=E.sent().response,E.label=2;case 2:return E.trys.push([2,4,,5]),[4,t(l,e)];case 3:return f=E.sent(),[2,{response:l,output:f}];case 4:throw u=E.sent(),Object.defineProperty(u,"$response",{value:l}),u;case 5:return[2]}})})}}},u3=function(e,t){return function(r,n){return function(a){return Yt(void 0,void 0,void 0,function(){var l,f,u;return Xt(this,function(E){switch(E.label){case 0:if(l=!((u=n.endpointV2)===null||u===void 0)&&u.url&&e.urlParser?function(){return Yt(void 0,void 0,void 0,function(){return Xt(this,function(m){return[2,e.urlParser(n.endpointV2.url)]})})}:e.endpoint,!l)throw new Error("No valid endpoint provider available.");return[4,t(a.input,De(De({},e),{endpoint:l}))];case 1:return f=E.sent(),[2,r(De(De({},a),{request:f}))]}})})}}},c3={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},h3={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function Gu(e,t,r){return{applyToStack:function(n){n.add(l3(e,r),c3),n.add(u3(e,t),h3)}}}var Vm=function(){var e=[],t=[],r=new Set,n=function(S){return S.sort(function(M,z){return Xw[z.step]-Xw[M.step]||Jw[z.priority||"normal"]-Jw[M.priority||"normal"]})},a=function(S){var M=!1,z=function(H){return H.name&&H.name===S?(M=!0,r.delete(S),!1):!0};return e=e.filter(z),t=t.filter(z),M},l=function(S){var M=!1,z=function(H){return H.middleware===S?(M=!0,H.name&&r.delete(H.name),!1):!0};return e=e.filter(z),t=t.filter(z),M},f=function(S){return e.forEach(function(M){S.add(M.middleware,De({},M))}),t.forEach(function(M){S.addRelativeTo(M.middleware,De({},M))}),S},u=function(S){var M=[];return S.before.forEach(function(z){z.before.length===0&&z.after.length===0?M.push(z):M.push.apply(M,Pa([],Bi(u(z)),!1))}),M.push(S),S.after.reverse().forEach(function(z){z.before.length===0&&z.after.length===0?M.push(z):M.push.apply(M,Pa([],Bi(u(z)),!1))}),M},E=function(S){S===void 0&&(S=!1);var M=[],z=[],H={};e.forEach(function(Y){var ye=De(De({},Y),{before:[],after:[]});ye.name&&(H[ye.name]=ye),M.push(ye)}),t.forEach(function(Y){var ye=De(De({},Y),{before:[],after:[]});ye.name&&(H[ye.name]=ye),z.push(ye)}),z.forEach(function(Y){if(Y.toMiddleware){var ye=H[Y.toMiddleware];if(ye===void 0){if(S)return;throw new Error("".concat(Y.toMiddleware," is not found when adding ").concat(Y.name||"anonymous"," middleware ").concat(Y.relation," ").concat(Y.toMiddleware))}Y.relation==="after"&&ye.after.push(Y),Y.relation==="before"&&ye.before.push(Y)}});var q=n(M).map(u).reduce(function(Y,ye){return Y.push.apply(Y,Pa([],Bi(ye),!1)),Y},[]);return q},m={add:function(S,M){M===void 0&&(M={});var z=M.name,H=M.override,q=De({step:"initialize",priority:"normal",middleware:S},M);if(z){if(r.has(z)){if(!H)throw new Error("Duplicate middleware name '".concat(z,"'"));var Y=e.findIndex(function(Q){return Q.name===z}),ye=e[Y];if(ye.step!==q.step||ye.priority!==q.priority)throw new Error('"'.concat(z,'" middleware with ').concat(ye.priority," priority in ").concat(ye.step," step cannot be ")+"overridden by same-name middleware with ".concat(q.priority," priority in ").concat(q.step," step."));e.splice(Y,1)}r.add(z)}e.push(q)},addRelativeTo:function(S,M){var z=M.name,H=M.override,q=De({middleware:S},M);if(z){if(r.has(z)){if(!H)throw new Error("Duplicate middleware name '".concat(z,"'"));var Y=t.findIndex(function(Q){return Q.name===z}),ye=t[Y];if(ye.toMiddleware!==q.toMiddleware||ye.relation!==q.relation)throw new Error('"'.concat(z,'" middleware ').concat(ye.relation,' "').concat(ye.toMiddleware,'" middleware cannot be overridden ')+"by same-name middleware ".concat(q.relation,' "').concat(q.toMiddleware,'" middleware.'));t.splice(Y,1)}r.add(z)}t.push(q)},clone:function(){return f(Vm())},use:function(S){S.applyToStack(m)},remove:function(S){return typeof S=="string"?a(S):l(S)},removeByTag:function(S){var M=!1,z=function(H){var q=H.tags,Y=H.name;return q&&q.includes(S)?(Y&&r.delete(Y),M=!0,!1):!0};return e=e.filter(z),t=t.filter(z),M},concat:function(S){var M=f(Vm());return M.use(S),M},applyToStack:f,identify:function(){return E(!0).map(function(S){return S.name+": "+(S.tags||[]).join(",")})},resolve:function(S,M){var z,H;try{for(var q=kg(E().map(function(Q){return Q.middleware}).reverse()),Y=q.next();!Y.done;Y=q.next()){var ye=Y.value;S=ye(S,M)}}catch(Q){z={error:Q}}finally{try{Y&&!Y.done&&(H=q.return)&&H.call(q)}finally{if(z)throw z.error}}return S}};return m},Xw={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},Jw={high:3,normal:2,low:1},d3=function(){function e(t){this.middlewareStack=Vm(),this.config=t}return e.prototype.send=function(t,r,n){var a=typeof r!="function"?r:void 0,l=typeof r=="function"?r:n,f=t.resolveMiddleware(this.middlewareStack,this.config,a);if(l)f(t).then(function(u){return l(null,u.output)},function(u){return l(u)}).catch(function(){});else return f(t).then(function(u){return u.output})},e.prototype.destroy=function(){this.config.requestHandler.destroy&&this.config.requestHandler.destroy()},e}(),qu=function(){function e(){this.middlewareStack=Vm()}return e}(),io="***SensitiveInformation***",f3=function(e){if(e!=null){if(typeof e=="number"){if((e===0||e===1)&&qm.warn(Gm("Expected boolean, got ".concat(typeof e,": ").concat(e))),e===0)return!1;if(e===1)return!0}if(typeof e=="string"){var t=e.toLowerCase();if((t==="false"||t==="true")&&qm.warn(Gm("Expected boolean, got ".concat(typeof e,": ").concat(e))),t==="false")return!1;if(t==="true")return!0}if(typeof e=="boolean")return e;throw new TypeError("Expected boolean, got ".concat(typeof e,": ").concat(e))}},WT=function(e){if(e!=null){if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return String(t)!==String(e)&&qm.warn(Gm("Expected number but observed string: ".concat(e))),t}if(typeof e=="number")return e;throw new TypeError("Expected number, got ".concat(typeof e,": ").concat(e))}},p3=Math.ceil(Math.pow(2,127)*(2-Math.pow(2,-23))),Yw=function(e){var t=WT(e);if(t!==void 0&&!Number.isNaN(t)&&t!==1/0&&t!==-1/0&&Math.abs(t)>p3)throw new TypeError("Expected 32-bit float, got ".concat(e));return t},m3=function(e){if(e!=null){if(Number.isInteger(e)&&!Number.isNaN(e))return e;throw new TypeError("Expected integer, got ".concat(typeof e,": ").concat(e))}},Lg=function(e){return hx(e,32)},Qw=function(e){return hx(e,16)},eE=function(e){return hx(e,8)},hx=function(e,t){var r=m3(e);if(r!==void 0&&g3(r,t)!==r)throw new TypeError("Expected ".concat(t,"-bit integer, got ").concat(e));return r},g3=function(e,t){switch(t){case 32:return Int32Array.of(e)[0];case 16:return Int16Array.of(e)[0];case 8:return Int8Array.of(e)[0]}},Is=function(e,t){if(e==null)throw t?new TypeError("Expected a non-null value for ".concat(t)):new TypeError("Expected a non-null value");return e},Hu=function(e){if(e!=null){if(typeof e=="object"&&!Array.isArray(e))return e;var t=Array.isArray(e)?"array":typeof e;throw new TypeError("Expected object, got ".concat(t,": ").concat(e))}},_r=function(e){if(e!=null){if(typeof e=="string")return e;if(["boolean","number","bigint"].includes(typeof e))return qm.warn(Gm("Expected string, got ".concat(typeof e,": ").concat(e))),String(e);throw new TypeError("Expected string, got ".concat(typeof e,": ").concat(e))}},y3=function(e){return Yw(typeof e=="string"?dx(e):e)},v3=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,dx=function(e){var t=e.match(v3);if(t===null||t[0].length!==e.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(e)},Bh=function(e){return typeof e=="string"?_3(e):WT(e)},_3=function(e){switch(e){case"NaN":return NaN;case"Infinity":return 1/0;case"-Infinity":return-1/0;default:throw new Error("Unable to parse float value: ".concat(e))}},x3=function(e){return Qw(typeof e=="string"?dx(e):e)},b3=function(e){return eE(typeof e=="string"?dx(e):e)},Gm=function(e){return String(new TypeError(e).stack||e).split(`
`).slice(0,5).filter(function(t){return!t.includes("stackTraceWarning")}).join(`
`)},qm={warn:console.warn},w3=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],E3=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?[zZ]$/),Uh=function(e){if(e!=null){if(typeof e!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");var t=E3.exec(e);if(!t)throw new TypeError("Invalid RFC-3339 date-time value");var r=Bi(t,8);r[0];var n=r[1],a=r[2],l=r[3],f=r[4],u=r[5],E=r[6],m=r[7],S=x3(KT(n)),M=nf(a,"month",1,12),z=nf(l,"day",1,31);return S3(S,M,z,{hours:f,minutes:u,seconds:E,fractionalMilliseconds:m})}},S3=function(e,t,r,n){var a=t-1;return C3(e,a,r),new Date(Date.UTC(e,a,r,nf(n.hours,"hour",0,23),nf(n.minutes,"minute",0,59),nf(n.seconds,"seconds",0,60),P3(n.fractionalMilliseconds)))},T3=[31,28,31,30,31,30,31,31,30,31,30,31],C3=function(e,t,r){var n=T3[t];if(t===1&&I3(e)&&(n=29),r>n)throw new TypeError("Invalid day for ".concat(w3[t]," in ").concat(e,": ").concat(r))},I3=function(e){return e%4===0&&(e%100!==0||e%400===0)},nf=function(e,t,r,n){var a=b3(KT(e));if(a<r||a>n)throw new TypeError("".concat(t," must be between ").concat(r," and ").concat(n,", inclusive"));return a},P3=function(e){return e==null?0:y3("0."+e)*1e3},KT=function(e){for(var t=0;t<e.length-1&&e.charAt(t)==="0";)t++;return t===0?e:e.slice(t)},A3=function(e){Di(t,e);function t(r){var n=e.call(this,r.message)||this;return Object.setPrototypeOf(n,t.prototype),n.name=r.name,n.$fault=r.$fault,n.$metadata=r.$metadata,n}return t}(Error),Zh=function(e,t){t===void 0&&(t={}),Object.entries(t).filter(function(n){var a=Bi(n,2),l=a[1];return l!==void 0}).forEach(function(n){var a=Bi(n,2),l=a[0],f=a[1];(e[l]==null||e[l]==="")&&(e[l]=f)});var r=e.message||e.Message||"UnknownError";return e.message=r,delete e.Message,e},Zu=function(e){var t=e.output,r=e.parsedBody,n=e.exceptionCtor,a=e.errorCode,l=M3(t),f=l.httpStatusCode?l.httpStatusCode+"":void 0,u=new n({name:r.code||r.Code||a||f||"UnknowError",$fault:"client",$metadata:l});throw Zh(u,r)},M3=function(e){var t;return{httpStatusCode:e.statusCode,requestId:(t=e.headers["x-amzn-requestid"])!==null&&t!==void 0?t:e.headers["x-amzn-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}},k3=function(e){switch(e){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}};function tE(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}var Hm=function(){var e=Object.getPrototypeOf(this).constructor,t=Function.bind.apply(String,Pa([null],Bi(arguments),!1)),r=new t;return Object.setPrototypeOf(r,e.prototype),r};Hm.prototype=Object.create(String.prototype,{constructor:{value:Hm,enumerable:!1,writable:!0,configurable:!0}});Object.setPrototypeOf(Hm,String);(function(e){Di(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.deserializeJSON=function(){return JSON.parse(e.prototype.toString.call(this))},t.prototype.toJSON=function(){return e.prototype.toString.call(this)},t.fromObject=function(r){return r instanceof t?r:r instanceof String||typeof r=="string"?new t(r):new t(JSON.stringify(r))},t})(Hm);function XT(e,t,r){var n,a,l,f,u;if(typeof t>"u"&&typeof r>"u")l={},u=e;else{if(l=e,typeof t=="function")return f=t,u=r,L3(l,f,u);u=t}try{for(var E=kg(Object.keys(u)),m=E.next();!m.done;m=E.next()){var S=m.value;if(!Array.isArray(u[S])){l[S]=u[S];continue}var M=Bi(u[S],2),z=M[0],H=M[1];if(typeof H=="function"){var q=void 0,Y=z===void 0&&(q=H())!=null,ye=typeof z=="function"&&!!z(void 0)||typeof z!="function"&&!!z;Y?l[S]=q:ye&&(l[S]=H())}else{var Y=z===void 0&&H!=null,ye=typeof z=="function"&&!!z(H)||typeof z!="function"&&!!z;(Y||ye)&&(l[S]=H)}}}catch(Q){n={error:Q}}finally{try{m&&!m.done&&(a=E.return)&&a.call(E)}finally{if(n)throw n.error}}return l}var L3=function(e,t,r){return XT(e,Object.entries(r).reduce(function(n,a){var l=Bi(a,2),f=l[0],u=l[1];return Array.isArray(u)?n[f]=u:typeof u=="function"?n[f]=[t,u()]:n[f]=[t,u],n},{}))},bl=function(e,t,r,n,a,l){if(t!=null&&t[r]!==void 0){var f=n();if(f.length<=0)throw new Error("Empty value provided for input HTTP label: "+r+".");e=e.replace(a,l?f.split("/").map(function(u){return tE(u)}).join("/"):tE(f))}else throw new Error("No value provided for input HTTP label: "+r+".");return e},fx=function(e){if(e!==e)return"NaN";switch(e){case 1/0:return"Infinity";case-1/0:return"-Infinity";default:return e}},cs=function(e){Di(t,e);function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return t}(A3),R3=function(e){Di(t,e);function t(r){var n=e.call(this,De({name:"AccessDeniedException",$fault:"client"},r))||this;return n.name="AccessDeniedException",n.$fault="client",Object.setPrototypeOf(n,t.prototype),n.Message=r.Message,n}return t}(cs);(function(e){Di(t,e);function t(r){var n=e.call(this,De({name:"ConflictException",$fault:"client"},r))||this;return n.name="ConflictException",n.$fault="client",Object.setPrototypeOf(n,t.prototype),n.Message=r.Message,n}return t})(cs);var O3=function(e){Di(t,e);function t(r){var n=e.call(this,De({name:"InternalServerException",$fault:"server"},r))||this;return n.name="InternalServerException",n.$fault="server",n.$retryable={},Object.setPrototypeOf(n,t.prototype),n.Message=r.Message,n}return t}(cs),D3=function(e){Di(t,e);function t(r){var n=e.call(this,De({name:"ResourceNotFoundException",$fault:"client"},r))||this;return n.name="ResourceNotFoundException",n.$fault="client",Object.setPrototypeOf(n,t.prototype),n.Message=r.Message,n}return t}(cs);(function(e){Di(t,e);function t(r){var n=e.call(this,De({name:"ServiceQuotaExceededException",$fault:"client"},r))||this;return n.name="ServiceQuotaExceededException",n.$fault="client",Object.setPrototypeOf(n,t.prototype),n.Message=r.Message,n}return t})(cs);var z3=function(e){Di(t,e);function t(r){var n=e.call(this,De({name:"ThrottlingException",$fault:"client"},r))||this;return n.name="ThrottlingException",n.$fault="client",n.$retryable={},Object.setPrototypeOf(n,t.prototype),n.Message=r.Message,n}return t}(cs),F3=function(e){Di(t,e);function t(r){var n=e.call(this,De({name:"ValidationException",$fault:"client"},r))||this;return n.name="ValidationException",n.$fault="client",Object.setPrototypeOf(n,t.prototype),n.Message=r.Message,n.Reason=r.Reason,n.FieldList=r.FieldList,n}return t}(cs),N3=function(e){return De({},e)},B3=function(e){return De({},e)},px=function(e){return De(De(De({},e),e.Polygon&&{Polygon:e.Polygon.map(function(t){return io})}),e.Circle&&{Circle:io})},U3=function(e){return De(De({},e),e.Geometry&&{Geometry:px(e.Geometry)})},j3=function(e){return De(De({},e),e.Entries&&{Entries:e.Entries.map(function(t){return U3(t)})})},$3=function(e){return De({},e)},V3=function(e){return De({},e)},G3=function(e){return De(De({},e),e.Geometry&&{Geometry:px(e.Geometry)})},q3=function(e){return De({},e)},H3=function(e){return De(De({},e),e.Geometry&&{Geometry:px(e.Geometry)})},Z3=function(e){return De(De({},e),e.Entries&&{Entries:e.Entries.map(function(t){return H3(t)})})},W3=function(e){return De({},e)},K3=function(e){return De(De({},e),e.Point&&{Point:io})},mx=function(e){return De(De({},e),e.Geometry&&{Geometry:K3(e.Geometry)})},X3=function(e){return De(De({},e),e.Place&&{Place:mx(e.Place)})},J3=function(e){return De(De({},e),e.Position&&{Position:io})},Y3=function(e){return De(De({},e),e.Place&&{Place:mx(e.Place)})},Q3=function(e){return De(De({},e),e.Position&&{Position:io})},eD=function(e){return De(De(De({},e),e.Summary&&{Summary:Q3(e.Summary)}),e.Results&&{Results:e.Results.map(function(t){return Y3(t)})})},tD=function(e){return De(De(De(De({},e),e.Text&&{Text:io}),e.BiasPosition&&{BiasPosition:io}),e.FilterBBox&&{FilterBBox:io})},rD=function(e){return De(De(De(De({},e),e.Text&&{Text:io}),e.BiasPosition&&{BiasPosition:io}),e.FilterBBox&&{FilterBBox:io})},nD=function(e){return De(De({},e),e.Summary&&{Summary:rD(e.Summary)})},iD=function(e){return De(De(De(De({},e),e.Text&&{Text:io}),e.BiasPosition&&{BiasPosition:io}),e.FilterBBox&&{FilterBBox:io})},oD=function(e){return De(De({},e),e.Place&&{Place:mx(e.Place)})},sD=function(e){return De(De(De(De(De({},e),e.Text&&{Text:io}),e.BiasPosition&&{BiasPosition:io}),e.FilterBBox&&{FilterBBox:io}),e.ResultBBox&&{ResultBBox:io})},aD=function(e){return De(De(De({},e),e.Summary&&{Summary:sD(e.Summary)}),e.Results&&{Results:e.Results.map(function(t){return oD(t)})})},Ps=function(){function e(t){this.method=t.method||"GET",this.hostname=t.hostname||"localhost",this.port=t.port,this.query=t.query||{},this.headers=t.headers||{},this.body=t.body,this.protocol=t.protocol?t.protocol.slice(-1)!==":"?"".concat(t.protocol,":"):t.protocol:"https:",this.path=t.path?t.path.charAt(0)!=="/"?"/".concat(t.path):t.path:"/"}return e.isInstance=function(t){if(!t)return!1;var r=t;return"method"in r&&"protocol"in r&&"hostname"in r&&"path"in r&&typeof r.query=="object"&&typeof r.headers=="object"},e.prototype.clone=function(){var t=new e(De(De({},this),{headers:De({},this.headers)}));return t.query&&(t.query=lD(t.query)),t},e}();function lD(e){return Object.keys(e).reduce(function(t,r){var n,a=e[r];return De(De({},t),(n={},n[r]=Array.isArray(a)?Pa([],Bi(a),!1):a,n))},{})}var Zm=function(){function e(t){this.statusCode=t.statusCode,this.headers=t.headers||{},this.body=t.body}return e.isInstance=function(t){if(!t)return!1;var r=t;return typeof r.statusCode=="number"&&typeof r.headers=="object"},e}();function Wu(e){var t=/^[a-z0-9][a-z0-9\.\-]*[a-z0-9]$/;return t.test(e)}var uD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l,f,u,E,m,S;return Xt(this,function(M){switch(M.label){case 0:return[4,t.endpoint()];case 1:return r=M.sent(),r.hostname,n=r.protocol,a=n===void 0?"https":n,l=r.port,f=r.path,u={"content-type":"application/json"},E="".concat(f!=null&&f.endsWith("/")?f.slice(0,-1):f||"")+"/geofencing/v0/collections/{CollectionName}/delete-geofences",E=bl(E,e,"CollectionName",function(){return e.CollectionName},"{CollectionName}",!1),m=JSON.stringify(De({},e.GeofenceIds!=null&&{GeofenceIds:FD(e.GeofenceIds)})),[4,t.endpoint()];case 2:if(S=M.sent().hostname,t.disableHostPrefix!==!0&&(S="geofencing."+S,!Wu(S)))throw new Error("ValidationError: prefixed hostname must be hostname compatible.");return[2,new Ps({protocol:a,hostname:S,port:l,method:"POST",headers:u,path:E,body:m})]}})})},cD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l,f,u,E,m,S;return Xt(this,function(M){switch(M.label){case 0:return[4,t.endpoint()];case 1:return r=M.sent(),r.hostname,n=r.protocol,a=n===void 0?"https":n,l=r.port,f=r.path,u={"content-type":"application/json"},E="".concat(f!=null&&f.endsWith("/")?f.slice(0,-1):f||"")+"/geofencing/v0/collections/{CollectionName}/put-geofences",E=bl(E,e,"CollectionName",function(){return e.CollectionName},"{CollectionName}",!1),m=JSON.stringify(De({},e.Entries!=null&&{Entries:OD(e.Entries)})),[4,t.endpoint()];case 2:if(S=M.sent().hostname,t.disableHostPrefix!==!0&&(S="geofencing."+S,!Wu(S)))throw new Error("ValidationError: prefixed hostname must be hostname compatible.");return[2,new Ps({protocol:a,hostname:S,port:l,method:"POST",headers:u,path:E,body:m})]}})})},hD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l,f,u,E,m,S;return Xt(this,function(M){switch(M.label){case 0:return[4,t.endpoint()];case 1:return r=M.sent(),r.hostname,n=r.protocol,a=n===void 0?"https":n,l=r.port,f=r.path,u={},E="".concat(f!=null&&f.endsWith("/")?f.slice(0,-1):f||"")+"/geofencing/v0/collections/{CollectionName}/geofences/{GeofenceId}",E=bl(E,e,"CollectionName",function(){return e.CollectionName},"{CollectionName}",!1),E=bl(E,e,"GeofenceId",function(){return e.GeofenceId},"{GeofenceId}",!1),[4,t.endpoint()];case 2:if(S=M.sent().hostname,t.disableHostPrefix!==!0&&(S="geofencing."+S,!Wu(S)))throw new Error("ValidationError: prefixed hostname must be hostname compatible.");return[2,new Ps({protocol:a,hostname:S,port:l,method:"GET",headers:u,path:E,body:m})]}})})},dD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l,f,u,E,m,S,M;return Xt(this,function(z){switch(z.label){case 0:return[4,t.endpoint()];case 1:return r=z.sent(),r.hostname,n=r.protocol,a=n===void 0?"https":n,l=r.port,f=r.path,u={},E="".concat(f!=null&&f.endsWith("/")?f.slice(0,-1):f||"")+"/places/v0/indexes/{IndexName}/places/{PlaceId}",E=bl(E,e,"IndexName",function(){return e.IndexName},"{IndexName}",!1),E=bl(E,e,"PlaceId",function(){return e.PlaceId},"{PlaceId}",!1),m=As({language:[,e.Language]}),[4,t.endpoint()];case 2:if(M=z.sent().hostname,t.disableHostPrefix!==!0&&(M="places."+M,!Wu(M)))throw new Error("ValidationError: prefixed hostname must be hostname compatible.");return[2,new Ps({protocol:a,hostname:M,port:l,method:"GET",headers:u,path:E,query:m,body:S})]}})})},fD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l,f,u,E,m,S;return Xt(this,function(M){switch(M.label){case 0:return[4,t.endpoint()];case 1:return r=M.sent(),r.hostname,n=r.protocol,a=n===void 0?"https":n,l=r.port,f=r.path,u={"content-type":"application/json"},E="".concat(f!=null&&f.endsWith("/")?f.slice(0,-1):f||"")+"/geofencing/v0/collections/{CollectionName}/list-geofences",E=bl(E,e,"CollectionName",function(){return e.CollectionName},"{CollectionName}",!1),m=JSON.stringify(De(De({},e.MaxResults!=null&&{MaxResults:e.MaxResults}),e.NextToken!=null&&{NextToken:e.NextToken})),[4,t.endpoint()];case 2:if(S=M.sent().hostname,t.disableHostPrefix!==!0&&(S="geofencing."+S,!Wu(S)))throw new Error("ValidationError: prefixed hostname must be hostname compatible.");return[2,new Ps({protocol:a,hostname:S,port:l,method:"POST",headers:u,path:E,body:m})]}})})},pD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l,f,u,E,m,S;return Xt(this,function(M){switch(M.label){case 0:return[4,t.endpoint()];case 1:return r=M.sent(),r.hostname,n=r.protocol,a=n===void 0?"https":n,l=r.port,f=r.path,u={"content-type":"application/json"},E="".concat(f!=null&&f.endsWith("/")?f.slice(0,-1):f||"")+"/places/v0/indexes/{IndexName}/search/position",E=bl(E,e,"IndexName",function(){return e.IndexName},"{IndexName}",!1),m=JSON.stringify(De(De(De({},e.Language!=null&&{Language:e.Language}),e.MaxResults!=null&&{MaxResults:e.MaxResults}),e.Position!=null&&{Position:Nf(e.Position)})),[4,t.endpoint()];case 2:if(S=M.sent().hostname,t.disableHostPrefix!==!0&&(S="places."+S,!Wu(S)))throw new Error("ValidationError: prefixed hostname must be hostname compatible.");return[2,new Ps({protocol:a,hostname:S,port:l,method:"POST",headers:u,path:E,body:m})]}})})},mD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l,f,u,E,m,S;return Xt(this,function(M){switch(M.label){case 0:return[4,t.endpoint()];case 1:return r=M.sent(),r.hostname,n=r.protocol,a=n===void 0?"https":n,l=r.port,f=r.path,u={"content-type":"application/json"},E="".concat(f!=null&&f.endsWith("/")?f.slice(0,-1):f||"")+"/places/v0/indexes/{IndexName}/search/suggestions",E=bl(E,e,"IndexName",function(){return e.IndexName},"{IndexName}",!1),m=JSON.stringify(De(De(De(De(De(De({},e.BiasPosition!=null&&{BiasPosition:Nf(e.BiasPosition)}),e.FilterBBox!=null&&{FilterBBox:JT(e.FilterBBox)}),e.FilterCountries!=null&&{FilterCountries:YT(e.FilterCountries)}),e.Language!=null&&{Language:e.Language}),e.MaxResults!=null&&{MaxResults:e.MaxResults}),e.Text!=null&&{Text:e.Text})),[4,t.endpoint()];case 2:if(S=M.sent().hostname,t.disableHostPrefix!==!0&&(S="places."+S,!Wu(S)))throw new Error("ValidationError: prefixed hostname must be hostname compatible.");return[2,new Ps({protocol:a,hostname:S,port:l,method:"POST",headers:u,path:E,body:m})]}})})},gD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l,f,u,E,m,S;return Xt(this,function(M){switch(M.label){case 0:return[4,t.endpoint()];case 1:return r=M.sent(),r.hostname,n=r.protocol,a=n===void 0?"https":n,l=r.port,f=r.path,u={"content-type":"application/json"},E="".concat(f!=null&&f.endsWith("/")?f.slice(0,-1):f||"")+"/places/v0/indexes/{IndexName}/search/text",E=bl(E,e,"IndexName",function(){return e.IndexName},"{IndexName}",!1),m=JSON.stringify(De(De(De(De(De(De({},e.BiasPosition!=null&&{BiasPosition:Nf(e.BiasPosition)}),e.FilterBBox!=null&&{FilterBBox:JT(e.FilterBBox)}),e.FilterCountries!=null&&{FilterCountries:YT(e.FilterCountries)}),e.Language!=null&&{Language:e.Language}),e.MaxResults!=null&&{MaxResults:e.MaxResults}),e.Text!=null&&{Text:e.Text})),[4,t.endpoint()];case 2:if(S=M.sent().hostname,t.disableHostPrefix!==!0&&(S="places."+S,!Wu(S)))throw new Error("ValidationError: prefixed hostname must be hostname compatible.");return[2,new Ps({protocol:a,hostname:S,port:l,method:"POST",headers:u,path:E,body:m})]}})})},yD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l;return Xt(this,function(f){switch(f.label){case 0:return e.statusCode!==200&&e.statusCode>=300?[2,vD(e,t)]:(r=As({$metadata:sa(e)}),a=Is,l=Hu,[4,Ql(e.body,t)]);case 1:return n=a.apply(void 0,[l.apply(void 0,[f.sent()]),"body"]),n.Errors!=null&&(r.Errors=jD(n.Errors)),[2,r]}})})},vD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l,f,u;return Xt(this,function(E){switch(E.label){case 0:return n=[De({},e)],u={},[4,ec(e.body,t)];case 1:switch(r=De.apply(void 0,n.concat([(u.body=E.sent(),u)])),a=tc(e,r.body),l=a,l){case"AccessDeniedException":return[3,2];case"com.amazonaws.location#AccessDeniedException":return[3,2];case"InternalServerException":return[3,4];case"com.amazonaws.location#InternalServerException":return[3,4];case"ResourceNotFoundException":return[3,6];case"com.amazonaws.location#ResourceNotFoundException":return[3,6];case"ThrottlingException":return[3,8];case"com.amazonaws.location#ThrottlingException":return[3,8];case"ValidationException":return[3,10];case"com.amazonaws.location#ValidationException":return[3,10]}return[3,12];case 2:return[4,Ku(r)];case 3:throw E.sent();case 4:return[4,Xu(r)];case 5:throw E.sent();case 6:return[4,Ju(r)];case 7:throw E.sent();case 8:return[4,Yu(r)];case 9:throw E.sent();case 10:return[4,Qu(r)];case 11:throw E.sent();case 12:f=r.body,Zu({output:e,parsedBody:f,exceptionCtor:cs,errorCode:a}),E.label=13;case 13:return[2]}})})},_D=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l;return Xt(this,function(f){switch(f.label){case 0:return e.statusCode!==200&&e.statusCode>=300?[2,xD(e,t)]:(r=As({$metadata:sa(e)}),a=Is,l=Hu,[4,Ql(e.body,t)]);case 1:return n=a.apply(void 0,[l.apply(void 0,[f.sent()]),"body"]),n.Errors!=null&&(r.Errors=VD(n.Errors)),n.Successes!=null&&(r.Successes=qD(n.Successes)),[2,r]}})})},xD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l,f,u;return Xt(this,function(E){switch(E.label){case 0:return n=[De({},e)],u={},[4,ec(e.body,t)];case 1:switch(r=De.apply(void 0,n.concat([(u.body=E.sent(),u)])),a=tc(e,r.body),l=a,l){case"AccessDeniedException":return[3,2];case"com.amazonaws.location#AccessDeniedException":return[3,2];case"InternalServerException":return[3,4];case"com.amazonaws.location#InternalServerException":return[3,4];case"ResourceNotFoundException":return[3,6];case"com.amazonaws.location#ResourceNotFoundException":return[3,6];case"ThrottlingException":return[3,8];case"com.amazonaws.location#ThrottlingException":return[3,8];case"ValidationException":return[3,10];case"com.amazonaws.location#ValidationException":return[3,10]}return[3,12];case 2:return[4,Ku(r)];case 3:throw E.sent();case 4:return[4,Xu(r)];case 5:throw E.sent();case 6:return[4,Ju(r)];case 7:throw E.sent();case 8:return[4,Yu(r)];case 9:throw E.sent();case 10:return[4,Qu(r)];case 11:throw E.sent();case 12:f=r.body,Zu({output:e,parsedBody:f,exceptionCtor:cs,errorCode:a}),E.label=13;case 13:return[2]}})})},bD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l;return Xt(this,function(f){switch(f.label){case 0:return e.statusCode!==200&&e.statusCode>=300?[2,wD(e,t)]:(r=As({$metadata:sa(e)}),a=Is,l=Hu,[4,Ql(e.body,t)]);case 1:return n=a.apply(void 0,[l.apply(void 0,[f.sent()]),"body"]),n.CreateTime!=null&&(r.CreateTime=Is(Uh(n.CreateTime))),n.GeofenceId!=null&&(r.GeofenceId=_r(n.GeofenceId)),n.Geometry!=null&&(r.Geometry=tC(n.Geometry)),n.Status!=null&&(r.Status=_r(n.Status)),n.UpdateTime!=null&&(r.UpdateTime=Is(Uh(n.UpdateTime))),[2,r]}})})},wD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l,f,u;return Xt(this,function(E){switch(E.label){case 0:return n=[De({},e)],u={},[4,ec(e.body,t)];case 1:switch(r=De.apply(void 0,n.concat([(u.body=E.sent(),u)])),a=tc(e,r.body),l=a,l){case"AccessDeniedException":return[3,2];case"com.amazonaws.location#AccessDeniedException":return[3,2];case"InternalServerException":return[3,4];case"com.amazonaws.location#InternalServerException":return[3,4];case"ResourceNotFoundException":return[3,6];case"com.amazonaws.location#ResourceNotFoundException":return[3,6];case"ThrottlingException":return[3,8];case"com.amazonaws.location#ThrottlingException":return[3,8];case"ValidationException":return[3,10];case"com.amazonaws.location#ValidationException":return[3,10]}return[3,12];case 2:return[4,Ku(r)];case 3:throw E.sent();case 4:return[4,Xu(r)];case 5:throw E.sent();case 6:return[4,Ju(r)];case 7:throw E.sent();case 8:return[4,Yu(r)];case 9:throw E.sent();case 10:return[4,Qu(r)];case 11:throw E.sent();case 12:f=r.body,Zu({output:e,parsedBody:f,exceptionCtor:cs,errorCode:a}),E.label=13;case 13:return[2]}})})},ED=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l;return Xt(this,function(f){switch(f.label){case 0:return e.statusCode!==200&&e.statusCode>=300?[2,SD(e,t)]:(r=As({$metadata:sa(e)}),a=Is,l=Hu,[4,Ql(e.body,t)]);case 1:return n=a.apply(void 0,[l.apply(void 0,[f.sent()]),"body"]),n.Place!=null&&(r.Place=gx(n.Place)),[2,r]}})})},SD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l,f,u;return Xt(this,function(E){switch(E.label){case 0:return n=[De({},e)],u={},[4,ec(e.body,t)];case 1:switch(r=De.apply(void 0,n.concat([(u.body=E.sent(),u)])),a=tc(e,r.body),l=a,l){case"AccessDeniedException":return[3,2];case"com.amazonaws.location#AccessDeniedException":return[3,2];case"InternalServerException":return[3,4];case"com.amazonaws.location#InternalServerException":return[3,4];case"ResourceNotFoundException":return[3,6];case"com.amazonaws.location#ResourceNotFoundException":return[3,6];case"ThrottlingException":return[3,8];case"com.amazonaws.location#ThrottlingException":return[3,8];case"ValidationException":return[3,10];case"com.amazonaws.location#ValidationException":return[3,10]}return[3,12];case 2:return[4,Ku(r)];case 3:throw E.sent();case 4:return[4,Xu(r)];case 5:throw E.sent();case 6:return[4,Ju(r)];case 7:throw E.sent();case 8:return[4,Yu(r)];case 9:throw E.sent();case 10:return[4,Qu(r)];case 11:throw E.sent();case 12:f=r.body,Zu({output:e,parsedBody:f,exceptionCtor:cs,errorCode:a}),E.label=13;case 13:return[2]}})})},TD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l;return Xt(this,function(f){switch(f.label){case 0:return e.statusCode!==200&&e.statusCode>=300?[2,CD(e,t)]:(r=As({$metadata:sa(e)}),a=Is,l=Hu,[4,Ql(e.body,t)]);case 1:return n=a.apply(void 0,[l.apply(void 0,[f.sent()]),"body"]),n.Entries!=null&&(r.Entries=XD(n.Entries)),n.NextToken!=null&&(r.NextToken=_r(n.NextToken)),[2,r]}})})},CD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l,f,u;return Xt(this,function(E){switch(E.label){case 0:return n=[De({},e)],u={},[4,ec(e.body,t)];case 1:switch(r=De.apply(void 0,n.concat([(u.body=E.sent(),u)])),a=tc(e,r.body),l=a,l){case"AccessDeniedException":return[3,2];case"com.amazonaws.location#AccessDeniedException":return[3,2];case"InternalServerException":return[3,4];case"com.amazonaws.location#InternalServerException":return[3,4];case"ResourceNotFoundException":return[3,6];case"com.amazonaws.location#ResourceNotFoundException":return[3,6];case"ThrottlingException":return[3,8];case"com.amazonaws.location#ThrottlingException":return[3,8];case"ValidationException":return[3,10];case"com.amazonaws.location#ValidationException":return[3,10]}return[3,12];case 2:return[4,Ku(r)];case 3:throw E.sent();case 4:return[4,Xu(r)];case 5:throw E.sent();case 6:return[4,Ju(r)];case 7:throw E.sent();case 8:return[4,Yu(r)];case 9:throw E.sent();case 10:return[4,Qu(r)];case 11:throw E.sent();case 12:f=r.body,Zu({output:e,parsedBody:f,exceptionCtor:cs,errorCode:a}),E.label=13;case 13:return[2]}})})},ID=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l;return Xt(this,function(f){switch(f.label){case 0:return e.statusCode!==200&&e.statusCode>=300?[2,PD(e,t)]:(r=As({$metadata:sa(e)}),a=Is,l=Hu,[4,Ql(e.body,t)]);case 1:return n=a.apply(void 0,[l.apply(void 0,[f.sent()]),"body"]),n.Results!=null&&(r.Results=QD(n.Results)),n.Summary!=null&&(r.Summary=iz(n.Summary)),[2,r]}})})},PD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l,f,u;return Xt(this,function(E){switch(E.label){case 0:return n=[De({},e)],u={},[4,ec(e.body,t)];case 1:switch(r=De.apply(void 0,n.concat([(u.body=E.sent(),u)])),a=tc(e,r.body),l=a,l){case"AccessDeniedException":return[3,2];case"com.amazonaws.location#AccessDeniedException":return[3,2];case"InternalServerException":return[3,4];case"com.amazonaws.location#InternalServerException":return[3,4];case"ResourceNotFoundException":return[3,6];case"com.amazonaws.location#ResourceNotFoundException":return[3,6];case"ThrottlingException":return[3,8];case"com.amazonaws.location#ThrottlingException":return[3,8];case"ValidationException":return[3,10];case"com.amazonaws.location#ValidationException":return[3,10]}return[3,12];case 2:return[4,Ku(r)];case 3:throw E.sent();case 4:return[4,Xu(r)];case 5:throw E.sent();case 6:return[4,Ju(r)];case 7:throw E.sent();case 8:return[4,Yu(r)];case 9:throw E.sent();case 10:return[4,Qu(r)];case 11:throw E.sent();case 12:f=r.body,Zu({output:e,parsedBody:f,exceptionCtor:cs,errorCode:a}),E.label=13;case 13:return[2]}})})},AD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l;return Xt(this,function(f){switch(f.label){case 0:return e.statusCode!==200&&e.statusCode>=300?[2,MD(e,t)]:(r=As({$metadata:sa(e)}),a=Is,l=Hu,[4,Ql(e.body,t)]);case 1:return n=a.apply(void 0,[l.apply(void 0,[f.sent()]),"body"]),n.Results!=null&&(r.Results=tz(n.Results)),n.Summary!=null&&(r.Summary=oz(n.Summary)),[2,r]}})})},MD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l,f,u;return Xt(this,function(E){switch(E.label){case 0:return n=[De({},e)],u={},[4,ec(e.body,t)];case 1:switch(r=De.apply(void 0,n.concat([(u.body=E.sent(),u)])),a=tc(e,r.body),l=a,l){case"AccessDeniedException":return[3,2];case"com.amazonaws.location#AccessDeniedException":return[3,2];case"InternalServerException":return[3,4];case"com.amazonaws.location#InternalServerException":return[3,4];case"ResourceNotFoundException":return[3,6];case"com.amazonaws.location#ResourceNotFoundException":return[3,6];case"ThrottlingException":return[3,8];case"com.amazonaws.location#ThrottlingException":return[3,8];case"ValidationException":return[3,10];case"com.amazonaws.location#ValidationException":return[3,10]}return[3,12];case 2:return[4,Ku(r)];case 3:throw E.sent();case 4:return[4,Xu(r)];case 5:throw E.sent();case 6:return[4,Ju(r)];case 7:throw E.sent();case 8:return[4,Yu(r)];case 9:throw E.sent();case 10:return[4,Qu(r)];case 11:throw E.sent();case 12:f=r.body,Zu({output:e,parsedBody:f,exceptionCtor:cs,errorCode:a}),E.label=13;case 13:return[2]}})})},kD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l;return Xt(this,function(f){switch(f.label){case 0:return e.statusCode!==200&&e.statusCode>=300?[2,LD(e,t)]:(r=As({$metadata:sa(e)}),a=Is,l=Hu,[4,Ql(e.body,t)]);case 1:return n=a.apply(void 0,[l.apply(void 0,[f.sent()]),"body"]),n.Results!=null&&(r.Results=nz(n.Results)),n.Summary!=null&&(r.Summary=sz(n.Summary)),[2,r]}})})},LD=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a,l,f,u;return Xt(this,function(E){switch(E.label){case 0:return n=[De({},e)],u={},[4,ec(e.body,t)];case 1:switch(r=De.apply(void 0,n.concat([(u.body=E.sent(),u)])),a=tc(e,r.body),l=a,l){case"AccessDeniedException":return[3,2];case"com.amazonaws.location#AccessDeniedException":return[3,2];case"InternalServerException":return[3,4];case"com.amazonaws.location#InternalServerException":return[3,4];case"ResourceNotFoundException":return[3,6];case"com.amazonaws.location#ResourceNotFoundException":return[3,6];case"ThrottlingException":return[3,8];case"com.amazonaws.location#ThrottlingException":return[3,8];case"ValidationException":return[3,10];case"com.amazonaws.location#ValidationException":return[3,10]}return[3,12];case 2:return[4,Ku(r)];case 3:throw E.sent();case 4:return[4,Xu(r)];case 5:throw E.sent();case 6:return[4,Ju(r)];case 7:throw E.sent();case 8:return[4,Yu(r)];case 9:throw E.sent();case 10:return[4,Qu(r)];case 11:throw E.sent();case 12:f=r.body,Zu({output:e,parsedBody:f,exceptionCtor:cs,errorCode:a}),E.label=13;case 13:return[2]}})})},As=XT,Ku=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a;return Xt(this,function(l){return r=As({}),n=e.body,n.message!=null&&(r.Message=_r(n.message)),a=new R3(De({$metadata:sa(e)},r)),[2,Zh(a,e.body)]})})},Xu=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a;return Xt(this,function(l){return r=As({}),n=e.body,n.message!=null&&(r.Message=_r(n.message)),a=new O3(De({$metadata:sa(e)},r)),[2,Zh(a,e.body)]})})},Ju=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a;return Xt(this,function(l){return r=As({}),n=e.body,n.message!=null&&(r.Message=_r(n.message)),a=new D3(De({$metadata:sa(e)},r)),[2,Zh(a,e.body)]})})},Yu=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a;return Xt(this,function(l){return r=As({}),n=e.body,n.message!=null&&(r.Message=_r(n.message)),a=new z3(De({$metadata:sa(e)},r)),[2,Zh(a,e.body)]})})},Qu=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n,a;return Xt(this,function(l){return r=As({}),n=e.body,n.fieldList!=null&&(r.FieldList=uz(n.fieldList)),n.message!=null&&(r.Message=_r(n.message)),n.reason!=null&&(r.Reason=_r(n.reason)),a=new F3(De({$metadata:sa(e)},r)),[2,Zh(a,e.body)]})})},RD=function(e,t){return De(De({},e.GeofenceId!=null&&{GeofenceId:e.GeofenceId}),e.Geometry!=null&&{Geometry:zD(e.Geometry)})},OD=function(e,t){return e.filter(function(r){return r!=null}).map(function(r){return RD(r)})},JT=function(e,t){return e.filter(function(r){return r!=null}).map(function(r){return fx(r)})},DD=function(e,t){return De(De({},e.Center!=null&&{Center:Nf(e.Center)}),e.Radius!=null&&{Radius:fx(e.Radius)})},YT=function(e,t){return e.filter(function(r){return r!=null}).map(function(r){return r})},zD=function(e,t){return De(De({},e.Circle!=null&&{Circle:DD(e.Circle)}),e.Polygon!=null&&{Polygon:BD(e.Polygon)})},FD=function(e,t){return e.filter(function(r){return r!=null}).map(function(r){return r})},ND=function(e,t){return e.filter(function(r){return r!=null}).map(function(r){return Nf(r)})},BD=function(e,t){return e.filter(function(r){return r!=null}).map(function(r){return ND(r)})},Nf=function(e,t){return e.filter(function(r){return r!=null}).map(function(r){return fx(r)})},UD=function(e,t){return{Error:e.Error!=null?QT(e.Error):void 0,GeofenceId:_r(e.GeofenceId)}},jD=function(e,t){var r=(e||[]).filter(function(n){return n!=null}).map(function(n){return n===null?null:UD(n)});return r},QT=function(e,t){return{Code:_r(e.Code),Message:_r(e.Message)}},$D=function(e,t){return{Error:e.Error!=null?QT(e.Error):void 0,GeofenceId:_r(e.GeofenceId)}},VD=function(e,t){var r=(e||[]).filter(function(n){return n!=null}).map(function(n){return n===null?null:$D(n)});return r},GD=function(e,t){return{CreateTime:e.CreateTime!=null?Is(Uh(e.CreateTime)):void 0,GeofenceId:_r(e.GeofenceId),UpdateTime:e.UpdateTime!=null?Is(Uh(e.UpdateTime)):void 0}},qD=function(e,t){var r=(e||[]).filter(function(n){return n!=null}).map(function(n){return n===null?null:GD(n)});return r},N_=function(e,t){var r=(e||[]).filter(function(n){return n!=null}).map(function(n){return n===null?null:Bh(n)});return r},HD=function(e,t){return{Center:e.Center!=null?Wh(e.Center):void 0,Radius:Bh(e.Radius)}},eC=function(e,t){var r=(e||[]).filter(function(n){return n!=null}).map(function(n){return n===null?null:_r(n)});return r},tC=function(e,t){return{Circle:e.Circle!=null?HD(e.Circle):void 0,Polygon:e.Polygon!=null?WD(e.Polygon):void 0}},ZD=function(e,t){var r=(e||[]).filter(function(n){return n!=null}).map(function(n){return n===null?null:Wh(n)});return r},WD=function(e,t){var r=(e||[]).filter(function(n){return n!=null}).map(function(n){return n===null?null:ZD(n)});return r},KD=function(e,t){return{CreateTime:e.CreateTime!=null?Is(Uh(e.CreateTime)):void 0,GeofenceId:_r(e.GeofenceId),Geometry:e.Geometry!=null?tC(e.Geometry):void 0,Status:_r(e.Status),UpdateTime:e.UpdateTime!=null?Is(Uh(e.UpdateTime)):void 0}},XD=function(e,t){var r=(e||[]).filter(function(n){return n!=null}).map(function(n){return n===null?null:KD(n)});return r},gx=function(e,t){return{AddressNumber:_r(e.AddressNumber),Country:_r(e.Country),Geometry:e.Geometry!=null?JD(e.Geometry):void 0,Interpolated:f3(e.Interpolated),Label:_r(e.Label),Municipality:_r(e.Municipality),Neighborhood:_r(e.Neighborhood),PostalCode:_r(e.PostalCode),Region:_r(e.Region),Street:_r(e.Street),SubRegion:_r(e.SubRegion),TimeZone:e.TimeZone!=null?az(e.TimeZone):void 0,UnitNumber:_r(e.UnitNumber),UnitType:_r(e.UnitType)}},JD=function(e,t){return{Point:e.Point!=null?Wh(e.Point):void 0}},Wh=function(e,t){var r=(e||[]).filter(function(n){return n!=null}).map(function(n){return n===null?null:Bh(n)});return r},YD=function(e,t){return{Distance:Bh(e.Distance),Place:e.Place!=null?gx(e.Place):void 0,PlaceId:_r(e.PlaceId)}},QD=function(e,t){var r=(e||[]).filter(function(n){return n!=null}).map(function(n){return n===null?null:YD(n)});return r},ez=function(e,t){return{PlaceId:_r(e.PlaceId),Text:_r(e.Text)}},tz=function(e,t){var r=(e||[]).filter(function(n){return n!=null}).map(function(n){return n===null?null:ez(n)});return r},rz=function(e,t){return{Distance:Bh(e.Distance),Place:e.Place!=null?gx(e.Place):void 0,PlaceId:_r(e.PlaceId),Relevance:Bh(e.Relevance)}},nz=function(e,t){var r=(e||[]).filter(function(n){return n!=null}).map(function(n){return n===null?null:rz(n)});return r},iz=function(e,t){return{DataSource:_r(e.DataSource),Language:_r(e.Language),MaxResults:Lg(e.MaxResults),Position:e.Position!=null?Wh(e.Position):void 0}},oz=function(e,t){return{BiasPosition:e.BiasPosition!=null?Wh(e.BiasPosition):void 0,DataSource:_r(e.DataSource),FilterBBox:e.FilterBBox!=null?N_(e.FilterBBox):void 0,FilterCountries:e.FilterCountries!=null?eC(e.FilterCountries):void 0,Language:_r(e.Language),MaxResults:Lg(e.MaxResults),Text:_r(e.Text)}},sz=function(e,t){return{BiasPosition:e.BiasPosition!=null?Wh(e.BiasPosition):void 0,DataSource:_r(e.DataSource),FilterBBox:e.FilterBBox!=null?N_(e.FilterBBox):void 0,FilterCountries:e.FilterCountries!=null?eC(e.FilterCountries):void 0,Language:_r(e.Language),MaxResults:Lg(e.MaxResults),ResultBBox:e.ResultBBox!=null?N_(e.ResultBBox):void 0,Text:_r(e.Text)}},az=function(e,t){return{Name:_r(e.Name),Offset:Lg(e.Offset)}},lz=function(e,t){return{Message:_r(e.message),Name:_r(e.name)}},uz=function(e,t){var r=(e||[]).filter(function(n){return n!=null}).map(function(n){return n===null?null:lz(n)});return r},sa=function(e){var t,r;return{httpStatusCode:e.statusCode,requestId:(r=(t=e.headers["x-amzn-requestid"])!==null&&t!==void 0?t:e.headers["x-amzn-request-id"])!==null&&r!==void 0?r:e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}},cz=function(e,t){return e===void 0&&(e=new Uint8Array),e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array)},hz=function(e,t){return cz(e,t).then(function(r){return t.utf8Encoder(r)})},Ql=function(e,t){return hz(e,t).then(function(r){return r.length?JSON.parse(r):{}})},ec=function(e,t){return Yt(void 0,void 0,void 0,function(){var r,n;return Xt(this,function(a){switch(a.label){case 0:return[4,Ql(e,t)];case 1:return r=a.sent(),r.message=(n=r.message)!==null&&n!==void 0?n:r.Message,[2,r]}})})},tc=function(e,t){var r=function(l,f){return Object.keys(l).find(function(u){return u.toLowerCase()===f.toLowerCase()})},n=function(l){var f=l;return typeof f=="number"&&(f=f.toString()),f.indexOf(",")>=0&&(f=f.split(",")[0]),f.indexOf(":")>=0&&(f=f.split(":")[0]),f.indexOf("#")>=0&&(f=f.split("#")[1]),f},a=r(e.headers,"x-amzn-errortype");if(a!==void 0)return n(e.headers[a]);if(t.code!==void 0)return n(t.code);if(t.__type!==void 0)return n(t.__type)},dz=function(e){Di(t,e);function t(r){var n=e.call(this)||this;return n.input=r,n}return t.prototype.resolveMiddleware=function(r,n,a){this.middlewareStack.use(Gu(n,this.serialize,this.deserialize));var l=r.concat(this.middlewareStack),f=n.logger,u="LocationClient",E="BatchDeleteGeofenceCommand",m={logger:f,clientName:u,commandName:E,inputFilterSensitiveLog:N3,outputFilterSensitiveLog:B3},S=n.requestHandler;return l.resolve(function(M){return S.handle(M.request,a||{})},m)},t.prototype.serialize=function(r,n){return uD(r,n)},t.prototype.deserialize=function(r,n){return yD(r,n)},t}(qu),fz=function(e){Di(t,e);function t(r){var n=e.call(this)||this;return n.input=r,n}return t.prototype.resolveMiddleware=function(r,n,a){this.middlewareStack.use(Gu(n,this.serialize,this.deserialize));var l=r.concat(this.middlewareStack),f=n.logger,u="LocationClient",E="BatchPutGeofenceCommand",m={logger:f,clientName:u,commandName:E,inputFilterSensitiveLog:j3,outputFilterSensitiveLog:$3},S=n.requestHandler;return l.resolve(function(M){return S.handle(M.request,a||{})},m)},t.prototype.serialize=function(r,n){return cD(r,n)},t.prototype.deserialize=function(r,n){return _D(r,n)},t}(qu),pz=function(e){Di(t,e);function t(r){var n=e.call(this)||this;return n.input=r,n}return t.prototype.resolveMiddleware=function(r,n,a){this.middlewareStack.use(Gu(n,this.serialize,this.deserialize));var l=r.concat(this.middlewareStack),f=n.logger,u="LocationClient",E="GetGeofenceCommand",m={logger:f,clientName:u,commandName:E,inputFilterSensitiveLog:V3,outputFilterSensitiveLog:G3},S=n.requestHandler;return l.resolve(function(M){return S.handle(M.request,a||{})},m)},t.prototype.serialize=function(r,n){return hD(r,n)},t.prototype.deserialize=function(r,n){return bD(r,n)},t}(qu),mz=function(e){Di(t,e);function t(r){var n=e.call(this)||this;return n.input=r,n}return t.prototype.resolveMiddleware=function(r,n,a){this.middlewareStack.use(Gu(n,this.serialize,this.deserialize));var l=r.concat(this.middlewareStack),f=n.logger,u="LocationClient",E="GetPlaceCommand",m={logger:f,clientName:u,commandName:E,inputFilterSensitiveLog:W3,outputFilterSensitiveLog:X3},S=n.requestHandler;return l.resolve(function(M){return S.handle(M.request,a||{})},m)},t.prototype.serialize=function(r,n){return dD(r,n)},t.prototype.deserialize=function(r,n){return ED(r,n)},t}(qu),gz=function(e){Di(t,e);function t(r){var n=e.call(this)||this;return n.input=r,n}return t.prototype.resolveMiddleware=function(r,n,a){this.middlewareStack.use(Gu(n,this.serialize,this.deserialize));var l=r.concat(this.middlewareStack),f=n.logger,u="LocationClient",E="ListGeofencesCommand",m={logger:f,clientName:u,commandName:E,inputFilterSensitiveLog:q3,outputFilterSensitiveLog:Z3},S=n.requestHandler;return l.resolve(function(M){return S.handle(M.request,a||{})},m)},t.prototype.serialize=function(r,n){return fD(r,n)},t.prototype.deserialize=function(r,n){return TD(r,n)},t}(qu),yz=function(e){Di(t,e);function t(r){var n=e.call(this)||this;return n.input=r,n}return t.prototype.resolveMiddleware=function(r,n,a){this.middlewareStack.use(Gu(n,this.serialize,this.deserialize));var l=r.concat(this.middlewareStack),f=n.logger,u="LocationClient",E="SearchPlaceIndexForPositionCommand",m={logger:f,clientName:u,commandName:E,inputFilterSensitiveLog:J3,outputFilterSensitiveLog:eD},S=n.requestHandler;return l.resolve(function(M){return S.handle(M.request,a||{})},m)},t.prototype.serialize=function(r,n){return pD(r,n)},t.prototype.deserialize=function(r,n){return ID(r,n)},t}(qu),vz=function(e){Di(t,e);function t(r){var n=e.call(this)||this;return n.input=r,n}return t.prototype.resolveMiddleware=function(r,n,a){this.middlewareStack.use(Gu(n,this.serialize,this.deserialize));var l=r.concat(this.middlewareStack),f=n.logger,u="LocationClient",E="SearchPlaceIndexForSuggestionsCommand",m={logger:f,clientName:u,commandName:E,inputFilterSensitiveLog:tD,outputFilterSensitiveLog:nD},S=n.requestHandler;return l.resolve(function(M){return S.handle(M.request,a||{})},m)},t.prototype.serialize=function(r,n){return mD(r,n)},t.prototype.deserialize=function(r,n){return AD(r,n)},t}(qu),_z=function(e){Di(t,e);function t(r){var n=e.call(this)||this;return n.input=r,n}return t.prototype.resolveMiddleware=function(r,n,a){this.middlewareStack.use(Gu(n,this.serialize,this.deserialize));var l=r.concat(this.middlewareStack),f=n.logger,u="LocationClient",E="SearchPlaceIndexForTextCommand",m={logger:f,clientName:u,commandName:E,inputFilterSensitiveLog:iD,outputFilterSensitiveLog:aD},S=n.requestHandler;return l.resolve(function(M){return S.handle(M.request,a||{})},m)},t.prototype.serialize=function(r,n){return gD(r,n)},t.prototype.deserialize=function(r,n){return kD(r,n)},t}(qu),rE;(function(e){e.ENV="env",e.CONFIG="shared config entry"})(rE||(rE={}));var xz=!1,bz=!1,Jl=function(e){if(typeof e=="function")return e;var t=Promise.resolve(e);return function(){return t}},wz=function(e){return Yt(void 0,void 0,void 0,function(){var t,r,n,a,l,f,u,E;return Xt(this,function(m){switch(m.label){case 0:return t=e.tls,r=t===void 0?!0:t,[4,e.region()];case 1:if(n=m.sent(),a=new RegExp(/^([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9])$/),!a.test(n))throw new Error("Invalid region in client config");return[4,e.useDualstackEndpoint()];case 2:return l=m.sent(),[4,e.useFipsEndpoint()];case 3:return f=m.sent(),[4,e.regionInfoProvider(n,{useDualstackEndpoint:l,useFipsEndpoint:f})];case 4:if(u=((E=m.sent())!==null&&E!==void 0?E:{}).hostname,!u)throw new Error("Cannot resolve hostname from client config");return[2,e.urlParser("".concat(r?"https:":"http:","//").concat(u))]}})})},Ez=function(e){var t,r=Jl(e.useDualstackEndpoint),n=e.endpoint,a=e.useFipsEndpoint,l=e.urlParser;return De(De({},e),{tls:(t=e.tls)!==null&&t!==void 0?t:!0,endpoint:n?Jl(typeof n=="string"?l(n):n):function(){return wz(De(De({},e),{useDualstackEndpoint:r,useFipsEndpoint:a}))},isCustomEndpoint:!!n,useDualstackEndpoint:r})},rC=function(e){return typeof e=="string"&&(e.startsWith("fips-")||e.endsWith("-fips"))},nE=function(e){return rC(e)?["fips-aws-{}","aws-fips"].includes(e)?"us-east-1":e.replace(/fips-(dkr-|prod-)?|-fips/,""):e},Sz=function(e){var t=e.region,r=e.useFipsEndpoint;if(!t)throw new Error("Region is missing");return De(De({},e),{region:function(){return Yt(void 0,void 0,void 0,function(){var n;return Xt(this,function(a){switch(a.label){case 0:return typeof t=="string"?[2,nE(t)]:[4,t()];case 1:return n=a.sent(),[2,nE(n)]}})})},useFipsEndpoint:function(){return Yt(void 0,void 0,void 0,function(){var n,a;return Xt(this,function(l){switch(l.label){case 0:return typeof t!="string"?[3,1]:(a=t,[3,3]);case 1:return[4,t()];case 2:a=l.sent(),l.label=3;case 3:return n=a,rC(n)?[2,!0]:[2,typeof r=="boolean"?Promise.resolve(r):r()]}})})}})},iE=function(e,t){var r;e===void 0&&(e=[]);var n=t.useFipsEndpoint,a=t.useDualstackEndpoint;return(r=e.find(function(l){var f=l.tags;return n===f.includes("fips")&&a===f.includes("dualstack")}))===null||r===void 0?void 0:r.hostname},Tz=function(e,t){var r=t.regionHostname,n=t.partitionHostname;return r||(n?n.replace("{region}",e):void 0)},Cz=function(e,t){var r,n=t.partitionHash;return(r=Object.keys(n||{}).find(function(a){return n[a].regions.includes(e)}))!==null&&r!==void 0?r:"aws"},Iz=function(e,t){var r=t.signingRegion,n=t.regionRegex,a=t.useFipsEndpoint;if(r)return r;if(a){var l=n.replace("\\\\","\\").replace(/^\^/g,"\\.").replace(/\$$/g,"\\."),f=e.match(l);if(f)return f[0].slice(1,-1)}},Pz=function(e,t){var r,n,a,l,f,u,E=t.useFipsEndpoint,m=E===void 0?!1:E,S=t.useDualstackEndpoint,M=S===void 0?!1:S,z=t.signingService,H=t.regionHash,q=t.partitionHash,Y=Cz(e,{partitionHash:q}),ye=e in H?e:(n=(r=q[Y])===null||r===void 0?void 0:r.endpoint)!==null&&n!==void 0?n:e,Q={useFipsEndpoint:m,useDualstackEndpoint:M},te=iE((a=H[ye])===null||a===void 0?void 0:a.variants,Q),ne=iE((l=q[Y])===null||l===void 0?void 0:l.variants,Q),Me=Tz(ye,{regionHostname:te,partitionHostname:ne});if(Me===void 0)throw new Error("Endpoint resolution failed for: ".concat({resolvedRegion:ye,useFipsEndpoint:m,useDualstackEndpoint:M}));var Ve=Iz(Me,{signingRegion:(f=H[ye])===null||f===void 0?void 0:f.signingRegion,regionRegex:q[Y].regionRegex,useFipsEndpoint:m});return De(De({partition:Y,signingService:z,hostname:Me},Ve&&{signingRegion:Ve}),((u=H[ye])===null||u===void 0?void 0:u.signingService)&&{signingService:H[ye].signingService})},oE="content-length";function Az(e){var t=this;return function(r){return function(n){return Yt(t,void 0,void 0,function(){var a,l,f,u,E;return Xt(this,function(m){if(a=n.request,Ps.isInstance(a)&&(l=a.body,f=a.headers,l&&Object.keys(f).map(function(S){return S.toLowerCase()}).indexOf(oE)===-1))try{u=e(l),a.headers=De(De({},a.headers),(E={},E[oE]=String(u),E))}catch{}return[2,r(De(De({},n),{request:a}))]})})}}}var Mz={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},kz=function(e){return{applyToStack:function(t){t.add(Az(e.bodyLengthChecker),Mz)}}};var Lz=function(e){return function(t){return function(r){return Yt(void 0,void 0,void 0,function(){var n,a,l;return Xt(this,function(f){return Ps.isInstance(r.request)?(n=r.request,a=(e.requestHandler.metadata||{}).handlerProtocol,l=a===void 0?"":a,l.indexOf("h2")>=0&&!n.headers[":authority"]?(delete n.headers.host,n.headers[":authority"]=""):n.headers.host||(n.headers.host=n.hostname),[2,t(r)]):[2,t(r)]})})}}},Rz={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},Oz=function(e){return{applyToStack:function(t){t.add(Lz(e),Rz)}}},Dz=function(){return function(e,t){return function(r){return Yt(void 0,void 0,void 0,function(){var n,a,l,f,u,E,m,S,M;return Xt(this,function(z){switch(z.label){case 0:return n=t.clientName,a=t.commandName,l=t.inputFilterSensitiveLog,f=t.logger,u=t.outputFilterSensitiveLog,[4,e(r)];case 1:return E=z.sent(),f?(typeof f.info=="function"&&(m=E.output,S=m.$metadata,M=ZT(m,["$metadata"]),f.info({clientName:n,commandName:a,input:l(r.input),output:u(M),metadata:S})),[2,E]):[2,E]}})})}}},zz={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},Fz=function(e){return{applyToStack:function(t){t.add(Dz(),zz)}}},ql=function(){return ql=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},ql.apply(this,arguments)};function Nz(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})}function Bz(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}function Uz(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l}function jz(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return e.concat(l||Array.prototype.slice.call(t))}var $z=function(){function e(t){this.method=t.method||"GET",this.hostname=t.hostname||"localhost",this.port=t.port,this.query=t.query||{},this.headers=t.headers||{},this.body=t.body,this.protocol=t.protocol?t.protocol.slice(-1)!==":"?"".concat(t.protocol,":"):t.protocol:"https:",this.path=t.path?t.path.charAt(0)!=="/"?"/".concat(t.path):t.path:"/"}return e.isInstance=function(t){if(!t)return!1;var r=t;return"method"in r&&"protocol"in r&&"hostname"in r&&"path"in r&&typeof r.query=="object"&&typeof r.headers=="object"},e.prototype.clone=function(){var t=new e(ql(ql({},this),{headers:ql({},this.headers)}));return t.query&&(t.query=Vz(t.query)),t},e}();function Vz(e){return Object.keys(e).reduce(function(t,r){var n,a=e[r];return ql(ql({},t),(n={},n[r]=Array.isArray(a)?jz([],Uz(a),!1):a,n))},{})}var sE="X-Amzn-Trace-Id",Gz="AWS_LAMBDA_FUNCTION_NAME",qz="_X_AMZN_TRACE_ID",Hz=function(e){return function(t){return function(r){return Nz(void 0,void 0,void 0,function(){var n,a,l,f;return Bz(this,function(u){return n=r.request,!$z.isInstance(n)||e.runtime!=="node"||n.headers.hasOwnProperty(sE)?[2,t(r)]:(a=process.env[Gz],l=process.env[qz],f=function(E){return typeof E=="string"&&E.length>0},f(a)&&f(l)&&(n.headers[sE]=l),[2,t(ql(ql({},r),{request:n}))])})})}}},Zz={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},Wz=function(e){return{applyToStack:function(t){t.add(Hz(e),Zz)}}},jh;(function(e){e.STANDARD="standard",e.ADAPTIVE="adaptive"})(jh||(jh={}));var yx=3,Kz=jh.STANDARD,Xz=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch"],Jz=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],Yz=["AbortError","TimeoutError","RequestTimeout","RequestTimeoutException"],Qz=[500,502,503,504],eF=["ECONNRESET","EPIPE","ETIMEDOUT"],tF=function(e){return e.$retryable!==void 0},rF=function(e){return Xz.includes(e.name)},vx=function(e){var t,r;return((t=e.$metadata)===null||t===void 0?void 0:t.httpStatusCode)===429||Jz.includes(e.name)||((r=e.$retryable)===null||r===void 0?void 0:r.throttling)==!0},nF=function(e){var t;return Yz.includes(e.name)||eF.includes((e==null?void 0:e.code)||"")||Qz.includes(((t=e.$metadata)===null||t===void 0?void 0:t.httpStatusCode)||0)},iF=function(){function e(t){var r,n,a,l,f;this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=(r=t==null?void 0:t.beta)!==null&&r!==void 0?r:.7,this.minCapacity=(n=t==null?void 0:t.minCapacity)!==null&&n!==void 0?n:1,this.minFillRate=(a=t==null?void 0:t.minFillRate)!==null&&a!==void 0?a:.5,this.scaleConstant=(l=t==null?void 0:t.scaleConstant)!==null&&l!==void 0?l:.4,this.smooth=(f=t==null?void 0:t.smooth)!==null&&f!==void 0?f:.8;var u=this.getCurrentTimeInSeconds();this.lastThrottleTime=u,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}return e.prototype.getCurrentTimeInSeconds=function(){return Date.now()/1e3},e.prototype.getSendToken=function(){return Yt(this,void 0,void 0,function(){return Xt(this,function(t){return[2,this.acquireTokenBucket(1)]})})},e.prototype.acquireTokenBucket=function(t){return Yt(this,void 0,void 0,function(){var r;return Xt(this,function(n){switch(n.label){case 0:return this.enabled?(this.refillTokenBucket(),t>this.currentCapacity?(r=(t-this.currentCapacity)/this.fillRate*1e3,[4,new Promise(function(a){return setTimeout(a,r)})]):[3,2]):[2];case 1:n.sent(),n.label=2;case 2:return this.currentCapacity=this.currentCapacity-t,[2]}})})},e.prototype.refillTokenBucket=function(){var t=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=t;return}var r=(t-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+r),this.lastTimestamp=t},e.prototype.updateClientSendingRate=function(t){var r;if(this.updateMeasuredRate(),vx(t)){var n=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=n,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),r=this.cubicThrottle(n),this.enableTokenBucket()}else this.calculateTimeWindow(),r=this.cubicSuccess(this.getCurrentTimeInSeconds());var a=Math.min(r,2*this.measuredTxRate);this.updateTokenBucketRate(a)},e.prototype.calculateTimeWindow=function(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))},e.prototype.cubicThrottle=function(t){return this.getPrecise(t*this.beta)},e.prototype.cubicSuccess=function(t){return this.getPrecise(this.scaleConstant*Math.pow(t-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)},e.prototype.enableTokenBucket=function(){this.enabled=!0},e.prototype.updateTokenBucketRate=function(t){this.refillTokenBucket(),this.fillRate=Math.max(t,this.minFillRate),this.maxCapacity=Math.max(t,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)},e.prototype.updateMeasuredRate=function(){var t=this.getCurrentTimeInSeconds(),r=Math.floor(t*2)/2;if(this.requestCount++,r>this.lastTxRateBucket){var n=this.requestCount/(r-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(n*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=r}},e.prototype.getPrecise=function(t){return parseFloat(t.toFixed(8))},e}(),Fp,oF=new Uint8Array(16);function sF(){if(!Fp&&(Fp=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Fp))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Fp(oF)}const aF=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function lF(e){return typeof e=="string"&&aF.test(e)}var go=[];for(var xv=0;xv<256;++xv)go.push((xv+256).toString(16).substr(1));function uF(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(go[e[t+0]]+go[e[t+1]]+go[e[t+2]]+go[e[t+3]]+"-"+go[e[t+4]]+go[e[t+5]]+"-"+go[e[t+6]]+go[e[t+7]]+"-"+go[e[t+8]]+go[e[t+9]]+"-"+go[e[t+10]]+go[e[t+11]]+go[e[t+12]]+go[e[t+13]]+go[e[t+14]]+go[e[t+15]]).toLowerCase();if(!lF(r))throw TypeError("Stringified UUID is invalid");return r}function cF(e,t,r){e=e||{};var n=e.random||(e.rng||sF)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(var a=0;a<16;++a)t[r+a]=n[a];return t}return uF(n)}var hF=100,dF=20*1e3,fF=500,pF=500,mF=5,gF=10,yF=1,vF="amz-sdk-invocation-id",_F="amz-sdk-request",xF=function(e,t){var r,n,a,l=e,f=(r=t==null?void 0:t.noRetryIncrement)!==null&&r!==void 0?r:yF,u=(n=t==null?void 0:t.retryCost)!==null&&n!==void 0?n:mF,E=(a=t==null?void 0:t.timeoutRetryCost)!==null&&a!==void 0?a:gF,m=e,S=function(q){return q.name==="TimeoutError"?E:u},M=function(q){return S(q)<=m},z=function(q){if(!M(q))throw new Error("No retry token available");var Y=S(q);return m-=Y,Y},H=function(q){m+=q??f,m=Math.min(m,l)};return Object.freeze({hasRetryTokens:M,retrieveRetryTokens:z,releaseRetryTokens:H})},bF=function(e,t){return Math.floor(Math.min(dF,Math.random()*Math.pow(2,t)*e))},wF=function(e){return e?tF(e)||rF(e)||vx(e)||nF(e):!1},nC=function(){function e(t,r){var n,a,l;this.maxAttemptsProvider=t,this.mode=jh.STANDARD,this.retryDecider=(n=r==null?void 0:r.retryDecider)!==null&&n!==void 0?n:wF,this.delayDecider=(a=r==null?void 0:r.delayDecider)!==null&&a!==void 0?a:bF,this.retryQuota=(l=r==null?void 0:r.retryQuota)!==null&&l!==void 0?l:xF(pF)}return e.prototype.shouldRetry=function(t,r,n){return r<n&&this.retryDecider(t)&&this.retryQuota.hasRetryTokens(t)},e.prototype.getMaxAttempts=function(){return Yt(this,void 0,void 0,function(){var t;return Xt(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.maxAttemptsProvider()];case 1:return t=r.sent(),[3,3];case 2:return r.sent(),t=yx,[3,3];case 3:return[2,t]}})})},e.prototype.retry=function(t,r,n){return Yt(this,void 0,void 0,function(){var a,l,f,u,E,m,S,M;return Xt(this,function(z){switch(z.label){case 0:return l=0,f=0,[4,this.getMaxAttempts()];case 1:u=z.sent(),E=r.request,Ps.isInstance(E)&&(E.headers[vF]=cF()),m=function(){var H,q,Y,ye,Q,te,ne,Me;return Xt(this,function(Ve){switch(Ve.label){case 0:return Ve.trys.push([0,4,,7]),Ps.isInstance(E)&&(E.headers[_F]="attempt=".concat(l+1,"; max=").concat(u)),n!=null&&n.beforeRequest?[4,n.beforeRequest()]:[3,2];case 1:Ve.sent(),Ve.label=2;case 2:return[4,t(r)];case 3:return H=Ve.sent(),q=H.response,Y=H.output,n!=null&&n.afterRequest&&n.afterRequest(q),S.retryQuota.releaseRetryTokens(a),Y.$metadata.attempts=l+1,Y.$metadata.totalRetryDelay=f,[2,{value:{response:q,output:Y}}];case 4:return ye=Ve.sent(),Q=SF(ye),l++,S.shouldRetry(Q,l,u)?(a=S.retryQuota.retrieveRetryTokens(Q),te=S.delayDecider(vx(Q)?fF:hF,l),ne=EF(Q.$response),Me=Math.max(ne||0,te),f+=Me,[4,new Promise(function(je){return setTimeout(je,Me)})]):[3,6];case 5:return Ve.sent(),[2,"continue"];case 6:throw Q.$metadata||(Q.$metadata={}),Q.$metadata.attempts=l,Q.$metadata.totalRetryDelay=f,Q;case 7:return[2]}})},S=this,z.label=2;case 2:return[5,m()];case 3:return M=z.sent(),typeof M=="object"?[2,M.value]:[3,2];case 4:return[2]}})})},e}(),EF=function(e){if(Zm.isInstance(e)){var t=Object.keys(e.headers).find(function(l){return l.toLowerCase()==="retry-after"});if(t){var r=e.headers[t],n=Number(r);if(!Number.isNaN(n))return n*1e3;var a=new Date(r);return a.getTime()-Date.now()}}},SF=function(e){return e instanceof Error?e:e instanceof Object?Object.assign(new Error,e):typeof e=="string"?new Error(e):new Error("AWS SDK error wrapper for ".concat(e))},TF=function(e){Di(t,e);function t(r,n){var a=this,l=n??{},f=l.rateLimiter,u=ZT(l,["rateLimiter"]);return a=e.call(this,r,u)||this,a.rateLimiter=f??new iF,a.mode=jh.ADAPTIVE,a}return t.prototype.retry=function(r,n){return Yt(this,void 0,void 0,function(){var a=this;return Xt(this,function(l){return[2,e.prototype.retry.call(this,r,n,{beforeRequest:function(){return Yt(a,void 0,void 0,function(){return Xt(this,function(f){return[2,this.rateLimiter.getSendToken()]})})},afterRequest:function(f){a.rateLimiter.updateClientSendingRate(f)}})]})})},t}(nC),CF=function(e){var t,r=Jl((t=e.maxAttempts)!==null&&t!==void 0?t:yx);return De(De({},e),{maxAttempts:r,retryStrategy:function(){return Yt(void 0,void 0,void 0,function(){var n;return Xt(this,function(a){switch(a.label){case 0:return e.retryStrategy?[2,e.retryStrategy]:[4,Jl(e.retryMode)()];case 1:return n=a.sent(),n===jh.ADAPTIVE?[2,new TF(r)]:[2,new nC(r)]}})})}})},IF=function(e){return function(t,r){return function(n){return Yt(void 0,void 0,void 0,function(){var a;return Xt(this,function(l){switch(l.label){case 0:return[4,e.retryStrategy()];case 1:return a=l.sent(),a!=null&&a.mode&&(r.userAgent=Pa(Pa([],Bi(r.userAgent||[]),!1),[["cfg/retry-mode",a.mode]],!1)),[2,a.retry(t,n)]}})})}}},PF={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},AF=function(e){return{applyToStack:function(t){t.add(IF(e),PF)}}},B_=function(e,t){return B_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},B_(e,t)};function _x(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");B_(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function bv(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})}function wv(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var iC=function(e){_x(t,e);function t(r,n){n===void 0&&(n=!0);var a=e.call(this,r)||this;return a.tryNextLink=n,a.name="ProviderError",Object.setPrototypeOf(a,t.prototype),a}return t.from=function(r,n){return n===void 0&&(n=!0),Object.assign(new this(r.message,n),r)},t}(Error);(function(e){_x(t,e);function t(r,n){n===void 0&&(n=!0);var a=e.call(this,r,n)||this;return a.tryNextLink=n,a.name="CredentialsProviderError",Object.setPrototypeOf(a,t.prototype),a}return t})(iC);(function(e){_x(t,e);function t(r,n){n===void 0&&(n=!0);var a=e.call(this,r,n)||this;return a.tryNextLink=n,a.name="TokenProviderError",Object.setPrototypeOf(a,t.prototype),a}return t})(iC);var oC=function(e,t,r){var n,a,l,f=!1,u=function(){return bv(void 0,void 0,void 0,function(){return wv(this,function(E){switch(E.label){case 0:a||(a=e()),E.label=1;case 1:return E.trys.push([1,,3,4]),[4,a];case 2:return n=E.sent(),l=!0,f=!1,[3,4];case 3:return a=void 0,[7];case 4:return[2,n]}})})};return t===void 0?function(E){return bv(void 0,void 0,void 0,function(){return wv(this,function(m){switch(m.label){case 0:return!l||E!=null&&E.forceRefresh?[4,u()]:[3,2];case 1:n=m.sent(),m.label=2;case 2:return[2,n]}})})}:function(E){return bv(void 0,void 0,void 0,function(){return wv(this,function(m){switch(m.label){case 0:return!l||E!=null&&E.forceRefresh?[4,u()]:[3,2];case 1:n=m.sent(),m.label=2;case 2:return f?[2,n]:r&&!r(n)?(f=!0,[2,n]):t(n)?[4,u()]:[3,4];case 3:return m.sent(),[2,n];case 4:return[2,n]}})})}},Hl=function(){return Hl=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Hl.apply(this,arguments)};function MF(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Bl(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})}function Ul(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}function rc(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function kF(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l}function LF(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return e.concat(l||Array.prototype.slice.call(t))}var sC={};for(var Np=0;Np<256;Np++){var Bp=Np.toString(16).toLowerCase();Bp.length===1&&(Bp="0".concat(Bp)),sC[Np]=Bp}function bh(e){for(var t="",r=0;r<e.byteLength;r++)t+=sC[e[r]];return t}var RF="X-Amz-Algorithm",OF="X-Amz-Credential",aC="X-Amz-Date",DF="X-Amz-SignedHeaders",zF="X-Amz-Expires",lC="X-Amz-Signature",uC="X-Amz-Security-Token",cC="authorization",hC=aC.toLowerCase(),FF="date",NF=[cC,hC,FF],BF=lC.toLowerCase(),U_="x-amz-content-sha256",UF=uC.toLowerCase(),jF={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},$F=/^proxy-/,VF=/^sec-/,Ev="AWS4-HMAC-SHA256",GF="AWS4-HMAC-SHA256-PAYLOAD",qF="UNSIGNED-PAYLOAD",HF=50,dC="aws4_request",ZF=60*60*24*7,Up={},Sv=[],Tv=function(e,t,r){return"".concat(e,"/").concat(t,"/").concat(r,"/").concat(dC)},WF=function(e,t,r,n,a){return Bl(void 0,void 0,void 0,function(){var l,f,u,E,m,S,M,z,H;return Ul(this,function(q){switch(q.label){case 0:return[4,aE(e,t.secretAccessKey,t.accessKeyId)];case 1:if(l=q.sent(),f="".concat(r,":").concat(n,":").concat(a,":").concat(bh(l),":").concat(t.sessionToken),f in Up)return[2,Up[f]];for(Sv.push(f);Sv.length>HF;)delete Up[Sv.shift()];u="AWS4".concat(t.secretAccessKey),q.label=2;case 2:q.trys.push([2,7,8,9]),E=rc([r,n,a,dC]),m=E.next(),q.label=3;case 3:return m.done?[3,6]:(S=m.value,[4,aE(e,u,S)]);case 4:u=q.sent(),q.label=5;case 5:return m=E.next(),[3,3];case 6:return[3,9];case 7:return M=q.sent(),z={error:M},[3,9];case 8:try{m&&!m.done&&(H=E.return)&&H.call(E)}finally{if(z)throw z.error}return[7];case 9:return[2,Up[f]=u]}})})},aE=function(e,t,r){var n=new e(t);return n.update(r),n.digest()},lE=function(e,t,r){var n,a,l=e.headers,f={};try{for(var u=rc(Object.keys(l).sort()),E=u.next();!E.done;E=u.next()){var m=E.value;if(l[m]!=null){var S=m.toLowerCase();(S in jF||t!=null&&t.has(S)||$F.test(S)||VF.test(S))&&(!r||r&&!r.has(S))||(f[S]=l[m].trim().replace(/\s+/g," "))}}}catch(M){n={error:M}}finally{try{E&&!E.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}return f},Sc=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,KF)},KF=function(e){return"%".concat(e.charCodeAt(0).toString(16).toUpperCase())},XF=function(e){var t,r,n=e.query,a=n===void 0?{}:n,l=[],f={},u=function(M){if(M.toLowerCase()===BF)return"continue";l.push(M);var z=a[M];typeof z=="string"?f[M]="".concat(Sc(M),"=").concat(Sc(z)):Array.isArray(z)&&(f[M]=z.slice(0).sort().reduce(function(H,q){return H.concat(["".concat(Sc(M),"=").concat(Sc(q))])},[]).join("&"))};try{for(var E=rc(Object.keys(a).sort()),m=E.next();!m.done;m=E.next()){var S=m.value;u(S)}}catch(M){t={error:M}}finally{try{m&&!m.done&&(r=E.return)&&r.call(E)}finally{if(t)throw t.error}}return l.map(function(M){return f[M]}).filter(function(M){return M}).join("&")},JF=function(e){return typeof ArrayBuffer=="function"&&e instanceof ArrayBuffer||Object.prototype.toString.call(e)==="[object ArrayBuffer]"},Cv=function(e,t){var r=e.headers,n=e.body;return Bl(void 0,void 0,void 0,function(){var a,l,f,u,E,m,S;return Ul(this,function(M){switch(M.label){case 0:try{for(a=rc(Object.keys(r)),l=a.next();!l.done;l=a.next())if(f=l.value,f.toLowerCase()===U_)return[2,r[f]]}catch(z){m={error:z}}finally{try{l&&!l.done&&(S=a.return)&&S.call(a)}finally{if(m)throw m.error}}return n!=null?[3,1]:[2,"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"];case 1:return typeof n=="string"||ArrayBuffer.isView(n)||JF(n)?(u=new t,u.update(n),E=bh,[4,u.digest()]):[3,3];case 2:return[2,E.apply(void 0,[M.sent()])];case 3:return[2,qF]}})})},YF=function(e,t){var r,n;e=e.toLowerCase();try{for(var a=rc(Object.keys(t)),l=a.next();!l.done;l=a.next()){var f=l.value;if(e===f.toLowerCase())return!0}}catch(u){r={error:u}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return!1},fC=function(e){var t=e.headers,r=e.query,n=MF(e,["headers","query"]);return Hl(Hl({},n),{headers:Hl({},t),query:r?QF(r):void 0})},QF=function(e){return Object.keys(e).reduce(function(t,r){var n,a=e[r];return Hl(Hl({},t),(n={},n[r]=Array.isArray(a)?LF([],kF(a),!1):a,n))},{})},e4=function(e,t){var r,n,a;t===void 0&&(t={});var l=typeof e.clone=="function"?e.clone():fC(e),f=l.headers,u=l.query,E=u===void 0?{}:u;try{for(var m=rc(Object.keys(f)),S=m.next();!S.done;S=m.next()){var M=S.value,z=M.toLowerCase();z.slice(0,6)==="x-amz-"&&!(!((a=t.unhoistableHeaders)===null||a===void 0)&&a.has(z))&&(E[M]=f[M],delete f[M])}}catch(H){r={error:H}}finally{try{S&&!S.done&&(n=m.return)&&n.call(m)}finally{if(r)throw r.error}}return Hl(Hl({},e),{headers:f,query:E})},uE=function(e){var t,r;e=typeof e.clone=="function"?e.clone():fC(e);try{for(var n=rc(Object.keys(e.headers)),a=n.next();!a.done;a=n.next()){var l=a.value;NF.indexOf(l.toLowerCase())>-1&&delete e.headers[l]}}catch(f){t={error:f}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return e},t4=function(e){return r4(e).toISOString().replace(/\.\d{3}Z$/,"Z")},r4=function(e){return typeof e=="number"?new Date(e*1e3):typeof e=="string"?Number(e)?new Date(Number(e)*1e3):new Date(e):e},cE=function(){function e(t){var r=t.applyChecksum,n=t.credentials,a=t.region,l=t.service,f=t.sha256,u=t.uriEscapePath,E=u===void 0?!0:u;this.service=l,this.sha256=f,this.uriEscapePath=E,this.applyChecksum=typeof r=="boolean"?r:!0,this.regionProvider=Jl(a),this.credentialProvider=Jl(n)}return e.prototype.presign=function(t,r){return r===void 0&&(r={}),Bl(this,void 0,void 0,function(){var n,a,l,f,u,E,m,S,M,z,H,q,Y,ye,Q,te,ne,Me,Ve,je,Qe,ot,Ut,st;return Ul(this,function(Qt){switch(Qt.label){case 0:return n=r.signingDate,a=n===void 0?new Date:n,l=r.expiresIn,f=l===void 0?3600:l,u=r.unsignableHeaders,E=r.unhoistableHeaders,m=r.signableHeaders,S=r.signingRegion,M=r.signingService,[4,this.credentialProvider()];case 1:return z=Qt.sent(),this.validateResolvedCredentials(z),S==null?[3,2]:(q=S,[3,4]);case 2:return[4,this.regionProvider()];case 3:q=Qt.sent(),Qt.label=4;case 4:return H=q,Y=jp(a),ye=Y.longDate,Q=Y.shortDate,f>ZF?[2,Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future")]:(te=Tv(Q,H,M??this.service),ne=e4(uE(t),{unhoistableHeaders:E}),z.sessionToken&&(ne.query[uC]=z.sessionToken),ne.query[RF]=Ev,ne.query[OF]="".concat(z.accessKeyId,"/").concat(te),ne.query[aC]=ye,ne.query[zF]=f.toString(10),Me=lE(ne,u,m),ne.query[DF]=hE(Me),Ve=ne.query,je=lC,Qe=this.getSignature,ot=[ye,te,this.getSigningKey(z,H,Q,M)],Ut=this.createCanonicalRequest,st=[ne,Me],[4,Cv(t,this.sha256)]);case 5:return[4,Qe.apply(this,ot.concat([Ut.apply(this,st.concat([Qt.sent()]))]))];case 6:return Ve[je]=Qt.sent(),[2,ne]}})})},e.prototype.sign=function(t,r){return Bl(this,void 0,void 0,function(){return Ul(this,function(n){return typeof t=="string"?[2,this.signString(t,r)]:t.headers&&t.payload?[2,this.signEvent(t,r)]:[2,this.signRequest(t,r)]})})},e.prototype.signEvent=function(t,r){var n=t.headers,a=t.payload,l=r.signingDate,f=l===void 0?new Date:l,u=r.priorSignature,E=r.signingRegion,m=r.signingService;return Bl(this,void 0,void 0,function(){var S,M,z,H,q,Y,ye,Q,te,ne,Me;return Ul(this,function(Ve){switch(Ve.label){case 0:return E==null?[3,1]:(M=E,[3,3]);case 1:return[4,this.regionProvider()];case 2:M=Ve.sent(),Ve.label=3;case 3:return S=M,z=jp(f),H=z.shortDate,q=z.longDate,Y=Tv(H,S,m??this.service),[4,Cv({headers:{},body:a},this.sha256)];case 4:return ye=Ve.sent(),Q=new this.sha256,Q.update(n),ne=bh,[4,Q.digest()];case 5:return te=ne.apply(void 0,[Ve.sent()]),Me=[GF,q,Y,u,te,ye].join(`
`),[2,this.signString(Me,{signingDate:f,signingRegion:S,signingService:m})]}})})},e.prototype.signString=function(t,r){var n=r===void 0?{}:r,a=n.signingDate,l=a===void 0?new Date:a,f=n.signingRegion,u=n.signingService;return Bl(this,void 0,void 0,function(){var E,m,S,M,z,H,q,Y;return Ul(this,function(ye){switch(ye.label){case 0:return[4,this.credentialProvider()];case 1:return E=ye.sent(),this.validateResolvedCredentials(E),f==null?[3,2]:(S=f,[3,4]);case 2:return[4,this.regionProvider()];case 3:S=ye.sent(),ye.label=4;case 4:return m=S,M=jp(l).shortDate,q=(H=this.sha256).bind,[4,this.getSigningKey(E,m,M,u)];case 5:return z=new(q.apply(H,[void 0,ye.sent()])),z.update(t),Y=bh,[4,z.digest()];case 6:return[2,Y.apply(void 0,[ye.sent()])]}})})},e.prototype.signRequest=function(t,r){var n=r===void 0?{}:r,a=n.signingDate,l=a===void 0?new Date:a,f=n.signableHeaders,u=n.unsignableHeaders,E=n.signingRegion,m=n.signingService;return Bl(this,void 0,void 0,function(){var S,M,z,H,q,Y,ye,Q,te,ne,Me;return Ul(this,function(Ve){switch(Ve.label){case 0:return[4,this.credentialProvider()];case 1:return S=Ve.sent(),this.validateResolvedCredentials(S),E==null?[3,2]:(z=E,[3,4]);case 2:return[4,this.regionProvider()];case 3:z=Ve.sent(),Ve.label=4;case 4:return M=z,H=uE(t),q=jp(l),Y=q.longDate,ye=q.shortDate,Q=Tv(ye,M,m??this.service),H.headers[hC]=Y,S.sessionToken&&(H.headers[UF]=S.sessionToken),[4,Cv(H,this.sha256)];case 5:return te=Ve.sent(),!YF(U_,H.headers)&&this.applyChecksum&&(H.headers[U_]=te),ne=lE(H,u,f),[4,this.getSignature(Y,Q,this.getSigningKey(S,M,ye,m),this.createCanonicalRequest(H,ne,te))];case 6:return Me=Ve.sent(),H.headers[cC]="".concat(Ev," ")+"Credential=".concat(S.accessKeyId,"/").concat(Q,", ")+"SignedHeaders=".concat(hE(ne),", ")+"Signature=".concat(Me),[2,H]}})})},e.prototype.createCanonicalRequest=function(t,r,n){var a=Object.keys(r).sort();return"".concat(t.method,`
`).concat(this.getCanonicalPath(t),`
`).concat(XF(t),`
`).concat(a.map(function(l){return"".concat(l,":").concat(r[l])}).join(`
`),`

`).concat(a.join(";"),`
`).concat(n)},e.prototype.createStringToSign=function(t,r,n){return Bl(this,void 0,void 0,function(){var a,l;return Ul(this,function(f){switch(f.label){case 0:return a=new this.sha256,a.update(n),[4,a.digest()];case 1:return l=f.sent(),[2,"".concat(Ev,`
`).concat(t,`
`).concat(r,`
`).concat(bh(l))]}})})},e.prototype.getCanonicalPath=function(t){var r,n,a=t.path;if(this.uriEscapePath){var l=[];try{for(var f=rc(a.split("/")),u=f.next();!u.done;u=f.next()){var E=u.value;(E==null?void 0:E.length)!==0&&E!=="."&&(E===".."?l.pop():l.push(E))}}catch(M){r={error:M}}finally{try{u&&!u.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}var m="".concat(a!=null&&a.startsWith("/")?"/":"").concat(l.join("/")).concat(l.length>0&&(a!=null&&a.endsWith("/"))?"/":""),S=encodeURIComponent(m);return S.replace(/%2F/g,"/")}return a},e.prototype.getSignature=function(t,r,n,a){return Bl(this,void 0,void 0,function(){var l,f,u,E,m;return Ul(this,function(S){switch(S.label){case 0:return[4,this.createStringToSign(t,r,a)];case 1:return l=S.sent(),E=(u=this.sha256).bind,[4,n];case 2:return f=new(E.apply(u,[void 0,S.sent()])),f.update(l),m=bh,[4,f.digest()];case 3:return[2,m.apply(void 0,[S.sent()])]}})})},e.prototype.getSigningKey=function(t,r,n,a){return WF(this.sha256,t,n,r,a||this.service)},e.prototype.validateResolvedCredentials=function(t){if(typeof t!="object"||typeof t.accessKeyId!="string"||typeof t.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")},e}(),jp=function(e){var t=t4(e).replace(/[\-:]/g,"");return{longDate:t,shortDate:t.slice(0,8)}},hE=function(e){return Object.keys(e).sort().join(";")},n4=3e5,i4=function(e){var t=e.credentials?o4(e.credentials):e.credentialDefaultProvider(e),r=e.signingEscapePath,n=r===void 0?!0:r,a=e.systemClockOffset,l=a===void 0?e.systemClockOffset||0:a,f=e.sha256,u;return e.signer?u=Jl(e.signer):e.regionInfoProvider?u=function(){return Jl(e.region)().then(function(E){return Yt(void 0,void 0,void 0,function(){var m,S,M,z;return Xt(this,function(H){switch(H.label){case 0:return S=(m=e).regionInfoProvider,M=[E],z={},[4,e.useFipsEndpoint()];case 1:return z.useFipsEndpoint=H.sent(),[4,e.useDualstackEndpoint()];case 2:return[4,S.apply(m,M.concat([(z.useDualstackEndpoint=H.sent(),z)]))];case 3:return[2,[H.sent()||{},E]]}})})}).then(function(E){var m=Bi(E,2),S=m[0],M=m[1],z=S.signingRegion,H=S.signingService;e.signingRegion=e.signingRegion||z||M,e.signingName=e.signingName||H||e.serviceId;var q=De(De({},e),{credentials:t,region:e.signingRegion,service:e.signingName,sha256:f,uriEscapePath:n}),Y=e.signerConstructor||cE;return new Y(q)})}:u=function(E){return Yt(void 0,void 0,void 0,function(){var m,S,M,z;return Xt(this,function(H){if(!E)throw new Error("Unexpected empty auth scheme config");return m=E.signingScope,S=E.signingName,e.signingRegion=e.signingRegion||m,e.signingName=e.signingName||S||e.serviceId,M=De(De({},e),{credentials:t,region:e.signingRegion,service:e.signingName,sha256:f,uriEscapePath:n}),z=e.signerConstructor||cE,[2,new z(M)]})})},De(De({},e),{systemClockOffset:l,signingEscapePath:n,credentials:t,signer:u})},o4=function(e){return typeof e=="function"?oC(e,function(t){return t.expiration!==void 0&&t.expiration.getTime()-Date.now()<n4},function(t){return t.expiration!==void 0}):Jl(e)},pC=function(e){return new Date(Date.now()+e)},s4=function(e,t){return Math.abs(pC(t).getTime()-e)>=3e5},dE=function(e,t){var r=Date.parse(e);return s4(r,t)?r-Date.now():t},a4=function(e){return function(t,r){return function(n){var a,l,f;return Yt(this,void 0,void 0,function(){var u,E,m,S,M,z,H;return Xt(this,function(q){switch(q.label){case 0:return Ps.isInstance(n.request)?(u=(f=(l=(a=r.endpointV2)===null||a===void 0?void 0:a.properties)===null||l===void 0?void 0:l.authSchemes)===null||f===void 0?void 0:f[0],[4,e.signer(u)]):[2,t(n)];case 1:return E=q.sent(),S=t,M=[De({},n)],H={},[4,E.sign(n.request,{signingDate:pC(e.systemClockOffset),signingRegion:r.signing_region,signingService:r.signing_service})];case 2:return[4,S.apply(void 0,[De.apply(void 0,M.concat([(H.request=q.sent(),H)]))]).catch(function(Y){var ye,Q=(ye=Y.ServerTime)!==null&&ye!==void 0?ye:fE(Y.$response);throw Q&&(e.systemClockOffset=dE(Q,e.systemClockOffset)),Y})];case 3:return m=q.sent(),z=fE(m.response),z&&(e.systemClockOffset=dE(z,e.systemClockOffset)),[2,m]}})})}}},fE=function(e){var t,r,n;return Zm.isInstance(e)?(r=(t=e.headers)===null||t===void 0?void 0:t.date)!==null&&r!==void 0?r:(n=e.headers)===null||n===void 0?void 0:n.Date:void 0},l4={name:"awsAuthMiddleware",tags:["SIGNATURE","AWSAUTH"],relation:"after",toMiddleware:"retryMiddleware",override:!0},u4=function(e){return{applyToStack:function(t){t.addRelativeTo(a4(e),l4)}}};function c4(e){return De(De({},e),{customUserAgent:typeof e.customUserAgent=="string"?[[e.customUserAgent]]:e.customUserAgent})}var pE="user-agent",Iv="x-amz-user-agent",mE=" ",h4=/[^\!\#\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,d4=function(e){return function(t,r){return function(n){return Yt(void 0,void 0,void 0,function(){var a,l,f,u,E,m,S,M,z;return Xt(this,function(H){switch(H.label){case 0:return a=n.request,Ps.isInstance(a)?(l=a.headers,f=((M=r==null?void 0:r.userAgent)===null||M===void 0?void 0:M.map(Pv))||[],[4,e.defaultUserAgentProvider()]):[2,t(n)];case 1:return u=H.sent().map(Pv),E=((z=e==null?void 0:e.customUserAgent)===null||z===void 0?void 0:z.map(Pv))||[],m=Pa(Pa(Pa([],Bi(u),!1),Bi(f),!1),Bi(E),!1).join(mE),S=Pa(Pa([],Bi(u.filter(function(q){return q.startsWith("aws-sdk-")})),!1),Bi(E),!1).join(mE),e.runtime!=="browser"?(S&&(l[Iv]=l[Iv]?"".concat(l[pE]," ").concat(S):S),l[pE]=m):l[Iv]=m,[2,t(De(De({},n),{request:a}))]}})})}}},Pv=function(e){var t=Bi(e,2),r=t[0],n=t[1],a=r.indexOf("/"),l=r.substring(0,a),f=r.substring(a+1);return l==="api"&&(f=f.toLowerCase()),[l,f,n].filter(function(u){return u&&u.length>0}).map(function(u){return u==null?void 0:u.replace(h4,"_")}).join("/")},f4={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},p4=function(e){return{applyToStack:function(t){t.add(d4(e),f4)}}};const m4="@aws-sdk/client-location",g4="AWS SDK for JavaScript Location Client for Node.js, Browser and React Native",y4="3.186.3",v4={build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"tsc -p tsconfig.cjs.json","build:docs":"typedoc","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo"},_4="./dist-cjs/index.js",x4="./dist-types/index.d.ts",b4="./dist-es/index.js",w4=!1,E4={"@aws-crypto/sha256-browser":"2.0.0","@aws-crypto/sha256-js":"2.0.0","@aws-sdk/client-sts":"3.186.3","@aws-sdk/config-resolver":"3.186.0","@aws-sdk/credential-provider-node":"3.186.0","@aws-sdk/fetch-http-handler":"3.186.0","@aws-sdk/hash-node":"3.186.0","@aws-sdk/invalid-dependency":"3.186.0","@aws-sdk/middleware-content-length":"3.186.0","@aws-sdk/middleware-host-header":"3.186.0","@aws-sdk/middleware-logger":"3.186.0","@aws-sdk/middleware-recursion-detection":"3.186.0","@aws-sdk/middleware-retry":"3.186.0","@aws-sdk/middleware-serde":"3.186.0","@aws-sdk/middleware-signing":"3.186.0","@aws-sdk/middleware-stack":"3.186.0","@aws-sdk/middleware-user-agent":"3.186.0","@aws-sdk/node-config-provider":"3.186.0","@aws-sdk/node-http-handler":"3.186.0","@aws-sdk/protocol-http":"3.186.0","@aws-sdk/smithy-client":"3.186.0","@aws-sdk/types":"3.186.0","@aws-sdk/url-parser":"3.186.0","@aws-sdk/util-base64-browser":"3.186.0","@aws-sdk/util-base64-node":"3.186.0","@aws-sdk/util-body-length-browser":"3.186.0","@aws-sdk/util-body-length-node":"3.186.0","@aws-sdk/util-defaults-mode-browser":"3.186.0","@aws-sdk/util-defaults-mode-node":"3.186.0","@aws-sdk/util-user-agent-browser":"3.186.0","@aws-sdk/util-user-agent-node":"3.186.0","@aws-sdk/util-utf8-browser":"3.186.0","@aws-sdk/util-utf8-node":"3.186.0",tslib:"^2.3.1"},S4={"@aws-sdk/service-client-documentation-generator":"3.186.0","@tsconfig/recommended":"1.0.1","@types/node":"^12.7.5",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typedoc:"0.19.2",typescript:"~4.6.2"},T4={typedoc:{typescript:"~4.6.2"}},C4={node:">=12.0.0"},I4={"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},P4=["dist-*"],A4={name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},M4="Apache-2.0",k4={"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},L4="https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-location",R4={type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-location"},O4={name:m4,description:g4,version:y4,scripts:v4,main:_4,types:x4,module:b4,sideEffects:w4,dependencies:E4,devDependencies:S4,overrides:T4,engines:C4,typesVersions:I4,files:P4,author:A4,license:M4,browser:k4,"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:L4,repository:R4};var mC={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var j_=function(e,t){return j_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},j_(e,t)};function D4(e,t){j_(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var $_=function(){return $_=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},$_.apply(this,arguments)};function z4(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function F4(e,t,r,n){var a=arguments.length,l=a<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(f=e[u])&&(l=(a<3?f(l):a>3?f(t,r,l):f(t,r))||l);return a>3&&l&&Object.defineProperty(t,r,l),l}function N4(e,t){return function(r,n){t(r,n,e)}}function B4(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function U4(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})}function j4(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}function $4(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function V4(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function V_(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function gC(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l}function G4(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(gC(arguments[t]));return e}function q4(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var l=arguments[t],f=0,u=l.length;f<u;f++,a++)n[a]=l[f];return n}function If(e){return this instanceof If?(this.v=e,this):new If(e)}function H4(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),a,l=[];return a={},f("next"),f("throw"),f("return"),a[Symbol.asyncIterator]=function(){return this},a;function f(z){n[z]&&(a[z]=function(H){return new Promise(function(q,Y){l.push([z,H,q,Y])>1||u(z,H)})})}function u(z,H){try{E(n[z](H))}catch(q){M(l[0][3],q)}}function E(z){z.value instanceof If?Promise.resolve(z.value.v).then(m,S):M(l[0][2],z)}function m(z){u("next",z)}function S(z){u("throw",z)}function M(z,H){z(H),l.shift(),l.length&&u(l[0][0],l[0][1])}}function Z4(e){var t,r;return t={},n("next"),n("throw",function(a){throw a}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(a,l){t[a]=e[a]?function(f){return(r=!r)?{value:If(e[a](f)),done:a==="return"}:l?l(f):f}:l}}function W4(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof V_=="function"?V_(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(l){r[l]=e[l]&&function(f){return new Promise(function(u,E){f=e[l](f),a(u,E,f.done,f.value)})}}function a(l,f,u,E){Promise.resolve(E).then(function(m){l({value:m,done:u})},f)}}function K4(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function X4(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function J4(e){return e&&e.__esModule?e:{default:e}}function Y4(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function Q4(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}const e5=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return $_},__asyncDelegator:Z4,__asyncGenerator:H4,__asyncValues:W4,__await:If,__awaiter:U4,__classPrivateFieldGet:Y4,__classPrivateFieldSet:Q4,__createBinding:$4,__decorate:F4,__exportStar:V4,__extends:D4,__generator:j4,__importDefault:J4,__importStar:X4,__makeTemplateObject:K4,__metadata:B4,__param:N4,__read:gC,__rest:z4,__spread:G4,__spreadArrays:q4,__values:V_},Symbol.toStringTag,{value:"Module"})),xx=na(e5);var Rg={},Bf={},Og={};Object.defineProperty(Og,"__esModule",{value:!0});Og.isEmptyData=void 0;function t5(e){return typeof e=="string"?e.length===0:e.byteLength===0}Og.isEmptyData=t5;var bx={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.EMPTY_DATA_SHA_256=e.SHA_256_HMAC_ALGO=e.SHA_256_HASH=void 0,e.SHA_256_HASH={name:"SHA-256"},e.SHA_256_HMAC_ALGO={name:"HMAC",hash:e.SHA_256_HASH},e.EMPTY_DATA_SHA_256=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85])})(bx);const r5=e=>{const t=[];for(let r=0,n=e.length;r<n;r++){const a=e.charCodeAt(r);if(a<128)t.push(a);else if(a<2048)t.push(a>>6|192,a&63|128);else if(r+1<e.length&&(a&64512)===55296&&(e.charCodeAt(r+1)&64512)===56320){const l=65536+((a&1023)<<10)+(e.charCodeAt(++r)&1023);t.push(l>>18|240,l>>12&63|128,l>>6&63|128,l&63|128)}else t.push(a>>12|224,a>>6&63|128,a&63|128)}return Uint8Array.from(t)},n5=e=>{let t="";for(let r=0,n=e.length;r<n;r++){const a=e[r];if(a<128)t+=String.fromCharCode(a);else if(192<=a&&a<224){const l=e[++r];t+=String.fromCharCode((a&31)<<6|l&63)}else if(240<=a&&a<365){const f="%"+[a,e[++r],e[++r],e[++r]].map(u=>u.toString(16)).join("%");t+=decodeURIComponent(f)}else t+=String.fromCharCode((a&15)<<12|(e[++r]&63)<<6|e[++r]&63)}return t};function i5(e){return new TextEncoder().encode(e)}function o5(e){return new TextDecoder("utf-8").decode(e)}const s5=e=>typeof TextEncoder=="function"?i5(e):r5(e),a5=e=>typeof TextDecoder=="function"?o5(e):n5(e),l5=Object.freeze(Object.defineProperty({__proto__:null,fromUtf8:s5,toUtf8:a5},Symbol.toStringTag,{value:"Module"})),u5=na(l5);Object.defineProperty(Bf,"__esModule",{value:!0});Bf.Sha256=void 0;var c5=Og,yC=bx,h5=u5,G_=ox,d5=function(){function e(t){t?(this.operation=f5(t).then(function(r){return(0,G_.locateWindow)().msCrypto.subtle.sign(yC.SHA_256_HMAC_ALGO,r)}),this.operation.catch(function(){})):this.operation=Promise.resolve((0,G_.locateWindow)().msCrypto.subtle.digest("SHA-256"))}return e.prototype.update=function(t){var r=this;(0,c5.isEmptyData)(t)||(this.operation=this.operation.then(function(n){return n.onerror=function(){r.operation=Promise.reject(new Error("Error encountered updating hash"))},n.process(vC(t)),n}),this.operation.catch(function(){}))},e.prototype.digest=function(){return this.operation.then(function(t){return new Promise(function(r,n){t.onerror=function(){n(new Error("Error encountered finalizing hash"))},t.oncomplete=function(){t.result&&r(new Uint8Array(t.result)),n(new Error("Error encountered finalizing hash"))},t.finish()})})},e}();Bf.Sha256=d5;function f5(e){return new Promise(function(t,r){var n=(0,G_.locateWindow)().msCrypto.subtle.importKey("raw",vC(e),yC.SHA_256_HMAC_ALGO,!1,["sign"]);n.oncomplete=function(){n.result&&t(n.result),r(new Error("ImportKey completed without importing key."))},n.onerror=function(){r(new Error("ImportKey failed to import key."))}})}function vC(e){return typeof e=="string"?(0,h5.fromUtf8)(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}var Uf={},wx={},Dg={};const p5=e=>{const t=[];for(let r=0,n=e.length;r<n;r++){const a=e.charCodeAt(r);if(a<128)t.push(a);else if(a<2048)t.push(a>>6|192,a&63|128);else if(r+1<e.length&&(a&64512)===55296&&(e.charCodeAt(r+1)&64512)===56320){const l=65536+((a&1023)<<10)+(e.charCodeAt(++r)&1023);t.push(l>>18|240,l>>12&63|128,l>>6&63|128,l&63|128)}else t.push(a>>12|224,a>>6&63|128,a&63|128)}return Uint8Array.from(t)},m5=e=>{let t="";for(let r=0,n=e.length;r<n;r++){const a=e[r];if(a<128)t+=String.fromCharCode(a);else if(192<=a&&a<224){const l=e[++r];t+=String.fromCharCode((a&31)<<6|l&63)}else if(240<=a&&a<365){const f="%"+[a,e[++r],e[++r],e[++r]].map(u=>u.toString(16)).join("%");t+=decodeURIComponent(f)}else t+=String.fromCharCode((a&15)<<12|(e[++r]&63)<<6|e[++r]&63)}return t};function g5(e){return new TextEncoder().encode(e)}function y5(e){return new TextDecoder("utf-8").decode(e)}const v5=e=>typeof TextEncoder=="function"?g5(e):p5(e),_5=e=>typeof TextDecoder=="function"?y5(e):m5(e),x5=Object.freeze(Object.defineProperty({__proto__:null,fromUtf8:v5,toUtf8:_5},Symbol.toStringTag,{value:"Module"})),b5=na(x5);Object.defineProperty(Dg,"__esModule",{value:!0});Dg.convertToBuffer=void 0;var w5=b5,E5=typeof Buffer<"u"&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:w5.fromUtf8;function S5(e){return e instanceof Uint8Array?e:typeof e=="string"?E5(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}Dg.convertToBuffer=S5;var zg={};Object.defineProperty(zg,"__esModule",{value:!0});zg.isEmptyData=void 0;function T5(e){return typeof e=="string"?e.length===0:e.byteLength===0}zg.isEmptyData=T5;var Fg={};Object.defineProperty(Fg,"__esModule",{value:!0});Fg.numToUint8=void 0;function C5(e){return new Uint8Array([(e&4278190080)>>24,(e&16711680)>>16,(e&65280)>>8,e&255])}Fg.numToUint8=C5;var Ng={};Object.defineProperty(Ng,"__esModule",{value:!0});Ng.uint32ArrayFrom=void 0;function I5(e){if(!Uint32Array.from){for(var t=new Uint32Array(e.length),r=0;r<e.length;)t[r]=e[r],r+=1;return t}return Uint32Array.from(e)}Ng.uint32ArrayFrom=I5;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.uint32ArrayFrom=e.numToUint8=e.isEmptyData=e.convertToBuffer=void 0;var t=Dg;Object.defineProperty(e,"convertToBuffer",{enumerable:!0,get:function(){return t.convertToBuffer}});var r=zg;Object.defineProperty(e,"isEmptyData",{enumerable:!0,get:function(){return r.isEmptyData}});var n=Fg;Object.defineProperty(e,"numToUint8",{enumerable:!0,get:function(){return n.numToUint8}});var a=Ng;Object.defineProperty(e,"uint32ArrayFrom",{enumerable:!0,get:function(){return a.uint32ArrayFrom}})})(wx);Object.defineProperty(Uf,"__esModule",{value:!0});Uf.Sha256=void 0;var $p=wx,Vp=bx,Av=ox,P5=function(){function e(t){this.toHash=new Uint8Array(0),t!==void 0&&(this.key=new Promise(function(r,n){(0,Av.locateWindow)().crypto.subtle.importKey("raw",(0,$p.convertToBuffer)(t),Vp.SHA_256_HMAC_ALGO,!1,["sign"]).then(r,n)}),this.key.catch(function(){}))}return e.prototype.update=function(t){if(!(0,$p.isEmptyData)(t)){var r=(0,$p.convertToBuffer)(t),n=new Uint8Array(this.toHash.byteLength+r.byteLength);n.set(this.toHash,0),n.set(r,this.toHash.byteLength),this.toHash=n}},e.prototype.digest=function(){var t=this;return this.key?this.key.then(function(r){return(0,Av.locateWindow)().crypto.subtle.sign(Vp.SHA_256_HMAC_ALGO,r,t.toHash).then(function(n){return new Uint8Array(n)})}):(0,$p.isEmptyData)(this.toHash)?Promise.resolve(Vp.EMPTY_DATA_SHA_256):Promise.resolve().then(function(){return(0,Av.locateWindow)().crypto.subtle.digest(Vp.SHA_256_HASH,t.toHash)}).then(function(r){return Promise.resolve(new Uint8Array(r))})},e}();Uf.Sha256=P5;var _C={},Od={},Xs={},gE;function xC(){return gE||(gE=1,Object.defineProperty(Xs,"__esModule",{value:!0}),Xs.MAX_HASHABLE_LENGTH=Xs.INIT=Xs.KEY=Xs.DIGEST_LENGTH=Xs.BLOCK_SIZE=void 0,Xs.BLOCK_SIZE=64,Xs.DIGEST_LENGTH=32,Xs.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Xs.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Xs.MAX_HASHABLE_LENGTH=Math.pow(2,53)-1),Xs}var Dd={},yE;function A5(){if(yE)return Dd;yE=1,Object.defineProperty(Dd,"__esModule",{value:!0}),Dd.RawSha256=void 0;var e=xC(),t=function(){function r(){this.state=Int32Array.from(e.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return r.prototype.update=function(n){if(this.finished)throw new Error("Attempted to update an already finished hash.");var a=0,l=n.byteLength;if(this.bytesHashed+=l,this.bytesHashed*8>e.MAX_HASHABLE_LENGTH)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;l>0;)this.buffer[this.bufferLength++]=n[a++],l--,this.bufferLength===e.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},r.prototype.digest=function(){if(!this.finished){var n=this.bytesHashed*8,a=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),l=this.bufferLength;if(a.setUint8(this.bufferLength++,128),l%e.BLOCK_SIZE>=e.BLOCK_SIZE-8){for(var f=this.bufferLength;f<e.BLOCK_SIZE;f++)a.setUint8(f,0);this.hashBuffer(),this.bufferLength=0}for(var f=this.bufferLength;f<e.BLOCK_SIZE-8;f++)a.setUint8(f,0);a.setUint32(e.BLOCK_SIZE-8,Math.floor(n/4294967296),!0),a.setUint32(e.BLOCK_SIZE-4,n),this.hashBuffer(),this.finished=!0}for(var u=new Uint8Array(e.DIGEST_LENGTH),f=0;f<8;f++)u[f*4]=this.state[f]>>>24&255,u[f*4+1]=this.state[f]>>>16&255,u[f*4+2]=this.state[f]>>>8&255,u[f*4+3]=this.state[f]>>>0&255;return u},r.prototype.hashBuffer=function(){for(var n=this,a=n.buffer,l=n.state,f=l[0],u=l[1],E=l[2],m=l[3],S=l[4],M=l[5],z=l[6],H=l[7],q=0;q<e.BLOCK_SIZE;q++){if(q<16)this.temp[q]=(a[q*4]&255)<<24|(a[q*4+1]&255)<<16|(a[q*4+2]&255)<<8|a[q*4+3]&255;else{var Y=this.temp[q-2],ye=(Y>>>17|Y<<15)^(Y>>>19|Y<<13)^Y>>>10;Y=this.temp[q-15];var Q=(Y>>>7|Y<<25)^(Y>>>18|Y<<14)^Y>>>3;this.temp[q]=(ye+this.temp[q-7]|0)+(Q+this.temp[q-16]|0)}var te=(((S>>>6|S<<26)^(S>>>11|S<<21)^(S>>>25|S<<7))+(S&M^~S&z)|0)+(H+(e.KEY[q]+this.temp[q]|0)|0)|0,ne=((f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10))+(f&u^f&E^u&E)|0;H=z,z=M,M=S,S=m+te|0,m=E,E=u,u=f,f=te+ne|0}l[0]+=f,l[1]+=u,l[2]+=E,l[3]+=m,l[4]+=S,l[5]+=M,l[6]+=z,l[7]+=H},r}();return Dd.RawSha256=t,Dd}var vE;function M5(){if(vE)return Od;vE=1,Object.defineProperty(Od,"__esModule",{value:!0}),Od.Sha256=void 0;var e=xx,t=xC(),r=A5(),n=wx,a=function(){function f(u){if(this.hash=new r.RawSha256,u){this.outer=new r.RawSha256;var E=l(u),m=new Uint8Array(t.BLOCK_SIZE);m.set(E);for(var S=0;S<t.BLOCK_SIZE;S++)E[S]^=54,m[S]^=92;this.hash.update(E),this.outer.update(m);for(var S=0;S<E.byteLength;S++)E[S]=0}}return f.prototype.update=function(u){if(!((0,n.isEmptyData)(u)||this.error))try{this.hash.update((0,n.convertToBuffer)(u))}catch(E){this.error=E}},f.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},f.prototype.digest=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(u){return[2,this.digestSync()]})})},f}();Od.Sha256=a;function l(f){var u=(0,n.convertToBuffer)(f);if(u.byteLength>t.BLOCK_SIZE){var E=new r.RawSha256;E.update(u),u=E.digest()}var m=new Uint8Array(t.BLOCK_SIZE);return m.set(u),m}return Od}(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=xx;t.__exportStar(M5(),e)})(_C);var bC={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var q_=function(e,t){return q_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},q_(e,t)};function k5(e,t){q_(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var H_=function(){return H_=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},H_.apply(this,arguments)};function L5(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function R5(e,t,r,n){var a=arguments.length,l=a<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(f=e[u])&&(l=(a<3?f(l):a>3?f(t,r,l):f(t,r))||l);return a>3&&l&&Object.defineProperty(t,r,l),l}function O5(e,t){return function(r,n){t(r,n,e)}}function D5(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function z5(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})}function F5(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}function N5(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function B5(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function Z_(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function wC(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l}function U5(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(wC(arguments[t]));return e}function j5(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var l=arguments[t],f=0,u=l.length;f<u;f++,a++)n[a]=l[f];return n}function Pf(e){return this instanceof Pf?(this.v=e,this):new Pf(e)}function $5(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),a,l=[];return a={},f("next"),f("throw"),f("return"),a[Symbol.asyncIterator]=function(){return this},a;function f(z){n[z]&&(a[z]=function(H){return new Promise(function(q,Y){l.push([z,H,q,Y])>1||u(z,H)})})}function u(z,H){try{E(n[z](H))}catch(q){M(l[0][3],q)}}function E(z){z.value instanceof Pf?Promise.resolve(z.value.v).then(m,S):M(l[0][2],z)}function m(z){u("next",z)}function S(z){u("throw",z)}function M(z,H){z(H),l.shift(),l.length&&u(l[0][0],l[0][1])}}function V5(e){var t,r;return t={},n("next"),n("throw",function(a){throw a}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(a,l){t[a]=e[a]?function(f){return(r=!r)?{value:Pf(e[a](f)),done:a==="return"}:l?l(f):f}:l}}function G5(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Z_=="function"?Z_(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(l){r[l]=e[l]&&function(f){return new Promise(function(u,E){f=e[l](f),a(u,E,f.done,f.value)})}}function a(l,f,u,E){Promise.resolve(E).then(function(m){l({value:m,done:u})},f)}}function q5(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function H5(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function Z5(e){return e&&e.__esModule?e:{default:e}}function W5(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function K5(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}const X5=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return H_},__asyncDelegator:V5,__asyncGenerator:$5,__asyncValues:G5,__await:Pf,__awaiter:z5,__classPrivateFieldGet:W5,__classPrivateFieldSet:K5,__createBinding:N5,__decorate:R5,__exportStar:B5,__extends:k5,__generator:F5,__importDefault:Z5,__importStar:H5,__makeTemplateObject:q5,__metadata:D5,__param:O5,__read:wC,__rest:L5,__spread:U5,__spreadArrays:j5,__values:Z_},Symbol.toStringTag,{value:"Module"})),EC=na(X5);var Xa={},_E;function J5(){if(_E)return Xa;_E=1,Object.defineProperty(Xa,"__esModule",{value:!0}),Xa.supportsZeroByteGCM=Xa.supportsSubtleCrypto=Xa.supportsSecureRandom=Xa.supportsWebCrypto=void 0;var e=EC,t=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function r(f){if(n(f)&&typeof f.crypto.subtle=="object"){var u=f.crypto.subtle;return a(u)}return!1}Xa.supportsWebCrypto=r;function n(f){if(typeof f=="object"&&typeof f.crypto=="object"){var u=f.crypto.getRandomValues;return typeof u=="function"}return!1}Xa.supportsSecureRandom=n;function a(f){return f&&t.every(function(u){return typeof f[u]=="function"})}Xa.supportsSubtleCrypto=a;function l(f){return e.__awaiter(this,void 0,void 0,function(){var u,E;return e.__generator(this,function(m){switch(m.label){case 0:if(!a(f))return[2,!1];m.label=1;case 1:return m.trys.push([1,4,,5]),[4,f.generateKey({name:"AES-GCM",length:128},!1,["encrypt"])];case 2:return u=m.sent(),[4,f.encrypt({name:"AES-GCM",iv:new Uint8Array(Array(12)),additionalData:new Uint8Array(Array(16)),tagLength:128},u,new Uint8Array(0))];case 3:return E=m.sent(),[2,E.byteLength===16];case 4:return m.sent(),[2,!1];case 5:return[2]}})})}return Xa.supportsZeroByteGCM=l,Xa}(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=EC;t.__exportStar(J5(),e)})(bC);var SC={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var W_=function(e,t){return W_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a])},W_(e,t)};function Y5(e,t){W_(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var K_=function(){return K_=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},K_.apply(this,arguments)};function Q5(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function eN(e,t,r,n){var a=arguments.length,l=a<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(f=e[u])&&(l=(a<3?f(l):a>3?f(t,r,l):f(t,r))||l);return a>3&&l&&Object.defineProperty(t,r,l),l}function tN(e,t){return function(r,n){t(r,n,e)}}function rN(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function nN(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})}function iN(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}function oN(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function sN(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function X_(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function TC(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],f;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(u){f={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return l}function aN(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(TC(arguments[t]));return e}function lN(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var l=arguments[t],f=0,u=l.length;f<u;f++,a++)n[a]=l[f];return n}function Af(e){return this instanceof Af?(this.v=e,this):new Af(e)}function uN(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),a,l=[];return a={},f("next"),f("throw"),f("return"),a[Symbol.asyncIterator]=function(){return this},a;function f(z){n[z]&&(a[z]=function(H){return new Promise(function(q,Y){l.push([z,H,q,Y])>1||u(z,H)})})}function u(z,H){try{E(n[z](H))}catch(q){M(l[0][3],q)}}function E(z){z.value instanceof Af?Promise.resolve(z.value.v).then(m,S):M(l[0][2],z)}function m(z){u("next",z)}function S(z){u("throw",z)}function M(z,H){z(H),l.shift(),l.length&&u(l[0][0],l[0][1])}}function cN(e){var t,r;return t={},n("next"),n("throw",function(a){throw a}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(a,l){t[a]=e[a]?function(f){return(r=!r)?{value:Af(e[a](f)),done:a==="return"}:l?l(f):f}:l}}function hN(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof X_=="function"?X_(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(l){r[l]=e[l]&&function(f){return new Promise(function(u,E){f=e[l](f),a(u,E,f.done,f.value)})}}function a(l,f,u,E){Promise.resolve(E).then(function(m){l({value:m,done:u})},f)}}function dN(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function fN(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function pN(e){return e&&e.__esModule?e:{default:e}}function mN(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function gN(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}const yN=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return K_},__asyncDelegator:cN,__asyncGenerator:uN,__asyncValues:hN,__await:Af,__awaiter:nN,__classPrivateFieldGet:mN,__classPrivateFieldSet:gN,__createBinding:oN,__decorate:eN,__exportStar:sN,__extends:Y5,__generator:iN,__importDefault:pN,__importStar:fN,__makeTemplateObject:dN,__metadata:rN,__param:tN,__read:TC,__rest:Q5,__spread:aN,__spreadArrays:lN,__values:X_},Symbol.toStringTag,{value:"Module"})),vN=na(yN);var Mv={},xE;function _N(){return xE||(xE=1,Object.defineProperty(Mv,"__esModule",{value:!0})),Mv}var kv={},bE;function xN(){return bE||(bE=1,Object.defineProperty(kv,"__esModule",{value:!0})),kv}var Lv={},wE;function bN(){return wE||(wE=1,Object.defineProperty(Lv,"__esModule",{value:!0})),Lv}var Rv={},EE;function wN(){return EE||(EE=1,Object.defineProperty(Rv,"__esModule",{value:!0})),Rv}var zd={},SE;function EN(){if(SE)return zd;SE=1,Object.defineProperty(zd,"__esModule",{value:!0}),zd.isMsWindow=void 0;var e=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function t(n){return"MSInputMethodContext"in n&&"msCrypto"in n}function r(n){if(t(n)&&n.msCrypto.subtle!==void 0){var a=n.msCrypto,l=a.getRandomValues,f=a.subtle;return e.map(function(u){return f[u]}).concat(l).every(function(u){return typeof u=="function"})}return!1}return zd.isMsWindow=r,zd}(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=vN;t.__exportStar(_N(),e),t.__exportStar(xN(),e),t.__exportStar(bN(),e),t.__exportStar(wN(),e),t.__exportStar(EN(),e)})(SC);Object.defineProperty(Rg,"__esModule",{value:!0});Rg.Sha256=void 0;var SN=Bf,TN=Uf,CN=_C,IN=bC,PN=SC,TE=ox,AN=function(){function e(t){(0,IN.supportsWebCrypto)((0,TE.locateWindow)())?this.hash=new TN.Sha256(t):(0,PN.isMsWindow)((0,TE.locateWindow)())?this.hash=new SN.Sha256(t):this.hash=new CN.Sha256(t)}return e.prototype.update=function(t,r){this.hash.update(t,r)},e.prototype.digest=function(){return this.hash.digest()},e}();Rg.Sha256=AN;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WebCryptoSha256=e.Ie11Sha256=void 0;var t=xx;(0,t.__exportStar)(Rg,e);var r=Bf;Object.defineProperty(e,"Ie11Sha256",{enumerable:!0,get:function(){return r.Sha256}});var n=Uf;Object.defineProperty(e,"WebCryptoSha256",{enumerable:!0,get:function(){return n.Sha256}})})(mC);function MN(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function kN(e){var t,r,n=[];try{for(var a=MN(Object.keys(e).sort()),l=a.next();!l.done;l=a.next()){var f=l.value,u=e[f];if(f=Sc(f),Array.isArray(u))for(var E=0,m=u.length;E<m;E++)n.push("".concat(f,"=").concat(Sc(u[E])));else{var S=f;(u||typeof u=="string")&&(S+="=".concat(Sc(u))),n.push(S)}}}catch(M){t={error:M}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return n.join("&")}function LN(e){return e===void 0&&(e=0),new Promise(function(t,r){e&&setTimeout(function(){var n=new Error("Request did not complete within ".concat(e," ms"));n.name="TimeoutError",r(n)},e)})}var RN=function(){function e(t){typeof t=="function"?this.configProvider=t().then(function(r){return r||{}}):(this.config=t??{},this.configProvider=Promise.resolve(this.config))}return e.prototype.destroy=function(){},e.prototype.handle=function(t,r){var n=r===void 0?{}:r,a=n.abortSignal;return Yt(this,void 0,void 0,function(){var l,f,u,E,m,S,M,z,H,q,Y,ye;return Xt(this,function(Q){switch(Q.label){case 0:return this.config?[3,2]:(l=this,[4,this.configProvider]);case 1:l.config=Q.sent(),Q.label=2;case 2:return f=this.config.requestTimeout,a!=null&&a.aborted?(u=new Error("Request aborted"),u.name="AbortError",[2,Promise.reject(u)]):(E=t.path,t.query&&(m=kN(t.query),m&&(E+="?".concat(m))),S=t.port,M=t.method,z="".concat(t.protocol,"//").concat(t.hostname).concat(S?":".concat(S):"").concat(E),H=M==="GET"||M==="HEAD"?void 0:t.body,q={body:H,headers:new Headers(t.headers),method:M},typeof AbortController<"u"&&(q.signal=a),Y=new Request(z,q),ye=[fetch(Y).then(function(te){var ne,Me,Ve=te.headers,je={};try{for(var Qe=kg(Ve.entries()),ot=Qe.next();!ot.done;ot=Qe.next()){var Ut=ot.value;je[Ut[0]]=Ut[1]}}catch(Qt){ne={error:Qt}}finally{try{ot&&!ot.done&&(Me=Qe.return)&&Me.call(Qe)}finally{if(ne)throw ne.error}}var st=te.body!==void 0;return st?{response:new Zm({headers:je,statusCode:te.status,body:te.body})}:te.blob().then(function(Qt){return{response:new Zm({headers:je,statusCode:te.status,body:Qt})}})}),LN(f)],a&&ye.push(new Promise(function(te,ne){a.onabort=function(){var Me=new Error("Request aborted");Me.name="AbortError",ne(Me)}})),[2,Promise.race(ye)])}})})},e}(),Bu={},Kh=new Array(64);for(var vo=0,Mf="A".charCodeAt(0),Ex="Z".charCodeAt(0);vo+Mf<=Ex;vo++){var Uu=String.fromCharCode(vo+Mf);Bu[Uu]=vo,Kh[vo]=Uu}for(var vo=0,Mf="a".charCodeAt(0),Ex="z".charCodeAt(0);vo+Mf<=Ex;vo++){var Uu=String.fromCharCode(vo+Mf),kf=vo+26;Bu[Uu]=kf,Kh[kf]=Uu}for(var vo=0;vo<10;vo++){Bu[vo.toString(10)]=vo+52;var Uu=vo.toString(10),kf=vo+52;Bu[Uu]=kf,Kh[kf]=Uu}Bu["+"]=62;Kh[62]="+";Bu["/"]=63;Kh[63]="/";var Ph=6,of=8,ON=63;function CC(e){var t=e.length/4*3;e.slice(-2)==="=="?t-=2:e.slice(-1)==="="&&t--;for(var r=new ArrayBuffer(t),n=new DataView(r),a=0;a<e.length;a+=4){for(var l=0,f=0,u=a,E=a+3;u<=E;u++)if(e[u]!=="="){if(!(e[u]in Bu))throw new TypeError("Invalid character ".concat(e[u]," in base64 string."));l|=Bu[e[u]]<<(E-u)*Ph,f+=Ph}else l>>=Ph;var m=a/4*3;l>>=f%of;for(var S=Math.floor(f/of),M=0;M<S;M++){var z=(S-M-1)*of;n.setUint8(m+M,(l&255<<z)>>z)}}return new Uint8Array(r)}function DN(e){for(var t="",r=0;r<e.length;r+=3){for(var n=0,a=0,l=r,f=Math.min(r+3,e.length);l<f;l++)n|=e[l]<<(f-l-1)*of,a+=of;var u=Math.ceil(a/Ph);n<<=u*Ph-a;for(var E=1;E<=u;E++){var m=(u-E)*Ph;t+=Kh[(n&ON<<m)>>m]}t+="==".slice(0,4-u)}return t}var zN=function(e){return typeof Blob=="function"&&e instanceof Blob?FN(e):NN(e)};function FN(e){return Yt(this,void 0,void 0,function(){var t,r;return Xt(this,function(n){switch(n.label){case 0:return[4,BN(e)];case 1:return t=n.sent(),r=CC(t),[2,new Uint8Array(r)]}})})}function NN(e){return Yt(this,void 0,void 0,function(){var t,r,n,a,l,f,u;return Xt(this,function(E){switch(E.label){case 0:t=new Uint8Array(0),r=e.getReader(),n=!1,E.label=1;case 1:return n?[3,3]:[4,r.read()];case 2:return a=E.sent(),l=a.done,f=a.value,f&&(u=t,t=new Uint8Array(u.length+f.length),t.set(u),t.set(f,u.length)),n=l,[3,1];case 3:return[2,t]}})})}function BN(e){return new Promise(function(t,r){var n=new FileReader;n.onloadend=function(){var a;if(n.readyState!==2)return r(new Error("Reader aborted too early"));var l=(a=n.result)!==null&&a!==void 0?a:"",f=l.indexOf(","),u=f>-1?f+1:l.length;t(l.substring(u))},n.onabort=function(){return r(new Error("Read aborted"))},n.onerror=function(){return r(n.error)},n.readAsDataURL(e)})}var UN=function(e){return function(){return Promise.reject(e)}},jN=function(e){if(typeof e=="string"){for(var t=e.length,r=t-1;r>=0;r--){var n=e.charCodeAt(r);n>127&&n<=2047?t++:n>2047&&n<=65535&&(t+=2),n>=56320&&n<=57343&&r--}return t}else{if(typeof e.byteLength=="number")return e.byteLength;if(typeof e.size=="number")return e.size}throw new Error("Body Length computation failed for ".concat(e))},$N=function(e){var t=e.serviceId,r=e.clientVersion;return function(){return Yt(void 0,void 0,void 0,function(){var n,a,l,f,u,E,m,S,M;return Xt(this,function(z){return n=typeof window<"u"&&(!((l=window==null?void 0:window.navigator)===null||l===void 0)&&l.userAgent)?DT.parse(window.navigator.userAgent):void 0,a=[["aws-sdk-js",r],["os/".concat(((f=n==null?void 0:n.os)===null||f===void 0?void 0:f.name)||"other"),(u=n==null?void 0:n.os)===null||u===void 0?void 0:u.version],["lang/js"],["md/browser","".concat((m=(E=n==null?void 0:n.browser)===null||E===void 0?void 0:E.name)!==null&&m!==void 0?m:"unknown","_").concat((M=(S=n==null?void 0:n.browser)===null||S===void 0?void 0:S.version)!==null&&M!==void 0?M:"unknown")]],t&&a.push(["api/".concat(t),r]),[2,a]})})}},VN=function(e){for(var t=[],r=0,n=e.length;r<n;r++){var a=e.charCodeAt(r);if(a<128)t.push(a);else if(a<2048)t.push(a>>6|192,a&63|128);else if(r+1<e.length&&(a&64512)===55296&&(e.charCodeAt(r+1)&64512)===56320){var l=65536+((a&1023)<<10)+(e.charCodeAt(++r)&1023);t.push(l>>18|240,l>>12&63|128,l>>6&63|128,l&63|128)}else t.push(a>>12|224,a>>6&63|128,a&63|128)}return Uint8Array.from(t)},GN=function(e){for(var t="",r=0,n=e.length;r<n;r++){var a=e[r];if(a<128)t+=String.fromCharCode(a);else if(192<=a&&a<224){var l=e[++r];t+=String.fromCharCode((a&31)<<6|l&63)}else if(240<=a&&a<365){var f=[a,e[++r],e[++r],e[++r]],u="%"+f.map(function(E){return E.toString(16)}).join("%");t+=decodeURIComponent(u)}else t+=String.fromCharCode((a&15)<<12|(e[++r]&63)<<6|e[++r]&63)}return t};function qN(e){return new TextEncoder().encode(e)}function HN(e){return new TextDecoder("utf-8").decode(e)}var ZN=function(e){return typeof TextEncoder=="function"?qN(e):VN(e)},WN=function(e){return typeof TextDecoder=="function"?HN(e):GN(e)};function KN(e){var t,r,n={};if(e=e.replace(/^\?/,""),e)try{for(var a=kg(e.split("&")),l=a.next();!l.done;l=a.next()){var f=l.value,u=Bi(f.split("="),2),E=u[0],m=u[1],S=m===void 0?null:m;E=decodeURIComponent(E),S&&(S=decodeURIComponent(S)),E in n?Array.isArray(n[E])?n[E].push(S):n[E]=[n[E],S]:n[E]=S}}catch(M){t={error:M}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return n}var IC=function(e){if(typeof e=="string")return IC(new URL(e));var t=e,r=t.hostname,n=t.pathname,a=t.port,l=t.protocol,f=t.search,u;return f&&(u=KN(f)),{hostname:r,port:a?parseInt(a):void 0,protocol:l,path:n,query:u}},XN={},JN={aws:{regions:["af-south-1","ap-east-1","ap-northeast-1","ap-northeast-2","ap-northeast-3","ap-south-1","ap-southeast-1","ap-southeast-2","ap-southeast-3","ca-central-1","eu-central-1","eu-north-1","eu-south-1","eu-west-1","eu-west-2","eu-west-3","me-central-1","me-south-1","sa-east-1","us-east-1","us-east-2","us-west-1","us-west-2"],regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",variants:[{hostname:"geo.{region}.amazonaws.com",tags:[]},{hostname:"geo-fips.{region}.amazonaws.com",tags:["fips"]},{hostname:"geo-fips.{region}.api.aws",tags:["dualstack","fips"]},{hostname:"geo.{region}.api.aws",tags:["dualstack"]}]},"aws-cn":{regions:["cn-north-1","cn-northwest-1"],regionRegex:"^cn\\-\\w+\\-\\d+$",variants:[{hostname:"geo.{region}.amazonaws.com.cn",tags:[]},{hostname:"geo-fips.{region}.amazonaws.com.cn",tags:["fips"]},{hostname:"geo-fips.{region}.api.amazonwebservices.com.cn",tags:["dualstack","fips"]},{hostname:"geo.{region}.api.amazonwebservices.com.cn",tags:["dualstack"]}]},"aws-iso":{regions:["us-iso-east-1","us-iso-west-1"],regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",variants:[{hostname:"geo.{region}.c2s.ic.gov",tags:[]},{hostname:"geo-fips.{region}.c2s.ic.gov",tags:["fips"]}]},"aws-iso-b":{regions:["us-isob-east-1"],regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",variants:[{hostname:"geo.{region}.sc2s.sgov.gov",tags:[]},{hostname:"geo-fips.{region}.sc2s.sgov.gov",tags:["fips"]}]},"aws-us-gov":{regions:["us-gov-east-1","us-gov-west-1"],regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",variants:[{hostname:"geo.{region}.amazonaws.com",tags:[]},{hostname:"geo-fips.{region}.amazonaws.com",tags:["fips"]},{hostname:"geo-fips.{region}.api.aws",tags:["dualstack","fips"]},{hostname:"geo.{region}.api.aws",tags:["dualstack"]}]}},YN=function(e,t){return Yt(void 0,void 0,void 0,function(){return Xt(this,function(r){return[2,Pz(e,De(De({},t),{signingService:"geo",regionHash:XN,partitionHash:JN}))]})})},QN=function(e){var t,r,n,a,l;return{apiVersion:"2020-11-19",disableHostPrefix:(t=e==null?void 0:e.disableHostPrefix)!==null&&t!==void 0?t:!1,logger:(r=e==null?void 0:e.logger)!==null&&r!==void 0?r:{},regionInfoProvider:(n=e==null?void 0:e.regionInfoProvider)!==null&&n!==void 0?n:YN,serviceId:(a=e==null?void 0:e.serviceId)!==null&&a!==void 0?a:"Location",urlParser:(l=e==null?void 0:e.urlParser)!==null&&l!==void 0?l:IC}};function eB(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})}function tB(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(m){return function(S){return E([m,S])}}function E(m){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(S){m=[6,S],a=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var rB=["in-region","cross-region","mobile","standard","legacy"],nB=function(e){var t=e===void 0?{}:e,r=t.defaultsMode;return oC(function(){return eB(void 0,void 0,void 0,function(){var n,a;return tB(this,function(l){switch(l.label){case 0:return typeof r!="function"?[3,2]:[4,r()];case 1:return a=l.sent(),[3,3];case 2:a=r,l.label=3;case 3:switch(n=a,n==null?void 0:n.toLowerCase()){case"auto":return[2,Promise.resolve(iB()?"mobile":"standard")];case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return[2,Promise.resolve(n==null?void 0:n.toLocaleLowerCase())];case void 0:return[2,Promise.resolve("legacy")];default:throw new Error('Invalid parameter for "defaultsMode", expect '.concat(rB.join(", "),", got ").concat(n))}return[2]}})})})},iB=function(){var e,t,r=typeof window<"u"&&(!((e=window==null?void 0:window.navigator)===null||e===void 0)&&e.userAgent)?DT.parse(window.navigator.userAgent):void 0,n=(t=r==null?void 0:r.platform)===null||t===void 0?void 0:t.type;return n==="tablet"||n==="mobile"},oB=function(e){var t,r,n,a,l,f,u,E,m,S,M,z,H,q,Y,ye=nB(e),Q=function(){return ye().then(k3)},te=QN(e);return De(De(De({},te),e),{runtime:"browser",defaultsMode:ye,base64Decoder:(t=e==null?void 0:e.base64Decoder)!==null&&t!==void 0?t:CC,base64Encoder:(r=e==null?void 0:e.base64Encoder)!==null&&r!==void 0?r:DN,bodyLengthChecker:(n=e==null?void 0:e.bodyLengthChecker)!==null&&n!==void 0?n:jN,credentialDefaultProvider:(a=e==null?void 0:e.credentialDefaultProvider)!==null&&a!==void 0?a:function(ne){return function(){return Promise.reject(new Error("Credential is missing"))}},defaultUserAgentProvider:(l=e==null?void 0:e.defaultUserAgentProvider)!==null&&l!==void 0?l:$N({serviceId:te.serviceId,clientVersion:O4.version}),maxAttempts:(f=e==null?void 0:e.maxAttempts)!==null&&f!==void 0?f:yx,region:(u=e==null?void 0:e.region)!==null&&u!==void 0?u:UN("Region is missing"),requestHandler:(E=e==null?void 0:e.requestHandler)!==null&&E!==void 0?E:new RN(Q),retryMode:(m=e==null?void 0:e.retryMode)!==null&&m!==void 0?m:function(){return Yt(void 0,void 0,void 0,function(){return Xt(this,function(ne){switch(ne.label){case 0:return[4,Q()];case 1:return[2,ne.sent().retryMode||Kz]}})})},sha256:(S=e==null?void 0:e.sha256)!==null&&S!==void 0?S:mC.Sha256,streamCollector:(M=e==null?void 0:e.streamCollector)!==null&&M!==void 0?M:zN,useDualstackEndpoint:(z=e==null?void 0:e.useDualstackEndpoint)!==null&&z!==void 0?z:function(){return Promise.resolve(xz)},useFipsEndpoint:(H=e==null?void 0:e.useFipsEndpoint)!==null&&H!==void 0?H:function(){return Promise.resolve(bz)},utf8Decoder:(q=e==null?void 0:e.utf8Decoder)!==null&&q!==void 0?q:ZN,utf8Encoder:(Y=e==null?void 0:e.utf8Encoder)!==null&&Y!==void 0?Y:WN})},gu=function(e){Di(t,e);function t(r){var n=this,a=oB(r),l=Sz(a),f=Ez(l),u=CF(f),E=u,m=i4(E),S=c4(m);return n=e.call(this,S)||this,n.config=S,n.middlewareStack.use(AF(n.config)),n.middlewareStack.use(kz(n.config)),n.middlewareStack.use(Oz(n.config)),n.middlewareStack.use(Fz(n.config)),n.middlewareStack.use(Wz(n.config)),n.middlewareStack.use(u4(n.config)),n.middlewareStack.use(p4(n.config)),n}return t.prototype.destroy=function(){e.prototype.destroy.call(this)},t}(d3),zo=63710088e-1,Sx={centimeters:zo*100,centimetres:zo*100,degrees:zo/111325,feet:zo*3.28084,inches:zo*39.37,kilometers:zo/1e3,kilometres:zo/1e3,meters:zo,metres:zo,miles:zo/1609.344,millimeters:zo*1e3,millimetres:zo*1e3,nauticalmiles:zo/1852,radians:1,yards:zo*1.0936},sB={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/zo,yards:1.0936133},J_={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function nc(e,t,r){r===void 0&&(r={});var n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function aB(e,t,r){switch(e){case"Point":return Bg(t).geometry;case"LineString":return Tx(t).geometry;case"Polygon":return Ug(t).geometry;case"MultiPoint":return AC(t).geometry;case"MultiLineString":return PC(t).geometry;case"MultiPolygon":return MC(t).geometry;default:throw new Error(e+" is invalid")}}function Bg(e,t,r){if(r===void 0&&(r={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Km(e[0])||!Km(e[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:e};return nc(n,t,r)}function lB(e,t,r){return r===void 0&&(r={}),jg(e.map(function(n){return Bg(n,t)}),r)}function Ug(e,t,r){r===void 0&&(r={});for(var n=0,a=e;n<a.length;n++){var l=a[n];if(l.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var f=0;f<l[l.length-1].length;f++)if(l[l.length-1][f]!==l[0][f])throw new Error("First and last Position are not equivalent.")}var u={type:"Polygon",coordinates:e};return nc(u,t,r)}function uB(e,t,r){return r===void 0&&(r={}),jg(e.map(function(n){return Ug(n,t)}),r)}function Tx(e,t,r){if(r===void 0&&(r={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:e};return nc(n,t,r)}function cB(e,t,r){return r===void 0&&(r={}),jg(e.map(function(n){return Tx(n,t)}),r)}function jg(e,t){t===void 0&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function PC(e,t,r){r===void 0&&(r={});var n={type:"MultiLineString",coordinates:e};return nc(n,t,r)}function AC(e,t,r){r===void 0&&(r={});var n={type:"MultiPoint",coordinates:e};return nc(n,t,r)}function MC(e,t,r){r===void 0&&(r={});var n={type:"MultiPolygon",coordinates:e};return nc(n,t,r)}function hB(e,t,r){r===void 0&&(r={});var n={type:"GeometryCollection",geometries:e};return nc(n,t,r)}function dB(e,t){if(t===void 0&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r}function Cx(e,t){t===void 0&&(t="kilometers");var r=Sx[t];if(!r)throw new Error(t+" units is invalid");return e*r}function $g(e,t){t===void 0&&(t="kilometers");var r=Sx[t];if(!r)throw new Error(t+" units is invalid");return e/r}function fB(e,t){return Wm($g(e,t))}function pB(e){var t=e%360;return t<0&&(t+=360),t}function Wm(e){var t=e%(2*Math.PI);return t*180/Math.PI}function Pu(e){var t=e%360;return t*Math.PI/180}function mB(e,t,r){if(t===void 0&&(t="kilometers"),r===void 0&&(r="kilometers"),!(e>=0))throw new Error("length must be a positive number");return Cx($g(e,t),r)}function gB(e,t,r){if(t===void 0&&(t="meters"),r===void 0&&(r="kilometers"),!(e>=0))throw new Error("area must be a positive number");var n=J_[t];if(!n)throw new Error("invalid original units");var a=J_[r];if(!a)throw new Error("invalid final units");return e/n*a}function Km(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function yB(e){return!!e&&e.constructor===Object}function vB(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(e.length!==4&&e.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(t){if(!Km(t))throw new Error("bbox must only contain numbers")})}function _B(e){if(!e)throw new Error("id is required");if(["string","number"].indexOf(typeof e)===-1)throw new Error("id must be a number or a string")}const xB=Object.freeze(Object.defineProperty({__proto__:null,areaFactors:J_,bearingToAzimuth:pB,convertArea:gB,convertLength:mB,degreesToRadians:Pu,earthRadius:zo,factors:Sx,feature:nc,featureCollection:jg,geometry:aB,geometryCollection:hB,isNumber:Km,isObject:yB,lengthToDegrees:fB,lengthToRadians:$g,lineString:Tx,lineStrings:cB,multiLineString:PC,multiPoint:AC,multiPolygon:MC,point:Bg,points:lB,polygon:Ug,polygons:uB,radiansToDegrees:Wm,radiansToLength:Cx,round:dB,unitsFactors:sB,validateBBox:vB,validateId:_B},Symbol.toStringTag,{value:"Module"}));function Y_(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function bB(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function wB(e){for(var t=bB(e),r=0,n=1,a,l;n<t.length;)a=l||t[0],l=t[n],r+=(l[0]-a[0])*(l[1]+a[1]),n++;return r>0}function kC(e,t){if(!Number.isFinite(e)||!Number.isFinite(t))throw new Error("Invalid coordinates: ["+e+","+t+"]");if(t<-90||90<t)throw new Error("Latitude must be between -90 and 90 degrees inclusive.");if(e<-180||180<e)throw new Error("Longitude must be between -180 and 180 degrees inclusive.")}function Q_(e){var t=/^[-._\p{L}\p{N}]+$/iu;if(!t.test(e))throw new Error("Invalid geofenceId: '"+e+"' - IDs can only contain alphanumeric characters, hyphens, underscores and periods.")}function LC(e,t){var r=t?t+": ":"";if(e.length<4)throw new Error(r+"LinearRing must contain 4 or more coordinates.");var n=[];if(e.forEach(function(S){try{kC(S[0],S[1])}catch(M){n.push({coordinates:S,error:M.message})}}),n.length>0)throw new Error(r+"One or more of the coordinates in the Polygon LinearRing are not valid: "+JSON.stringify(n));var a=Fh(e[0],2),l=a[0],f=a[1],u=Fh(e[e.length-1],2),E=u[0],m=u[1];if(l!==E||f!==m)throw new Error(r+"LinearRing's first and last coordinates are not the same");if(wB(e))throw new Error(r+"LinearRing coordinates must be wound counterclockwise")}function EB(e,t){var r=t?t+": ":"";if(!Array.isArray(e))throw new Error(r+"Polygon is of incorrect structure. It should be an array of LinearRings");if(e.length<1)throw new Error(r+"Polygon must have a single LinearRing array.");if(e.length>1)throw new Error(r+"Polygon must have a single LinearRing array. Note: We do not currently support polygons with holes, multipolygons, polygons that are wound clockwise, or that cross the antimeridian.");var n=e.reduce(function(a,l){return a+l.length},0);if(n>1e3)throw new Error(r+"Polygon has more than the maximum 1000 vertices.");e.forEach(function(a){LC(a,t)})}function SB(e){var t={};e.forEach(function(r){if(!r.geofenceId)throw new Error("Geofence '"+r+"' is missing geofenceId");var n=r.geofenceId;if(Q_(n),t[n])throw new Error("Duplicate geofenceId: "+n);if(t[n]=!0,!r.geometry)throw new Error("Geofence '"+n+"' is missing geometry");var a=r.geometry;if(!a.polygon)throw new Error("Geofence '"+n+"' is missing geometry.polygon");var l=a.polygon;try{EB(l,n)}catch(E){if(E.message.includes("Polygon has more than the maximum 1000 vertices."))throw new Error("Geofence '"+n+"' has more than the maximum of 1000 vertices")}var f=Fh(l,1),u=f[0];LC(u,n)})}function CE(e,t){var r=Iu({},t);if(r.FilterCountries=e.countries,r.MaxResults=e.maxResults,e.searchIndexName&&(r.IndexName=e.searchIndexName),e.biasPosition&&e.searchAreaConstraints)throw new Error("BiasPosition and SearchAreaConstraints are mutually exclusive, please remove one or the other from the options object");return e.biasPosition&&(r.BiasPosition=e.biasPosition),e.searchAreaConstraints&&(r.FilterBBox=e.searchAreaConstraints),r}var to=new El("AmazonLocationServiceProvider"),TB=function(){function e(t){this._config=t||{},to.debug("Geo Options",this._config)}return e.prototype.getCategory=function(){return e.CATEGORY},e.prototype.getProviderName=function(){return e.PROVIDER_NAME},e.prototype.configure=function(t){return to.debug("configure Amazon Location Service Provider",t),t?(this._config=Object.assign({},this._config,t),this._config):this._config},e.prototype.getAvailableMaps=function(){this._verifyMapResources();var t=[],r=this._config.maps.items,n=this._config.region;for(var a in r){var l=r[a].style;t.push({mapName:a,style:l,region:n})}return t},e.prototype.getDefaultMap=function(){this._verifyMapResources();var t=this._config.maps.default,r=this._config.maps.items[t].style,n=this._config.region;return{mapName:t,style:r,region:n}},e.prototype.searchByText=function(t,r){return ci(this,void 0,void 0,function(){var n,a,l,f,u,E,m,S;return hi(this,function(M){switch(M.label){case 0:return[4,this._ensureCredentials()];case 1:if(n=M.sent(),!n)throw new Error("No credentials");this._verifySearchIndex(r==null?void 0:r.searchIndexName),a={Text:t,IndexName:this._config.search_indices.default},r&&(a=Iu(Iu({},a),CE(r,a))),l=new gu({credentials:this._config.credentials,region:this._config.region,customUserAgent:Fl()}),f=new _z(a),M.label=2;case 2:return M.trys.push([2,4,,5]),[4,l.send(f)];case 3:return u=M.sent(),[3,5];case 4:throw E=M.sent(),to.debug(E),E;case 5:return m=u.Results.map(function(z){return z.Place}),S=_v(m,{deep:!0}),[2,S]}})})},e.prototype.searchForSuggestions=function(t,r){return ci(this,void 0,void 0,function(){var n,a,l,f,u,E,m;return hi(this,function(S){switch(S.label){case 0:return[4,this._ensureCredentials()];case 1:if(n=S.sent(),!n)throw new Error("No credentials");this._verifySearchIndex(r==null?void 0:r.searchIndexName),a={Text:t,IndexName:this._config.search_indices.default},r&&(a=Iu(Iu({},a),CE(r,a))),l=new gu({credentials:this._config.credentials,region:this._config.region,customUserAgent:Fl()}),f=new vz(a),S.label=2;case 2:return S.trys.push([2,4,,5]),[4,l.send(f)];case 3:return u=S.sent(),[3,5];case 4:throw E=S.sent(),to.debug(E),E;case 5:return m=u.Results.map(function(M){return{text:M.Text,placeId:M.PlaceId}}),[2,m]}})})},e.prototype._verifyPlaceId=function(t){if(t.length===0){var r="PlaceId cannot be an empty string.";throw to.debug(r),new Error(r)}},e.prototype.searchByPlaceId=function(t,r){return ci(this,void 0,void 0,function(){var n,a,l,f,u,E,m;return hi(this,function(S){switch(S.label){case 0:return[4,this._ensureCredentials()];case 1:if(n=S.sent(),!n)throw new Error("No credentials");this._verifySearchIndex(r==null?void 0:r.searchIndexName),this._verifyPlaceId(t),a=new gu({credentials:this._config.credentials,region:this._config.region,customUserAgent:Fl()}),l={PlaceId:t,IndexName:(r==null?void 0:r.searchIndexName)||this._config.search_indices.default},f=new mz(l),S.label=2;case 2:return S.trys.push([2,4,,5]),[4,a.send(f)];case 3:return u=S.sent(),[3,5];case 4:throw E=S.sent(),to.debug(E),E;case 5:return m=u.Place,m?[2,_v(m,{deep:!0})]:[2]}})})},e.prototype.searchByCoordinates=function(t,r){return ci(this,void 0,void 0,function(){var n,a,l,f,u,E,m,S;return hi(this,function(M){switch(M.label){case 0:return[4,this._ensureCredentials()];case 1:if(n=M.sent(),!n)throw new Error("No credentials");this._verifySearchIndex(r==null?void 0:r.searchIndexName),a={Position:t,IndexName:this._config.search_indices.default},r&&(r.searchIndexName&&(a.IndexName=r.searchIndexName),a.MaxResults=r.maxResults),l=new gu({credentials:this._config.credentials,region:this._config.region,customUserAgent:Fl()}),f=new yz(a),M.label=2;case 2:return M.trys.push([2,4,,5]),[4,l.send(f)];case 3:return u=M.sent(),[3,5];case 4:throw E=M.sent(),to.debug(E),E;case 5:return m=u.Results.map(function(z){return z.Place}),S=_v(m[0],{deep:!0}),[2,S]}})})},e.prototype.saveGeofences=function(t,r){return ci(this,void 0,void 0,function(){var n,a,l,f,u,E=this;return hi(this,function(m){switch(m.label){case 0:if(t.length<1)throw new Error("Geofence input array is empty");return[4,this._ensureCredentials()];case 1:if(n=m.sent(),!n)throw new Error("No credentials");try{this._verifyGeofenceCollections(r==null?void 0:r.collectionName)}catch(S){throw to.debug(S),S}for(SB(t),a=t.map(function(S){var M=S.geofenceId,z=S.geometry.polygon;return{GeofenceId:M,Geometry:{Polygon:z}}}),l={successes:[],errors:[]},f=[];a.length>0;)u=10,f.push(a.splice(0,u));return[4,Promise.all(f.map(function(S){return ci(E,void 0,void 0,function(){var M,z;return hi(this,function(H){switch(H.label){case 0:return H.trys.push([0,2,,3]),[4,this._AmazonLocationServiceBatchPutGeofenceCall(S,(r==null?void 0:r.collectionName)||this._config.geofenceCollections.default)];case 1:return M=H.sent(),[3,3];case 2:return z=H.sent(),S.forEach(function(q){l.errors.push({geofenceId:q.GeofenceId,error:{code:"APIConnectionError",message:z.message}})}),[2];case 3:return M.Successes.forEach(function(q){var Y=q.GeofenceId,ye=q.CreateTime,Q=q.UpdateTime;l.successes.push({geofenceId:Y,createTime:ye,updateTime:Q})}),M.Errors.forEach(function(q){var Y=q.Error,ye=Y.Code,Q=Y.Message,te=q.GeofenceId;l.errors.push({error:{code:ye,message:Q},geofenceId:te})}),[2]}})})}))];case 2:return m.sent(),[2,l]}})})},e.prototype.getGeofence=function(t,r){return ci(this,void 0,void 0,function(){var n,a,l,f,u,E,m,S,M,z,H,q;return hi(this,function(Y){switch(Y.label){case 0:return[4,this._ensureCredentials()];case 1:if(n=Y.sent(),!n)throw new Error("No credentials");try{this._verifyGeofenceCollections(r==null?void 0:r.collectionName)}catch(ye){throw to.debug(ye),ye}Q_(t),a=new gu({credentials:this._config.credentials,region:this._config.region,customUserAgent:Fl()}),l={GeofenceId:t,CollectionName:(r==null?void 0:r.collectionName)||this._config.geofenceCollections.default},f=new pz(l),Y.label=2;case 2:return Y.trys.push([2,4,,5]),[4,a.send(f)];case 3:return u=Y.sent(),[3,5];case 4:throw E=Y.sent(),to.debug(E),E;case 5:return m=u.GeofenceId,S=u.CreateTime,M=u.UpdateTime,z=u.Status,H=u.Geometry,q={createTime:S,geofenceId:m,geometry:{polygon:H.Polygon},status:z,updateTime:M},[2,q]}})})},e.prototype.listGeofences=function(t){return ci(this,void 0,void 0,function(){var r,n,a,l,f,u,E,m,S;return hi(this,function(M){switch(M.label){case 0:return[4,this._ensureCredentials()];case 1:if(r=M.sent(),!r)throw new Error("No credentials");try{this._verifyGeofenceCollections(t==null?void 0:t.collectionName)}catch(z){throw to.debug(z),z}n=new gu({credentials:this._config.credentials,region:this._config.region,customUserAgent:Fl()}),a={NextToken:t==null?void 0:t.nextToken,CollectionName:(t==null?void 0:t.collectionName)||this._config.geofenceCollections.default},l=new gz(a),M.label=2;case 2:return M.trys.push([2,4,,5]),[4,n.send(l)];case 3:return f=M.sent(),[3,5];case 4:throw u=M.sent(),to.debug(u),u;case 5:return E=f.NextToken,m=f.Entries,S={entries:m.map(function(z){var H=z.GeofenceId,q=z.CreateTime,Y=z.UpdateTime,ye=z.Status,Q=z.Geometry.Polygon;return{geofenceId:H,createTime:q,updateTime:Y,status:ye,geometry:{polygon:Q}}}),nextToken:E},[2,S]}})})},e.prototype.deleteGeofences=function(t,r){return ci(this,void 0,void 0,function(){var n,a,l,f,u,E=this;return hi(this,function(m){switch(m.label){case 0:if(t.length<1)throw new Error("GeofenceId input array is empty");return[4,this._ensureCredentials()];case 1:if(n=m.sent(),!n)throw new Error("No credentials");if(this._verifyGeofenceCollections(r==null?void 0:r.collectionName),a=t.filter(function(S){try{Q_(S)}catch{return!0}}),a.length>0)throw new Error("Invalid geofence ids: "+a.join(", "));for(l={successes:[],errors:[]},f=[],u=0;u<t.length;)f.push(t.slice(u,u+=10));return[4,Promise.all(f.map(function(S){return ci(E,void 0,void 0,function(){var M,z,H,q;return hi(this,function(Y){switch(Y.label){case 0:return Y.trys.push([0,2,,3]),[4,this._AmazonLocationServiceBatchDeleteGeofenceCall(S,(r==null?void 0:r.collectionName)||this._config.geofenceCollections.default)];case 1:return M=Y.sent(),[3,3];case 2:return z=Y.sent(),S.forEach(function(ye){var Q={geofenceId:ye,error:{code:z.message,message:z.message}};l.errors.push(Q)}),[2];case 3:return H=M.Errors.map(function(ye){var Q=ye.geofenceId;return Q}),(q=l.successes).push.apply(q,IT(S.filter(function(ye){return!H.includes(ye)}))),[2]}})})}))];case 2:return m.sent(),[2,l]}})})},e.prototype._ensureCredentials=function(){return ci(this,void 0,void 0,function(){var t,r,n;return hi(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Cf.get()];case 1:return t=a.sent(),t?(r=Cf.shear(t),to.debug("Set credentials for storage. Credentials are:",r),this._config.credentials=r,[2,!0]):[2,!1];case 2:return n=a.sent(),to.debug("Ensure credentials error. Credentials are:",n),[2,!1];case 3:return[2]}})})},e.prototype._verifyMapResources=function(){if(!this._config.maps){var t="No map resources found in amplify config, run 'amplify add geo' to create one and run `amplify push` after";throw to.debug(t),new Error(t)}if(!this._config.maps.default){var t="No default map resource found in amplify config, run 'amplify add geo' to create one and run `amplify push` after";throw to.debug(t),new Error(t)}},e.prototype._verifySearchIndex=function(t){if((!this._config.search_indices||!this._config.search_indices.default)&&!t){var r="No Search Index found in amplify config, please run `amplify add geo` to create one and run `amplify push` after.";throw to.debug(r),new Error(r)}},e.prototype._verifyGeofenceCollections=function(t){if((!this._config.geofenceCollections||!this._config.geofenceCollections.default)&&!t){var r="No Geofence Collections found, please run `amplify add geo` to create one and run `amplify push` after.";throw to.debug(r),new Error(r)}},e.prototype._AmazonLocationServiceBatchPutGeofenceCall=function(t,r){return ci(this,void 0,void 0,function(){var n,a,l,f,u;return hi(this,function(E){switch(E.label){case 0:n={Entries:t,CollectionName:r||this._config.geofenceCollections.default},a=new gu({credentials:this._config.credentials,region:this._config.region,customUserAgent:Fl()}),l=new fz(n),E.label=1;case 1:return E.trys.push([1,3,,4]),[4,a.send(l)];case 2:return f=E.sent(),[3,4];case 3:throw u=E.sent(),u;case 4:return[2,f]}})})},e.prototype._AmazonLocationServiceBatchDeleteGeofenceCall=function(t,r){return ci(this,void 0,void 0,function(){var n,a,l,f,u;return hi(this,function(E){switch(E.label){case 0:n={GeofenceIds:t,CollectionName:r||this._config.geofenceCollections.default},a=new gu({credentials:this._config.credentials,region:this._config.region,customUserAgent:Fl()}),l=new dz(n),E.label=1;case 1:return E.trys.push([1,3,,4]),[4,a.send(l)];case 2:return f=E.sent(),[3,4];case 3:throw u=E.sent(),u;case 4:return[2,f]}})})},e.CATEGORY="Geo",e.PROVIDER_NAME="AmazonLocationService",e}(),Ja=new El("Geo"),gl="AmazonLocationService",CB=function(){function e(){this._config={},this._pluggables=[],Ja.debug("Geo Options",this._config)}return e.prototype.getModuleName=function(){return e.MODULE},e.prototype.addPluggable=function(t){if(t&&t.getCategory()==="Geo"){this._pluggables.push(t);var r=t.configure(this._config[t.getProviderName()]);return r}},e.prototype.getPluggable=function(t){var r=this._pluggables.find(function(n){return n.getProviderName()===t});if(r===void 0)throw Ja.debug("No plugin found with providerName",t),new Error("No plugin found in Geo for the provider");return r},e.prototype.removePluggable=function(t){this._pluggables=this._pluggables.filter(function(r){return r.getProviderName()!==t})},e.prototype.configure=function(t){var r=this;if(Ja.debug("configure Geo"),!t)return this._config;var n=RT(t);return this._config=Object.assign({},this._config,n.Geo,t),this._pluggables.forEach(function(a){a.configure(r._config[a.getProviderName()])}),this._pluggables.length===0&&this.addPluggable(new TB),this._config},e.prototype.getAvailableMaps=function(t){t===void 0&&(t=gl);var r=this.getPluggable(t);return r.getAvailableMaps()},e.prototype.getDefaultMap=function(t){t===void 0&&(t=gl);var r=this.getPluggable(t);return r.getDefaultMap()},e.prototype.searchByText=function(t,r){return ci(this,void 0,void 0,function(){var n,a,l,f;return hi(this,function(u){switch(u.label){case 0:n=(r||{}).providerName,a=n===void 0?gl:n,l=this.getPluggable(a),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,l.searchByText(t,r)];case 2:return[2,u.sent()];case 3:throw f=u.sent(),Ja.debug(f),f;case 4:return[2]}})})},e.prototype.searchForSuggestions=function(t,r){return ci(this,void 0,void 0,function(){var n,a,l,f;return hi(this,function(u){switch(u.label){case 0:n=(r||{}).providerName,a=n===void 0?gl:n,l=this.getPluggable(a),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,l.searchForSuggestions(t,r)];case 2:return[2,u.sent()];case 3:throw f=u.sent(),Ja.debug(f),f;case 4:return[2]}})})},e.prototype.searchByPlaceId=function(t,r){return ci(this,void 0,void 0,function(){var n,a,l;return hi(this,function(f){switch(f.label){case 0:n=gl,a=this.getPluggable(n),f.label=1;case 1:return f.trys.push([1,3,,4]),[4,a.searchByPlaceId(t,r)];case 2:return[2,f.sent()];case 3:throw l=f.sent(),Ja.debug(l),l;case 4:return[2]}})})},e.prototype.searchByCoordinates=function(t,r){return ci(this,void 0,void 0,function(){var n,a,l,f,u,E,m;return hi(this,function(S){switch(S.label){case 0:n=(r||{}).providerName,a=n===void 0?gl:n,l=this.getPluggable(a),f=Fh(t,2),u=f[0],E=f[1],S.label=1;case 1:return S.trys.push([1,3,,4]),kC(u,E),[4,l.searchByCoordinates(t,r)];case 2:return[2,S.sent()];case 3:throw m=S.sent(),Ja.debug(m),m;case 4:return[2]}})})},e.prototype.saveGeofences=function(t,r){return ci(this,void 0,void 0,function(){var n,a,l,f,u;return hi(this,function(E){switch(E.label){case 0:n=(r||{}).providerName,a=n===void 0?gl:n,l=this.getPluggable(a),Array.isArray(t)?f=t:f=[t],E.label=1;case 1:return E.trys.push([1,3,,4]),[4,l.saveGeofences(f,r)];case 2:return[2,E.sent()];case 3:throw u=E.sent(),Ja.debug(u),u;case 4:return[2]}})})},e.prototype.getGeofence=function(t,r){return ci(this,void 0,void 0,function(){var n,a,l,f;return hi(this,function(u){switch(u.label){case 0:n=(r||{}).providerName,a=n===void 0?gl:n,l=this.getPluggable(a),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,l.getGeofence(t,r)];case 2:return[2,u.sent()];case 3:throw f=u.sent(),Ja.debug(f),f;case 4:return[2]}})})},e.prototype.listGeofences=function(t){return ci(this,void 0,void 0,function(){var r,n,a,l;return hi(this,function(f){switch(f.label){case 0:r=(t||{}).providerName,n=r===void 0?gl:r,a=this.getPluggable(n),f.label=1;case 1:return f.trys.push([1,3,,4]),[4,a.listGeofences(t)];case 2:return[2,f.sent()];case 3:throw l=f.sent(),Ja.debug(l),l;case 4:return[2]}})})},e.prototype.deleteGeofences=function(t,r){return ci(this,void 0,void 0,function(){var n,a,l,f,u;return hi(this,function(E){switch(E.label){case 0:n=(r||{}).providerName,a=n===void 0?gl:n,l=this.getPluggable(a),Array.isArray(t)?f=t:f=[t],E.label=1;case 1:return E.trys.push([1,3,,4]),[4,l.deleteGeofences(f,r)];case 2:return[2,E.sent()];case 3:throw u=E.sent(),Ja.debug(u),u;case 4:return[2]}})})},e.MODULE="Geo",e}(),Tc=new CB;bg.register(Tc);var RC={exports:{}};(function(e,t){(function({},r){e.exports=r()})(ig,function(){var r,n,a;function l(u,E){if(!r)r=E;else if(!n)n=E;else{var m="var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk);",S={};r(S),a=E(S),typeof window<"u"&&(a.workerUrl=window.URL.createObjectURL(new Blob([m],{type:"text/javascript"})))}}l(["exports"],function(u){function E(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var m=S;function S(s,i){this.x=s,this.y=i}S.prototype={clone:function(){return new S(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,i){return this.clone()._rotateAround(s,i)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var i=s.x-this.x,c=s.y-this.y;return i*i+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,i){return Math.atan2(this.x*i-this.y*s,this.x*s+this.y*i)},_matMult:function(s){var i=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=i,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var i=Math.cos(s),c=Math.sin(s),d=c*this.x+i*this.y;return this.x=i*this.x-c*this.y,this.y=d,this},_rotateAround:function(s,i){var c=Math.cos(s),d=Math.sin(s),g=i.y+d*(this.x-i.x)+c*(this.y-i.y);return this.x=i.x+c*(this.x-i.x)-d*(this.y-i.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},S.convert=function(s){return s instanceof S?s:Array.isArray(s)?new S(s[0],s[1]):s};var M=E(m),z=H;function H(s,i,c,d){this.cx=3*s,this.bx=3*(c-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(d-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=i,this.p2x=c,this.p2y=d}H.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,i){if(i===void 0&&(i=1e-6),s<0)return 0;if(s>1)return 1;for(var c=s,d=0;d<8;d++){var g=this.sampleCurveX(c)-s;if(Math.abs(g)<i)return c;var b=this.sampleCurveDerivativeX(c);if(Math.abs(b)<1e-6)break;c-=g/b}var w=0,I=1;for(c=s,d=0;d<20&&(g=this.sampleCurveX(c),!(Math.abs(g-s)<i));d++)s>g?w=c:I=c,c=.5*(I-w)+w;return c},solve:function(s,i){return this.sampleCurveY(this.solveCurveX(s,i))}};var q=E(z);function Y(s,i,c,d){const g=new q(s,i,c,d);return function(b){return g.solve(b)}}const ye=Y(.25,.1,.25,1);function Q(s,i,c){return Math.min(c,Math.max(i,s))}function te(s,i,c){const d=c-i,g=((s-i)%d+d)%d+i;return g===i?c:g}function ne(s,...i){for(const c of i)for(const d in c)s[d]=c[d];return s}let Me=1;function Ve(s,i,c){const d={};for(const g in s)d[g]=i.call(c||this,s[g],g,s);return d}function je(s,i,c){const d={};for(const g in s)i.call(c||this,s[g],g,s)&&(d[g]=s[g]);return d}function Qe(s){return Array.isArray(s)?s.map(Qe):typeof s=="object"&&s?Ve(s,Qe):s}const ot={};function Ut(s){ot[s]||(typeof console<"u"&&console.warn(s),ot[s]=!0)}function st(s,i,c){return(c.y-s.y)*(i.x-s.x)>(i.y-s.y)*(c.x-s.x)}function Qt(s){let i=0;for(let c,d,g=0,b=s.length,w=b-1;g<b;w=g++)c=s[g],d=s[w],i+=(d.x-c.x)*(c.y+d.y);return i}function ar(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Xr=null;function Tr(s){if(Xr==null){const i=s.navigator?s.navigator.userAgent:null;Xr=!!s.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return Xr}function sn(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const qr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Un,pt;const Nt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(s){const i=requestAnimationFrame(s);return{cancel:()=>cancelAnimationFrame(i)}},getImageData(s,i=0){return this.getImageCanvasContext(s).getImageData(-i,-i,s.width+2*i,s.height+2*i)},getImageCanvasContext(s){const i=window.document.createElement("canvas"),c=i.getContext("2d",{willReadFrequently:!0});if(!c)throw new Error("failed to create canvas 2d context");return i.width=s.width,i.height=s.height,c.drawImage(s,0,0,s.width,s.height),c},resolveURL:s=>(Un||(Un=document.createElement("a")),Un.href=s,Un.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(pt==null&&(pt=matchMedia("(prefers-reduced-motion: reduce)")),pt.matches)}},mt={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class gr extends Error{constructor(i,c,d,g){super(`AJAXError: ${c} (${i}): ${d}`),this.status=i,this.statusText=c,this.url=d,this.body=g}}const Ar=ar()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,Lr=s=>mt.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))];function yr(s,i){const c=new AbortController,d=new Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:Ar(),signal:c.signal});let g=!1,b=!1;return s.type==="json"&&d.headers.set("Accept","application/json"),b||fetch(d).then(w=>w.ok?(I=>{(s.type==="arrayBuffer"||s.type==="image"?I.arrayBuffer():s.type==="json"?I.json():I.text()).then(k=>{b||(g=!0,i(null,k,I.headers.get("Cache-Control"),I.headers.get("Expires")))}).catch(k=>{b||i(new Error(k.message))})})(w):w.blob().then(I=>i(new gr(w.status,w.statusText,s.url,I)))).catch(w=>{w.code!==20&&i(new Error(w.message))}),{cancel:()=>{b=!0,g||c.abort()}}}const Dn=function(s,i){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){if(ar()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,i);if(!ar())return(Lr(s.url)||yr)(s,i)}if(!(/^file:/.test(c=s.url)||/^file:/.test(Ar())&&!/^\w+:/.test(c))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return yr(s,i);if(ar()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,i,void 0,!0)}var c;return function(d,g){const b=new XMLHttpRequest;b.open(d.method||"GET",d.url,!0),d.type!=="arrayBuffer"&&d.type!=="image"||(b.responseType="arraybuffer");for(const w in d.headers)b.setRequestHeader(w,d.headers[w]);return d.type==="json"&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials=d.credentials==="include",b.onerror=()=>{g(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){let w=b.response;if(d.type==="json")try{w=JSON.parse(b.response)}catch(I){return g(I)}g(null,w,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else{const w=new Blob([b.response],{type:b.getResponseHeader("Content-Type")});g(new gr(b.status,b.statusText,d.url,w))}},b.send(d.body),{cancel:()=>b.abort()}}(s,i)},dn=function(s,i){return Dn(ne(s,{type:"arrayBuffer"}),i)};function ji(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const i=new URL(s),c=window.location;return i.protocol===c.protocol&&i.host===c.host}function jo(s,i,c){c[s]&&c[s].indexOf(i)!==-1||(c[s]=c[s]||[],c[s].push(i))}function vn(s,i,c){if(c&&c[s]){const d=c[s].indexOf(i);d!==-1&&c[s].splice(d,1)}}class er{constructor(i,c={}){ne(this,c),this.type=i}}class so extends er{constructor(i,c={}){super("error",ne({error:i},c))}}class wi{on(i,c){return this._listeners=this._listeners||{},jo(i,c,this._listeners),this}off(i,c){return vn(i,c,this._listeners),vn(i,c,this._oneTimeListeners),this}once(i,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},jo(i,c,this._oneTimeListeners),this):new Promise(d=>this.once(i,d))}fire(i,c){typeof i=="string"&&(i=new er(i,c||{}));const d=i.type;if(this.listens(d)){i.target=this;const g=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const I of g)I.call(this,i);const b=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const I of b)vn(d,I,this._oneTimeListeners),I.call(this,i);const w=this._eventedParent;w&&(ne(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(i))}else i instanceof so&&console.error(i.error);return this}listens(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)}setEventedParent(i,c){return this._eventedParent=i,this._eventedParentData=c,this}}var Ue={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Xn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ei(s,i){const c={};for(const d in s)d!=="ref"&&(c[d]=s[d]);return Xn.forEach(d=>{d in i&&(c[d]=i[d])}),c}function Dt(s,i){if(Array.isArray(s)){if(!Array.isArray(i)||s.length!==i.length)return!1;for(let c=0;c<s.length;c++)if(!Dt(s[c],i[c]))return!1;return!0}if(typeof s=="object"&&s!==null&&i!==null){if(typeof i!="object"||Object.keys(s).length!==Object.keys(i).length)return!1;for(const c in s)if(!Dt(s[c],i[c]))return!1;return!0}return s===i}const Mr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function hs(s,i,c){c.push({command:Mr.addSource,args:[s,i[s]]})}function ks(s,i,c){i.push({command:Mr.removeSource,args:[s]}),c[s]=!0}function Tn(s,i,c,d){ks(s,c,d),hs(s,i,c)}function ol(s,i,c){let d;for(d in s[c])if(Object.prototype.hasOwnProperty.call(s[c],d)&&d!=="data"&&!Dt(s[c][d],i[c][d]))return!1;for(d in i[c])if(Object.prototype.hasOwnProperty.call(i[c],d)&&d!=="data"&&!Dt(s[c][d],i[c][d]))return!1;return!0}function tn(s,i,c,d,g,b){let w;for(w in i=i||{},s=s||{})Object.prototype.hasOwnProperty.call(s,w)&&(Dt(s[w],i[w])||c.push({command:b,args:[d,w,i[w],g]}));for(w in i)Object.prototype.hasOwnProperty.call(i,w)&&!Object.prototype.hasOwnProperty.call(s,w)&&(Dt(s[w],i[w])||c.push({command:b,args:[d,w,i[w],g]}))}function Ls(s){return s.id}function ao(s,i){return s[i.id]=i,s}class ut{constructor(i,c,d,g){this.message=(i?`${i}: `:"")+d,g&&(this.identifier=g),c!=null&&c.__line__&&(this.line=c.__line__)}}function _n(s,...i){for(const c of i)for(const d in c)s[d]=c[d];return s}class Jn extends Error{constructor(i,c){super(c),this.message=c,this.key=i}}class Si{constructor(i,c=[]){this.parent=i,this.bindings={};for(const[d,g]of c)this.bindings[d]=g}concat(i){return new Si(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const $i={kind:"null"},et={kind:"number"},Gt={kind:"string"},jt={kind:"boolean"},Nr={kind:"color"},$o={kind:"object"},Bt={kind:"value"},Jr={kind:"collator"},ir={kind:"formatted"},lo={kind:"padding"},Yn={kind:"resolvedImage"};function jn(s,i){return{kind:"array",itemType:s,N:i}}function Ir(s){if(s.kind==="array"){const i=Ir(s.itemType);return typeof s.N=="number"?`array<${i}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${i}>`}return s.kind}const Ti=[$i,et,Gt,jt,Nr,ir,$o,jn(Bt),lo,Yn];function xr(s,i){if(i.kind==="error")return null;if(s.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!xr(s.itemType,i.itemType))&&(typeof s.N!="number"||s.N===i.N))return null}else{if(s.kind===i.kind)return null;if(s.kind==="value"){for(const c of Ti)if(!xr(c,i))return null}}return`Expected ${Ir(s)} but found ${Ir(i)} instead.`}function bo(s,i){return i.some(c=>c.kind===s.kind)}function oe(s,i){return i.some(c=>c==="null"?s===null:c==="array"?Array.isArray(s):c==="object"?s&&!Array.isArray(s)&&typeof s=="object":c===typeof s)}function j(s,i){return s.kind==="array"&&i.kind==="array"?s.itemType.kind===i.itemType.kind&&typeof s.N=="number":s.kind===i.kind}const G=.96422,ee=.82521,ce=4/29,me=6/29,be=3*me*me,ve=me*me*me,pe=Math.PI/180,Te=180/Math.PI;function He(s){return(s%=360)<0&&(s+=360),s}function We([s,i,c,d]){let g,b;const w=Pt((.2225045*(s=Ze(s))+.7168786*(i=Ze(i))+.0606169*(c=Ze(c)))/1);s===i&&i===c?g=b=w:(g=Pt((.4360747*s+.3850649*i+.1430804*c)/G),b=Pt((.0139322*s+.0971045*i+.7141733*c)/ee));const I=116*w-16;return[I<0?0:I,500*(g-w),200*(w-b),d]}function Ze(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Pt(s){return s>ve?Math.pow(s,1/3):s/be+ce}function Zt([s,i,c,d]){let g=(s+16)/116,b=isNaN(i)?g:g+i/500,w=isNaN(c)?g:g-c/200;return g=1*Mt(g),b=G*Mt(b),w=ee*Mt(w),[xt(3.1338561*b-1.6168667*g-.4906146*w),xt(-.9787684*b+1.9161415*g+.033454*w),xt(.0719453*b-.2289914*g+1.4052427*w),d]}function xt(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function Mt(s){return s>me?s*s*s:be*(s-ce)}function $t(s){return parseInt(s.padEnd(2,s),16)/255}function Kt(s,i){return sr(i?s/100:s,0,1)}function sr(s,i,c){return Math.min(Math.max(i,s),c)}function Br(s){return!s.some(Number.isNaN)}const Ur={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class tr{constructor(i,c,d,g=1,b=!0){this.r=i,this.g=c,this.b=d,this.a=g,b||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[i,c,d,g]))}static parse(i){if(i instanceof tr)return i;if(typeof i!="string")return;const c=function(d){if((d=d.toLowerCase())==="transparent")return[0,0,0,0];const g=Ur[d];if(g){const[w,I,k]=g;return[w/255,I/255,k/255,1]}if(d.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(d)){const w=d.length<6?1:2;let I=1;return[$t(d.slice(I,I+=w)),$t(d.slice(I,I+=w)),$t(d.slice(I,I+=w)),$t(d.slice(I,I+w)||"ff")]}if(d.startsWith("rgb")){const w=d.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){const[I,k,D,N,U,V,W,J,ae,de,ge,Ie]=w,_e=[N||" ",W||" ",de].join("");if(_e==="  "||_e==="  /"||_e===",,"||_e===",,,"){const ke=[D,V,ae].join(""),Oe=ke==="%%%"?100:ke===""?255:0;if(Oe){const Xe=[sr(+k/Oe,0,1),sr(+U/Oe,0,1),sr(+J/Oe,0,1),ge?Kt(+ge,Ie):1];if(Br(Xe))return Xe}}return}}const b=d.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[w,I,k,D,N,U,V,W,J]=b,ae=[k||" ",N||" ",V].join("");if(ae==="  "||ae==="  /"||ae===",,"||ae===",,,"){const de=[+I,sr(+D,0,100),sr(+U,0,100),W?Kt(+W,J):1];if(Br(de))return function([ge,Ie,_e,ke]){function Oe(Xe){const Et=(Xe+ge/30)%12,Ct=Ie*Math.min(_e,1-_e);return _e-Ct*Math.max(-1,Math.min(Et-3,9-Et,1))}return ge=He(ge),Ie/=100,_e/=100,[Oe(0),Oe(8),Oe(4),ke]}(de)}}}(i);return c?new tr(...c,!1):void 0}get rgb(){const{r:i,g:c,b:d,a:g}=this,b=g||1/0;return this.overwriteGetter("rgb",[i/b,c/b,d/b,g])}get hcl(){return this.overwriteGetter("hcl",function(i){const[c,d,g,b]=We(i),w=Math.sqrt(d*d+g*g);return[Math.round(1e4*w)?He(Math.atan2(g,d)*Te):NaN,w,c,b]}(this.rgb))}get lab(){return this.overwriteGetter("lab",We(this.rgb))}overwriteGetter(i,c){return Object.defineProperty(this,i,{value:c}),c}toString(){const[i,c,d,g]=this.rgb;return`rgba(${[i,c,d].map(b=>Math.round(255*b)).join(",")},${g})`}}tr.black=new tr(0,0,0,1),tr.white=new tr(1,1,1,1),tr.transparent=new tr(0,0,0,0),tr.red=new tr(1,0,0,1);class an{constructor(i,c,d){this.sensitivity=i?c?"variant":"case":c?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,c){return this.collator.compare(i,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ln{constructor(i,c,d,g,b){this.text=i,this.image=c,this.scale=d,this.fontStack=g,this.textColor=b}}class Rr{constructor(i){this.sections=i}static fromString(i){return new Rr([new ln(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.name.length!==0)}static factory(i){return i instanceof Rr?i:Rr.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}}class Cn{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Cn)return i;if(typeof i=="number")return new Cn([i,i,i,i]);if(Array.isArray(i)&&!(i.length<1||i.length>4)){for(const c of i)if(typeof c!="number")return;switch(i.length){case 1:i=[i[0],i[0],i[0],i[0]];break;case 2:i=[i[0],i[1],i[0],i[1]];break;case 3:i=[i[0],i[1],i[2],i[1]]}return new Cn(i)}}toString(){return JSON.stringify(this.values)}}class Ci{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new Ci({name:i,available:!1}):null}}function aa(s,i,c,d){return typeof s=="number"&&s>=0&&s<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof c=="number"&&c>=0&&c<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[s,i,c,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[s,i,c,d]:[s,i,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Yr(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof tr||s instanceof an||s instanceof Rr||s instanceof Cn||s instanceof Ci)return!0;if(Array.isArray(s)){for(const i of s)if(!Yr(i))return!1;return!0}if(typeof s=="object"){for(const i in s)if(!Yr(s[i]))return!1;return!0}return!1}function xn(s){if(s===null)return $i;if(typeof s=="string")return Gt;if(typeof s=="boolean")return jt;if(typeof s=="number")return et;if(s instanceof tr)return Nr;if(s instanceof an)return Jr;if(s instanceof Rr)return ir;if(s instanceof Cn)return lo;if(s instanceof Ci)return Yn;if(Array.isArray(s)){const i=s.length;let c;for(const d of s){const g=xn(d);if(c){if(c===g)continue;c=Bt;break}c=g}return jn(c||Bt,i)}return $o}function Rs(s){const i=typeof s;return s===null?"":i==="string"||i==="number"||i==="boolean"?String(s):s instanceof tr||s instanceof Rr||s instanceof Cn||s instanceof Ci?s.toString():JSON.stringify(s)}class zr{constructor(i,c){this.type=i,this.value=c}static parse(i,c){if(i.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!Yr(i[1]))return c.error("invalid value");const d=i[1];let g=xn(d);const b=c.expectedType;return g.kind!=="array"||g.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(g=b),new zr(g,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Hr{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}const wo={string:Gt,number:et,boolean:jt,object:$o};class fn{constructor(i,c){this.type=i,this.args=c}static parse(i,c){if(i.length<2)return c.error("Expected at least one argument.");let d,g=1;const b=i[0];if(b==="array"){let I,k;if(i.length>2){const D=i[1];if(typeof D!="string"||!(D in wo)||D==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);I=wo[D],g++}else I=Bt;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return c.error('The length argument to "array" must be a positive integer literal',2);k=i[2],g++}d=jn(I,k)}else{if(!wo[b])throw new Error(`Types doesn't contain name = ${b}`);d=wo[b]}const w=[];for(;g<i.length;g++){const I=c.parse(i[g],g,Bt);if(!I)return null;w.push(I)}return new fn(d,w)}evaluate(i){for(let c=0;c<this.args.length;c++){const d=this.args[c].evaluate(i);if(!xr(this.type,xn(d)))return d;if(c===this.args.length-1)throw new Hr(`Expected value to be of type ${Ir(this.type)}, but found ${Ir(xn(d))} instead.`)}throw new Error}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const Qn={"to-boolean":jt,"to-color":Nr,"to-number":et,"to-string":Gt};class uo{constructor(i,c){this.type=i,this.args=c}static parse(i,c){if(i.length<2)return c.error("Expected at least one argument.");const d=i[0];if(!Qn[d])throw new Error(`Can't parse ${d} as it is not part of the known types`);if((d==="to-boolean"||d==="to-string")&&i.length!==2)return c.error("Expected one argument.");const g=Qn[d],b=[];for(let w=1;w<i.length;w++){const I=c.parse(i[w],w,Bt);if(!I)return null;b.push(I)}return new uo(g,b)}evaluate(i){if(this.type.kind==="boolean")return!!this.args[0].evaluate(i);if(this.type.kind==="color"){let c,d;for(const g of this.args){if(c=g.evaluate(i),d=null,c instanceof tr)return c;if(typeof c=="string"){const b=i.parseColor(c);if(b)return b}else if(Array.isArray(c)&&(d=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:aa(c[0],c[1],c[2],c[3]),!d))return new tr(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new Hr(d||`Could not parse color from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}if(this.type.kind==="padding"){let c;for(const d of this.args){c=d.evaluate(i);const g=Cn.parse(c);if(g)return g}throw new Hr(`Could not parse padding from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}if(this.type.kind==="number"){let c=null;for(const d of this.args){if(c=d.evaluate(i),c===null)return 0;const g=Number(c);if(!isNaN(g))return g}throw new Hr(`Could not convert ${JSON.stringify(c)} to number.`)}return this.type.kind==="formatted"?Rr.fromString(Rs(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?Ci.fromString(Rs(this.args[0].evaluate(i))):Rs(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const Vi=["Unknown","Point","LineString","Polygon"];class Eo{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Vi[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(i){let c=this._parseColorCache[i];return c||(c=this._parseColorCache[i]=tr.parse(i)),c}}class Os{constructor(i,c,d=[],g,b=new Si,w=[]){this.registry=i,this.path=d,this.key=d.map(I=>`[${I}]`).join(""),this.scope=b,this.errors=w,this.expectedType=g,this._isConstant=c}parse(i,c,d,g,b={}){return c?this.concat(c,d,g)._parse(i,b):this._parse(i,b)}_parse(i,c){function d(g,b,w){return w==="assert"?new fn(b,[g]):w==="coerce"?new uo(b,[g]):g}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=i[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[g];if(b){let w=b.parse(i,this);if(!w)return null;if(this.expectedType){const I=this.expectedType,k=w.type;if(I.kind!=="string"&&I.kind!=="number"&&I.kind!=="boolean"&&I.kind!=="object"&&I.kind!=="array"||k.kind!=="value")if(I.kind!=="color"&&I.kind!=="formatted"&&I.kind!=="resolvedImage"||k.kind!=="value"&&k.kind!=="string")if(I.kind!=="padding"||k.kind!=="value"&&k.kind!=="number"&&k.kind!=="array"){if(this.checkSubtype(I,k))return null}else w=d(w,I,c.typeAnnotation||"coerce");else w=d(w,I,c.typeAnnotation||"coerce");else w=d(w,I,c.typeAnnotation||"assert")}if(!(w instanceof zr)&&w.type.kind!=="resolvedImage"&&this._isConstant(w)){const I=new Eo;try{w=new zr(w.type,w.evaluate(I))}catch(k){return this.error(k.message),null}}return w}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,c,d){const g=typeof i=="number"?this.path.concat(i):this.path,b=d?this.scope.concat(d):this.scope;return new Os(this.registry,this._isConstant,g,c||null,b,this.errors)}error(i,...c){const d=`${this.key}${c.map(g=>`[${g}]`).join("")}`;this.errors.push(new Jn(d,i))}checkSubtype(i,c){const d=xr(i,c);return d&&this.error(d),d}}class Vo{constructor(i,c,d){this.type=Jr,this.locale=d,this.caseSensitive=i,this.diacriticSensitive=c}static parse(i,c){if(i.length!==2)return c.error("Expected one argument.");const d=i[1];if(typeof d!="object"||Array.isArray(d))return c.error("Collator options argument must be an object.");const g=c.parse(d["case-sensitive"]!==void 0&&d["case-sensitive"],1,jt);if(!g)return null;const b=c.parse(d["diacritic-sensitive"]!==void 0&&d["diacritic-sensitive"],1,jt);if(!b)return null;let w=null;return d.locale&&(w=c.parse(d.locale,1,Gt),!w)?null:new Vo(g,b,w)}evaluate(i){return new an(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}}const fr=8192;function Sl(s,i){s[0]=Math.min(s[0],i[0]),s[1]=Math.min(s[1],i[1]),s[2]=Math.max(s[2],i[0]),s[3]=Math.max(s[3],i[1])}function ds(s,i){return!(s[0]<=i[0]||s[2]>=i[2]||s[1]<=i[1]||s[3]>=i[3])}function ic(s,i){const c=(180+s[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,g=Math.pow(2,i.z);return[Math.round(c*g*fr),Math.round(d*g*fr)]}function tu(s,i,c){const d=s[0]-i[0],g=s[1]-i[1],b=s[0]-c[0],w=s[1]-c[1];return d*w-b*g==0&&d*b<=0&&g*w<=0}function sl(s,i){let c=!1;for(let w=0,I=i.length;w<I;w++){const k=i[w];for(let D=0,N=k.length;D<N-1;D++){if(tu(s,k[D],k[D+1]))return!1;(g=k[D])[1]>(d=s)[1]!=(b=k[D+1])[1]>d[1]&&d[0]<(b[0]-g[0])*(d[1]-g[1])/(b[1]-g[1])+g[0]&&(c=!c)}}var d,g,b;return c}function al(s,i){for(let c=0;c<i.length;c++)if(sl(s,i[c]))return!0;return!1}function C(s,i,c,d){const g=d[0]-c[0],b=d[1]-c[1],w=(s[0]-c[0])*b-g*(s[1]-c[1]),I=(i[0]-c[0])*b-g*(i[1]-c[1]);return w>0&&I<0||w<0&&I>0}function y(s,i,c){for(const D of c)for(let N=0;N<D.length-1;++N)if((I=[(w=D[N+1])[0]-(b=D[N])[0],w[1]-b[1]])[0]*(k=[(g=i)[0]-(d=s)[0],g[1]-d[1]])[1]-I[1]*k[0]!=0&&C(d,g,b,w)&&C(b,w,d,g))return!0;var d,g,b,w,I,k;return!1}function T(s,i){for(let c=0;c<s.length;++c)if(!sl(s[c],i))return!1;for(let c=0;c<s.length-1;++c)if(y(s[c],s[c+1],i))return!1;return!0}function R(s,i){for(let c=0;c<i.length;c++)if(T(s,i[c]))return!0;return!1}function $(s,i,c){const d=[];for(let g=0;g<s.length;g++){const b=[];for(let w=0;w<s[g].length;w++){const I=ic(s[g][w],c);Sl(i,I),b.push(I)}d.push(b)}return d}function K(s,i,c){const d=[];for(let g=0;g<s.length;g++){const b=$(s[g],i,c);d.push(b)}return d}function X(s,i,c,d){if(s[0]<c[0]||s[0]>c[2]){const g=.5*d;let b=s[0]-c[0]>g?-d:c[0]-s[0]>g?d:0;b===0&&(b=s[0]-c[2]>g?-d:c[2]-s[0]>g?d:0),s[0]+=b}Sl(i,s)}function le(s,i,c,d){const g=Math.pow(2,d.z)*fr,b=[d.x*fr,d.y*fr],w=[];for(const I of s)for(const k of I){const D=[k.x+b[0],k.y+b[1]];X(D,i,c,g),w.push(D)}return w}function we(s,i,c,d){const g=Math.pow(2,d.z)*fr,b=[d.x*fr,d.y*fr],w=[];for(const k of s){const D=[];for(const N of k){const U=[N.x+b[0],N.y+b[1]];Sl(i,U),D.push(U)}w.push(D)}if(i[2]-i[0]<=g/2){(I=i)[0]=I[1]=1/0,I[2]=I[3]=-1/0;for(const k of w)for(const D of k)X(D,i,c,g)}var I;return w}class Ce{constructor(i,c){this.type=jt,this.geojson=i,this.geometries=c}static parse(i,c){if(i.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(Yr(i[1])){const d=i[1];if(d.type==="FeatureCollection")for(let g=0;g<d.features.length;++g){const b=d.features[g].geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new Ce(d,d.features[g].geometry)}else if(d.type==="Feature"){const g=d.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Ce(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new Ce(d,d)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(c,d){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],w=c.canonicalID();if(d.type==="Polygon"){const I=$(d.coordinates,b,w),k=le(c.geometry(),g,b,w);if(!ds(g,b))return!1;for(const D of k)if(!sl(D,I))return!1}if(d.type==="MultiPolygon"){const I=K(d.coordinates,b,w),k=le(c.geometry(),g,b,w);if(!ds(g,b))return!1;for(const D of k)if(!al(D,I))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(c,d){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],w=c.canonicalID();if(d.type==="Polygon"){const I=$(d.coordinates,b,w),k=we(c.geometry(),g,b,w);if(!ds(g,b))return!1;for(const D of k)if(!T(D,I))return!1}if(d.type==="MultiPolygon"){const I=K(d.coordinates,b,w),k=we(c.geometry(),g,b,w);if(!ds(g,b))return!1;for(const D of k)if(!R(D,I))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Re{constructor(i,c){this.type=c.type,this.name=i,this.boundExpression=c}static parse(i,c){if(i.length!==2||typeof i[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const d=i[1];return c.scope.has(d)?new Re(d,c.scope.get(d)):c.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}}class fe{constructor(i,c,d,g){this.name=i,this.type=c,this._evaluate=d,this.args=g}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}static parse(i,c){const d=i[0],g=fe.definitions[d];if(!g)return c.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(g)?g[0]:g.type,w=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,I=w.filter(([D])=>!Array.isArray(D)||D.length===i.length-1);let k=null;for(const[D,N]of I){k=new Os(c.registry,$e,c.path,null,c.scope);const U=[];let V=!1;for(let W=1;W<i.length;W++){const J=i[W],ae=Array.isArray(D)?D[W-1]:D.type,de=k.parse(J,1+U.length,ae);if(!de){V=!0;break}U.push(de)}if(!V)if(Array.isArray(D)&&D.length!==U.length)k.error(`Expected ${D.length} arguments, but found ${U.length} instead.`);else{for(let W=0;W<U.length;W++){const J=Array.isArray(D)?D[W]:D.type,ae=U[W];k.concat(W+1).checkSubtype(J,ae.type)}if(k.errors.length===0)return new fe(d,b,N,U)}}if(I.length===1)c.errors.push(...k.errors);else{const D=(I.length?I:w).map(([U])=>{return V=U,Array.isArray(V)?`(${V.map(Ir).join(", ")})`:`(${Ir(V.type)}...)`;var V}).join(" | "),N=[];for(let U=1;U<i.length;U++){const V=c.parse(i[U],1+N.length);if(!V)return null;N.push(Ir(V.type))}c.error(`Expected arguments of type ${D}, but found (${N.join(", ")}) instead.`)}return null}static register(i,c){fe.definitions=c;for(const d in c)i[d]=fe}}function $e(s){if(s instanceof Re)return $e(s.boundExpression);if(s instanceof fe&&s.name==="error"||s instanceof Vo||s instanceof Ce)return!1;const i=s instanceof uo||s instanceof fn;let c=!0;return s.eachChild(d=>{c=i?c&&$e(d):c&&d instanceof zr}),!!c&&at(s)&&Tt(s,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function at(s){if(s instanceof fe&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof Ce)return!1;let i=!0;return s.eachChild(c=>{i&&!at(c)&&(i=!1)}),i}function tt(s){if(s instanceof fe&&s.name==="feature-state")return!1;let i=!0;return s.eachChild(c=>{i&&!tt(c)&&(i=!1)}),i}function Tt(s,i){if(s instanceof fe&&i.indexOf(s.name)>=0)return!1;let c=!0;return s.eachChild(d=>{c&&!Tt(d,i)&&(c=!1)}),c}function Be(s,i){const c=s.length-1;let d,g,b=0,w=c,I=0;for(;b<=w;)if(I=Math.floor((b+w)/2),d=s[I],g=s[I+1],d<=i){if(I===c||i<g)return I;b=I+1}else{if(!(d>i))throw new Hr("Input is not a number.");w=I-1}return 0}class Pe{constructor(i,c,d){this.type=i,this.input=c,this.labels=[],this.outputs=[];for(const[g,b]of d)this.labels.push(g),this.outputs.push(b)}static parse(i,c){if(i.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return c.error("Expected an even number of arguments.");const d=c.parse(i[1],1,et);if(!d)return null;const g=[];let b=null;c.expectedType&&c.expectedType.kind!=="value"&&(b=c.expectedType);for(let w=1;w<i.length;w+=2){const I=w===1?-1/0:i[w],k=i[w+1],D=w,N=w+1;if(typeof I!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(g.length&&g[g.length-1][0]>=I)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);const U=c.parse(k,N,b);if(!U)return null;b=b||U.type,g.push([I,U])}return new Pe(b,d,g)}evaluate(i){const c=this.labels,d=this.outputs;if(c.length===1)return d[0].evaluate(i);const g=this.input.evaluate(i);if(g<=c[0])return d[0].evaluate(i);const b=c.length;return g>=c[b-1]?d[b-1].evaluate(i):d[Be(c,g)].evaluate(i)}eachChild(i){i(this.input);for(const c of this.outputs)i(c)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function rt(s,i,c){return s+c*(i-s)}function rr(s,i,c){return s.map((d,g)=>rt(d,i[g],c))}const Ot={number:rt,color:function(s,i,c,d="rgb"){switch(d){case"rgb":{const[g,b,w,I]=rr(s.rgb,i.rgb,c);return new tr(g,b,w,I,!1)}case"hcl":{const[g,b,w,I]=s.hcl,[k,D,N,U]=i.hcl;let V,W;if(isNaN(g)||isNaN(k))isNaN(g)?isNaN(k)?V=NaN:(V=k,w!==1&&w!==0||(W=D)):(V=g,N!==1&&N!==0||(W=b));else{let Ie=k-g;k>g&&Ie>180?Ie-=360:k<g&&g-k>180&&(Ie+=360),V=g+c*Ie}const[J,ae,de,ge]=function([Ie,_e,ke,Oe]){return Ie=isNaN(Ie)?0:Ie*pe,Zt([ke,Math.cos(Ie)*_e,Math.sin(Ie)*_e,Oe])}([V,W??rt(b,D,c),rt(w,N,c),rt(I,U,c)]);return new tr(J,ae,de,ge,!1)}case"lab":{const[g,b,w,I]=Zt(rr(s.lab,i.lab,c));return new tr(g,b,w,I,!1)}}},array:rr,padding:function(s,i,c){return new Cn(rr(s.values,i.values,c))}};class vr{constructor(i,c,d,g,b){this.type=i,this.operator=c,this.interpolation=d,this.input=g,this.labels=[],this.outputs=[];for(const[w,I]of b)this.labels.push(w),this.outputs.push(I)}static interpolationFactor(i,c,d,g){let b=0;if(i.name==="exponential")b=Ft(c,i.base,d,g);else if(i.name==="linear")b=Ft(c,1,d,g);else if(i.name==="cubic-bezier"){const w=i.controlPoints;b=new q(w[0],w[1],w[2],w[3]).solve(Ft(c,1,d,g))}return b}static parse(i,c){let[d,g,b,...w]=i;if(!Array.isArray(g)||g.length===0)return c.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const D=g[1];if(typeof D!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:D}}else{if(g[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const D=g.slice(1);if(D.length!==4||D.some(N=>typeof N!="number"||N<0||N>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:D}}}if(i.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(b=c.parse(b,2,et),!b)return null;const I=[];let k=null;d==="interpolate-hcl"||d==="interpolate-lab"?k=Nr:c.expectedType&&c.expectedType.kind!=="value"&&(k=c.expectedType);for(let D=0;D<w.length;D+=2){const N=w[D],U=w[D+1],V=D+3,W=D+4;if(typeof N!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(I.length&&I[I.length-1][0]>=N)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',V);const J=c.parse(U,W,k);if(!J)return null;k=k||J.type,I.push([N,J])}return j(k,et)||j(k,Nr)||j(k,lo)||j(k,jn(et))?new vr(k,d,g,b,I):c.error(`Type ${Ir(k)} is not interpolatable.`)}evaluate(i){const c=this.labels,d=this.outputs;if(c.length===1)return d[0].evaluate(i);const g=this.input.evaluate(i);if(g<=c[0])return d[0].evaluate(i);const b=c.length;if(g>=c[b-1])return d[b-1].evaluate(i);const w=Be(c,g),I=vr.interpolationFactor(this.interpolation,g,c[w],c[w+1]),k=d[w].evaluate(i),D=d[w+1].evaluate(i);switch(this.operator){case"interpolate":return Ot[this.type.kind](k,D,I);case"interpolate-hcl":return Ot.color(k,D,I,"hcl");case"interpolate-lab":return Ot.color(k,D,I,"lab")}}eachChild(i){i(this.input);for(const c of this.outputs)i(c)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function Ft(s,i,c,d){const g=d-c,b=s-c;return g===0?0:i===1?b/g:(Math.pow(i,b)-1)/(Math.pow(i,g)-1)}class Pr{constructor(i,c){this.type=i,this.args=c}static parse(i,c){if(i.length<2)return c.error("Expectected at least one argument.");let d=null;const g=c.expectedType;g&&g.kind!=="value"&&(d=g);const b=[];for(const I of i.slice(1)){const k=c.parse(I,1+b.length,d,void 0,{typeAnnotation:"omit"});if(!k)return null;d=d||k.type,b.push(k)}if(!d)throw new Error("No output type");const w=g&&b.some(I=>xr(g,I.type));return new Pr(w?Bt:d,b)}evaluate(i){let c,d=null,g=0;for(const b of this.args)if(g++,d=b.evaluate(i),d&&d instanceof Ci&&!d.available&&(c||(c=d.name),d=null,g===this.args.length&&(d=c)),d!==null)break;return d}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}class Gi{constructor(i,c){this.type=c.type,this.bindings=[].concat(i),this.result=c}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const c of this.bindings)i(c[1]);i(this.result)}static parse(i,c){if(i.length<4)return c.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const d=[];for(let b=1;b<i.length-1;b+=2){const w=i[b];if(typeof w!="string")return c.error(`Expected string, but found ${typeof w} instead.`,b);if(/[^a-zA-Z0-9_]/.test(w))return c.error("Variable names must contain only alphanumeric characters or '_'.",b);const I=c.parse(i[b+1],b+1);if(!I)return null;d.push([w,I])}const g=c.parse(i[i.length-1],i.length-1,c.expectedType,d);return g?new Gi(d,g):null}outputDefined(){return this.result.outputDefined()}}class Cr{constructor(i,c,d){this.type=i,this.index=c,this.input=d}static parse(i,c){if(i.length!==3)return c.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const d=c.parse(i[1],1,et),g=c.parse(i[2],2,jn(c.expectedType||Bt));return d&&g?new Cr(g.type.itemType,d,g):null}evaluate(i){const c=this.index.evaluate(i),d=this.input.evaluate(i);if(c<0)throw new Hr(`Array index out of bounds: ${c} < 0.`);if(c>=d.length)throw new Hr(`Array index out of bounds: ${c} > ${d.length-1}.`);if(c!==Math.floor(c))throw new Hr(`Array index must be an integer, but found ${c} instead.`);return d[c]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}}class In{constructor(i,c){this.type=jt,this.needle=i,this.haystack=c}static parse(i,c){if(i.length!==3)return c.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const d=c.parse(i[1],1,Bt),g=c.parse(i[2],2,Bt);return d&&g?bo(d.type,[jt,Gt,et,$i,Bt])?new In(d,g):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ir(d.type)} instead`):null}evaluate(i){const c=this.needle.evaluate(i),d=this.haystack.evaluate(i);if(!d)return!1;if(!oe(c,["boolean","string","number","null"]))throw new Hr(`Expected first argument to be of type boolean, string, number or null, but found ${Ir(xn(c))} instead.`);if(!oe(d,["string","array"]))throw new Hr(`Expected second argument to be of type array or string, but found ${Ir(xn(d))} instead.`);return d.indexOf(c)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}}class Ln{constructor(i,c,d){this.type=et,this.needle=i,this.haystack=c,this.fromIndex=d}static parse(i,c){if(i.length<=2||i.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const d=c.parse(i[1],1,Bt),g=c.parse(i[2],2,Bt);if(!d||!g)return null;if(!bo(d.type,[jt,Gt,et,$i,Bt]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ir(d.type)} instead`);if(i.length===4){const b=c.parse(i[3],3,et);return b?new Ln(d,g,b):null}return new Ln(d,g)}evaluate(i){const c=this.needle.evaluate(i),d=this.haystack.evaluate(i);if(!oe(c,["boolean","string","number","null"]))throw new Hr(`Expected first argument to be of type boolean, string, number or null, but found ${Ir(xn(c))} instead.`);if(!oe(d,["string","array"]))throw new Hr(`Expected second argument to be of type array or string, but found ${Ir(xn(d))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(i);return d.indexOf(c,g)}return d.indexOf(c)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}}class Go{constructor(i,c,d,g,b,w){this.inputType=i,this.type=c,this.input=d,this.cases=g,this.outputs=b,this.otherwise=w}static parse(i,c){if(i.length<5)return c.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return c.error("Expected an even number of arguments.");let d,g;c.expectedType&&c.expectedType.kind!=="value"&&(g=c.expectedType);const b={},w=[];for(let D=2;D<i.length-1;D+=2){let N=i[D];const U=i[D+1];Array.isArray(N)||(N=[N]);const V=c.concat(D);if(N.length===0)return V.error("Expected at least one branch label.");for(const J of N){if(typeof J!="number"&&typeof J!="string")return V.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return V.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return V.error("Numeric branch labels must be integer values.");if(d){if(V.checkSubtype(d,xn(J)))return null}else d=xn(J);if(b[String(J)]!==void 0)return V.error("Branch labels must be unique.");b[String(J)]=w.length}const W=c.parse(U,D,g);if(!W)return null;g=g||W.type,w.push(W)}const I=c.parse(i[1],1,Bt);if(!I)return null;const k=c.parse(i[i.length-1],i.length-1,g);return k?I.type.kind!=="value"&&c.concat(1).checkSubtype(d,I.type)?null:new Go(d,g,I,b,w,k):null}evaluate(i){const c=this.input.evaluate(i);return(xn(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}}class br{constructor(i,c,d){this.type=i,this.branches=c,this.otherwise=d}static parse(i,c){if(i.length<4)return c.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return c.error("Expected an odd number of arguments.");let d;c.expectedType&&c.expectedType.kind!=="value"&&(d=c.expectedType);const g=[];for(let w=1;w<i.length-1;w+=2){const I=c.parse(i[w],w,jt);if(!I)return null;const k=c.parse(i[w+1],w+1,d);if(!k)return null;g.push([I,k]),d=d||k.type}const b=c.parse(i[i.length-1],i.length-1,d);if(!b)return null;if(!d)throw new Error("Can't infer output type");return new br(d,g,b)}evaluate(i){for(const[c,d]of this.branches)if(c.evaluate(i))return d.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[c,d]of this.branches)i(c),i(d);i(this.otherwise)}outputDefined(){return this.branches.every(([i,c])=>c.outputDefined())&&this.otherwise.outputDefined()}}class pi{constructor(i,c,d,g){this.type=i,this.input=c,this.beginIndex=d,this.endIndex=g}static parse(i,c){if(i.length<=2||i.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const d=c.parse(i[1],1,Bt),g=c.parse(i[2],2,et);if(!d||!g)return null;if(!bo(d.type,[jn(Bt),Gt,Bt]))return c.error(`Expected first argument to be of type array or string, but found ${Ir(d.type)} instead`);if(i.length===4){const b=c.parse(i[3],3,et);return b?new pi(d.type,d,g,b):null}return new pi(d.type,d,g)}evaluate(i){const c=this.input.evaluate(i),d=this.beginIndex.evaluate(i);if(!oe(c,["string","array"]))throw new Hr(`Expected first argument to be of type array or string, but found ${Ir(xn(c))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(i);return c.slice(d,g)}return c.slice(d)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}}function ll(s,i){return s==="=="||s==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function ul(s,i,c,d){return d.compare(i,c)===0}function la(s,i,c){const d=s!=="=="&&s!=="!=";return class OC{constructor(b,w,I){this.type=jt,this.lhs=b,this.rhs=w,this.collator=I,this.hasUntypedArgument=b.type.kind==="value"||w.type.kind==="value"}static parse(b,w){if(b.length!==3&&b.length!==4)return w.error("Expected two or three arguments.");const I=b[0];let k=w.parse(b[1],1,Bt);if(!k)return null;if(!ll(I,k.type))return w.concat(1).error(`"${I}" comparisons are not supported for type '${Ir(k.type)}'.`);let D=w.parse(b[2],2,Bt);if(!D)return null;if(!ll(I,D.type))return w.concat(2).error(`"${I}" comparisons are not supported for type '${Ir(D.type)}'.`);if(k.type.kind!==D.type.kind&&k.type.kind!=="value"&&D.type.kind!=="value")return w.error(`Cannot compare types '${Ir(k.type)}' and '${Ir(D.type)}'.`);d&&(k.type.kind==="value"&&D.type.kind!=="value"?k=new fn(D.type,[k]):k.type.kind!=="value"&&D.type.kind==="value"&&(D=new fn(k.type,[D])));let N=null;if(b.length===4){if(k.type.kind!=="string"&&D.type.kind!=="string"&&k.type.kind!=="value"&&D.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(N=w.parse(b[3],3,Jr),!N)return null}return new OC(k,D,N)}evaluate(b){const w=this.lhs.evaluate(b),I=this.rhs.evaluate(b);if(d&&this.hasUntypedArgument){const k=xn(w),D=xn(I);if(k.kind!==D.kind||k.kind!=="string"&&k.kind!=="number")throw new Hr(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${k.kind}, ${D.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const k=xn(w),D=xn(I);if(k.kind!=="string"||D.kind!=="string")return i(b,w,I)}return this.collator?c(b,w,I,this.collator.evaluate(b)):i(b,w,I)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}}}const ru=la("==",function(s,i,c){return i===c},ul),cl=la("!=",function(s,i,c){return i!==c},function(s,i,c,d){return!ul(0,i,c,d)}),Tl=la("<",function(s,i,c){return i<c},function(s,i,c,d){return d.compare(i,c)<0}),Cl=la(">",function(s,i,c){return i>c},function(s,i,c,d){return d.compare(i,c)>0}),nu=la("<=",function(s,i,c){return i<=c},function(s,i,c,d){return d.compare(i,c)<=0}),Ds=la(">=",function(s,i,c){return i>=c},function(s,i,c,d){return d.compare(i,c)>=0});class hl{constructor(i,c,d,g,b){this.type=Gt,this.number=i,this.locale=c,this.currency=d,this.minFractionDigits=g,this.maxFractionDigits=b}static parse(i,c){if(i.length!==3)return c.error("Expected two arguments.");const d=c.parse(i[1],1,et);if(!d)return null;const g=i[2];if(typeof g!="object"||Array.isArray(g))return c.error("NumberFormat options argument must be an object.");let b=null;if(g.locale&&(b=c.parse(g.locale,1,Gt),!b))return null;let w=null;if(g.currency&&(w=c.parse(g.currency,1,Gt),!w))return null;let I=null;if(g["min-fraction-digits"]&&(I=c.parse(g["min-fraction-digits"],1,et),!I))return null;let k=null;return g["max-fraction-digits"]&&(k=c.parse(g["max-fraction-digits"],1,et),!k)?null:new hl(d,b,w,I,k)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}}class zs{constructor(i){this.type=ir,this.sections=i}static parse(i,c){if(i.length<2)return c.error("Expected at least one argument.");const d=i[1];if(!Array.isArray(d)&&typeof d=="object")return c.error("First argument must be an image or text section.");const g=[];let b=!1;for(let w=1;w<=i.length-1;++w){const I=i[w];if(b&&typeof I=="object"&&!Array.isArray(I)){b=!1;let k=null;if(I["font-scale"]&&(k=c.parse(I["font-scale"],1,et),!k))return null;let D=null;if(I["text-font"]&&(D=c.parse(I["text-font"],1,jn(Gt)),!D))return null;let N=null;if(I["text-color"]&&(N=c.parse(I["text-color"],1,Nr),!N))return null;const U=g[g.length-1];U.scale=k,U.font=D,U.textColor=N}else{const k=c.parse(i[w],1,Bt);if(!k)return null;const D=k.type.kind;if(D!=="string"&&D!=="value"&&D!=="null"&&D!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,g.push({content:k,scale:null,font:null,textColor:null})}}return new zs(g)}evaluate(i){return new Rr(this.sections.map(c=>{const d=c.content.evaluate(i);return xn(d)===Yn?new ln("",d,null,null,null):new ln(Rs(d),null,c.scale?c.scale.evaluate(i):null,c.font?c.font.evaluate(i).join(","):null,c.textColor?c.textColor.evaluate(i):null)}))}eachChild(i){for(const c of this.sections)i(c.content),c.scale&&i(c.scale),c.font&&i(c.font),c.textColor&&i(c.textColor)}outputDefined(){return!1}}class Oa{constructor(i){this.type=Yn,this.input=i}static parse(i,c){if(i.length!==2)return c.error("Expected two arguments.");const d=c.parse(i[1],1,Gt);return d?new Oa(d):c.error("No image name provided.")}evaluate(i){const c=this.input.evaluate(i),d=Ci.fromString(c);return d&&i.availableImages&&(d.available=i.availableImages.indexOf(c)>-1),d}eachChild(i){i(this.input)}outputDefined(){return!1}}class ua{constructor(i){this.type=et,this.input=i}static parse(i,c){if(i.length!==2)return c.error(`Expected 1 argument, but found ${i.length-1} instead.`);const d=c.parse(i[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${Ir(d.type)} instead.`):new ua(d):null}evaluate(i){const c=this.input.evaluate(i);if(typeof c=="string"||Array.isArray(c))return c.length;throw new Hr(`Expected value to be of type string or array, but found ${Ir(xn(c))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}}const zn={"==":ru,"!=":cl,">":Cl,"<":Tl,">=":Ds,"<=":nu,array:fn,at:Cr,boolean:fn,case:br,coalesce:Pr,collator:Vo,format:zs,image:Oa,in:In,"index-of":Ln,interpolate:vr,"interpolate-hcl":vr,"interpolate-lab":vr,length:ua,let:Gi,literal:zr,match:Go,number:fn,"number-format":hl,object:fn,slice:pi,step:Pe,string:fn,"to-boolean":uo,"to-color":uo,"to-number":uo,"to-string":uo,var:Re,within:Ce};function Da(s,[i,c,d,g]){i=i.evaluate(s),c=c.evaluate(s),d=d.evaluate(s);const b=g?g.evaluate(s):1,w=aa(i,c,d,b);if(w)throw new Hr(w);return new tr(i/255,c/255,d/255,b,!1)}function za(s,i){return s in i}function Fa(s,i){const c=i[s];return c===void 0?null:c}function qi(s){return{type:s}}function Na(s){return{result:"success",value:s}}function Fs(s){return{result:"error",value:s}}function Ns(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function iu(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function qo(s){return!!s.expression&&s.expression.interpolated}function kr(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function ca(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function Bs(s){return s}function Hi(s,i){const c=i.type==="color",d=s.stops&&typeof s.stops[0][0]=="object",g=d||!(d||s.property!==void 0),b=s.type||(qo(i)?"exponential":"interval");if(c||i.type==="padding"){const N=c?tr.parse:Cn.parse;(s=_n({},s)).stops&&(s.stops=s.stops.map(U=>[U[0],N(U[1])])),s.default=N(s.default?s.default:i.default)}if(s.colorSpace&&(w=s.colorSpace)!=="rgb"&&w!=="hcl"&&w!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var w;let I,k,D;if(b==="exponential")I=da;else if(b==="interval")I=So;else if(b==="categorical"){I=ha,k=Object.create(null);for(const N of s.stops)k[N[0]]=N[1];D=typeof s.stops[0][0]}else{if(b!=="identity")throw new Error(`Unknown function type "${b}"`);I=fs}if(d){const N={},U=[];for(let J=0;J<s.stops.length;J++){const ae=s.stops[J],de=ae[0].zoom;N[de]===void 0&&(N[de]={zoom:de,type:s.type,property:s.property,default:s.default,stops:[]},U.push(de)),N[de].stops.push([ae[0].value,ae[1]])}const V=[];for(const J of U)V.push([N[J].zoom,Hi(N[J],i)]);const W={name:"linear"};return{kind:"composite",interpolationType:W,interpolationFactor:vr.interpolationFactor.bind(void 0,W),zoomStops:V.map(J=>J[0]),evaluate:({zoom:J},ae)=>da({stops:V,base:s.base},i,J).evaluate(J,ae)}}if(g){const N=b==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:N,interpolationFactor:vr.interpolationFactor.bind(void 0,N),zoomStops:s.stops.map(U=>U[0]),evaluate:({zoom:U})=>I(s,i,U,k,D)}}return{kind:"source",evaluate(N,U){const V=U&&U.properties?U.properties[s.property]:void 0;return V===void 0?mi(s.default,i.default):I(s,i,V,k,D)}}}function mi(s,i,c){return s!==void 0?s:i!==void 0?i:c!==void 0?c:void 0}function ha(s,i,c,d,g){return mi(typeof c===g?d[c]:void 0,s.default,i.default)}function So(s,i,c){if(kr(c)!=="number")return mi(s.default,i.default);const d=s.stops.length;if(d===1||c<=s.stops[0][0])return s.stops[0][1];if(c>=s.stops[d-1][0])return s.stops[d-1][1];const g=Be(s.stops.map(b=>b[0]),c);return s.stops[g][1]}function da(s,i,c){const d=s.base!==void 0?s.base:1;if(kr(c)!=="number")return mi(s.default,i.default);const g=s.stops.length;if(g===1||c<=s.stops[0][0])return s.stops[0][1];if(c>=s.stops[g-1][0])return s.stops[g-1][1];const b=Be(s.stops.map(N=>N[0]),c),w=function(N,U,V,W){const J=W-V,ae=N-V;return J===0?0:U===1?ae/J:(Math.pow(U,ae)-1)/(Math.pow(U,J)-1)}(c,d,s.stops[b][0],s.stops[b+1][0]),I=s.stops[b][1],k=s.stops[b+1][1],D=Ot[i.type]||Bs;return typeof I.evaluate=="function"?{evaluate(...N){const U=I.evaluate.apply(void 0,N),V=k.evaluate.apply(void 0,N);if(U!==void 0&&V!==void 0)return D(U,V,w,s.colorSpace)}}:D(I,k,w,s.colorSpace)}function fs(s,i,c){switch(i.type){case"color":c=tr.parse(c);break;case"formatted":c=Rr.fromString(c.toString());break;case"resolvedImage":c=Ci.fromString(c.toString());break;case"padding":c=Cn.parse(c);break;default:kr(c)===i.type||i.type==="enum"&&i.values[c]||(c=void 0)}return mi(c,s.default,i.default)}fe.register(zn,{error:[{kind:"error"},[Gt],(s,[i])=>{throw new Hr(i.evaluate(s))}],typeof:[Gt,[Bt],(s,[i])=>Ir(xn(i.evaluate(s)))],"to-rgba":[jn(et,4),[Nr],(s,[i])=>{const[c,d,g,b]=i.evaluate(s).rgb;return[255*c,255*d,255*g,b]}],rgb:[Nr,[et,et,et],Da],rgba:[Nr,[et,et,et,et],Da],has:{type:jt,overloads:[[[Gt],(s,[i])=>za(i.evaluate(s),s.properties())],[[Gt,$o],(s,[i,c])=>za(i.evaluate(s),c.evaluate(s))]]},get:{type:Bt,overloads:[[[Gt],(s,[i])=>Fa(i.evaluate(s),s.properties())],[[Gt,$o],(s,[i,c])=>Fa(i.evaluate(s),c.evaluate(s))]]},"feature-state":[Bt,[Gt],(s,[i])=>Fa(i.evaluate(s),s.featureState||{})],properties:[$o,[],s=>s.properties()],"geometry-type":[Gt,[],s=>s.geometryType()],id:[Bt,[],s=>s.id()],zoom:[et,[],s=>s.globals.zoom],"heatmap-density":[et,[],s=>s.globals.heatmapDensity||0],"line-progress":[et,[],s=>s.globals.lineProgress||0],accumulated:[Bt,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[et,qi(et),(s,i)=>{let c=0;for(const d of i)c+=d.evaluate(s);return c}],"*":[et,qi(et),(s,i)=>{let c=1;for(const d of i)c*=d.evaluate(s);return c}],"-":{type:et,overloads:[[[et,et],(s,[i,c])=>i.evaluate(s)-c.evaluate(s)],[[et],(s,[i])=>-i.evaluate(s)]]},"/":[et,[et,et],(s,[i,c])=>i.evaluate(s)/c.evaluate(s)],"%":[et,[et,et],(s,[i,c])=>i.evaluate(s)%c.evaluate(s)],ln2:[et,[],()=>Math.LN2],pi:[et,[],()=>Math.PI],e:[et,[],()=>Math.E],"^":[et,[et,et],(s,[i,c])=>Math.pow(i.evaluate(s),c.evaluate(s))],sqrt:[et,[et],(s,[i])=>Math.sqrt(i.evaluate(s))],log10:[et,[et],(s,[i])=>Math.log(i.evaluate(s))/Math.LN10],ln:[et,[et],(s,[i])=>Math.log(i.evaluate(s))],log2:[et,[et],(s,[i])=>Math.log(i.evaluate(s))/Math.LN2],sin:[et,[et],(s,[i])=>Math.sin(i.evaluate(s))],cos:[et,[et],(s,[i])=>Math.cos(i.evaluate(s))],tan:[et,[et],(s,[i])=>Math.tan(i.evaluate(s))],asin:[et,[et],(s,[i])=>Math.asin(i.evaluate(s))],acos:[et,[et],(s,[i])=>Math.acos(i.evaluate(s))],atan:[et,[et],(s,[i])=>Math.atan(i.evaluate(s))],min:[et,qi(et),(s,i)=>Math.min(...i.map(c=>c.evaluate(s)))],max:[et,qi(et),(s,i)=>Math.max(...i.map(c=>c.evaluate(s)))],abs:[et,[et],(s,[i])=>Math.abs(i.evaluate(s))],round:[et,[et],(s,[i])=>{const c=i.evaluate(s);return c<0?-Math.round(-c):Math.round(c)}],floor:[et,[et],(s,[i])=>Math.floor(i.evaluate(s))],ceil:[et,[et],(s,[i])=>Math.ceil(i.evaluate(s))],"filter-==":[jt,[Gt,Bt],(s,[i,c])=>s.properties()[i.value]===c.value],"filter-id-==":[jt,[Bt],(s,[i])=>s.id()===i.value],"filter-type-==":[jt,[Gt],(s,[i])=>s.geometryType()===i.value],"filter-<":[jt,[Gt,Bt],(s,[i,c])=>{const d=s.properties()[i.value],g=c.value;return typeof d==typeof g&&d<g}],"filter-id-<":[jt,[Bt],(s,[i])=>{const c=s.id(),d=i.value;return typeof c==typeof d&&c<d}],"filter->":[jt,[Gt,Bt],(s,[i,c])=>{const d=s.properties()[i.value],g=c.value;return typeof d==typeof g&&d>g}],"filter-id->":[jt,[Bt],(s,[i])=>{const c=s.id(),d=i.value;return typeof c==typeof d&&c>d}],"filter-<=":[jt,[Gt,Bt],(s,[i,c])=>{const d=s.properties()[i.value],g=c.value;return typeof d==typeof g&&d<=g}],"filter-id-<=":[jt,[Bt],(s,[i])=>{const c=s.id(),d=i.value;return typeof c==typeof d&&c<=d}],"filter->=":[jt,[Gt,Bt],(s,[i,c])=>{const d=s.properties()[i.value],g=c.value;return typeof d==typeof g&&d>=g}],"filter-id->=":[jt,[Bt],(s,[i])=>{const c=s.id(),d=i.value;return typeof c==typeof d&&c>=d}],"filter-has":[jt,[Bt],(s,[i])=>i.value in s.properties()],"filter-has-id":[jt,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[jt,[jn(Gt)],(s,[i])=>i.value.indexOf(s.geometryType())>=0],"filter-id-in":[jt,[jn(Bt)],(s,[i])=>i.value.indexOf(s.id())>=0],"filter-in-small":[jt,[Gt,jn(Bt)],(s,[i,c])=>c.value.indexOf(s.properties()[i.value])>=0],"filter-in-large":[jt,[Gt,jn(Bt)],(s,[i,c])=>function(d,g,b,w){for(;b<=w;){const I=b+w>>1;if(g[I]===d)return!0;g[I]>d?w=I-1:b=I+1}return!1}(s.properties()[i.value],c.value,0,c.value.length-1)],all:{type:jt,overloads:[[[jt,jt],(s,[i,c])=>i.evaluate(s)&&c.evaluate(s)],[qi(jt),(s,i)=>{for(const c of i)if(!c.evaluate(s))return!1;return!0}]]},any:{type:jt,overloads:[[[jt,jt],(s,[i,c])=>i.evaluate(s)||c.evaluate(s)],[qi(jt),(s,i)=>{for(const c of i)if(c.evaluate(s))return!0;return!1}]]},"!":[jt,[jt],(s,[i])=>!i.evaluate(s)],"is-supported-script":[jt,[Gt],(s,[i])=>{const c=s.globals&&s.globals.isSupportedScript;return!c||c(i.evaluate(s))}],upcase:[Gt,[Gt],(s,[i])=>i.evaluate(s).toUpperCase()],downcase:[Gt,[Gt],(s,[i])=>i.evaluate(s).toLowerCase()],concat:[Gt,qi(Bt),(s,i)=>i.map(c=>Rs(c.evaluate(s))).join("")],"resolved-locale":[Gt,[Jr],(s,[i])=>i.evaluate(s).resolvedLocale()]});class Us{constructor(i,c){var d;this.expression=i,this._warningHistory={},this._evaluator=new Eo,this._defaultValue=c?(d=c).type==="color"&&ca(d.default)?new tr(0,0,0,0):d.type==="color"?tr.parse(d.default)||null:d.type==="padding"?Cn.parse(d.default)||null:d.default===void 0?null:d.default:null,this._enumValues=c&&c.type==="enum"?c.values:null}evaluateWithoutErrorHandling(i,c,d,g,b,w){return this._evaluator.globals=i,this._evaluator.feature=c,this._evaluator.featureState=d,this._evaluator.canonical=g,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)}evaluate(i,c,d,g,b,w){this._evaluator.globals=i,this._evaluator.feature=c||null,this._evaluator.featureState=d||null,this._evaluator.canonical=g,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=w||null;try{const I=this.expression.evaluate(this._evaluator);if(I==null||typeof I=="number"&&I!=I)return this._defaultValue;if(this._enumValues&&!(I in this._enumValues))throw new Hr(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(I)} instead.`);return I}catch(I){return this._warningHistory[I.message]||(this._warningHistory[I.message]=!0,typeof console<"u"&&console.warn(I.message)),this._defaultValue}}}function Ba(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in zn}function Ua(s,i){const c=new Os(zn,$e,[],i?function(g){const b={color:Nr,string:Gt,number:et,enum:Gt,boolean:jt,formatted:ir,padding:lo,resolvedImage:Yn};return g.type==="array"?jn(b[g.value]||Bt,g.length):b[g.type]}(i):void 0),d=c.parse(s,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?Na(new Us(d,i)):Fs(c.errors)}class mn{constructor(i,c){this.kind=i,this._styleExpression=c,this.isStateDependent=i!=="constant"&&!tt(c.expression)}evaluateWithoutErrorHandling(i,c,d,g,b,w){return this._styleExpression.evaluateWithoutErrorHandling(i,c,d,g,b,w)}evaluate(i,c,d,g,b,w){return this._styleExpression.evaluate(i,c,d,g,b,w)}}class Il{constructor(i,c,d,g){this.kind=i,this.zoomStops=d,this._styleExpression=c,this.isStateDependent=i!=="camera"&&!tt(c.expression),this.interpolationType=g}evaluateWithoutErrorHandling(i,c,d,g,b,w){return this._styleExpression.evaluateWithoutErrorHandling(i,c,d,g,b,w)}evaluate(i,c,d,g,b,w){return this._styleExpression.evaluate(i,c,d,g,b,w)}interpolationFactor(i,c,d){return this.interpolationType?vr.interpolationFactor(this.interpolationType,i,c,d):0}}function cr(s,i){const c=Ua(s,i);if(c.result==="error")return c;const d=c.value.expression,g=at(d);if(!g&&!Ns(i))return Fs([new Jn("","data expressions not supported")]);const b=Tt(d,["zoom"]);if(!b&&!iu(i))return Fs([new Jn("","zoom expressions not supported")]);const w=wr(d);return w||b?w instanceof Jn?Fs([w]):w instanceof vr&&!qo(i)?Fs([new Jn("",'"interpolate" expressions cannot be used with this property')]):Na(w?new Il(g?"camera":"composite",c.value,w.labels,w instanceof vr?w.interpolation:void 0):new mn(g?"constant":"source",c.value)):Fs([new Jn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ho{constructor(i,c){this._parameters=i,this._specification=c,_n(this,Hi(this._parameters,this._specification))}static deserialize(i){return new Ho(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function wr(s){let i=null;if(s instanceof Gi)i=wr(s.result);else if(s instanceof Pr){for(const c of s.args)if(i=wr(c),i)break}else(s instanceof Pe||s instanceof vr)&&s.input instanceof fe&&s.input.name==="zoom"&&(i=s);return i instanceof Jn||s.eachChild(c=>{const d=wr(c);d instanceof Jn?i=d:!i&&d?i=new Jn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&d&&i!==d&&(i=new Jn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function hr(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const i of s.slice(1))if(!hr(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}const To={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ii(s){if(s==null)return{filter:()=>!0,needGeometry:!1};hr(s)||(s=gs(s));const i=Ua(s,To);if(i.result==="error")throw new Error(i.value.map(c=>`${c.key}: ${c.message}`).join(", "));return{filter:(c,d,g)=>i.value.evaluate(c,d,{},g),needGeometry:ms(s)}}function ps(s,i){return s<i?-1:s>i?1:0}function ms(s){if(!Array.isArray(s))return!1;if(s[0]==="within")return!0;for(let i=1;i<s.length;i++)if(ms(s[i]))return!0;return!1}function gs(s){if(!s)return!0;const i=s[0];return s.length<=1?i!=="any":i==="=="?js(s[1],s[2],"=="):i==="!="?pa(js(s[1],s[2],"==")):i==="<"||i===">"||i==="<="||i===">="?js(s[1],s[2],i):i==="any"?(c=s.slice(1),["any"].concat(c.map(gs))):i==="all"?["all"].concat(s.slice(1).map(gs)):i==="none"?["all"].concat(s.slice(1).map(gs).map(pa)):i==="in"?$s(s[1],s.slice(2)):i==="!in"?pa($s(s[1],s.slice(2))):i==="has"?fa(s[1]):i==="!has"?pa(fa(s[1])):i!=="within"||s;var c}function js(s,i,c){switch(s){case"$type":return[`filter-type-${c}`,i];case"$id":return[`filter-id-${c}`,i];default:return[`filter-${c}`,s,i]}}function $s(s,i){if(i.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(c=>typeof c!=typeof i[0])?["filter-in-large",s,["literal",i.sort(ps)]]:["filter-in-small",s,["literal",i]]}}function fa(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function pa(s){return["!",s]}function ja(s){const i=typeof s;if(i==="number"||i==="boolean"||i==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let g="[";for(const b of s)g+=`${ja(b)},`;return`${g}]`}const c=Object.keys(s).sort();let d="{";for(let g=0;g<c.length;g++)d+=`${JSON.stringify(c[g])}:${ja(s[c[g]])},`;return`${d}}`}function $a(s){let i="";for(const c of Xn)i+=`/${ja(s[c])}`;return i}function Vs(s){const i=s.value;return i?[new ut(s.key,i,"constants have been deprecated as of v8")]:[]}function un(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function Zi(s){if(Array.isArray(s))return s.map(Zi);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const i={};for(const c in s)i[c]=Zi(s[c]);return i}return un(s)}function Ee(s){const i=s.key,c=s.value,d=s.valueSpec||{},g=s.objectElementValidators||{},b=s.style,w=s.styleSpec,I=s.validateSpec;let k=[];const D=kr(c);if(D!=="object")return[new ut(i,c,`object expected, ${D} found`)];for(const N in c){const U=N.split(".")[0],V=d[U]||d["*"];let W;if(g[U])W=g[U];else if(d[U])W=I;else if(g["*"])W=g["*"];else{if(!d["*"]){k.push(new ut(i,c[N],`unknown property "${N}"`));continue}W=I}k=k.concat(W({key:(i&&`${i}.`)+N,value:c[N],valueSpec:V,style:b,styleSpec:w,object:c,objectKey:N,validateSpec:I},c))}for(const N in d)g[N]||d[N].required&&d[N].default===void 0&&c[N]===void 0&&k.push(new ut(i,c,`missing required property "${N}"`));return k}function Fe(s){const i=s.value,c=s.valueSpec,d=s.style,g=s.styleSpec,b=s.key,w=s.arrayElementValidator||s.validateSpec;if(kr(i)!=="array")return[new ut(b,i,`array expected, ${kr(i)} found`)];if(c.length&&i.length!==c.length)return[new ut(b,i,`array length ${c.length} expected, length ${i.length} found`)];if(c["min-length"]&&i.length<c["min-length"])return[new ut(b,i,`array length at least ${c["min-length"]} expected, length ${i.length} found`)];let I={type:c.value,values:c.values};g.$version<7&&(I.function=c.function),kr(c.value)==="object"&&(I=c.value);let k=[];for(let D=0;D<i.length;D++)k=k.concat(w({array:i,arrayIndex:D,value:i[D],valueSpec:I,validateSpec:s.validateSpec,style:d,styleSpec:g,key:`${b}[${D}]`}));return k}function ft(s){const i=s.key,c=s.value,d=s.valueSpec;let g=kr(c);return g==="number"&&c!=c&&(g="NaN"),g!=="number"?[new ut(i,c,`number expected, ${g} found`)]:"minimum"in d&&c<d.minimum?[new ut(i,c,`${c} is less than the minimum value ${d.minimum}`)]:"maximum"in d&&c>d.maximum?[new ut(i,c,`${c} is greater than the maximum value ${d.maximum}`)]:[]}function At(s){const i=s.valueSpec,c=un(s.value.type);let d,g,b,w={};const I=c!=="categorical"&&s.value.property===void 0,k=!I,D=kr(s.value.stops)==="array"&&kr(s.value.stops[0])==="array"&&kr(s.value.stops[0][0])==="object",N=Ee({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(W){if(c==="identity")return[new ut(W.key,W.value,'identity function may not have a "stops" property')];let J=[];const ae=W.value;return J=J.concat(Fe({key:W.key,value:ae,valueSpec:W.valueSpec,validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec,arrayElementValidator:U})),kr(ae)==="array"&&ae.length===0&&J.push(new ut(W.key,ae,"array must have at least one stop")),J},default:function(W){return W.validateSpec({key:W.key,value:W.value,valueSpec:i,validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec})}}});return c==="identity"&&I&&N.push(new ut(s.key,s.value,'missing required property "property"')),c==="identity"||s.value.stops||N.push(new ut(s.key,s.value,'missing required property "stops"')),c==="exponential"&&s.valueSpec.expression&&!qo(s.valueSpec)&&N.push(new ut(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(k&&!Ns(s.valueSpec)?N.push(new ut(s.key,s.value,"property functions not supported")):I&&!iu(s.valueSpec)&&N.push(new ut(s.key,s.value,"zoom functions not supported"))),c!=="categorical"&&!D||s.value.property!==void 0||N.push(new ut(s.key,s.value,'"property" property is required')),N;function U(W){let J=[];const ae=W.value,de=W.key;if(kr(ae)!=="array")return[new ut(de,ae,`array expected, ${kr(ae)} found`)];if(ae.length!==2)return[new ut(de,ae,`array length 2 expected, length ${ae.length} found`)];if(D){if(kr(ae[0])!=="object")return[new ut(de,ae,`object expected, ${kr(ae[0])} found`)];if(ae[0].zoom===void 0)return[new ut(de,ae,"object stop key must have zoom")];if(ae[0].value===void 0)return[new ut(de,ae,"object stop key must have value")];if(b&&b>un(ae[0].zoom))return[new ut(de,ae[0].zoom,"stop zoom values must appear in ascending order")];un(ae[0].zoom)!==b&&(b=un(ae[0].zoom),g=void 0,w={}),J=J.concat(Ee({key:`${de}[0]`,value:ae[0],valueSpec:{zoom:{}},validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec,objectElementValidators:{zoom:ft,value:V}}))}else J=J.concat(V({key:`${de}[0]`,value:ae[0],valueSpec:{},validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec},ae));return Ba(Zi(ae[1]))?J.concat([new ut(`${de}[1]`,ae[1],"expressions are not allowed in function stops.")]):J.concat(W.validateSpec({key:`${de}[1]`,value:ae[1],valueSpec:i,validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec}))}function V(W,J){const ae=kr(W.value),de=un(W.value),ge=W.value!==null?W.value:J;if(d){if(ae!==d)return[new ut(W.key,ge,`${ae} stop domain type must match previous stop domain type ${d}`)]}else d=ae;if(ae!=="number"&&ae!=="string"&&ae!=="boolean")return[new ut(W.key,ge,"stop domain value must be a number, string, or boolean")];if(ae!=="number"&&c!=="categorical"){let Ie=`number expected, ${ae} found`;return Ns(i)&&c===void 0&&(Ie+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ut(W.key,ge,Ie)]}return c!=="categorical"||ae!=="number"||isFinite(de)&&Math.floor(de)===de?c!=="categorical"&&ae==="number"&&g!==void 0&&de<g?[new ut(W.key,ge,"stop domain values must appear in ascending order")]:(g=de,c==="categorical"&&de in w?[new ut(W.key,ge,"stop domain values must be unique")]:(w[de]=!0,[])):[new ut(W.key,ge,`integer expected, found ${de}`)]}}function Fr(s){const i=(s.expressionContext==="property"?cr:Ua)(Zi(s.value),s.valueSpec);if(i.result==="error")return i.value.map(d=>new ut(`${s.key}${d.key}`,s.value,d.message));const c=i.value.expression||i.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!c.outputDefined())return[new ut(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!tt(c))return[new ut(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!tt(c))return[new ut(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!Tt(c,["zoom","feature-state"]))return[new ut(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!at(c))return[new ut(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function dr(s){const i=s.key,c=s.value,d=s.valueSpec,g=[];return Array.isArray(d.values)?d.values.indexOf(un(c))===-1&&g.push(new ut(i,c,`expected one of [${d.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(d.values).indexOf(un(c))===-1&&g.push(new ut(i,c,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(c)} found`)),g}function Qr(s){return hr(Zi(s.value))?Fr(_n({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):nn(s)}function nn(s){const i=s.value,c=s.key;if(kr(i)!=="array")return[new ut(c,i,`array expected, ${kr(i)} found`)];const d=s.styleSpec;let g,b=[];if(i.length<1)return[new ut(c,i,"filter array must have at least 1 element")];switch(b=b.concat(dr({key:`${c}[0]`,value:i[0],valueSpec:d.filter_operator,style:s.style,styleSpec:s.styleSpec})),un(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&un(i[1])==="$type"&&b.push(new ut(c,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&b.push(new ut(c,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(g=kr(i[1]),g!=="string"&&b.push(new ut(`${c}[1]`,i[1],`string expected, ${g} found`)));for(let w=2;w<i.length;w++)g=kr(i[w]),un(i[1])==="$type"?b=b.concat(dr({key:`${c}[${w}]`,value:i[w],valueSpec:d.geometry_type,style:s.style,styleSpec:s.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&b.push(new ut(`${c}[${w}]`,i[w],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let w=1;w<i.length;w++)b=b.concat(nn({key:`${c}[${w}]`,value:i[w],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":g=kr(i[1]),i.length!==2?b.push(new ut(c,i,`filter array for "${i[0]}" operator must have 2 elements`)):g!=="string"&&b.push(new ut(`${c}[1]`,i[1],`string expected, ${g} found`));break;case"within":g=kr(i[1]),i.length!==2?b.push(new ut(c,i,`filter array for "${i[0]}" operator must have 2 elements`)):g!=="object"&&b.push(new ut(`${c}[1]`,i[1],`object expected, ${g} found`))}return b}function zi(s,i){const c=s.key,d=s.validateSpec,g=s.style,b=s.styleSpec,w=s.value,I=s.objectKey,k=b[`${i}_${s.layerType}`];if(!k)return[];const D=I.match(/^(.*)-transition$/);if(i==="paint"&&D&&k[D[1]]&&k[D[1]].transition)return d({key:c,value:w,valueSpec:b.transition,style:g,styleSpec:b});const N=s.valueSpec||k[I];if(!N)return[new ut(c,w,`unknown property "${I}"`)];let U;if(kr(w)==="string"&&Ns(N)&&!N.tokens&&(U=/^{([^}]+)}$/.exec(w)))return[new ut(c,w,`"${I}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(U[1])} }\`.`)];const V=[];return s.layerType==="symbol"&&(I==="text-field"&&g&&!g.glyphs&&V.push(new ut(c,w,'use of "text-field" requires a style "glyphs" property')),I==="text-font"&&ca(Zi(w))&&un(w.type)==="identity"&&V.push(new ut(c,w,'"text-font" does not support identity functions'))),V.concat(d({key:s.key,value:w,valueSpec:N,style:g,styleSpec:b,expressionContext:"property",propertyType:i,propertyKey:I}))}function bn(s){return zi(s,"paint")}function Pn(s){return zi(s,"layout")}function ei(s){let i=[];const c=s.value,d=s.key,g=s.style,b=s.styleSpec;c.type||c.ref||i.push(new ut(d,c,'either "type" or "ref" is required'));let w=un(c.type);const I=un(c.ref);if(c.id){const k=un(c.id);for(let D=0;D<s.arrayIndex;D++){const N=g.layers[D];un(N.id)===k&&i.push(new ut(d,c.id,`duplicate layer id "${c.id}", previously used at line ${N.id.__line__}`))}}if("ref"in c){let k;["type","source","source-layer","filter","layout"].forEach(D=>{D in c&&i.push(new ut(d,c[D],`"${D}" is prohibited for ref layers`))}),g.layers.forEach(D=>{un(D.id)===I&&(k=D)}),k?k.ref?i.push(new ut(d,c.ref,"ref cannot reference another ref layer")):w=un(k.type):i.push(new ut(d,c.ref,`ref layer "${I}" not found`))}else if(w!=="background")if(c.source){const k=g.sources&&g.sources[c.source],D=k&&un(k.type);k?D==="vector"&&w==="raster"?i.push(new ut(d,c.source,`layer "${c.id}" requires a raster source`)):D==="raster"&&w!=="raster"?i.push(new ut(d,c.source,`layer "${c.id}" requires a vector source`)):D!=="vector"||c["source-layer"]?D==="raster-dem"&&w!=="hillshade"?i.push(new ut(d,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!c.paint||!c.paint["line-gradient"]||D==="geojson"&&k.lineMetrics||i.push(new ut(d,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new ut(d,c,`layer "${c.id}" must specify a "source-layer"`)):i.push(new ut(d,c.source,`source "${c.source}" not found`))}else i.push(new ut(d,c,'missing required property "source"'));return i=i.concat(Ee({key:d,value:c,valueSpec:b.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${d}.type`,value:c.type,valueSpec:b.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:c,objectKey:"type"}),filter:Qr,layout:k=>Ee({layer:c,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*":D=>Pn(_n({layerType:w},D))}}),paint:k=>Ee({layer:c,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*":D=>bn(_n({layerType:w},D))}})}})),i}function Fn(s){const i=s.value,c=s.key,d=kr(i);return d!=="string"?[new ut(c,i,`string expected, ${d} found`)]:[]}const $n={promoteId:function({key:s,value:i}){if(kr(i)==="string")return Fn({key:s,value:i});{const c=[];for(const d in i)c.push(...Fn({key:`${s}.${d}`,value:i[d]}));return c}}};function Se(s){const i=s.value,c=s.key,d=s.styleSpec,g=s.style,b=s.validateSpec;if(!i.type)return[new ut(c,i,'"type" is required')];const w=un(i.type);let I;switch(w){case"vector":case"raster":case"raster-dem":return I=Ee({key:c,value:i,valueSpec:d[`source_${w.replace("-","_")}`],style:s.style,styleSpec:d,objectElementValidators:$n,validateSpec:b}),I;case"geojson":if(I=Ee({key:c,value:i,valueSpec:d.source_geojson,style:g,styleSpec:d,validateSpec:b,objectElementValidators:$n}),i.cluster)for(const k in i.clusterProperties){const[D,N]=i.clusterProperties[k],U=typeof D=="string"?[D,["accumulated"],["get",k]]:D;I.push(...Fr({key:`${c}.${k}.map`,value:N,validateSpec:b,expressionContext:"cluster-map"})),I.push(...Fr({key:`${c}.${k}.reduce`,value:U,validateSpec:b,expressionContext:"cluster-reduce"}))}return I;case"video":return Ee({key:c,value:i,valueSpec:d.source_video,style:g,validateSpec:b,styleSpec:d});case"image":return Ee({key:c,value:i,valueSpec:d.source_image,style:g,validateSpec:b,styleSpec:d});case"canvas":return[new ut(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return dr({key:`${c}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:g,validateSpec:b,styleSpec:d})}}function Ne(s){const i=s.value,c=s.styleSpec,d=c.light,g=s.style;let b=[];const w=kr(i);if(i===void 0)return b;if(w!=="object")return b=b.concat([new ut("light",i,`object expected, ${w} found`)]),b;for(const I in i){const k=I.match(/^(.*)-transition$/);b=b.concat(k&&d[k[1]]&&d[k[1]].transition?s.validateSpec({key:I,value:i[I],valueSpec:c.transition,validateSpec:s.validateSpec,style:g,styleSpec:c}):d[I]?s.validateSpec({key:I,value:i[I],valueSpec:d[I],validateSpec:s.validateSpec,style:g,styleSpec:c}):[new ut(I,i[I],`unknown property "${I}"`)])}return b}function lt(s){const i=s.value,c=s.styleSpec,d=c.terrain,g=s.style;let b=[];const w=kr(i);if(i===void 0)return b;if(w!=="object")return b=b.concat([new ut("terrain",i,`object expected, ${w} found`)]),b;for(const I in i)b=b.concat(d[I]?s.validateSpec({key:I,value:i[I],valueSpec:d[I],validateSpec:s.validateSpec,style:g,styleSpec:c}):[new ut(I,i[I],`unknown property "${I}"`)]);return b}function kt(s){let i=[];const c=s.value,d=s.key;if(Array.isArray(c)){const g=[],b=[];for(const w in c)c[w].id&&g.includes(c[w].id)&&i.push(new ut(d,c,`all the sprites' ids must be unique, but ${c[w].id} is duplicated`)),g.push(c[w].id),c[w].url&&b.includes(c[w].url)&&i.push(new ut(d,c,`all the sprites' URLs must be unique, but ${c[w].url} is duplicated`)),b.push(c[w].url),i=i.concat(Ee({key:`${d}[${w}]`,value:c[w],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return i}return Fn({key:d,value:c})}const jr={"*":()=>[],array:Fe,boolean:function(s){const i=s.value,c=s.key,d=kr(i);return d!=="boolean"?[new ut(c,i,`boolean expected, ${d} found`)]:[]},number:ft,color:function(s){const i=s.key,c=s.value,d=kr(c);return d!=="string"?[new ut(i,c,`color expected, ${d} found`)]:tr.parse(String(c))?[]:[new ut(i,c,`color expected, "${c}" found`)]},constants:Vs,enum:dr,filter:Qr,function:At,layer:ei,object:Ee,source:Se,light:Ne,terrain:lt,string:Fn,formatted:function(s){return Fn(s).length===0?[]:Fr(s)},resolvedImage:function(s){return Fn(s).length===0?[]:Fr(s)},padding:function(s){const i=s.key,c=s.value;if(kr(c)==="array"){if(c.length<1||c.length>4)return[new ut(i,c,`padding requires 1 to 4 values; ${c.length} values found`)];const d={type:"number"};let g=[];for(let b=0;b<c.length;b++)g=g.concat(s.validateSpec({key:`${i}[${b}]`,value:c[b],validateSpec:s.validateSpec,valueSpec:d}));return g}return ft({key:i,value:c,valueSpec:{}})},sprite:kt};function lr(s){const i=s.value,c=s.valueSpec,d=s.styleSpec;return s.validateSpec=lr,c.expression&&ca(un(i))?At(s):c.expression&&Ba(Zi(i))?Fr(s):c.type&&jr[c.type]?jr[c.type](s):Ee(_n({},s,{valueSpec:c.type?d[c.type]:c}))}function gn(s){const i=s.value,c=s.key,d=Fn(s);return d.length||(i.indexOf("{fontstack}")===-1&&d.push(new ut(c,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&d.push(new ut(c,i,'"glyphs" url must include a "{range}" token'))),d}function Zr(s,i=Ue){let c=[];return c=c.concat(lr({key:"",value:s,valueSpec:i.$root,styleSpec:i,style:s,validateSpec:lr,objectElementValidators:{glyphs:gn,"*":()=>[]}})),s.constants&&(c=c.concat(Vs({key:"constants",value:s.constants,style:s,styleSpec:i,validateSpec:lr}))),Jt(c)}function or(s){return function(i){return s({...i,validateSpec:lr})}}function Jt(s){return[].concat(s).sort((i,c)=>i.line-c.line)}function ur(s){return function(...i){return Jt(s.apply(this,i))}}Zr.source=ur(or(Se)),Zr.sprite=ur(or(kt)),Zr.glyphs=ur(or(gn)),Zr.light=ur(or(Ne)),Zr.terrain=ur(or(lt)),Zr.layer=ur(or(ei)),Zr.filter=ur(or(Qr)),Zr.paintProperty=ur(or(bn)),Zr.layoutProperty=ur(or(Pn));const pn=Zr,co=pn.light,on=pn.paintProperty,ti=pn.layoutProperty;function Vn(s,i){let c=!1;if(i&&i.length)for(const d of i)s.fire(new so(new Error(d.message))),c=!0;return c}class Wi{constructor(i,c,d){const g=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;const w=new Int32Array(this.arrayBuffer);i=w[0],this.d=(c=w[1])+2*(d=w[2]);for(let k=0;k<this.d*this.d;k++){const D=w[3+k],N=w[3+k+1];g.push(D===N?null:w.subarray(D,N))}const I=w[3+g.length+1];this.keys=w.subarray(w[3+g.length],I),this.bboxes=w.subarray(I),this.insert=this._insertReadonly}else{this.d=c+2*d;for(let w=0;w<this.d*this.d;w++)g.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=i,this.padding=d,this.scale=c/i,this.uid=0;const b=d/c*i;this.min=-b,this.max=i+b}insert(i,c,d,g,b){this._forEachCell(c,d,g,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(i),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(g),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(i,c,d,g,b,w){this.cells[b].push(w)}query(i,c,d,g,b){const w=this.min,I=this.max;if(i<=w&&c<=w&&I<=d&&I<=g&&!b)return Array.prototype.slice.call(this.keys);{const k=[];return this._forEachCell(i,c,d,g,this._queryCell,k,{},b),k}}_queryCell(i,c,d,g,b,w,I,k){const D=this.cells[b];if(D!==null){const N=this.keys,U=this.bboxes;for(let V=0;V<D.length;V++){const W=D[V];if(I[W]===void 0){const J=4*W;(k?k(U[J+0],U[J+1],U[J+2],U[J+3]):i<=U[J+2]&&c<=U[J+3]&&d>=U[J+0]&&g>=U[J+1])?(I[W]=!0,w.push(N[W])):I[W]=!1}}}}_forEachCell(i,c,d,g,b,w,I,k){const D=this._convertToCellCoord(i),N=this._convertToCellCoord(c),U=this._convertToCellCoord(d),V=this._convertToCellCoord(g);for(let W=D;W<=U;W++)for(let J=N;J<=V;J++){const ae=this.d*J+W;if((!k||k(this._convertFromCellCoord(W),this._convertFromCellCoord(J),this._convertFromCellCoord(W+1),this._convertFromCellCoord(J+1)))&&b.call(this,i,c,d,g,ae,w,I,k))return}}_convertFromCellCoord(i){return(i-this.padding)/this.scale}_convertToCellCoord(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const i=this.cells,c=3+this.cells.length+1+1;let d=0;for(let w=0;w<this.cells.length;w++)d+=this.cells[w].length;const g=new Int32Array(c+d+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let b=c;for(let w=0;w<i.length;w++){const I=i[w];g[3+w]=b,g.set(I,b),b+=I.length}return g[3+i.length]=b,g.set(this.keys,b),b+=this.keys.length,g[3+i.length+1]=b,g.set(this.bboxes,b),b+=this.bboxes.length,g.buffer}static serialize(i,c){const d=i.toArrayBuffer();return c&&c.push(d),{buffer:d}}static deserialize(i){return new Wi(i.buffer)}}const Gn={};function yt(s,i,c={}){if(Gn[s])throw new Error(`${s} is already registered.`);Object.defineProperty(i,"_classRegistryKey",{value:s,writeable:!1}),Gn[s]={klass:i,omit:c.omit||[],shallow:c.shallow||[]}}yt("Object",Object),yt("TransferableGridIndex",Wi),yt("Color",tr),yt("Error",Error),yt("AJAXError",gr),yt("ResolvedImage",Ci),yt("StylePropertyFunction",Ho),yt("StyleExpression",Us,{omit:["_evaluator"]}),yt("ZoomDependentExpression",Il),yt("ZoomConstantExpression",mn),yt("CompoundExpression",fe,{omit:["_evaluate"]});for(const s in zn)zn[s]._classRegistryKey||yt(`Expression_${s}`,zn[s]);function Ki(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function ma(s,i){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob)return s;if(Ki(s)||sn(s))return i&&i.push(s),s;if(ArrayBuffer.isView(s)){const c=s;return i&&i.push(c.buffer),c}if(s instanceof ImageData)return i&&i.push(s.data.buffer),s;if(Array.isArray(s)){const c=[];for(const d of s)c.push(ma(d,i));return c}if(typeof s=="object"){const c=s.constructor,d=c._classRegistryKey;if(!d)throw new Error("can't serialize object of unregistered class");if(!Gn[d])throw new Error(`${d} is not registered.`);const g=c.serialize?c.serialize(s,i):{};if(c.serialize){if(i&&g===i[i.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const b in s){if(!s.hasOwnProperty(b)||Gn[d].omit.indexOf(b)>=0)continue;const w=s[b];g[b]=Gn[d].shallow.indexOf(b)>=0?w:ma(w,i)}s instanceof Error&&(g.message=s.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return d!=="Object"&&(g.$name=d),g}throw new Error("can't serialize object of type "+typeof s)}function Xi(s){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||Ki(s)||sn(s)||ArrayBuffer.isView(s)||s instanceof ImageData)return s;if(Array.isArray(s))return s.map(Xi);if(typeof s=="object"){const i=s.$name||"Object";if(!Gn[i])throw new Error(`can't deserialize unregistered class ${i}`);const{klass:c}=Gn[i];if(!c)throw new Error(`can't deserialize unregistered class ${i}`);if(c.deserialize)return c.deserialize(s);const d=Object.create(c.prototype);for(const g of Object.keys(s)){if(g==="$name")continue;const b=s[g];d[g]=Gn[i].shallow.indexOf(g)>=0?b:Xi(b)}return d}throw new Error("can't deserialize object of type "+typeof s)}class $r{constructor(){this.first=!0}update(i,c){const d=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=d,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=d,!0):(this.lastFloorZoom>d?(this.lastIntegerZoom=d+1,this.lastIntegerZoomTime=c):this.lastFloorZoom<d&&(this.lastIntegerZoom=d,this.lastIntegerZoomTime=c),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=d,!0))}}const Ye={"Latin-1 Supplement":s=>s>=128&&s<=255,Arabic:s=>s>=1536&&s<=1791,"Arabic Supplement":s=>s>=1872&&s<=1919,"Arabic Extended-A":s=>s>=2208&&s<=2303,"Hangul Jamo":s=>s>=4352&&s<=4607,"Unified Canadian Aboriginal Syllabics":s=>s>=5120&&s<=5759,Khmer:s=>s>=6016&&s<=6143,"Unified Canadian Aboriginal Syllabics Extended":s=>s>=6320&&s<=6399,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"CJK Radicals Supplement":s=>s>=11904&&s<=12031,"Kangxi Radicals":s=>s>=12032&&s<=12255,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Hiragana:s=>s>=12352&&s<=12447,Katakana:s=>s>=12448&&s<=12543,Bopomofo:s=>s>=12544&&s<=12591,"Hangul Compatibility Jamo":s=>s>=12592&&s<=12687,Kanbun:s=>s>=12688&&s<=12703,"Bopomofo Extended":s=>s>=12704&&s<=12735,"CJK Strokes":s=>s>=12736&&s<=12783,"Katakana Phonetic Extensions":s=>s>=12784&&s<=12799,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"CJK Unified Ideographs Extension A":s=>s>=13312&&s<=19903,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"CJK Unified Ideographs":s=>s>=19968&&s<=40959,"Yi Syllables":s=>s>=40960&&s<=42127,"Yi Radicals":s=>s>=42128&&s<=42191,"Hangul Jamo Extended-A":s=>s>=43360&&s<=43391,"Hangul Syllables":s=>s>=44032&&s<=55215,"Hangul Jamo Extended-B":s=>s>=55216&&s<=55295,"Private Use Area":s=>s>=57344&&s<=63743,"CJK Compatibility Ideographs":s=>s>=63744&&s<=64255,"Arabic Presentation Forms-A":s=>s>=64336&&s<=65023,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Arabic Presentation Forms-B":s=>s>=65136&&s<=65279,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function Co(s){for(const i of s)if(qn(i.charCodeAt(0)))return!0;return!1}function ho(s){for(const i of s)if(!Gs(i.charCodeAt(0)))return!1;return!0}function Gs(s){return!(Ye.Arabic(s)||Ye["Arabic Supplement"](s)||Ye["Arabic Extended-A"](s)||Ye["Arabic Presentation Forms-A"](s)||Ye["Arabic Presentation Forms-B"](s))}function qn(s){return!(s!==746&&s!==747&&(s<4352||!(Ye["Bopomofo Extended"](s)||Ye.Bopomofo(s)||Ye["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||Ye["CJK Compatibility Ideographs"](s)||Ye["CJK Compatibility"](s)||Ye["CJK Radicals Supplement"](s)||Ye["CJK Strokes"](s)||!(!Ye["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||Ye["CJK Unified Ideographs Extension A"](s)||Ye["CJK Unified Ideographs"](s)||Ye["Enclosed CJK Letters and Months"](s)||Ye["Hangul Compatibility Jamo"](s)||Ye["Hangul Jamo Extended-A"](s)||Ye["Hangul Jamo Extended-B"](s)||Ye["Hangul Jamo"](s)||Ye["Hangul Syllables"](s)||Ye.Hiragana(s)||Ye["Ideographic Description Characters"](s)||Ye.Kanbun(s)||Ye["Kangxi Radicals"](s)||Ye["Katakana Phonetic Extensions"](s)||Ye.Katakana(s)&&s!==12540||!(!Ye["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!Ye["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||Ye["Unified Canadian Aboriginal Syllabics"](s)||Ye["Unified Canadian Aboriginal Syllabics Extended"](s)||Ye["Vertical Forms"](s)||Ye["Yijing Hexagram Symbols"](s)||Ye["Yi Syllables"](s)||Ye["Yi Radicals"](s))))}function ys(s){return!(qn(s)||function(i){return!!(Ye["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||Ye["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||Ye["Letterlike Symbols"](i)||Ye["Number Forms"](i)||Ye["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||Ye["Control Pictures"](i)&&i!==9251||Ye["Optical Character Recognition"](i)||Ye["Enclosed Alphanumerics"](i)||Ye["Geometric Shapes"](i)||Ye["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||Ye["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||Ye["CJK Symbols and Punctuation"](i)||Ye.Katakana(i)||Ye["Private Use Area"](i)||Ye["CJK Compatibility Forms"](i)||Ye["Small Form Variants"](i)||Ye["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(s))}function Zo(s){return s>=1424&&s<=2303||Ye["Arabic Presentation Forms-A"](s)||Ye["Arabic Presentation Forms-B"](s)}function ga(s,i){return!(!i&&Zo(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||Ye.Khmer(s))}function Pl(s){for(const i of s)if(Zo(i.charCodeAt(0)))return!0;return!1}const ya="deferred",vs="loading",ou="loaded";let va=null,Pi="unavailable",Wo=null;const Al=function(s){s&&typeof s=="string"&&s.indexOf("NetworkError")>-1&&(Pi="error"),va&&va(s)};function su(){Va.fire(new er("pluginStateChange",{pluginStatus:Pi,pluginURL:Wo}))}const Va=new wi,dl=function(){return Pi},Vf=function(){if(Pi!==ya||!Wo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Pi=vs,su(),Wo&&dn({url:Wo},s=>{s?Al(s):(Pi=ou,su())})},_s={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Pi===ou||_s.applyArabicShaping!=null,isLoading:()=>Pi===vs,setState(s){if(!ar())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Pi=s.pluginStatus,Wo=s.pluginURL},isParsed(){if(!ar())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return _s.applyArabicShaping!=null&&_s.processBidirectionalText!=null&&_s.processStyledBidirectionalText!=null},getPluginURL(){if(!ar())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Wo}};class An{constructor(i,c){this.zoom=i,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.zoomHistory=c.zoomHistory,this.transition=c.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new $r,this.transition={})}isSupportedScript(i){return function(c,d){for(const g of c)if(!ga(g.charCodeAt(0),d))return!1;return!0}(i,_s.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,c=i-Math.floor(i),d=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:c+(1-c)*d}:{fromScale:.5,toScale:1,t:1-(1-d)*c}}}class Fc{constructor(i,c){this.property=i,this.value=c,this.expression=function(d,g){if(ca(d))return new Ho(d,g);if(Ba(d)){const b=cr(d,g);if(b.result==="error")throw new Error(b.value.map(w=>`${w.key}: ${w.message}`).join(", "));return b.value}{let b=d;return g.type==="color"&&typeof d=="string"?b=tr.parse(d):g.type!=="padding"||typeof d!="number"&&!Array.isArray(d)||(b=Cn.parse(d)),{kind:"constant",evaluate:()=>b}}}(c===void 0?i.specification.default:c,i.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,c,d){return this.property.possiblyEvaluate(this,i,c,d)}}class Jh{constructor(i){this.property=i,this.value=new Fc(i,void 0)}transitioned(i,c){return new oc(this.property,this.value,c,ne({},i.transition,this.transition),i.now)}untransitioned(){return new oc(this.property,this.value,null,{},0)}}class Gf{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return Qe(this._values[i].value.value)}setValue(i,c){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Jh(this._values[i].property)),this._values[i].value=new Fc(this._values[i].property,c===null?void 0:Qe(c))}getTransition(i){return Qe(this._values[i].transition)}setTransition(i,c){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Jh(this._values[i].property)),this._values[i].transition=Qe(c)||void 0}serialize(){const i={};for(const c of Object.keys(this._values)){const d=this.getValue(c);d!==void 0&&(i[c]=d);const g=this.getTransition(c);g!==void 0&&(i[`${c}-transition`]=g)}return i}transitioned(i,c){const d=new qf(this._properties);for(const g of Object.keys(this._values))d._values[g]=this._values[g].transitioned(i,c._values[g]);return d}untransitioned(){const i=new qf(this._properties);for(const c of Object.keys(this._values))i._values[c]=this._values[c].untransitioned();return i}}class oc{constructor(i,c,d,g,b){this.property=i,this.value=c,this.begin=b+g.delay||0,this.end=this.begin+g.duration||0,i.specification.transition&&(g.delay||g.duration)&&(this.prior=d)}possiblyEvaluate(i,c,d){const g=i.now||0,b=this.value.possiblyEvaluate(i,c,d),w=this.prior;if(w){if(g>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(g<this.begin)return w.possiblyEvaluate(i,c,d);{const I=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(i,c,d),b,function(k){if(k<=0)return 0;if(k>=1)return 1;const D=k*k,N=D*k;return 4*(k<.5?N:3*(k-D)+N-.75)}(I))}}return b}}class qf{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,c,d){const g=new Nc(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(i,c,d);return g}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class Yh{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}getValue(i){return Qe(this._values[i].value)}setValue(i,c){this._values[i]=new Fc(this._values[i].property,c===null?void 0:Qe(c))}serialize(){const i={};for(const c of Object.keys(this._values)){const d=this.getValue(c);d!==void 0&&(i[c]=d)}return i}possiblyEvaluate(i,c,d){const g=new Nc(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(i,c,d);return g}}class _a{constructor(i,c,d){this.property=i,this.value=c,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,c,d,g){return this.property.evaluate(this.value,this.parameters,i,c,d,g)}}class Nc{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class Lt{constructor(i){this.specification=i}possiblyEvaluate(i,c){if(i.isDataDriven())throw new Error("Value should not be data driven");return i.expression.evaluate(c)}interpolate(i,c,d){const g=Ot[this.specification.type];return g?g(i,c,d):i}}class Wt{constructor(i,c){this.specification=i,this.overrides=c}possiblyEvaluate(i,c,d,g){return new _a(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(c,null,{},d,g)}:i.expression,c)}interpolate(i,c,d){if(i.value.kind!=="constant"||c.value.kind!=="constant")return i;if(i.value.value===void 0||c.value.value===void 0)return new _a(this,{kind:"constant",value:void 0},i.parameters);const g=Ot[this.specification.type];if(g){const b=g(i.value.value,c.value.value,d);return new _a(this,{kind:"constant",value:b},i.parameters)}return i}evaluate(i,c,d,g,b,w){return i.kind==="constant"?i.value:i.evaluate(c,d,g,b,w)}}class Bc extends Wt{possiblyEvaluate(i,c,d,g){if(i.value===void 0)return new _a(this,{kind:"constant",value:void 0},c);if(i.expression.kind==="constant"){const b=i.expression.evaluate(c,null,{},d,g),w=i.property.specification.type==="resolvedImage"&&typeof b!="string"?b.name:b,I=this._calculate(w,w,w,c);return new _a(this,{kind:"constant",value:I},c)}if(i.expression.kind==="camera"){const b=this._calculate(i.expression.evaluate({zoom:c.zoom-1}),i.expression.evaluate({zoom:c.zoom}),i.expression.evaluate({zoom:c.zoom+1}),c);return new _a(this,{kind:"constant",value:b},c)}return new _a(this,i.expression,c)}evaluate(i,c,d,g,b,w){if(i.kind==="source"){const I=i.evaluate(c,d,g,b,w);return this._calculate(I,I,I,c)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(c.zoom)-1},d,g),i.evaluate({zoom:Math.floor(c.zoom)},d,g),i.evaluate({zoom:Math.floor(c.zoom)+1},d,g),c):i.value}_calculate(i,c,d,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:i,to:c}:{from:d,to:c}}interpolate(i){return i}}class Qh{constructor(i){this.specification=i}possiblyEvaluate(i,c,d,g){if(i.value!==void 0){if(i.expression.kind==="constant"){const b=i.expression.evaluate(c,null,{},d,g);return this._calculate(b,b,b,c)}return this._calculate(i.expression.evaluate(new An(Math.floor(c.zoom-1),c)),i.expression.evaluate(new An(Math.floor(c.zoom),c)),i.expression.evaluate(new An(Math.floor(c.zoom+1),c)),c)}}_calculate(i,c,d,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:i,to:c}:{from:d,to:c}}interpolate(i){return i}}class ed{constructor(i){this.specification=i}possiblyEvaluate(i,c,d,g){return!!i.expression.evaluate(c,null,{},d,g)}interpolate(){return!1}}class Io{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const c in i){const d=i[c];d.specification.overridable&&this.overridableProperties.push(c);const g=this.defaultPropertyValues[c]=new Fc(d,void 0),b=this.defaultTransitionablePropertyValues[c]=new Jh(d);this.defaultTransitioningPropertyValues[c]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=g.possiblyEvaluate({})}}}yt("DataDrivenProperty",Wt),yt("DataConstantProperty",Lt),yt("CrossFadedDataDrivenProperty",Bc),yt("CrossFadedProperty",Qh),yt("ColorRampProperty",ed);const Hf="-transition";class xa extends wi{constructor(i,c){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1},i.type!=="custom"&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),c.layout&&(this._unevaluatedLayout=new Yh(c.layout)),c.paint)){this._transitionablePaint=new Gf(c.paint);for(const d in i.paint)this.setPaintProperty(d,i.paint[d],{validate:!1});for(const d in i.layout)this.setLayoutProperty(d,i.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Nc(c.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,c,d={}){c!=null&&this._validate(ti,`layers.${this.id}.layout.${i}`,i,c,d)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,c):this.visibility=c)}getPaintProperty(i){return i.endsWith(Hf)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,c,d={}){if(c!=null&&this._validate(on,`layers.${this.id}.paint.${i}`,i,c,d))return!1;if(i.endsWith(Hf))return this._transitionablePaint.setTransition(i.slice(0,-11),c||void 0),!1;{const g=this._transitionablePaint._values[i],b=g.property.specification["property-type"]==="cross-faded-data-driven",w=g.value.isDataDriven(),I=g.value;this._transitionablePaint.setValue(i,c),this._handleSpecialPaintPropertyUpdate(i);const k=this._transitionablePaint._values[i].value;return k.isDataDriven()||w||b||this._handleOverridablePaintPropertyUpdate(i,I,k)}}_handleSpecialPaintPropertyUpdate(i){}_handleOverridablePaintPropertyUpdate(i,c,d){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,c){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,c)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),je(i,(c,d)=>!(c===void 0||d==="layout"&&!Object.keys(c).length||d==="paint"&&!Object.keys(c).length))}_validate(i,c,d,g,b={}){return(!b||b.validate!==!1)&&Vn(this,i.call(pn,{key:c,layerType:this.type,objectKey:d,value:g,styleSpec:Ue,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const c=this.paint.get(i);if(c instanceof _a&&Ns(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}}const au={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Uc{constructor(i,c){this._structArray=i,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Hn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,c){return i._trim(),c&&(i.isTransferred=!0,c.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const c=Object.create(this.prototype);return c.arrayBuffer=i.arrayBuffer,c.length=i.length,c.capacity=i.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ai(s,i=1){let c=0,d=0;return{members:s.map(g=>{const b=au[g.type].BYTES_PER_ELEMENT,w=c=td(c,Math.max(i,b)),I=g.components||1;return d=Math.max(d,b),c+=b*I,{name:g.name,type:g.type,components:I,offset:w}}),size:td(c,Math.max(d,i)),alignment:i}}function td(s,i){return Math.ceil(s/i)*i}class sc extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c){const d=this.length;return this.resize(d+1),this.emplace(d,i,c)}emplace(i,c,d){const g=2*i;return this.int16[g+0]=c,this.int16[g+1]=d,i}}sc.prototype.bytesPerElement=4,yt("StructArrayLayout2i4",sc);class jc extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,i,c,d)}emplace(i,c,d,g){const b=3*i;return this.int16[b+0]=c,this.int16[b+1]=d,this.int16[b+2]=g,i}}jc.prototype.bytesPerElement=6,yt("StructArrayLayout3i6",jc);class ba extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,d,g){const b=this.length;return this.resize(b+1),this.emplace(b,i,c,d,g)}emplace(i,c,d,g,b){const w=4*i;return this.int16[w+0]=c,this.int16[w+1]=d,this.int16[w+2]=g,this.int16[w+3]=b,i}}ba.prototype.bytesPerElement=8,yt("StructArrayLayout4i8",ba);class $c extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,d,g,b,w){const I=this.length;return this.resize(I+1),this.emplace(I,i,c,d,g,b,w)}emplace(i,c,d,g,b,w,I){const k=6*i;return this.int16[k+0]=c,this.int16[k+1]=d,this.int16[k+2]=g,this.int16[k+3]=b,this.int16[k+4]=w,this.int16[k+5]=I,i}}$c.prototype.bytesPerElement=12,yt("StructArrayLayout2i4i12",$c);class ac extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,d,g,b,w){const I=this.length;return this.resize(I+1),this.emplace(I,i,c,d,g,b,w)}emplace(i,c,d,g,b,w,I){const k=4*i,D=8*i;return this.int16[k+0]=c,this.int16[k+1]=d,this.uint8[D+4]=g,this.uint8[D+5]=b,this.uint8[D+6]=w,this.uint8[D+7]=I,i}}ac.prototype.bytesPerElement=8,yt("StructArrayLayout2i4ub8",ac);class lu extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c){const d=this.length;return this.resize(d+1),this.emplace(d,i,c)}emplace(i,c,d){const g=2*i;return this.float32[g+0]=c,this.float32[g+1]=d,i}}lu.prototype.bytesPerElement=8,yt("StructArrayLayout2f8",lu);class lc extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,d,g,b,w,I,k,D,N){const U=this.length;return this.resize(U+1),this.emplace(U,i,c,d,g,b,w,I,k,D,N)}emplace(i,c,d,g,b,w,I,k,D,N,U){const V=10*i;return this.uint16[V+0]=c,this.uint16[V+1]=d,this.uint16[V+2]=g,this.uint16[V+3]=b,this.uint16[V+4]=w,this.uint16[V+5]=I,this.uint16[V+6]=k,this.uint16[V+7]=D,this.uint16[V+8]=N,this.uint16[V+9]=U,i}}lc.prototype.bytesPerElement=20,yt("StructArrayLayout10ui20",lc);class rd extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,d,g,b,w,I,k,D,N,U,V){const W=this.length;return this.resize(W+1),this.emplace(W,i,c,d,g,b,w,I,k,D,N,U,V)}emplace(i,c,d,g,b,w,I,k,D,N,U,V,W){const J=12*i;return this.int16[J+0]=c,this.int16[J+1]=d,this.int16[J+2]=g,this.int16[J+3]=b,this.uint16[J+4]=w,this.uint16[J+5]=I,this.uint16[J+6]=k,this.uint16[J+7]=D,this.int16[J+8]=N,this.int16[J+9]=U,this.int16[J+10]=V,this.int16[J+11]=W,i}}rd.prototype.bytesPerElement=24,yt("StructArrayLayout4i4ui4i24",rd);class uu extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,i,c,d)}emplace(i,c,d,g){const b=3*i;return this.float32[b+0]=c,this.float32[b+1]=d,this.float32[b+2]=g,i}}uu.prototype.bytesPerElement=12,yt("StructArrayLayout3f12",uu);class Ml extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const c=this.length;return this.resize(c+1),this.emplace(c,i)}emplace(i,c){return this.uint32[1*i+0]=c,i}}Ml.prototype.bytesPerElement=4,yt("StructArrayLayout1ul4",Ml);class nd extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,d,g,b,w,I,k,D){const N=this.length;return this.resize(N+1),this.emplace(N,i,c,d,g,b,w,I,k,D)}emplace(i,c,d,g,b,w,I,k,D,N){const U=10*i,V=5*i;return this.int16[U+0]=c,this.int16[U+1]=d,this.int16[U+2]=g,this.int16[U+3]=b,this.int16[U+4]=w,this.int16[U+5]=I,this.uint32[V+3]=k,this.uint16[U+8]=D,this.uint16[U+9]=N,i}}nd.prototype.bytesPerElement=20,yt("StructArrayLayout6i1ul2ui20",nd);class Vc extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,d,g,b,w){const I=this.length;return this.resize(I+1),this.emplace(I,i,c,d,g,b,w)}emplace(i,c,d,g,b,w,I){const k=6*i;return this.int16[k+0]=c,this.int16[k+1]=d,this.int16[k+2]=g,this.int16[k+3]=b,this.int16[k+4]=w,this.int16[k+5]=I,i}}Vc.prototype.bytesPerElement=12,yt("StructArrayLayout2i2i2i12",Vc);class kl extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,d,g,b){const w=this.length;return this.resize(w+1),this.emplace(w,i,c,d,g,b)}emplace(i,c,d,g,b,w){const I=4*i,k=8*i;return this.float32[I+0]=c,this.float32[I+1]=d,this.float32[I+2]=g,this.int16[k+6]=b,this.int16[k+7]=w,i}}kl.prototype.bytesPerElement=16,yt("StructArrayLayout2f1f2i16",kl);class id extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,d,g){const b=this.length;return this.resize(b+1),this.emplace(b,i,c,d,g)}emplace(i,c,d,g,b){const w=12*i,I=3*i;return this.uint8[w+0]=c,this.uint8[w+1]=d,this.float32[I+1]=g,this.float32[I+2]=b,i}}id.prototype.bytesPerElement=12,yt("StructArrayLayout2ub2f12",id);class Gc extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,i,c,d)}emplace(i,c,d,g){const b=3*i;return this.uint16[b+0]=c,this.uint16[b+1]=d,this.uint16[b+2]=g,i}}Gc.prototype.bytesPerElement=6,yt("StructArrayLayout3ui6",Gc);class qc extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,d,g,b,w,I,k,D,N,U,V,W,J,ae,de,ge){const Ie=this.length;return this.resize(Ie+1),this.emplace(Ie,i,c,d,g,b,w,I,k,D,N,U,V,W,J,ae,de,ge)}emplace(i,c,d,g,b,w,I,k,D,N,U,V,W,J,ae,de,ge,Ie){const _e=24*i,ke=12*i,Oe=48*i;return this.int16[_e+0]=c,this.int16[_e+1]=d,this.uint16[_e+2]=g,this.uint16[_e+3]=b,this.uint32[ke+2]=w,this.uint32[ke+3]=I,this.uint32[ke+4]=k,this.uint16[_e+10]=D,this.uint16[_e+11]=N,this.uint16[_e+12]=U,this.float32[ke+7]=V,this.float32[ke+8]=W,this.uint8[Oe+36]=J,this.uint8[Oe+37]=ae,this.uint8[Oe+38]=de,this.uint32[ke+10]=ge,this.int16[_e+22]=Ie,i}}qc.prototype.bytesPerElement=48,yt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",qc);class od extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,d,g,b,w,I,k,D,N,U,V,W,J,ae,de,ge,Ie,_e,ke,Oe,Xe,Et,Ct,wt,vt,dt,St){const _t=this.length;return this.resize(_t+1),this.emplace(_t,i,c,d,g,b,w,I,k,D,N,U,V,W,J,ae,de,ge,Ie,_e,ke,Oe,Xe,Et,Ct,wt,vt,dt,St)}emplace(i,c,d,g,b,w,I,k,D,N,U,V,W,J,ae,de,ge,Ie,_e,ke,Oe,Xe,Et,Ct,wt,vt,dt,St,_t){const it=34*i,qt=17*i;return this.int16[it+0]=c,this.int16[it+1]=d,this.int16[it+2]=g,this.int16[it+3]=b,this.int16[it+4]=w,this.int16[it+5]=I,this.int16[it+6]=k,this.int16[it+7]=D,this.uint16[it+8]=N,this.uint16[it+9]=U,this.uint16[it+10]=V,this.uint16[it+11]=W,this.uint16[it+12]=J,this.uint16[it+13]=ae,this.uint16[it+14]=de,this.uint16[it+15]=ge,this.uint16[it+16]=Ie,this.uint16[it+17]=_e,this.uint16[it+18]=ke,this.uint16[it+19]=Oe,this.uint16[it+20]=Xe,this.uint16[it+21]=Et,this.uint16[it+22]=Ct,this.uint32[qt+12]=wt,this.float32[qt+13]=vt,this.float32[qt+14]=dt,this.float32[qt+15]=St,this.float32[qt+16]=_t,i}}od.prototype.bytesPerElement=68,yt("StructArrayLayout8i15ui1ul4f68",od);class Hc extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const c=this.length;return this.resize(c+1),this.emplace(c,i)}emplace(i,c){return this.float32[1*i+0]=c,i}}Hc.prototype.bytesPerElement=4,yt("StructArrayLayout1f4",Hc);class Wr extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,i,c,d)}emplace(i,c,d,g){const b=4*i;return this.uint32[2*i+0]=c,this.uint16[b+2]=d,this.uint16[b+3]=g,i}}Wr.prototype.bytesPerElement=8,yt("StructArrayLayout1ul2ui8",Wr);class _ extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c){const d=this.length;return this.resize(d+1),this.emplace(d,i,c)}emplace(i,c,d){const g=2*i;return this.uint16[g+0]=c,this.uint16[g+1]=d,i}}_.prototype.bytesPerElement=4,yt("StructArrayLayout2ui4",_);class o extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const c=this.length;return this.resize(c+1),this.emplace(c,i)}emplace(i,c){return this.uint16[1*i+0]=c,i}}o.prototype.bytesPerElement=2,yt("StructArrayLayout1ui2",o);class h extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,d,g){const b=this.length;return this.resize(b+1),this.emplace(b,i,c,d,g)}emplace(i,c,d,g,b){const w=4*i;return this.float32[w+0]=c,this.float32[w+1]=d,this.float32[w+2]=g,this.float32[w+3]=b,i}}h.prototype.bytesPerElement=16,yt("StructArrayLayout4f16",h);class p extends Uc{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new M(this.anchorPointX,this.anchorPointY)}}p.prototype.size=20;class v extends nd{get(i){return new p(this,i)}}yt("CollisionBoxArray",v);class x extends Uc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(i){this._structArray.uint8[this._pos1+37]=i}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(i){this._structArray.uint8[this._pos1+38]=i}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(i){this._structArray.uint32[this._pos4+10]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}x.prototype.size=48;class P extends qc{get(i){return new x(this,i)}}yt("PlacedSymbolArray",P);class A extends Uc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(i){this._structArray.uint32[this._pos4+12]=i}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}A.prototype.size=68;class L extends od{get(i){return new A(this,i)}}yt("SymbolInstanceArray",L);class O extends Hc{getoffsetX(i){return this.float32[1*i+0]}}yt("GlyphOffsetArray",O);class F extends jc{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}yt("SymbolLineVertexArray",F);class B extends Uc{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}B.prototype.size=8;class Z extends Wr{get(i){return new B(this,i)}}yt("FeatureIndexArray",Z);class ie extends sc{}class re extends sc{}class ue extends sc{}class se extends $c{}class xe extends ac{}class Le extends lu{}class he extends lc{}class Ae extends rd{}class ze extends uu{}class Ge extends Ml{}class qe extends Vc{}class Je extends id{}class Ke extends Gc{}class gt extends _{}const It=ai([{name:"a_pos",components:2,type:"Int16"}],4),{members:pr}=It;class ct{constructor(i=[]){this.segments=i}prepareSegment(i,c,d,g){let b=this.segments[this.segments.length-1];return i>ct.MAX_VERTEX_ARRAY_LENGTH&&Ut(`Max vertices per segment is ${ct.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!b||b.vertexLength+i>ct.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==g)&&(b={vertexOffset:c.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0},g!==void 0&&(b.sortKey=g),this.segments.push(b)),b}get(){return this.segments}destroy(){for(const i of this.segments)for(const c in i.vaos)i.vaos[c].destroy()}static simpleSegment(i,c,d,g){return new ct([{vertexOffset:i,primitiveOffset:c,vertexLength:d,primitiveLength:g,vaos:{},sortKey:0}])}}function Ht(s,i){return 256*(s=Q(Math.floor(s),0,255))+Q(Math.floor(i),0,255)}ct.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,yt("SegmentVector",ct);const bt=ai([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Vr={exports:{}},Or={exports:{}};Or.exports=function(s,i){var c,d,g,b,w,I,k,D;for(d=s.length-(c=3&s.length),g=i,w=3432918353,I=461845907,D=0;D<d;)k=255&s.charCodeAt(D)|(255&s.charCodeAt(++D))<<8|(255&s.charCodeAt(++D))<<16|(255&s.charCodeAt(++D))<<24,++D,g=27492+(65535&(b=5*(65535&(g=(g^=k=(65535&(k=(k=(65535&k)*w+(((k>>>16)*w&65535)<<16)&4294967295)<<15|k>>>17))*I+(((k>>>16)*I&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(k=0,c){case 3:k^=(255&s.charCodeAt(D+2))<<16;case 2:k^=(255&s.charCodeAt(D+1))<<8;case 1:g^=k=(65535&(k=(k=(65535&(k^=255&s.charCodeAt(D)))*w+(((k>>>16)*w&65535)<<16)&4294967295)<<15|k>>>17))*I+(((k>>>16)*I&65535)<<16)&4294967295}return g^=s.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var Er=Or.exports,nr={exports:{}};nr.exports=function(s,i){for(var c,d=s.length,g=i^d,b=0;d>=4;)c=1540483477*(65535&(c=255&s.charCodeAt(b)|(255&s.charCodeAt(++b))<<8|(255&s.charCodeAt(++b))<<16|(255&s.charCodeAt(++b))<<24))+((1540483477*(c>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),d-=4,++b;switch(d){case 3:g^=(255&s.charCodeAt(b+2))<<16;case 2:g^=(255&s.charCodeAt(b+1))<<8;case 1:g=1540483477*(65535&(g^=255&s.charCodeAt(b)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var Rn=Er,Fi=nr.exports;Vr.exports=Rn,Vr.exports.murmur3=Rn,Vr.exports.murmur2=Fi;var ri=E(Vr.exports);class Ai{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,c,d,g){this.ids.push(Ko(i)),this.positions.push(c,d,g)}getPositions(i){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const c=Ko(i);let d=0,g=this.ids.length-1;for(;d<g;){const w=d+g>>1;this.ids[w]>=c?g=w:d=w+1}const b=[];for(;this.ids[d]===c;)b.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return b}static serialize(i,c){const d=new Float64Array(i.ids),g=new Uint32Array(i.positions);return qs(d,g,0,d.length-1),c&&c.push(d.buffer,g.buffer),{ids:d,positions:g}}static deserialize(i){const c=new Ai;return c.ids=i.ids,c.positions=i.positions,c.indexed=!0,c}}function Ko(s){const i=+s;return!isNaN(i)&&i<=Number.MAX_SAFE_INTEGER?i:ri(String(s))}function qs(s,i,c,d){for(;c<d;){const g=s[c+d>>1];let b=c-1,w=d+1;for(;;){do b++;while(s[b]<g);do w--;while(s[w]>g);if(b>=w)break;Hs(s,b,w),Hs(i,3*b,3*w),Hs(i,3*b+1,3*w+1),Hs(i,3*b+2,3*w+2)}w-c<d-w?(qs(s,i,c,w),c=w+1):(qs(s,i,w+1,d),d=w)}}function Hs(s,i,c){const d=s[i];s[i]=s[c],s[c]=d}yt("FeaturePositionMap",Ai);class fo{constructor(i,c){this.gl=i.gl,this.location=c}}class wa extends fo{constructor(i,c){super(i,c),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class uc extends fo{constructor(i,c){super(i,c),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class Ji extends fo{constructor(i,c){super(i,c),this.current=tr.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}const Mi=new Float32Array(16);function Kr(s){return[Ht(255*s.r,255*s.g),Ht(255*s.b,255*s.a)]}class gi{constructor(i,c,d){this.value=i,this.uniformNames=c.map(g=>`u_${g}`),this.type=d}setUniform(i,c,d){i.set(d.constantOr(this.value))}getBinding(i,c,d){return this.type==="color"?new Ji(i,c):new wa(i,c)}}class ki{constructor(i,c){this.uniformNames=c.map(d=>`u_${d}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,c){this.pixelRatioFrom=c.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=c.tlbr,this.patternTo=i.tlbr}setUniform(i,c,d,g){const b=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;b&&i.set(b)}getBinding(i,c,d){return d.substr(0,9)==="u_pattern"?new uc(i,c):new wa(i,c)}}class en{constructor(i,c,d,g){this.expression=i,this.type=d,this.maxValue=0,this.paintVertexAttributes=c.map(b=>({name:`a_${b}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(i,c,d,g,b){const w=this.paintVertexArray.length,I=this.expression.evaluate(new An(0),c,{},g,[],b);this.paintVertexArray.resize(i),this._setPaintValue(w,i,I)}updatePaintArray(i,c,d,g){const b=this.expression.evaluate({zoom:0},d,g);this._setPaintValue(i,c,b)}_setPaintValue(i,c,d){if(this.type==="color"){const g=Kr(d);for(let b=i;b<c;b++)this.paintVertexArray.emplace(b,g[0],g[1])}else{for(let g=i;g<c;g++)this.paintVertexArray.emplace(g,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class yi{constructor(i,c,d,g,b,w){this.expression=i,this.uniformNames=c.map(I=>`u_${I}_t`),this.type=d,this.useIntegerZoom=g,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=c.map(I=>({name:`a_${I}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(i,c,d,g,b){const w=this.expression.evaluate(new An(this.zoom),c,{},g,[],b),I=this.expression.evaluate(new An(this.zoom+1),c,{},g,[],b),k=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(k,i,w,I)}updatePaintArray(i,c,d,g){const b=this.expression.evaluate({zoom:this.zoom},d,g),w=this.expression.evaluate({zoom:this.zoom+1},d,g);this._setPaintValue(i,c,b,w)}_setPaintValue(i,c,d,g){if(this.type==="color"){const b=Kr(d),w=Kr(g);for(let I=i;I<c;I++)this.paintVertexArray.emplace(I,b[0],b[1],w[0],w[1])}else{for(let b=i;b<c;b++)this.paintVertexArray.emplace(b,d,g);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(g))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,c){const d=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,g=Q(this.expression.interpolationFactor(d,this.zoom,this.zoom+1),0,1);i.set(g)}getBinding(i,c,d){return new wa(i,c)}}class Xo{constructor(i,c,d,g,b,w){this.expression=i,this.type=c,this.useIntegerZoom=d,this.zoom=g,this.layerId=w,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(i,c,d){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(g,i,c.patterns&&c.patterns[this.layerId],d)}updatePaintArray(i,c,d,g,b){this._setPaintValues(i,c,d.patterns&&d.patterns[this.layerId],b)}_setPaintValues(i,c,d,g){if(!g||!d)return;const{min:b,mid:w,max:I}=d,k=g[b],D=g[w],N=g[I];if(k&&D&&N)for(let U=i;U<c;U++)this.zoomInPaintVertexArray.emplace(U,D.tl[0],D.tl[1],D.br[0],D.br[1],k.tl[0],k.tl[1],k.br[0],k.br[1],D.pixelRatio,k.pixelRatio),this.zoomOutPaintVertexArray.emplace(U,D.tl[0],D.tl[1],D.br[0],D.br[1],N.tl[0],N.tl[1],N.br[0],N.br[1],D.pixelRatio,N.pixelRatio)}upload(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,bt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,bt.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Zc{constructor(i,c,d){this.binders={},this._buffers=[];const g=[];for(const b in i.paint._values){if(!d(b))continue;const w=i.paint.get(b);if(!(w instanceof _a&&Ns(w.property.specification)))continue;const I=Xg(b,i.type),k=w.value,D=w.property.specification.type,N=w.property.useIntegerZoom,U=w.property.specification["property-type"],V=U==="cross-faded"||U==="cross-faded-data-driven";if(k.kind==="constant")this.binders[b]=V?new ki(k.value,I):new gi(k.value,I,D),g.push(`/u_${b}`);else if(k.kind==="source"||V){const W=Zf(b,D,"source");this.binders[b]=V?new Xo(k,D,N,c,W,i.id):new en(k,I,D,W),g.push(`/a_${b}`)}else{const W=Zf(b,D,"composite");this.binders[b]=new yi(k,I,D,N,c,W),g.push(`/z_${b}`)}}this.cacheKey=g.sort().join("")}getMaxValue(i){const c=this.binders[i];return c instanceof en||c instanceof yi?c.maxValue:0}populatePaintArrays(i,c,d,g,b){for(const w in this.binders){const I=this.binders[w];(I instanceof en||I instanceof yi||I instanceof Xo)&&I.populatePaintArray(i,c,d,g,b)}}setConstantPatternPositions(i,c){for(const d in this.binders){const g=this.binders[d];g instanceof ki&&g.setConstantPatternPositions(i,c)}}updatePaintArrays(i,c,d,g,b){let w=!1;for(const I in i){const k=c.getPositions(I);for(const D of k){const N=d.feature(D.index);for(const U in this.binders){const V=this.binders[U];if((V instanceof en||V instanceof yi||V instanceof Xo)&&V.expression.isStateDependent===!0){const W=g.paint.get(U);V.expression=W.value,V.updatePaintArray(D.start,D.end,N,i[I],b),w=!0}}}}return w}defines(){const i=[];for(const c in this.binders){const d=this.binders[c];(d instanceof gi||d instanceof ki)&&i.push(...d.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return i}getBinderAttributes(){const i=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof en||d instanceof yi)for(let g=0;g<d.paintVertexAttributes.length;g++)i.push(d.paintVertexAttributes[g].name);else if(d instanceof Xo)for(let g=0;g<bt.members.length;g++)i.push(bt.members[g].name)}return i}getBinderUniforms(){const i=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof gi||d instanceof ki||d instanceof yi)for(const g of d.uniformNames)i.push(g)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,c){const d=[];for(const g in this.binders){const b=this.binders[g];if(b instanceof gi||b instanceof ki||b instanceof yi){for(const w of b.uniformNames)if(c[w]){const I=b.getBinding(i,c[w],w);d.push({name:w,property:g,binding:I})}}}return d}setUniforms(i,c,d,g){for(const{name:b,property:w,binding:I}of c)this.binders[w].setUniform(I,g,d.get(w),b)}updatePaintBuffers(i){this._buffers=[];for(const c in this.binders){const d=this.binders[c];if(i&&d instanceof Xo){const g=i.fromScale===2?d.zoomInPaintVertexBuffer:d.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(d instanceof en||d instanceof yi)&&d.paintVertexBuffer&&this._buffers.push(d.paintVertexBuffer)}}upload(i){for(const c in this.binders){const d=this.binders[c];(d instanceof en||d instanceof yi||d instanceof Xo)&&d.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const c=this.binders[i];(c instanceof en||c instanceof yi||c instanceof Xo)&&c.destroy()}}}class Ga{constructor(i,c,d=()=>!0){this.programConfigurations={};for(const g of i)this.programConfigurations[g.id]=new Zc(g,c,d);this.needsUpload=!1,this._featureMap=new Ai,this._bufferOffset=0}populatePaintArrays(i,c,d,g,b,w){for(const I in this.programConfigurations)this.programConfigurations[I].populatePaintArrays(i,c,g,b,w);c.id!==void 0&&this._featureMap.add(c.id,d,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,c,d,g){for(const b of d)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(i,this._featureMap,c,b,g)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}function Xg(s,i){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${i}-`,"").replace(/-/g,"_")]}function Zf(s,i,c){const d={color:{source:lu,composite:h},number:{source:Hc,composite:lu}},g=function(b){return{"line-pattern":{source:he,composite:he},"fill-pattern":{source:he,composite:he},"fill-extrusion-pattern":{source:he,composite:he}}[b]}(s);return g&&g[c]||d[i][c]}yt("ConstantBinder",gi),yt("CrossFadedConstantBinder",ki),yt("SourceExpressionBinder",en),yt("CrossFadedCompositeBinder",Xo),yt("CompositeExpressionBinder",yi),yt("ProgramConfiguration",Zc,{omit:["_buffers"]}),yt("ProgramConfigurationSet",Ga);const wn=8192,sd=Math.pow(2,14)-1,cc=-sd-1;function qa(s){const i=wn/s.extent,c=s.loadGeometry();for(let d=0;d<c.length;d++){const g=c[d];for(let b=0;b<g.length;b++){const w=g[b],I=Math.round(w.x*i),k=Math.round(w.y*i);w.x=Q(I,cc,sd),w.y=Q(k,cc,sd),(I<w.x||I>w.x+1||k<w.y||k>w.y+1)&&Ut("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return c}function hc(s,i){return{type:s.type,id:s.id,properties:s.properties,geometry:i?qa(s):[]}}function Wf(s,i,c,d,g){s.emplaceBack(2*i+(d+1)/2,2*c+(g+1)/2)}class Jg{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(c=>c.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new re,this.indexArray=new Ke,this.segments=new ct,this.programConfigurations=new Ga(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(i,c,d){const g=this.layers[0],b=[];let w=null,I=!1;g.type==="circle"&&(w=g.layout.get("circle-sort-key"),I=!w.isConstant());for(const{feature:k,id:D,index:N,sourceLayerIndex:U}of i){const V=this.layers[0]._featureFilter.needGeometry,W=hc(k,V);if(!this.layers[0]._featureFilter.filter(new An(this.zoom),W,d))continue;const J=I?w.evaluate(W,{},d):void 0,ae={id:D,properties:k.properties,type:k.type,sourceLayerIndex:U,index:N,geometry:V?W.geometry:qa(k),patterns:{},sortKey:J};b.push(ae)}I&&b.sort((k,D)=>k.sortKey-D.sortKey);for(const k of b){const{geometry:D,index:N,sourceLayerIndex:U}=k,V=i[N].feature;this.addFeature(k,D,N,d),c.featureIndex.insert(V,D,N,U,this.index)}}update(i,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,c,this.stateDependentLayers,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,pr),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,c,d,g){for(const b of c)for(const w of b){const I=w.x,k=w.y;if(I<0||I>=wn||k<0||k>=wn)continue;const D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),N=D.vertexLength;Wf(this.layoutVertexArray,I,k,-1,-1),Wf(this.layoutVertexArray,I,k,1,-1),Wf(this.layoutVertexArray,I,k,1,1),Wf(this.layoutVertexArray,I,k,-1,1),this.indexArray.emplaceBack(N,N+1,N+2),this.indexArray.emplaceBack(N,N+3,N+2),D.vertexLength+=4,D.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,d,{},g)}}function zx(s,i){for(let c=0;c<s.length;c++)if(Wc(i,s[c]))return!0;for(let c=0;c<i.length;c++)if(Wc(s,i[c]))return!0;return!!Yg(s,i)}function EI(s,i,c){return!!Wc(s,i)||!!Qg(i,s,c)}function Fx(s,i){if(s.length===1)return Bx(i,s[0]);for(let c=0;c<i.length;c++){const d=i[c];for(let g=0;g<d.length;g++)if(Wc(s,d[g]))return!0}for(let c=0;c<s.length;c++)if(Bx(i,s[c]))return!0;for(let c=0;c<i.length;c++)if(Yg(s,i[c]))return!0;return!1}function SI(s,i,c){if(s.length>1){if(Yg(s,i))return!0;for(let d=0;d<i.length;d++)if(Qg(i[d],s,c))return!0}for(let d=0;d<s.length;d++)if(Qg(s[d],i,c))return!0;return!1}function Yg(s,i){if(s.length===0||i.length===0)return!1;for(let c=0;c<s.length-1;c++){const d=s[c],g=s[c+1];for(let b=0;b<i.length-1;b++)if(TI(d,g,i[b],i[b+1]))return!0}return!1}function TI(s,i,c,d){return st(s,c,d)!==st(i,c,d)&&st(s,i,c)!==st(s,i,d)}function Qg(s,i,c){const d=c*c;if(i.length===1)return s.distSqr(i[0])<d;for(let g=1;g<i.length;g++)if(Nx(s,i[g-1],i[g])<d)return!0;return!1}function Nx(s,i,c){const d=i.distSqr(c);if(d===0)return s.distSqr(i);const g=((s.x-i.x)*(c.x-i.x)+(s.y-i.y)*(c.y-i.y))/d;return s.distSqr(g<0?i:g>1?c:c.sub(i)._mult(g)._add(i))}function Bx(s,i){let c,d,g,b=!1;for(let w=0;w<s.length;w++){c=s[w];for(let I=0,k=c.length-1;I<c.length;k=I++)d=c[I],g=c[k],d.y>i.y!=g.y>i.y&&i.x<(g.x-d.x)*(i.y-d.y)/(g.y-d.y)+d.x&&(b=!b)}return b}function Wc(s,i){let c=!1;for(let d=0,g=s.length-1;d<s.length;g=d++){const b=s[d],w=s[g];b.y>i.y!=w.y>i.y&&i.x<(w.x-b.x)*(i.y-b.y)/(w.y-b.y)+b.x&&(c=!c)}return c}function CI(s,i,c){const d=c[0],g=c[2];if(s.x<d.x&&i.x<d.x||s.x>g.x&&i.x>g.x||s.y<d.y&&i.y<d.y||s.y>g.y&&i.y>g.y)return!1;const b=st(s,i,c[0]);return b!==st(s,i,c[1])||b!==st(s,i,c[2])||b!==st(s,i,c[3])}function ad(s,i,c){const d=i.paint.get(s).value;return d.kind==="constant"?d.value:c.programConfigurations.get(i.id).getMaxValue(s)}function Kf(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function Xf(s,i,c,d,g){if(!i[0]&&!i[1])return s;const b=M.convert(i)._mult(g);c==="viewport"&&b._rotate(-d);const w=[];for(let I=0;I<s.length;I++)w.push(s[I].sub(b));return w}let Ux,jx;yt("CircleBucket",Jg,{omit:["layers"]});var II={get paint(){return jx=jx||new Io({"circle-radius":new Wt(Ue.paint_circle["circle-radius"]),"circle-color":new Wt(Ue.paint_circle["circle-color"]),"circle-blur":new Wt(Ue.paint_circle["circle-blur"]),"circle-opacity":new Wt(Ue.paint_circle["circle-opacity"]),"circle-translate":new Lt(Ue.paint_circle["circle-translate"]),"circle-translate-anchor":new Lt(Ue.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Lt(Ue.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Lt(Ue.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Wt(Ue.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Wt(Ue.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Wt(Ue.paint_circle["circle-stroke-opacity"])})},get layout(){return Ux=Ux||new Io({"circle-sort-key":new Wt(Ue.layout_circle["circle-sort-key"])})}},Po=1e-6,Kc=typeof Float32Array<"u"?Float32Array:Array;function ey(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function $x(s,i,c){var d=i[0],g=i[1],b=i[2],w=i[3],I=i[4],k=i[5],D=i[6],N=i[7],U=i[8],V=i[9],W=i[10],J=i[11],ae=i[12],de=i[13],ge=i[14],Ie=i[15],_e=c[0],ke=c[1],Oe=c[2],Xe=c[3];return s[0]=_e*d+ke*I+Oe*U+Xe*ae,s[1]=_e*g+ke*k+Oe*V+Xe*de,s[2]=_e*b+ke*D+Oe*W+Xe*ge,s[3]=_e*w+ke*N+Oe*J+Xe*Ie,s[4]=(_e=c[4])*d+(ke=c[5])*I+(Oe=c[6])*U+(Xe=c[7])*ae,s[5]=_e*g+ke*k+Oe*V+Xe*de,s[6]=_e*b+ke*D+Oe*W+Xe*ge,s[7]=_e*w+ke*N+Oe*J+Xe*Ie,s[8]=(_e=c[8])*d+(ke=c[9])*I+(Oe=c[10])*U+(Xe=c[11])*ae,s[9]=_e*g+ke*k+Oe*V+Xe*de,s[10]=_e*b+ke*D+Oe*W+Xe*ge,s[11]=_e*w+ke*N+Oe*J+Xe*Ie,s[12]=(_e=c[12])*d+(ke=c[13])*I+(Oe=c[14])*U+(Xe=c[15])*ae,s[13]=_e*g+ke*k+Oe*V+Xe*de,s[14]=_e*b+ke*D+Oe*W+Xe*ge,s[15]=_e*w+ke*N+Oe*J+Xe*Ie,s}Math.hypot||(Math.hypot=function(){for(var s=0,i=arguments.length;i--;)s+=arguments[i]*arguments[i];return Math.sqrt(s)});var ld,PI=$x;function Jf(s,i,c){var d=i[0],g=i[1],b=i[2],w=i[3];return s[0]=c[0]*d+c[4]*g+c[8]*b+c[12]*w,s[1]=c[1]*d+c[5]*g+c[9]*b+c[13]*w,s[2]=c[2]*d+c[6]*g+c[10]*b+c[14]*w,s[3]=c[3]*d+c[7]*g+c[11]*b+c[15]*w,s}ld=new Kc(4),Kc!=Float32Array&&(ld[0]=0,ld[1]=0,ld[2]=0,ld[3]=0);class AI extends xa{constructor(i){super(i,II)}createBucket(i){return new Jg(i)}queryRadius(i){const c=i;return ad("circle-radius",this,c)+ad("circle-stroke-width",this,c)+Kf(this.paint.get("circle-translate"))}queryIntersectsFeature(i,c,d,g,b,w,I,k){const D=Xf(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),w.angle,I),N=this.paint.get("circle-radius").evaluate(c,d)+this.paint.get("circle-stroke-width").evaluate(c,d),U=this.paint.get("circle-pitch-alignment")==="map",V=U?D:function(J,ae){return J.map(de=>Vx(de,ae))}(D,k),W=U?N*I:N;for(const J of g)for(const ae of J){const de=U?ae:Vx(ae,k);let ge=W;const Ie=Jf([],[ae.x,ae.y,0,1],k);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ge*=Ie[3]/w.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ge*=w.cameraToCenterDistance/Ie[3]),EI(V,de,ge))return!0}return!1}}function Vx(s,i){const c=Jf([],[s.x,s.y,0,1],i);return new M(c[0]/c[3],c[1]/c[3])}class Gx extends Jg{}let qx;yt("HeatmapBucket",Gx,{omit:["layers"]});var MI={get paint(){return qx=qx||new Io({"heatmap-radius":new Wt(Ue.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Wt(Ue.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Lt(Ue.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ed(Ue.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Lt(Ue.paint_heatmap["heatmap-opacity"])})}};function ty(s,{width:i,height:c},d,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==i*c*d)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${i*c*d}`)}else g=new Uint8Array(i*c*d);return s.width=i,s.height=c,s.data=g,s}function Hx(s,{width:i,height:c},d){if(i===s.width&&c===s.height)return;const g=ty({},{width:i,height:c},d);ry(s,g,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,i),height:Math.min(s.height,c)},d),s.width=i,s.height=c,s.data=g.data}function ry(s,i,c,d,g,b){if(g.width===0||g.height===0)return i;if(g.width>s.width||g.height>s.height||c.x>s.width-g.width||c.y>s.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>i.width||g.height>i.height||d.x>i.width-g.width||d.y>i.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const w=s.data,I=i.data;if(w===I)throw new Error("srcData equals dstData, so image is already copied");for(let k=0;k<g.height;k++){const D=((c.y+k)*s.width+c.x)*b,N=((d.y+k)*i.width+d.x)*b;for(let U=0;U<g.width*b;U++)I[N+U]=w[D+U]}return i}class ud{constructor(i,c){ty(this,i,1,c)}resize(i){Hx(this,i,1)}clone(){return new ud({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,c,d,g,b){ry(i,c,d,g,b,1)}}class Zs{constructor(i,c){ty(this,i,4,c)}resize(i){Hx(this,i,4)}replace(i,c){c?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Zs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,c,d,g,b){ry(i,c,d,g,b,4)}}function Zx(s){const i={},c=s.resolution||256,d=s.clips?s.clips.length:1,g=s.image||new Zs({width:c,height:d});if(Math.log(c)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${c}`);const b=(w,I,k)=>{i[s.evaluationKey]=k;const D=s.expression.evaluate(i);g.data[w+I+0]=Math.floor(255*D.r/D.a),g.data[w+I+1]=Math.floor(255*D.g/D.a),g.data[w+I+2]=Math.floor(255*D.b/D.a),g.data[w+I+3]=Math.floor(255*D.a)};if(s.clips)for(let w=0,I=0;w<d;++w,I+=4*c)for(let k=0,D=0;k<c;k++,D+=4){const N=k/(c-1),{start:U,end:V}=s.clips[w];b(I,D,U*(1-N)+V*N)}else for(let w=0,I=0;w<c;w++,I+=4)b(0,I,w/(c-1));return g}yt("AlphaImage",ud),yt("RGBAImage",Zs);class kI extends xa{createBucket(i){return new Gx(i)}constructor(i){super(i,MI),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Zx({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Wx;var LI={get paint(){return Wx=Wx||new Io({"hillshade-illumination-direction":new Lt(Ue.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Lt(Ue.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Lt(Ue.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Lt(Ue.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Lt(Ue.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Lt(Ue.paint_hillshade["hillshade-accent-color"])})}};class RI extends xa{constructor(i){super(i,LI)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const OI=ai([{name:"a_pos",components:2,type:"Int16"}],4),{members:DI}=OI;var ny={exports:{}};function Yf(s,i,c){c=c||2;var d,g,b,w,I,k,D,N=i&&i.length,U=N?i[0]*c:s.length,V=Kx(s,0,U,c,!0),W=[];if(!V||V.next===V.prev)return W;if(N&&(V=function(ae,de,ge,Ie){var _e,ke,Oe,Xe=[];for(_e=0,ke=de.length;_e<ke;_e++)(Oe=Kx(ae,de[_e]*Ie,_e<ke-1?de[_e+1]*Ie:ae.length,Ie,!1))===Oe.next&&(Oe.steiner=!0),Xe.push(VI(Oe));for(Xe.sort(UI),_e=0;_e<Xe.length;_e++)ge=jI(Xe[_e],ge);return ge}(s,i,V,c)),s.length>80*c){d=b=s[0],g=w=s[1];for(var J=c;J<U;J+=c)(I=s[J])<d&&(d=I),(k=s[J+1])<g&&(g=k),I>b&&(b=I),k>w&&(w=k);D=(D=Math.max(b-d,w-g))!==0?32767/D:0}return cd(V,W,c,d,g,D,0),W}function Kx(s,i,c,d,g){var b,w;if(g===sy(s,i,c,d)>0)for(b=i;b<c;b+=d)w=Yx(b,s[b],s[b+1],w);else for(b=c-d;b>=i;b-=d)w=Yx(b,s[b],s[b+1],w);return w&&Qf(w,w.next)&&(dd(w),w=w.next),w}function dc(s,i){if(!s)return s;i||(i=s);var c,d=s;do if(c=!1,d.steiner||!Qf(d,d.next)&&ni(d.prev,d,d.next)!==0)d=d.next;else{if(dd(d),(d=i=d.prev)===d.next)break;c=!0}while(c||d!==i);return i}function cd(s,i,c,d,g,b,w){if(s){!w&&b&&function(N,U,V,W){var J=N;do J.z===0&&(J.z=iy(J.x,J.y,U,V,W)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==N);J.prevZ.nextZ=null,J.prevZ=null,function(ae){var de,ge,Ie,_e,ke,Oe,Xe,Et,Ct=1;do{for(ge=ae,ae=null,ke=null,Oe=0;ge;){for(Oe++,Ie=ge,Xe=0,de=0;de<Ct&&(Xe++,Ie=Ie.nextZ);de++);for(Et=Ct;Xe>0||Et>0&&Ie;)Xe!==0&&(Et===0||!Ie||ge.z<=Ie.z)?(_e=ge,ge=ge.nextZ,Xe--):(_e=Ie,Ie=Ie.nextZ,Et--),ke?ke.nextZ=_e:ae=_e,_e.prevZ=ke,ke=_e;ge=Ie}ke.nextZ=null,Ct*=2}while(Oe>1)}(J)}(s,d,g,b);for(var I,k,D=s;s.prev!==s.next;)if(I=s.prev,k=s.next,b?FI(s,d,g,b):zI(s))i.push(I.i/c|0),i.push(s.i/c|0),i.push(k.i/c|0),dd(s),s=k.next,D=k.next;else if((s=k)===D){w?w===1?cd(s=NI(dc(s),i,c),i,c,d,g,b,2):w===2&&BI(s,i,c,d,g,b):cd(dc(s),i,c,d,g,b,1);break}}}function zI(s){var i=s.prev,c=s,d=s.next;if(ni(i,c,d)>=0)return!1;for(var g=i.x,b=c.x,w=d.x,I=i.y,k=c.y,D=d.y,N=g<b?g<w?g:w:b<w?b:w,U=I<k?I<D?I:D:k<D?k:D,V=g>b?g>w?g:w:b>w?b:w,W=I>k?I>D?I:D:k>D?k:D,J=d.next;J!==i;){if(J.x>=N&&J.x<=V&&J.y>=U&&J.y<=W&&Xc(g,I,b,k,w,D,J.x,J.y)&&ni(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function FI(s,i,c,d){var g=s.prev,b=s,w=s.next;if(ni(g,b,w)>=0)return!1;for(var I=g.x,k=b.x,D=w.x,N=g.y,U=b.y,V=w.y,W=I<k?I<D?I:D:k<D?k:D,J=N<U?N<V?N:V:U<V?U:V,ae=I>k?I>D?I:D:k>D?k:D,de=N>U?N>V?N:V:U>V?U:V,ge=iy(W,J,i,c,d),Ie=iy(ae,de,i,c,d),_e=s.prevZ,ke=s.nextZ;_e&&_e.z>=ge&&ke&&ke.z<=Ie;){if(_e.x>=W&&_e.x<=ae&&_e.y>=J&&_e.y<=de&&_e!==g&&_e!==w&&Xc(I,N,k,U,D,V,_e.x,_e.y)&&ni(_e.prev,_e,_e.next)>=0||(_e=_e.prevZ,ke.x>=W&&ke.x<=ae&&ke.y>=J&&ke.y<=de&&ke!==g&&ke!==w&&Xc(I,N,k,U,D,V,ke.x,ke.y)&&ni(ke.prev,ke,ke.next)>=0))return!1;ke=ke.nextZ}for(;_e&&_e.z>=ge;){if(_e.x>=W&&_e.x<=ae&&_e.y>=J&&_e.y<=de&&_e!==g&&_e!==w&&Xc(I,N,k,U,D,V,_e.x,_e.y)&&ni(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;ke&&ke.z<=Ie;){if(ke.x>=W&&ke.x<=ae&&ke.y>=J&&ke.y<=de&&ke!==g&&ke!==w&&Xc(I,N,k,U,D,V,ke.x,ke.y)&&ni(ke.prev,ke,ke.next)>=0)return!1;ke=ke.nextZ}return!0}function NI(s,i,c){var d=s;do{var g=d.prev,b=d.next.next;!Qf(g,b)&&Xx(g,d,d.next,b)&&hd(g,b)&&hd(b,g)&&(i.push(g.i/c|0),i.push(d.i/c|0),i.push(b.i/c|0),dd(d),dd(d.next),d=s=b),d=d.next}while(d!==s);return dc(d)}function BI(s,i,c,d,g,b){var w=s;do{for(var I=w.next.next;I!==w.prev;){if(w.i!==I.i&&GI(w,I)){var k=Jx(w,I);return w=dc(w,w.next),k=dc(k,k.next),cd(w,i,c,d,g,b,0),void cd(k,i,c,d,g,b,0)}I=I.next}w=w.next}while(w!==s)}function UI(s,i){return s.x-i.x}function jI(s,i){var c=function(g,b){var w,I=b,k=g.x,D=g.y,N=-1/0;do{if(D<=I.y&&D>=I.next.y&&I.next.y!==I.y){var U=I.x+(D-I.y)*(I.next.x-I.x)/(I.next.y-I.y);if(U<=k&&U>N&&(N=U,w=I.x<I.next.x?I:I.next,U===k))return w}I=I.next}while(I!==b);if(!w)return null;var V,W=w,J=w.x,ae=w.y,de=1/0;I=w;do k>=I.x&&I.x>=J&&k!==I.x&&Xc(D<ae?k:N,D,J,ae,D<ae?N:k,D,I.x,I.y)&&(V=Math.abs(D-I.y)/(k-I.x),hd(I,g)&&(V<de||V===de&&(I.x>w.x||I.x===w.x&&$I(w,I)))&&(w=I,de=V)),I=I.next;while(I!==W);return w}(s,i);if(!c)return i;var d=Jx(c,s);return dc(d,d.next),dc(c,c.next)}function $I(s,i){return ni(s.prev,s,i.prev)<0&&ni(i.next,s,s.next)<0}function iy(s,i,c,d,g){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-c)*g|0)|s<<8))|s<<4))|s<<2))|s<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-d)*g|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function VI(s){var i=s,c=s;do(i.x<c.x||i.x===c.x&&i.y<c.y)&&(c=i),i=i.next;while(i!==s);return c}function Xc(s,i,c,d,g,b,w,I){return(g-w)*(i-I)>=(s-w)*(b-I)&&(s-w)*(d-I)>=(c-w)*(i-I)&&(c-w)*(b-I)>=(g-w)*(d-I)}function GI(s,i){return s.next.i!==i.i&&s.prev.i!==i.i&&!function(c,d){var g=c;do{if(g.i!==c.i&&g.next.i!==c.i&&g.i!==d.i&&g.next.i!==d.i&&Xx(g,g.next,c,d))return!0;g=g.next}while(g!==c);return!1}(s,i)&&(hd(s,i)&&hd(i,s)&&function(c,d){var g=c,b=!1,w=(c.x+d.x)/2,I=(c.y+d.y)/2;do g.y>I!=g.next.y>I&&g.next.y!==g.y&&w<(g.next.x-g.x)*(I-g.y)/(g.next.y-g.y)+g.x&&(b=!b),g=g.next;while(g!==c);return b}(s,i)&&(ni(s.prev,s,i.prev)||ni(s,i.prev,i))||Qf(s,i)&&ni(s.prev,s,s.next)>0&&ni(i.prev,i,i.next)>0)}function ni(s,i,c){return(i.y-s.y)*(c.x-i.x)-(i.x-s.x)*(c.y-i.y)}function Qf(s,i){return s.x===i.x&&s.y===i.y}function Xx(s,i,c,d){var g=tp(ni(s,i,c)),b=tp(ni(s,i,d)),w=tp(ni(c,d,s)),I=tp(ni(c,d,i));return g!==b&&w!==I||!(g!==0||!ep(s,c,i))||!(b!==0||!ep(s,d,i))||!(w!==0||!ep(c,s,d))||!(I!==0||!ep(c,i,d))}function ep(s,i,c){return i.x<=Math.max(s.x,c.x)&&i.x>=Math.min(s.x,c.x)&&i.y<=Math.max(s.y,c.y)&&i.y>=Math.min(s.y,c.y)}function tp(s){return s>0?1:s<0?-1:0}function hd(s,i){return ni(s.prev,s,s.next)<0?ni(s,i,s.next)>=0&&ni(s,s.prev,i)>=0:ni(s,i,s.prev)<0||ni(s,s.next,i)<0}function Jx(s,i){var c=new oy(s.i,s.x,s.y),d=new oy(i.i,i.x,i.y),g=s.next,b=i.prev;return s.next=i,i.prev=s,c.next=g,g.prev=c,d.next=c,c.prev=d,b.next=d,d.prev=b,d}function Yx(s,i,c,d){var g=new oy(s,i,c);return d?(g.next=d.next,g.prev=d,d.next.prev=g,d.next=g):(g.prev=g,g.next=g),g}function dd(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function oy(s,i,c){this.i=s,this.x=i,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function sy(s,i,c,d){for(var g=0,b=i,w=c-d;b<c;b+=d)g+=(s[w]-s[b])*(s[b+1]+s[w+1]),w=b;return g}ny.exports=Yf,ny.exports.default=Yf,Yf.deviation=function(s,i,c,d){var g=i&&i.length,b=Math.abs(sy(s,0,g?i[0]*c:s.length,c));if(g)for(var w=0,I=i.length;w<I;w++)b-=Math.abs(sy(s,i[w]*c,w<I-1?i[w+1]*c:s.length,c));var k=0;for(w=0;w<d.length;w+=3){var D=d[w]*c,N=d[w+1]*c,U=d[w+2]*c;k+=Math.abs((s[D]-s[U])*(s[N+1]-s[D+1])-(s[D]-s[N])*(s[U+1]-s[D+1]))}return b===0&&k===0?0:Math.abs((k-b)/b)},Yf.flatten=function(s){for(var i=s[0][0].length,c={vertices:[],holes:[],dimensions:i},d=0,g=0;g<s.length;g++){for(var b=0;b<s[g].length;b++)for(var w=0;w<i;w++)c.vertices.push(s[g][b][w]);g>0&&c.holes.push(d+=s[g-1].length)}return c};var Qx=E(ny.exports);function qI(s,i,c,d,g){e1(s,i,c||0,d||s.length-1,g||HI)}function e1(s,i,c,d,g){for(;d>c;){if(d-c>600){var b=d-c+1,w=i-c+1,I=Math.log(b),k=.5*Math.exp(2*I/3),D=.5*Math.sqrt(I*k*(b-k)/b)*(w-b/2<0?-1:1);e1(s,i,Math.max(c,Math.floor(i-w*k/b+D)),Math.min(d,Math.floor(i+(b-w)*k/b+D)),g)}var N=s[i],U=c,V=d;for(fd(s,c,i),g(s[d],N)>0&&fd(s,c,d);U<V;){for(fd(s,U,V),U++,V--;g(s[U],N)<0;)U++;for(;g(s[V],N)>0;)V--}g(s[c],N)===0?fd(s,c,V):fd(s,++V,d),V<=i&&(c=V+1),i<=V&&(d=V-1)}}function fd(s,i,c){var d=s[i];s[i]=s[c],s[c]=d}function HI(s,i){return s<i?-1:s>i?1:0}function ay(s,i){const c=s.length;if(c<=1)return[s];const d=[];let g,b;for(let w=0;w<c;w++){const I=Qt(s[w]);I!==0&&(s[w].area=Math.abs(I),b===void 0&&(b=I<0),b===I<0?(g&&d.push(g),g=[s[w]]):g.push(s[w]))}if(g&&d.push(g),i>1)for(let w=0;w<d.length;w++)d[w].length<=i||(qI(d[w],i,1,d[w].length-1,ZI),d[w]=d[w].slice(0,i));return d}function ZI(s,i){return i.area-s.area}function ly(s,i,c){const d=c.patternDependencies;let g=!1;for(const b of i){const w=b.paint.get(`${s}-pattern`);w.isConstant()||(g=!0);const I=w.constantOr(null);I&&(g=!0,d[I.to]=!0,d[I.from]=!0)}return g}function uy(s,i,c,d,g){const b=g.patternDependencies;for(const w of i){const I=w.paint.get(`${s}-pattern`).value;if(I.kind!=="constant"){let k=I.evaluate({zoom:d-1},c,{},g.availableImages),D=I.evaluate({zoom:d},c,{},g.availableImages),N=I.evaluate({zoom:d+1},c,{},g.availableImages);k=k&&k.name?k.name:k,D=D&&D.name?D.name:D,N=N&&N.name?N.name:N,b[k]=!0,b[D]=!0,b[N]=!0,c.patterns[w.id]={min:k,mid:D,max:N}}}return c}class cy{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(c=>c.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ue,this.indexArray=new Ke,this.indexArray2=new gt,this.programConfigurations=new Ga(i.layers,i.zoom),this.segments=new ct,this.segments2=new ct,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(i,c,d){this.hasPattern=ly("fill",this.layers,c);const g=this.layers[0].layout.get("fill-sort-key"),b=!g.isConstant(),w=[];for(const{feature:I,id:k,index:D,sourceLayerIndex:N}of i){const U=this.layers[0]._featureFilter.needGeometry,V=hc(I,U);if(!this.layers[0]._featureFilter.filter(new An(this.zoom),V,d))continue;const W=b?g.evaluate(V,{},d,c.availableImages):void 0,J={id:k,properties:I.properties,type:I.type,sourceLayerIndex:N,index:D,geometry:U?V.geometry:qa(I),patterns:{},sortKey:W};w.push(J)}b&&w.sort((I,k)=>I.sortKey-k.sortKey);for(const I of w){const{geometry:k,index:D,sourceLayerIndex:N}=I;if(this.hasPattern){const U=uy("fill",this.layers,I,this.zoom,c);this.patternFeatures.push(U)}else this.addFeature(I,k,D,d,{});c.featureIndex.insert(i[D].feature,k,D,N,this.index)}}update(i,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,c,this.stateDependentLayers,d)}addFeatures(i,c,d){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,c,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,DI),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,c,d,g,b){for(const w of ay(c,500)){let I=0;for(const W of w)I+=W.length;const k=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray),D=k.vertexLength,N=[],U=[];for(const W of w){if(W.length===0)continue;W!==w[0]&&U.push(N.length/2);const J=this.segments2.prepareSegment(W.length,this.layoutVertexArray,this.indexArray2),ae=J.vertexLength;this.layoutVertexArray.emplaceBack(W[0].x,W[0].y),this.indexArray2.emplaceBack(ae+W.length-1,ae),N.push(W[0].x),N.push(W[0].y);for(let de=1;de<W.length;de++)this.layoutVertexArray.emplaceBack(W[de].x,W[de].y),this.indexArray2.emplaceBack(ae+de-1,ae+de),N.push(W[de].x),N.push(W[de].y);J.vertexLength+=W.length,J.primitiveLength+=W.length}const V=Qx(N,U);for(let W=0;W<V.length;W+=3)this.indexArray.emplaceBack(D+V[W],D+V[W+1],D+V[W+2]);k.vertexLength+=I,k.primitiveLength+=V.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,d,b,g)}}let t1,r1;yt("FillBucket",cy,{omit:["layers","patternFeatures"]});var WI={get paint(){return r1=r1||new Io({"fill-antialias":new Lt(Ue.paint_fill["fill-antialias"]),"fill-opacity":new Wt(Ue.paint_fill["fill-opacity"]),"fill-color":new Wt(Ue.paint_fill["fill-color"]),"fill-outline-color":new Wt(Ue.paint_fill["fill-outline-color"]),"fill-translate":new Lt(Ue.paint_fill["fill-translate"]),"fill-translate-anchor":new Lt(Ue.paint_fill["fill-translate-anchor"]),"fill-pattern":new Bc(Ue.paint_fill["fill-pattern"])})},get layout(){return t1=t1||new Io({"fill-sort-key":new Wt(Ue.layout_fill["fill-sort-key"])})}};class KI extends xa{constructor(i){super(i,WI)}recalculate(i,c){super.recalculate(i,c);const d=this.paint._values["fill-outline-color"];d.value.kind==="constant"&&d.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new cy(i)}queryRadius(){return Kf(this.paint.get("fill-translate"))}queryIntersectsFeature(i,c,d,g,b,w,I){return Fx(Xf(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),w.angle,I),g)}isTileClipped(){return!0}}const XI=ai([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),JI=ai([{name:"a_centroid",components:2,type:"Int16"}],4),{members:YI}=XI;var cu={},QI=m,n1=Jc;function Jc(s,i,c,d,g){this.properties={},this.extent=c,this.type=0,this._pbf=s,this._geometry=-1,this._keys=d,this._values=g,s.readFields(eP,this,i)}function eP(s,i,c){s==1?i.id=c.readVarint():s==2?function(d,g){for(var b=d.readVarint()+d.pos;d.pos<b;){var w=g._keys[d.readVarint()],I=g._values[d.readVarint()];g.properties[w]=I}}(c,i):s==3?i.type=c.readVarint():s==4&&(i._geometry=c.pos)}function tP(s){for(var i,c,d=0,g=0,b=s.length,w=b-1;g<b;w=g++)d+=((c=s[w]).x-(i=s[g]).x)*(i.y+c.y);return d}Jc.types=["Unknown","Point","LineString","Polygon"],Jc.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var i,c=s.readVarint()+s.pos,d=1,g=0,b=0,w=0,I=[];s.pos<c;){if(g<=0){var k=s.readVarint();d=7&k,g=k>>3}if(g--,d===1||d===2)b+=s.readSVarint(),w+=s.readSVarint(),d===1&&(i&&I.push(i),i=[]),i.push(new QI(b,w));else{if(d!==7)throw new Error("unknown command "+d);i&&i.push(i[0].clone())}}return i&&I.push(i),I},Jc.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var i=s.readVarint()+s.pos,c=1,d=0,g=0,b=0,w=1/0,I=-1/0,k=1/0,D=-1/0;s.pos<i;){if(d<=0){var N=s.readVarint();c=7&N,d=N>>3}if(d--,c===1||c===2)(g+=s.readSVarint())<w&&(w=g),g>I&&(I=g),(b+=s.readSVarint())<k&&(k=b),b>D&&(D=b);else if(c!==7)throw new Error("unknown command "+c)}return[w,k,I,D]},Jc.prototype.toGeoJSON=function(s,i,c){var d,g,b=this.extent*Math.pow(2,c),w=this.extent*s,I=this.extent*i,k=this.loadGeometry(),D=Jc.types[this.type];function N(W){for(var J=0;J<W.length;J++){var ae=W[J];W[J]=[360*(ae.x+w)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(ae.y+I)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var U=[];for(d=0;d<k.length;d++)U[d]=k[d][0];N(k=U);break;case 2:for(d=0;d<k.length;d++)N(k[d]);break;case 3:for(k=function(W){var J=W.length;if(J<=1)return[W];for(var ae,de,ge=[],Ie=0;Ie<J;Ie++){var _e=tP(W[Ie]);_e!==0&&(de===void 0&&(de=_e<0),de===_e<0?(ae&&ge.push(ae),ae=[W[Ie]]):ae.push(W[Ie]))}return ae&&ge.push(ae),ge}(k),d=0;d<k.length;d++)for(g=0;g<k[d].length;g++)N(k[d][g])}k.length===1?k=k[0]:D="Multi"+D;var V={type:"Feature",geometry:{type:D,coordinates:k},properties:this.properties};return"id"in this&&(V.id=this.id),V};var rP=n1,i1=o1;function o1(s,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(nP,this,i),this.length=this._features.length}function nP(s,i,c){s===15?i.version=c.readVarint():s===1?i.name=c.readString():s===5?i.extent=c.readVarint():s===2?i._features.push(c.pos):s===3?i._keys.push(c.readString()):s===4&&i._values.push(function(d){for(var g=null,b=d.readVarint()+d.pos;d.pos<b;){var w=d.readVarint()>>3;g=w===1?d.readString():w===2?d.readFloat():w===3?d.readDouble():w===4?d.readVarint64():w===5?d.readVarint():w===6?d.readSVarint():w===7?d.readBoolean():null}return g}(c))}o1.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var i=this._pbf.readVarint()+this._pbf.pos;return new rP(this._pbf,i,this.extent,this._keys,this._values)};var iP=i1;function oP(s,i,c){if(s===3){var d=new iP(c,c.readVarint()+c.pos);d.length&&(i[d.name]=d)}}cu.VectorTile=function(s,i){this.layers=s.readFields(oP,{},i)},cu.VectorTileFeature=n1,cu.VectorTileLayer=i1;const sP=cu.VectorTileFeature.types,hy=Math.pow(2,13);function pd(s,i,c,d,g,b,w,I){s.emplaceBack(i,c,2*Math.floor(d*hy)+w,g*hy*2,b*hy*2,Math.round(I))}class dy{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(c=>c.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new se,this.centroidVertexArray=new ie,this.indexArray=new Ke,this.programConfigurations=new Ga(i.layers,i.zoom),this.segments=new ct,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(i,c,d){this.features=[],this.hasPattern=ly("fill-extrusion",this.layers,c);for(const{feature:g,id:b,index:w,sourceLayerIndex:I}of i){const k=this.layers[0]._featureFilter.needGeometry,D=hc(g,k);if(!this.layers[0]._featureFilter.filter(new An(this.zoom),D,d))continue;const N={id:b,sourceLayerIndex:I,index:w,geometry:k?D.geometry:qa(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(uy("fill-extrusion",this.layers,N,this.zoom,c)):this.addFeature(N,N.geometry,w,d,{}),c.featureIndex.insert(g,N.geometry,w,I,this.index,!0)}}addFeatures(i,c,d){for(const g of this.features){const{geometry:b}=g;this.addFeature(g,b,g.index,c,d)}}update(i,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,c,this.stateDependentLayers,d)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,YI),this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,JI.members,!0),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(i,c,d,g,b){const w={x:0,y:0,vertexCount:0};for(const I of ay(c,500)){let k=0;for(const J of I)k+=J.length;let D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const J of I){if(J.length===0||lP(J))continue;let ae=0;for(let de=0;de<J.length;de++){const ge=J[de];if(de>=1){const Ie=J[de-1];if(!aP(ge,Ie)){D.vertexLength+4>ct.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const _e=ge.sub(Ie)._perp()._unit(),ke=Ie.dist(ge);ae+ke>32768&&(ae=0),pd(this.layoutVertexArray,ge.x,ge.y,_e.x,_e.y,0,0,ae),pd(this.layoutVertexArray,ge.x,ge.y,_e.x,_e.y,0,1,ae),w.x+=2*ge.x,w.y+=2*ge.y,w.vertexCount+=2,ae+=ke,pd(this.layoutVertexArray,Ie.x,Ie.y,_e.x,_e.y,0,0,ae),pd(this.layoutVertexArray,Ie.x,Ie.y,_e.x,_e.y,0,1,ae),w.x+=2*Ie.x,w.y+=2*Ie.y,w.vertexCount+=2;const Oe=D.vertexLength;this.indexArray.emplaceBack(Oe,Oe+2,Oe+1),this.indexArray.emplaceBack(Oe+1,Oe+2,Oe+3),D.vertexLength+=4,D.primitiveLength+=2}}}}if(D.vertexLength+k>ct.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray)),sP[i.type]!=="Polygon")continue;const N=[],U=[],V=D.vertexLength;for(const J of I)if(J.length!==0){J!==I[0]&&U.push(N.length/2);for(let ae=0;ae<J.length;ae++){const de=J[ae];pd(this.layoutVertexArray,de.x,de.y,0,0,1,1,0),w.x+=de.x,w.y+=de.y,w.vertexCount+=1,N.push(de.x),N.push(de.y)}}const W=Qx(N,U);for(let J=0;J<W.length;J+=3)this.indexArray.emplaceBack(V+W[J],V+W[J+2],V+W[J+1]);D.primitiveLength+=W.length/3,D.vertexLength+=k}for(let I=0;I<w.vertexCount;I++)this.centroidVertexArray.emplaceBack(Math.floor(w.x/w.vertexCount),Math.floor(w.y/w.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,d,b,g)}}function aP(s,i){return s.x===i.x&&(s.x<0||s.x>wn)||s.y===i.y&&(s.y<0||s.y>wn)}function lP(s){return s.every(i=>i.x<0)||s.every(i=>i.x>wn)||s.every(i=>i.y<0)||s.every(i=>i.y>wn)}let s1;yt("FillExtrusionBucket",dy,{omit:["layers","features"]});var uP={get paint(){return s1=s1||new Io({"fill-extrusion-opacity":new Lt(Ue["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Wt(Ue["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Lt(Ue["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Lt(Ue["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Bc(Ue["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Wt(Ue["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Wt(Ue["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Lt(Ue["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class cP extends xa{constructor(i){super(i,uP)}createBucket(i){return new dy(i)}queryRadius(){return Kf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(i,c,d,g,b,w,I,k){const D=Xf(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),w.angle,I),N=this.paint.get("fill-extrusion-height").evaluate(c,d),U=this.paint.get("fill-extrusion-base").evaluate(c,d),V=function(J,ae,de,ge){const Ie=[];for(const _e of J){const ke=[_e.x,_e.y,0,1];Jf(ke,ke,ae),Ie.push(new M(ke[0]/ke[3],ke[1]/ke[3]))}return Ie}(D,k),W=function(J,ae,de,ge){const Ie=[],_e=[],ke=ge[8]*ae,Oe=ge[9]*ae,Xe=ge[10]*ae,Et=ge[11]*ae,Ct=ge[8]*de,wt=ge[9]*de,vt=ge[10]*de,dt=ge[11]*de;for(const St of J){const _t=[],it=[];for(const qt of St){const Rt=qt.x,mr=qt.y,En=ge[0]*Rt+ge[4]*mr+ge[12],Mn=ge[1]*Rt+ge[5]*mr+ge[13],vi=ge[2]*Rt+ge[6]*mr+ge[14],xs=ge[3]*Rt+ge[7]*mr+ge[15],Ao=vi+Xe,Zn=xs+Et,Ri=En+Ct,Yi=Mn+wt,Yo=vi+vt,Mo=xs+dt,li=new M((En+ke)/Zn,(Mn+Oe)/Zn);li.z=Ao/Zn,_t.push(li);const _i=new M(Ri/Mo,Yi/Mo);_i.z=Yo/Mo,it.push(_i)}Ie.push(_t),_e.push(it)}return[Ie,_e]}(g,U,N,k);return function(J,ae,de){let ge=1/0;Fx(de,ae)&&(ge=a1(de,ae[0]));for(let Ie=0;Ie<ae.length;Ie++){const _e=ae[Ie],ke=J[Ie];for(let Oe=0;Oe<_e.length-1;Oe++){const Xe=_e[Oe],Et=[Xe,_e[Oe+1],ke[Oe+1],ke[Oe],Xe];zx(de,Et)&&(ge=Math.min(ge,a1(de,Et)))}}return ge!==1/0&&ge}(W[0],W[1],V)}}function md(s,i){return s.x*i.x+s.y*i.y}function a1(s,i){if(s.length===1){let c=0;const d=i[c++];let g;for(;!g||d.equals(g);)if(g=i[c++],!g)return 1/0;for(;c<i.length;c++){const b=i[c],w=s[0],I=g.sub(d),k=b.sub(d),D=w.sub(d),N=md(I,I),U=md(I,k),V=md(k,k),W=md(D,I),J=md(D,k),ae=N*V-U*U,de=(V*W-U*J)/ae,ge=(N*J-U*W)/ae,Ie=d.z*(1-de-ge)+g.z*de+b.z*ge;if(isFinite(Ie))return Ie}return 1/0}{let c=1/0;for(const d of i)c=Math.min(c,d.z);return c}}const hP=ai([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:dP}=hP,fP=ai([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:pP}=fP,mP=cu.VectorTileFeature.types,gP=Math.cos(Math.PI/180*37.5),l1=Math.pow(2,14)/.5;class fy{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(c=>c.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new xe,this.layoutVertexArray2=new Le,this.indexArray=new Ke,this.programConfigurations=new Ga(i.layers,i.zoom),this.segments=new ct,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(i,c,d){this.hasPattern=ly("line",this.layers,c);const g=this.layers[0].layout.get("line-sort-key"),b=!g.isConstant(),w=[];for(const{feature:I,id:k,index:D,sourceLayerIndex:N}of i){const U=this.layers[0]._featureFilter.needGeometry,V=hc(I,U);if(!this.layers[0]._featureFilter.filter(new An(this.zoom),V,d))continue;const W=b?g.evaluate(V,{},d):void 0,J={id:k,properties:I.properties,type:I.type,sourceLayerIndex:N,index:D,geometry:U?V.geometry:qa(I),patterns:{},sortKey:W};w.push(J)}b&&w.sort((I,k)=>I.sortKey-k.sortKey);for(const I of w){const{geometry:k,index:D,sourceLayerIndex:N}=I;if(this.hasPattern){const U=uy("line",this.layers,I,this.zoom,c);this.patternFeatures.push(U)}else this.addFeature(I,k,D,d,{});c.featureIndex.insert(i[D].feature,k,D,N,this.index)}}update(i,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,c,this.stateDependentLayers,d)}addFeatures(i,c,d){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,c,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,pP)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,dP),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,c,d,g,b){const w=this.layers[0].layout,I=w.get("line-join").evaluate(i,{}),k=w.get("line-cap"),D=w.get("line-miter-limit"),N=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const U of c)this.addLine(U,i,I,k,D,N);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,d,b,g)}addLine(i,c,d,g,b,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ge=0;ge<i.length-1;ge++)this.totalDistance+=i[ge].dist(i[ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const I=mP[c.type]==="Polygon";let k=i.length;for(;k>=2&&i[k-1].equals(i[k-2]);)k--;let D=0;for(;D<k-1&&i[D].equals(i[D+1]);)D++;if(k<(I?3:2))return;d==="bevel"&&(b=1.05);const N=this.overscaling<=16?15*wn/(512*this.overscaling):0,U=this.segments.prepareSegment(10*k,this.layoutVertexArray,this.indexArray);let V,W,J,ae,de;this.e1=this.e2=-1,I&&(V=i[k-2],de=i[D].sub(V)._unit()._perp());for(let ge=D;ge<k;ge++){if(J=ge===k-1?I?i[D+1]:void 0:i[ge+1],J&&i[ge].equals(J))continue;de&&(ae=de),V&&(W=V),V=i[ge],de=J?J.sub(V)._unit()._perp():ae,ae=ae||de;let Ie=ae.add(de);Ie.x===0&&Ie.y===0||Ie._unit();const _e=ae.x*de.x+ae.y*de.y,ke=Ie.x*de.x+Ie.y*de.y,Oe=ke!==0?1/ke:1/0,Xe=2*Math.sqrt(2-2*ke),Et=ke<gP&&W&&J,Ct=ae.x*de.y-ae.y*de.x>0;if(Et&&ge>D){const dt=V.dist(W);if(dt>2*N){const St=V.sub(V.sub(W)._mult(N/dt)._round());this.updateDistance(W,St),this.addCurrentVertex(St,ae,0,0,U),W=St}}const wt=W&&J;let vt=wt?d:I?"butt":g;if(wt&&vt==="round"&&(Oe<w?vt="miter":Oe<=2&&(vt="fakeround")),vt==="miter"&&Oe>b&&(vt="bevel"),vt==="bevel"&&(Oe>2&&(vt="flipbevel"),Oe<b&&(vt="miter")),W&&this.updateDistance(W,V),vt==="miter")Ie._mult(Oe),this.addCurrentVertex(V,Ie,0,0,U);else if(vt==="flipbevel"){if(Oe>100)Ie=de.mult(-1);else{const dt=Oe*ae.add(de).mag()/ae.sub(de).mag();Ie._perp()._mult(dt*(Ct?-1:1))}this.addCurrentVertex(V,Ie,0,0,U),this.addCurrentVertex(V,Ie.mult(-1),0,0,U)}else if(vt==="bevel"||vt==="fakeround"){const dt=-Math.sqrt(Oe*Oe-1),St=Ct?dt:0,_t=Ct?0:dt;if(W&&this.addCurrentVertex(V,ae,St,_t,U),vt==="fakeround"){const it=Math.round(180*Xe/Math.PI/20);for(let qt=1;qt<it;qt++){let Rt=qt/it;if(Rt!==.5){const En=Rt-.5;Rt+=Rt*En*(Rt-1)*((1.0904+_e*(_e*(3.55645-1.43519*_e)-3.2452))*En*En+(.848013+_e*(.215638*_e-1.06021)))}const mr=de.sub(ae)._mult(Rt)._add(ae)._unit()._mult(Ct?-1:1);this.addHalfVertex(V,mr.x,mr.y,!1,Ct,0,U)}}J&&this.addCurrentVertex(V,de,-St,-_t,U)}else if(vt==="butt")this.addCurrentVertex(V,Ie,0,0,U);else if(vt==="square"){const dt=W?1:-1;this.addCurrentVertex(V,Ie,dt,dt,U)}else vt==="round"&&(W&&(this.addCurrentVertex(V,ae,0,0,U),this.addCurrentVertex(V,ae,1,1,U,!0)),J&&(this.addCurrentVertex(V,de,-1,-1,U,!0),this.addCurrentVertex(V,de,0,0,U)));if(Et&&ge<k-1){const dt=V.dist(J);if(dt>2*N){const St=V.add(J.sub(V)._mult(N/dt)._round());this.updateDistance(V,St),this.addCurrentVertex(St,de,0,0,U),V=St}}}}addCurrentVertex(i,c,d,g,b,w=!1){const I=c.y*g-c.x,k=-c.y-c.x*g;this.addHalfVertex(i,c.x+c.y*d,c.y-c.x*d,w,!1,d,b),this.addHalfVertex(i,I,k,w,!0,-g,b),this.distance>l1/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(i,c,d,g,b,w))}addHalfVertex({x:i,y:c},d,g,b,w,I,k){const D=.5*(this.lineClips?this.scaledDistance*(l1-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((i<<1)+(b?1:0),(c<<1)+(w?1:0),Math.round(63*d)+128,Math.round(63*g)+128,1+(I===0?0:I<0?-1:1)|(63&D)<<2,D>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const N=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,N),k.primitiveLength++),w?this.e2=N:this.e1=N}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(i,c){this.distance+=i.dist(c),this.updateScaledDistance()}}let u1,c1;yt("LineBucket",fy,{omit:["layers","patternFeatures"]});var h1={get paint(){return c1=c1||new Io({"line-opacity":new Wt(Ue.paint_line["line-opacity"]),"line-color":new Wt(Ue.paint_line["line-color"]),"line-translate":new Lt(Ue.paint_line["line-translate"]),"line-translate-anchor":new Lt(Ue.paint_line["line-translate-anchor"]),"line-width":new Wt(Ue.paint_line["line-width"]),"line-gap-width":new Wt(Ue.paint_line["line-gap-width"]),"line-offset":new Wt(Ue.paint_line["line-offset"]),"line-blur":new Wt(Ue.paint_line["line-blur"]),"line-dasharray":new Qh(Ue.paint_line["line-dasharray"]),"line-pattern":new Bc(Ue.paint_line["line-pattern"]),"line-gradient":new ed(Ue.paint_line["line-gradient"])})},get layout(){return u1=u1||new Io({"line-cap":new Lt(Ue.layout_line["line-cap"]),"line-join":new Wt(Ue.layout_line["line-join"]),"line-miter-limit":new Lt(Ue.layout_line["line-miter-limit"]),"line-round-limit":new Lt(Ue.layout_line["line-round-limit"]),"line-sort-key":new Wt(Ue.layout_line["line-sort-key"])})}};class yP extends Wt{possiblyEvaluate(i,c){return c=new An(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),super.possiblyEvaluate(i,c)}evaluate(i,c,d,g){return c=ne({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(i,c,d,g)}}let rp;class vP extends xa{constructor(i){super(i,h1),this.gradientVersion=0,rp||(rp=new yP(h1.paint.properties["line-width"].specification),rp.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Pe,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,c){super.recalculate(i,c),this.paint._values["line-floorwidth"]=rp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new fy(i)}queryRadius(i){const c=i,d=d1(ad("line-width",this,c),ad("line-gap-width",this,c)),g=ad("line-offset",this,c);return d/2+Math.abs(g)+Kf(this.paint.get("line-translate"))}queryIntersectsFeature(i,c,d,g,b,w,I){const k=Xf(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),w.angle,I),D=I/2*d1(this.paint.get("line-width").evaluate(c,d),this.paint.get("line-gap-width").evaluate(c,d)),N=this.paint.get("line-offset").evaluate(c,d);return N&&(g=function(U,V){const W=[];for(let J=0;J<U.length;J++){const ae=U[J],de=[];for(let ge=0;ge<ae.length;ge++){const Ie=ae[ge-1],_e=ae[ge],ke=ae[ge+1],Oe=ge===0?new M(0,0):_e.sub(Ie)._unit()._perp(),Xe=ge===ae.length-1?new M(0,0):ke.sub(_e)._unit()._perp(),Et=Oe._add(Xe)._unit(),Ct=Et.x*Xe.x+Et.y*Xe.y;Ct!==0&&Et._mult(1/Ct),de.push(Et._mult(V)._add(_e))}W.push(de)}return W}(g,N*I)),function(U,V,W){for(let J=0;J<V.length;J++){const ae=V[J];if(U.length>=3){for(let de=0;de<ae.length;de++)if(Wc(U,ae[de]))return!0}if(SI(U,ae,W))return!0}return!1}(k,g,D)}isTileClipped(){return!0}}function d1(s,i){return i>0?i+2*s:s}const _P=ai([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),xP=ai([{name:"a_projected_pos",components:3,type:"Float32"}],4);ai([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const bP=ai([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);ai([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const f1=ai([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),wP=ai([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function EP(s,i,c){return s.sections.forEach(d=>{d.text=function(g,b,w){const I=b.layout.get("text-transform").evaluate(w,{});return I==="uppercase"?g=g.toLocaleUpperCase():I==="lowercase"&&(g=g.toLocaleLowerCase()),_s.applyArabicShaping&&(g=_s.applyArabicShaping(g)),g}(d.text,i,c)}),s}ai([{name:"triangle",components:3,type:"Uint16"}]),ai([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ai([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ai([{type:"Float32",name:"offsetX"}]),ai([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const gd={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Li=24,p1=cn,m1=function(s,i,c,d,g){var b,w,I=8*g-d-1,k=(1<<I)-1,D=k>>1,N=-7,U=c?g-1:0,V=c?-1:1,W=s[i+U];for(U+=V,b=W&(1<<-N)-1,W>>=-N,N+=I;N>0;b=256*b+s[i+U],U+=V,N-=8);for(w=b&(1<<-N)-1,b>>=-N,N+=d;N>0;w=256*w+s[i+U],U+=V,N-=8);if(b===0)b=1-D;else{if(b===k)return w?NaN:1/0*(W?-1:1);w+=Math.pow(2,d),b-=D}return(W?-1:1)*w*Math.pow(2,b-d)},g1=function(s,i,c,d,g,b){var w,I,k,D=8*b-g-1,N=(1<<D)-1,U=N>>1,V=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,W=d?0:b-1,J=d?1:-1,ae=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(I=isNaN(i)?1:0,w=N):(w=Math.floor(Math.log(i)/Math.LN2),i*(k=Math.pow(2,-w))<1&&(w--,k*=2),(i+=w+U>=1?V/k:V*Math.pow(2,1-U))*k>=2&&(w++,k/=2),w+U>=N?(I=0,w=N):w+U>=1?(I=(i*k-1)*Math.pow(2,g),w+=U):(I=i*Math.pow(2,U-1)*Math.pow(2,g),w=0));g>=8;s[c+W]=255&I,W+=J,I/=256,g-=8);for(w=w<<g|I,D+=g;D>0;s[c+W]=255&w,W+=J,w/=256,D-=8);s[c+W-J]|=128*ae};function cn(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}cn.Varint=0,cn.Fixed64=1,cn.Bytes=2,cn.Fixed32=5;var py=4294967296,y1=1/py,v1=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ll(s){return s.type===cn.Bytes?s.readVarint()+s.pos:s.pos+1}function Yc(s,i,c){return c?4294967296*i+(s>>>0):4294967296*(i>>>0)+(s>>>0)}function _1(s,i,c){var d=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));c.realloc(d);for(var g=c.pos-1;g>=s;g--)c.buf[g+d]=c.buf[g]}function SP(s,i){for(var c=0;c<s.length;c++)i.writeVarint(s[c])}function TP(s,i){for(var c=0;c<s.length;c++)i.writeSVarint(s[c])}function CP(s,i){for(var c=0;c<s.length;c++)i.writeFloat(s[c])}function IP(s,i){for(var c=0;c<s.length;c++)i.writeDouble(s[c])}function PP(s,i){for(var c=0;c<s.length;c++)i.writeBoolean(s[c])}function AP(s,i){for(var c=0;c<s.length;c++)i.writeFixed32(s[c])}function MP(s,i){for(var c=0;c<s.length;c++)i.writeSFixed32(s[c])}function kP(s,i){for(var c=0;c<s.length;c++)i.writeFixed64(s[c])}function LP(s,i){for(var c=0;c<s.length;c++)i.writeSFixed64(s[c])}function np(s,i){return(s[i]|s[i+1]<<8|s[i+2]<<16)+16777216*s[i+3]}function Qc(s,i,c){s[c]=i,s[c+1]=i>>>8,s[c+2]=i>>>16,s[c+3]=i>>>24}function x1(s,i){return(s[i]|s[i+1]<<8|s[i+2]<<16)+(s[i+3]<<24)}cn.prototype={destroy:function(){this.buf=null},readFields:function(s,i,c){for(c=c||this.length;this.pos<c;){var d=this.readVarint(),g=d>>3,b=this.pos;this.type=7&d,s(g,i,this),this.pos===b&&this.skip(d)}return i},readMessage:function(s,i){return this.readFields(s,i,this.readVarint()+this.pos)},readFixed32:function(){var s=np(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=x1(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=np(this.buf,this.pos)+np(this.buf,this.pos+4)*py;return this.pos+=8,s},readSFixed64:function(){var s=np(this.buf,this.pos)+x1(this.buf,this.pos+4)*py;return this.pos+=8,s},readFloat:function(){var s=m1(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=m1(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var i,c,d=this.buf;return i=127&(c=d[this.pos++]),c<128?i:(i|=(127&(c=d[this.pos++]))<<7,c<128?i:(i|=(127&(c=d[this.pos++]))<<14,c<128?i:(i|=(127&(c=d[this.pos++]))<<21,c<128?i:function(g,b,w){var I,k,D=w.buf;if(I=(112&(k=D[w.pos++]))>>4,k<128||(I|=(127&(k=D[w.pos++]))<<3,k<128)||(I|=(127&(k=D[w.pos++]))<<10,k<128)||(I|=(127&(k=D[w.pos++]))<<17,k<128)||(I|=(127&(k=D[w.pos++]))<<24,k<128)||(I|=(1&(k=D[w.pos++]))<<31,k<128))return Yc(g,I,b);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(c=d[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var s=this.readVarint()+this.pos,i=this.pos;return this.pos=s,s-i>=12&&v1?function(c,d,g){return v1.decode(c.subarray(d,g))}(this.buf,i,s):function(c,d,g){for(var b="",w=d;w<g;){var I,k,D,N=c[w],U=null,V=N>239?4:N>223?3:N>191?2:1;if(w+V>g)break;V===1?N<128&&(U=N):V===2?(192&(I=c[w+1]))==128&&(U=(31&N)<<6|63&I)<=127&&(U=null):V===3?(k=c[w+2],(192&(I=c[w+1]))==128&&(192&k)==128&&((U=(15&N)<<12|(63&I)<<6|63&k)<=2047||U>=55296&&U<=57343)&&(U=null)):V===4&&(k=c[w+2],D=c[w+3],(192&(I=c[w+1]))==128&&(192&k)==128&&(192&D)==128&&((U=(15&N)<<18|(63&I)<<12|(63&k)<<6|63&D)<=65535||U>=1114112)&&(U=null)),U===null?(U=65533,V=1):U>65535&&(U-=65536,b+=String.fromCharCode(U>>>10&1023|55296),U=56320|1023&U),b+=String.fromCharCode(U),w+=V}return b}(this.buf,i,s)},readBytes:function(){var s=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,s);return this.pos=s,i},readPackedVarint:function(s,i){if(this.type!==cn.Bytes)return s.push(this.readVarint(i));var c=Ll(this);for(s=s||[];this.pos<c;)s.push(this.readVarint(i));return s},readPackedSVarint:function(s){if(this.type!==cn.Bytes)return s.push(this.readSVarint());var i=Ll(this);for(s=s||[];this.pos<i;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==cn.Bytes)return s.push(this.readBoolean());var i=Ll(this);for(s=s||[];this.pos<i;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==cn.Bytes)return s.push(this.readFloat());var i=Ll(this);for(s=s||[];this.pos<i;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==cn.Bytes)return s.push(this.readDouble());var i=Ll(this);for(s=s||[];this.pos<i;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==cn.Bytes)return s.push(this.readFixed32());var i=Ll(this);for(s=s||[];this.pos<i;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==cn.Bytes)return s.push(this.readSFixed32());var i=Ll(this);for(s=s||[];this.pos<i;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==cn.Bytes)return s.push(this.readFixed64());var i=Ll(this);for(s=s||[];this.pos<i;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==cn.Bytes)return s.push(this.readSFixed64());var i=Ll(this);for(s=s||[];this.pos<i;)s.push(this.readSFixed64());return s},skip:function(s){var i=7&s;if(i===cn.Varint)for(;this.buf[this.pos++]>127;);else if(i===cn.Bytes)this.pos=this.readVarint()+this.pos;else if(i===cn.Fixed32)this.pos+=4;else{if(i!==cn.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(s,i){this.writeVarint(s<<3|i)},realloc:function(s){for(var i=this.length||16;i<this.pos+s;)i*=2;if(i!==this.length){var c=new Uint8Array(i);c.set(this.buf),this.buf=c,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),Qc(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),Qc(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),Qc(this.buf,-1&s,this.pos),Qc(this.buf,Math.floor(s*y1),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),Qc(this.buf,-1&s,this.pos),Qc(this.buf,Math.floor(s*y1),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(i,c){var d,g;if(i>=0?(d=i%4294967296|0,g=i/4294967296|0):(g=~(-i/4294967296),4294967295^(d=~(-i%4294967296))?d=d+1|0:(d=0,g=g+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),function(b,w,I){I.buf[I.pos++]=127&b|128,b>>>=7,I.buf[I.pos++]=127&b|128,b>>>=7,I.buf[I.pos++]=127&b|128,b>>>=7,I.buf[I.pos++]=127&b|128,I.buf[I.pos]=127&(b>>>=7)}(d,0,c),function(b,w){var I=(7&b)<<4;w.buf[w.pos++]|=I|((b>>>=3)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b)))))}(g,c)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(!!s)},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var i=this.pos;this.pos=function(d,g,b){for(var w,I,k=0;k<g.length;k++){if((w=g.charCodeAt(k))>55295&&w<57344){if(!I){w>56319||k+1===g.length?(d[b++]=239,d[b++]=191,d[b++]=189):I=w;continue}if(w<56320){d[b++]=239,d[b++]=191,d[b++]=189,I=w;continue}w=I-55296<<10|w-56320|65536,I=null}else I&&(d[b++]=239,d[b++]=191,d[b++]=189,I=null);w<128?d[b++]=w:(w<2048?d[b++]=w>>6|192:(w<65536?d[b++]=w>>12|224:(d[b++]=w>>18|240,d[b++]=w>>12&63|128),d[b++]=w>>6&63|128),d[b++]=63&w|128)}return b}(this.buf,s,this.pos);var c=this.pos-i;c>=128&&_1(i,c,this),this.pos=i-1,this.writeVarint(c),this.pos+=c},writeFloat:function(s){this.realloc(4),g1(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),g1(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var i=s.length;this.writeVarint(i),this.realloc(i);for(var c=0;c<i;c++)this.buf[this.pos++]=s[c]},writeRawMessage:function(s,i){this.pos++;var c=this.pos;s(i,this);var d=this.pos-c;d>=128&&_1(c,d,this),this.pos=c-1,this.writeVarint(d),this.pos+=d},writeMessage:function(s,i,c){this.writeTag(s,cn.Bytes),this.writeRawMessage(i,c)},writePackedVarint:function(s,i){i.length&&this.writeMessage(s,SP,i)},writePackedSVarint:function(s,i){i.length&&this.writeMessage(s,TP,i)},writePackedBoolean:function(s,i){i.length&&this.writeMessage(s,PP,i)},writePackedFloat:function(s,i){i.length&&this.writeMessage(s,CP,i)},writePackedDouble:function(s,i){i.length&&this.writeMessage(s,IP,i)},writePackedFixed32:function(s,i){i.length&&this.writeMessage(s,AP,i)},writePackedSFixed32:function(s,i){i.length&&this.writeMessage(s,MP,i)},writePackedFixed64:function(s,i){i.length&&this.writeMessage(s,kP,i)},writePackedSFixed64:function(s,i){i.length&&this.writeMessage(s,LP,i)},writeBytesField:function(s,i){this.writeTag(s,cn.Bytes),this.writeBytes(i)},writeFixed32Field:function(s,i){this.writeTag(s,cn.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(s,i){this.writeTag(s,cn.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(s,i){this.writeTag(s,cn.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(s,i){this.writeTag(s,cn.Fixed64),this.writeSFixed64(i)},writeVarintField:function(s,i){this.writeTag(s,cn.Varint),this.writeVarint(i)},writeSVarintField:function(s,i){this.writeTag(s,cn.Varint),this.writeSVarint(i)},writeStringField:function(s,i){this.writeTag(s,cn.Bytes),this.writeString(i)},writeFloatField:function(s,i){this.writeTag(s,cn.Fixed32),this.writeFloat(i)},writeDoubleField:function(s,i){this.writeTag(s,cn.Fixed64),this.writeDouble(i)},writeBooleanField:function(s,i){this.writeVarintField(s,!!i)}};var my=E(p1);const gy=3;function RP(s,i,c){s===1&&c.readMessage(OP,i)}function OP(s,i,c){if(s===3){const{id:d,bitmap:g,width:b,height:w,left:I,top:k,advance:D}=c.readMessage(DP,{});i.push({id:d,bitmap:new ud({width:b+2*gy,height:w+2*gy},g),metrics:{width:b,height:w,left:I,top:k,advance:D}})}}function DP(s,i,c){s===1?i.id=c.readVarint():s===2?i.bitmap=c.readBytes():s===3?i.width=c.readVarint():s===4?i.height=c.readVarint():s===5?i.left=c.readSVarint():s===6?i.top=c.readSVarint():s===7&&(i.advance=c.readVarint())}const b1=gy;function w1(s){let i=0,c=0;for(const w of s)i+=w.w*w.h,c=Math.max(c,w.w);s.sort((w,I)=>I.h-w.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),c),h:1/0}];let g=0,b=0;for(const w of s)for(let I=d.length-1;I>=0;I--){const k=d[I];if(!(w.w>k.w||w.h>k.h)){if(w.x=k.x,w.y=k.y,b=Math.max(b,w.y+w.h),g=Math.max(g,w.x+w.w),w.w===k.w&&w.h===k.h){const D=d.pop();I<d.length&&(d[I]=D)}else w.h===k.h?(k.x+=w.w,k.w-=w.w):w.w===k.w?(k.y+=w.h,k.h-=w.h):(d.push({x:k.x+w.w,y:k.y,w:k.w-w.w,h:w.h}),k.y+=w.h,k.h-=w.h);break}}return{w:g,h:b,fill:i/(g*b)||0}}const Jo=1;class yy{constructor(i,{pixelRatio:c,version:d,stretchX:g,stretchY:b,content:w}){this.paddedRect=i,this.pixelRatio=c,this.stretchX=g,this.stretchY=b,this.content=w,this.version=d}get tl(){return[this.paddedRect.x+Jo,this.paddedRect.y+Jo]}get br(){return[this.paddedRect.x+this.paddedRect.w-Jo,this.paddedRect.y+this.paddedRect.h-Jo]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Jo)/this.pixelRatio,(this.paddedRect.h-2*Jo)/this.pixelRatio]}}class E1{constructor(i,c){const d={},g={};this.haveRenderCallbacks=[];const b=[];this.addImages(i,d,b),this.addImages(c,g,b);const{w,h:I}=w1(b),k=new Zs({width:w||1,height:I||1});for(const D in i){const N=i[D],U=d[D].paddedRect;Zs.copy(N.data,k,{x:0,y:0},{x:U.x+Jo,y:U.y+Jo},N.data)}for(const D in c){const N=c[D],U=g[D].paddedRect,V=U.x+Jo,W=U.y+Jo,J=N.data.width,ae=N.data.height;Zs.copy(N.data,k,{x:0,y:0},{x:V,y:W},N.data),Zs.copy(N.data,k,{x:0,y:ae-1},{x:V,y:W-1},{width:J,height:1}),Zs.copy(N.data,k,{x:0,y:0},{x:V,y:W+ae},{width:J,height:1}),Zs.copy(N.data,k,{x:J-1,y:0},{x:V-1,y:W},{width:1,height:ae}),Zs.copy(N.data,k,{x:0,y:0},{x:V+J,y:W},{width:1,height:ae})}this.image=k,this.iconPositions=d,this.patternPositions=g}addImages(i,c,d){for(const g in i){const b=i[g],w={x:0,y:0,w:b.data.width+2*Jo,h:b.data.height+2*Jo};d.push(w),c[g]=new yy(w,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(i,c){i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in i.updatedImages)this.patchUpdatedImage(this.iconPositions[d],i.getImage(d),c),this.patchUpdatedImage(this.patternPositions[d],i.getImage(d),c)}patchUpdatedImage(i,c,d){if(!i||!c||i.version===c.version)return;i.version=c.version;const[g,b]=i.tl;d.update(c.data,void 0,{x:g,y:b})}}var hu;yt("ImagePosition",yy),yt("ImageAtlas",E1),u.WritingMode=void 0,(hu=u.WritingMode||(u.WritingMode={}))[hu.none=0]="none",hu[hu.horizontal=1]="horizontal",hu[hu.vertical=2]="vertical",hu[hu.horizontalOnly=3]="horizontalOnly";const yd=-17;class vd{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,c){const d=new vd;return d.scale=i||1,d.fontStack=c,d}static forImage(i){const c=new vd;return c.imageName=i,c}}class eh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,c){const d=new eh;for(let g=0;g<i.sections.length;g++){const b=i.sections[g];b.image?d.addImageSection(b):d.addTextSection(b,c)}return d}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(){this.text=function(i){let c="";for(let d=0;d<i.length;d++){const g=i.charCodeAt(d+1)||null,b=i.charCodeAt(d-1)||null;c+=g&&ys(g)&&!gd[i[d+1]]||b&&ys(b)&&!gd[i[d-1]]||!gd[i[d]]?i[d]:gd[i[d]]}return c}(this.text)}trim(){let i=0;for(let d=0;d<this.text.length&&op[this.text.charCodeAt(d)];d++)i++;let c=this.text.length;for(let d=this.text.length-1;d>=0&&d>=i&&op[this.text.charCodeAt(d)];d--)c--;this.text=this.text.substring(i,c),this.sectionIndex=this.sectionIndex.slice(i,c)}substring(i,c){const d=new eh;return d.text=this.text.substring(i,c),d.sectionIndex=this.sectionIndex.slice(i,c),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,c)=>Math.max(i,this.sections[c].scale),0)}addTextSection(i,c){this.text+=i.text,this.sections.push(vd.forText(i.scale,i.fontStack||c));const d=this.sections.length-1;for(let g=0;g<i.text.length;++g)this.sectionIndex.push(d)}addImageSection(i){const c=i.image?i.image.name:"";if(c.length===0)return void Ut("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(vd.forImage(c)),this.sectionIndex.push(this.sections.length-1)):Ut("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ip(s,i,c,d,g,b,w,I,k,D,N,U,V,W,J,ae){const de=eh.fromFeature(s,g);let ge;U===u.WritingMode.vertical&&de.verticalizePunctuation();const{processBidirectionalText:Ie,processStyledBidirectionalText:_e}=_s;if(Ie&&de.sections.length===1){ge=[];const Xe=Ie(de.toString(),vy(de,D,b,i,d,W,J));for(const Et of Xe){const Ct=new eh;Ct.text=Et,Ct.sections=de.sections;for(let wt=0;wt<Et.length;wt++)Ct.sectionIndex.push(0);ge.push(Ct)}}else if(_e){ge=[];const Xe=_e(de.text,de.sectionIndex,vy(de,D,b,i,d,W,J));for(const Et of Xe){const Ct=new eh;Ct.text=Et[0],Ct.sectionIndex=Et[1],Ct.sections=de.sections,ge.push(Ct)}}else ge=function(Xe,Et){const Ct=[],wt=Xe.text;let vt=0;for(const dt of Et)Ct.push(Xe.substring(vt,dt)),vt=dt;return vt<wt.length&&Ct.push(Xe.substring(vt,wt.length)),Ct}(de,vy(de,D,b,i,d,W,J));const ke=[],Oe={positionedLines:ke,text:de.toString(),top:N[1],bottom:N[1],left:N[0],right:N[0],writingMode:U,iconsInText:!1,verticalizable:!1};return function(Xe,Et,Ct,wt,vt,dt,St,_t,it,qt,Rt,mr){let En=0,Mn=yd,vi=0,xs=0;const Ao=_t==="right"?1:_t==="left"?0:.5;let Zn=0;for(const li of vt){li.trim();const _i=li.getMaxScale(),po=(_i-1)*Li,ko={positionedGlyphs:[],lineOffset:0};Xe.positionedLines[Zn]=ko;const Qo=ko.positionedGlyphs;let es=0;if(!li.length()){Mn+=dt,++Zn;continue}for(let Qi=0;Qi<li.length();Qi++){const Sr=li.getSection(Qi),bs=li.getSectionIndex(Qi),eo=li.getCharCode(Qi);let mo=0,Ea=null,Ha=null,Za=null,Rl=Li;const Sa=!(it===u.WritingMode.horizontal||!Rt&&!qn(eo)||Rt&&(op[eo]||(Ri=eo,Ye.Arabic(Ri)||Ye["Arabic Supplement"](Ri)||Ye["Arabic Extended-A"](Ri)||Ye["Arabic Presentation Forms-A"](Ri)||Ye["Arabic Presentation Forms-B"](Ri))));if(Sr.imageName){const Ks=wt[Sr.imageName];if(!Ks)continue;Za=Sr.imageName,Xe.iconsInText=Xe.iconsInText||!0,Ha=Ks.paddedRect;const ts=Ks.displaySize;Sr.scale=Sr.scale*Li/mr,Ea={width:ts[0],height:ts[1],left:Jo,top:-b1,advance:Sa?ts[1]:ts[0]},mo=po+(Li-ts[1]*Sr.scale),Rl=Ea.advance;const Ol=Sa?ts[0]*Sr.scale-Li*_i:ts[1]*Sr.scale-Li*_i;Ol>0&&Ol>es&&(es=Ol)}else{const Ks=Ct[Sr.fontStack],ts=Ks&&Ks[eo];if(ts&&ts.rect)Ha=ts.rect,Ea=ts.metrics;else{const Ol=Et[Sr.fontStack],Ed=Ol&&Ol[eo];if(!Ed)continue;Ea=Ed.metrics}mo=(_i-Sr.scale)*Li}Sa?(Xe.verticalizable=!0,Qo.push({glyph:eo,imageName:Za,x:En,y:Mn+mo,vertical:Sa,scale:Sr.scale,fontStack:Sr.fontStack,sectionIndex:bs,metrics:Ea,rect:Ha}),En+=Rl*Sr.scale+qt):(Qo.push({glyph:eo,imageName:Za,x:En,y:Mn+mo,vertical:Sa,scale:Sr.scale,fontStack:Sr.fontStack,sectionIndex:bs,metrics:Ea,rect:Ha}),En+=Ea.advance*Sr.scale+qt)}Qo.length!==0&&(vi=Math.max(En-qt,vi),NP(Qo,0,Qo.length-1,Ao,es)),En=0;const Wn=dt*_i+es;ko.lineOffset=Math.max(es,po),Mn+=Wn,xs=Math.max(Wn,xs),++Zn}var Ri;const Yi=Mn-yd,{horizontalAlign:Yo,verticalAlign:Mo}=_y(St);(function(li,_i,po,ko,Qo,es,Wn,Qi,Sr){const bs=(_i-po)*Qo;let eo=0;eo=es!==Wn?-Qi*ko-yd:(-ko*Sr+.5)*Wn;for(const mo of li)for(const Ea of mo.positionedGlyphs)Ea.x+=bs,Ea.y+=eo})(Xe.positionedLines,Ao,Yo,Mo,vi,xs,dt,Yi,vt.length),Xe.top+=-Mo*Yi,Xe.bottom=Xe.top+Yi,Xe.left+=-Yo*vi,Xe.right=Xe.left+vi}(Oe,i,c,d,ge,w,I,k,U,D,V,ae),!function(Xe){for(const Et of Xe)if(Et.positionedGlyphs.length!==0)return!1;return!0}(ke)&&Oe}const op={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},zP={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function S1(s,i,c,d,g,b){if(i.imageName){const w=d[i.imageName];return w?w.displaySize[0]*i.scale*Li/b+g:0}{const w=c[i.fontStack],I=w&&w[s];return I?I.metrics.advance*i.scale+g:0}}function T1(s,i,c,d){const g=Math.pow(s-i,2);return d?s<i?g/2:2*g:g+Math.abs(c)*c}function FP(s,i,c){let d=0;return s===10&&(d-=1e4),c&&(d+=150),s!==40&&s!==65288||(d+=50),i!==41&&i!==65289||(d+=50),d}function C1(s,i,c,d,g,b){let w=null,I=T1(i,c,g,b);for(const k of d){const D=T1(i-k.x,c,g,b)+k.badness;D<=I&&(w=k,I=D)}return{index:s,x:i,priorBreak:w,badness:I}}function I1(s){return s?I1(s.priorBreak).concat(s.index):[]}function vy(s,i,c,d,g,b,w){if(b!=="point")return[];if(!s)return[];const I=[],k=function(V,W,J,ae,de,ge){let Ie=0;for(let _e=0;_e<V.length();_e++){const ke=V.getSection(_e);Ie+=S1(V.getCharCode(_e),ke,ae,de,W,ge)}return Ie/Math.max(1,Math.ceil(Ie/J))}(s,i,c,d,g,w),D=s.text.indexOf("​")>=0;let N=0;for(let V=0;V<s.length();V++){const W=s.getSection(V),J=s.getCharCode(V);if(op[J]||(N+=S1(J,W,d,g,i,w)),V<s.length()-1){const ae=!((U=J)<11904||!(Ye["Bopomofo Extended"](U)||Ye.Bopomofo(U)||Ye["CJK Compatibility Forms"](U)||Ye["CJK Compatibility Ideographs"](U)||Ye["CJK Compatibility"](U)||Ye["CJK Radicals Supplement"](U)||Ye["CJK Strokes"](U)||Ye["CJK Symbols and Punctuation"](U)||Ye["CJK Unified Ideographs Extension A"](U)||Ye["CJK Unified Ideographs"](U)||Ye["Enclosed CJK Letters and Months"](U)||Ye["Halfwidth and Fullwidth Forms"](U)||Ye.Hiragana(U)||Ye["Ideographic Description Characters"](U)||Ye["Kangxi Radicals"](U)||Ye["Katakana Phonetic Extensions"](U)||Ye.Katakana(U)||Ye["Vertical Forms"](U)||Ye["Yi Radicals"](U)||Ye["Yi Syllables"](U)));(zP[J]||ae||W.imageName)&&I.push(C1(V+1,N,k,I,FP(J,s.getCharCode(V+1),ae&&D),!1))}}var U;return I1(C1(s.length(),N,k,I,0,!0))}function _y(s){let i=.5,c=.5;switch(s){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:i,verticalAlign:c}}function NP(s,i,c,d,g){if(!d&&!g)return;const b=s[c],w=(s[c].x+b.metrics.advance*b.scale)*d;for(let I=i;I<=c;I++)s[I].x-=w,s[I].y+=g}function BP(s,i,c){const{horizontalAlign:d,verticalAlign:g}=_y(c),b=i[0]-s.displaySize[0]*d,w=i[1]-s.displaySize[1]*g;return{image:s,top:w,bottom:w+s.displaySize[1],left:b,right:b+s.displaySize[0]}}function P1(s,i,c,d,g,b){const w=s.image;let I;if(w.content){const de=w.content,ge=w.pixelRatio||1;I=[de[0]/ge,de[1]/ge,w.displaySize[0]-de[2]/ge,w.displaySize[1]-de[3]/ge]}const k=i.left*b,D=i.right*b;let N,U,V,W;c==="width"||c==="both"?(W=g[0]+k-d[3],U=g[0]+D+d[1]):(W=g[0]+(k+D-w.displaySize[0])/2,U=W+w.displaySize[0]);const J=i.top*b,ae=i.bottom*b;return c==="height"||c==="both"?(N=g[1]+J-d[0],V=g[1]+ae+d[2]):(N=g[1]+(J+ae-w.displaySize[1])/2,V=N+w.displaySize[1]),{image:w,top:N,right:U,bottom:V,left:W,collisionPadding:I}}const _d=255,fl=128,du=_d*fl;function A1(s,i){const{expression:c}=i;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new An(s+1))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:d,interpolationType:g}=c;let b=0;for(;b<d.length&&d[b]<=s;)b++;b=Math.max(0,b-1);let w=b;for(;w<d.length&&d[w]<s+1;)w++;w=Math.min(d.length-1,w);const I=d[b],k=d[w];return c.kind==="composite"?{kind:"composite",minZoom:I,maxZoom:k,interpolationType:g}:{kind:"camera",minZoom:I,maxZoom:k,minSize:c.evaluate(new An(I)),maxSize:c.evaluate(new An(k)),interpolationType:g}}}function xy(s,i,c){let d="never";const g=s.get(i);return g?d=g:s.get(c)&&(d="always"),d}const UP=cu.VectorTileFeature.types,jP=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function sp(s,i,c,d,g,b,w,I,k,D,N,U,V){const W=I?Math.min(du,Math.round(I[0])):0,J=I?Math.min(du,Math.round(I[1])):0;s.emplaceBack(i,c,Math.round(32*d),Math.round(32*g),b,w,(W<<1)+(k?1:0),J,16*D,16*N,256*U,256*V)}function by(s,i,c){s.emplaceBack(i.x,i.y,c),s.emplaceBack(i.x,i.y,c),s.emplaceBack(i.x,i.y,c),s.emplaceBack(i.x,i.y,c)}function $P(s){for(const i of s.sections)if(Pl(i.text))return!0;return!1}class wy{constructor(i){this.layoutVertexArray=new Ae,this.indexArray=new Ke,this.programConfigurations=i,this.segments=new ct,this.dynamicLayoutVertexArray=new ze,this.opacityVertexArray=new Ge,this.hasVisibleVertices=!1,this.placedSymbolArray=new P}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(i,c,d,g){this.isEmpty()||(d&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,_P.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,xP.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,jP,!0),this.opacityVertexBuffer.itemSize=1),(d||g)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}yt("SymbolBuffers",wy);class Ey{constructor(i,c,d){this.layoutVertexArray=new i,this.layoutAttributes=c,this.indexArray=new d,this.segments=new ct,this.collisionVertexArray=new Je}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,bP.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}yt("CollisionBuffers",Ey);class th{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(w=>w.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ey([]),this.placementViewportMatrix=ey([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=A1(this.zoom,c["text-size"]),this.iconSizeData=A1(this.zoom,c["icon-size"]);const d=this.layers[0].layout,g=d.get("symbol-sort-key"),b=d.get("symbol-z-order");this.canOverlap=xy(d,"text-overlap","text-allow-overlap")!=="never"||xy(d,"icon-overlap","icon-allow-overlap")!=="never"||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,d.get("symbol-placement")==="point"&&(this.writingModes=d.get("text-writing-mode").map(w=>u.WritingMode[w])),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=i.sourceID}createArrays(){this.text=new wy(new Ga(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new wy(new Ga(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new O,this.lineVertexArray=new F,this.symbolInstances=new L}calculateGlyphDependencies(i,c,d,g,b){for(let w=0;w<i.length;w++)if(c[i.charCodeAt(w)]=!0,(d||g)&&b){const I=gd[i.charAt(w)];I&&(c[I.charCodeAt(0)]=!0)}}populate(i,c,d){const g=this.layers[0],b=g.layout,w=b.get("text-font"),I=b.get("text-field"),k=b.get("icon-image"),D=(I.value.kind!=="constant"||I.value.value instanceof Rr&&!I.value.value.isEmpty()||I.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),N=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,U=b.get("symbol-sort-key");if(this.features=[],!D&&!N)return;const V=c.iconDependencies,W=c.glyphDependencies,J=c.availableImages,ae=new An(this.zoom);for(const{feature:de,id:ge,index:Ie,sourceLayerIndex:_e}of i){const ke=g._featureFilter.needGeometry,Oe=hc(de,ke);if(!g._featureFilter.filter(ae,Oe,d))continue;let Xe,Et;if(ke||(Oe.geometry=qa(de)),D){const wt=g.getValueAndResolveTokens("text-field",Oe,d,J),vt=Rr.factory(wt);$P(vt)&&(this.hasRTLText=!0),(!this.hasRTLText||dl()==="unavailable"||this.hasRTLText&&_s.isParsed())&&(Xe=EP(vt,g,Oe))}if(N){const wt=g.getValueAndResolveTokens("icon-image",Oe,d,J);Et=wt instanceof Ci?wt:Ci.fromString(wt)}if(!Xe&&!Et)continue;const Ct=this.sortFeaturesByKey?U.evaluate(Oe,{},d):void 0;if(this.features.push({id:ge,text:Xe,icon:Et,index:Ie,sourceLayerIndex:_e,geometry:Oe.geometry,properties:de.properties,type:UP[de.type],sortKey:Ct}),Et&&(V[Et.name]=!0),Xe){const wt=w.evaluate(Oe,{},d).join(","),vt=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(u.WritingMode.vertical)>=0;for(const dt of Xe.sections)if(dt.image)V[dt.image.name]=!0;else{const St=Co(Xe.toString()),_t=dt.fontStack||wt,it=W[_t]=W[_t]||{};this.calculateGlyphDependencies(dt.text,it,vt,this.allowVerticalPlacement,St)}}}b.get("symbol-placement")==="line"&&(this.features=function(de){const ge={},Ie={},_e=[];let ke=0;function Oe(wt){_e.push(de[wt]),ke++}function Xe(wt,vt,dt){const St=Ie[wt];return delete Ie[wt],Ie[vt]=St,_e[St].geometry[0].pop(),_e[St].geometry[0]=_e[St].geometry[0].concat(dt[0]),St}function Et(wt,vt,dt){const St=ge[vt];return delete ge[vt],ge[wt]=St,_e[St].geometry[0].shift(),_e[St].geometry[0]=dt[0].concat(_e[St].geometry[0]),St}function Ct(wt,vt,dt){const St=dt?vt[0][vt[0].length-1]:vt[0][0];return`${wt}:${St.x}:${St.y}`}for(let wt=0;wt<de.length;wt++){const vt=de[wt],dt=vt.geometry,St=vt.text?vt.text.toString():null;if(!St){Oe(wt);continue}const _t=Ct(St,dt),it=Ct(St,dt,!0);if(_t in Ie&&it in ge&&Ie[_t]!==ge[it]){const qt=Et(_t,it,dt),Rt=Xe(_t,it,_e[qt].geometry);delete ge[_t],delete Ie[it],Ie[Ct(St,_e[Rt].geometry,!0)]=Rt,_e[qt].geometry=null}else _t in Ie?Xe(_t,it,dt):it in ge?Et(_t,it,dt):(Oe(wt),ge[_t]=ke-1,Ie[it]=ke-1)}return _e.filter(wt=>wt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((de,ge)=>de.sortKey-ge.sortKey)}update(i,c,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,c,this.layers,d),this.icon.programConfigurations.updatePaintArrays(i,c,this.layers,d))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,c){const d=this.lineVertexArray.length;if(i.segment!==void 0){let g=i.dist(c[i.segment+1]),b=i.dist(c[i.segment]);const w={};for(let I=i.segment+1;I<c.length;I++)w[I]={x:c[I].x,y:c[I].y,tileUnitDistanceFromAnchor:g},I<c.length-1&&(g+=c[I+1].dist(c[I]));for(let I=i.segment||0;I>=0;I--)w[I]={x:c[I].x,y:c[I].y,tileUnitDistanceFromAnchor:b},I>0&&(b+=c[I-1].dist(c[I]));for(let I=0;I<c.length;I++){const k=w[I];this.lineVertexArray.emplaceBack(k.x,k.y,k.tileUnitDistanceFromAnchor)}}return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(i,c,d,g,b,w,I,k,D,N,U,V){const W=i.indexArray,J=i.layoutVertexArray,ae=i.segments.prepareSegment(4*c.length,J,W,this.canOverlap?w.sortKey:void 0),de=this.glyphOffsetArray.length,ge=ae.vertexLength,Ie=this.allowVerticalPlacement&&I===u.WritingMode.vertical?Math.PI/2:0,_e=w.text&&w.text.sections;for(let ke=0;ke<c.length;ke++){const{tl:Oe,tr:Xe,bl:Et,br:Ct,tex:wt,pixelOffsetTL:vt,pixelOffsetBR:dt,minFontScaleX:St,minFontScaleY:_t,glyphOffset:it,isSDF:qt,sectionIndex:Rt}=c[ke],mr=ae.vertexLength,En=it[1];sp(J,k.x,k.y,Oe.x,En+Oe.y,wt.x,wt.y,d,qt,vt.x,vt.y,St,_t),sp(J,k.x,k.y,Xe.x,En+Xe.y,wt.x+wt.w,wt.y,d,qt,dt.x,vt.y,St,_t),sp(J,k.x,k.y,Et.x,En+Et.y,wt.x,wt.y+wt.h,d,qt,vt.x,dt.y,St,_t),sp(J,k.x,k.y,Ct.x,En+Ct.y,wt.x+wt.w,wt.y+wt.h,d,qt,dt.x,dt.y,St,_t),by(i.dynamicLayoutVertexArray,k,Ie),W.emplaceBack(mr,mr+1,mr+2),W.emplaceBack(mr+1,mr+2,mr+3),ae.vertexLength+=4,ae.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(it[0]),ke!==c.length-1&&Rt===c[ke+1].sectionIndex||i.programConfigurations.populatePaintArrays(J.length,w,w.index,{},V,_e&&_e[Rt])}i.placedSymbolArray.emplaceBack(k.x,k.y,de,this.glyphOffsetArray.length-de,ge,D,N,k.segment,d?d[0]:0,d?d[1]:0,g[0],g[1],I,0,!1,0,U)}_addCollisionDebugVertex(i,c,d,g,b,w){return c.emplaceBack(0,0),i.emplaceBack(d.x,d.y,g,b,Math.round(w.x),Math.round(w.y))}addCollisionDebugVertices(i,c,d,g,b,w,I){const k=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),D=k.vertexLength,N=b.layoutVertexArray,U=b.collisionVertexArray,V=I.anchorX,W=I.anchorY;this._addCollisionDebugVertex(N,U,w,V,W,new M(i,c)),this._addCollisionDebugVertex(N,U,w,V,W,new M(d,c)),this._addCollisionDebugVertex(N,U,w,V,W,new M(d,g)),this._addCollisionDebugVertex(N,U,w,V,W,new M(i,g)),k.vertexLength+=4;const J=b.indexArray;J.emplaceBack(D,D+1),J.emplaceBack(D+1,D+2),J.emplaceBack(D+2,D+3),J.emplaceBack(D+3,D),k.primitiveLength+=4}addDebugCollisionBoxes(i,c,d,g){for(let b=i;b<c;b++){const w=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,g?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,d)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ey(qe,f1.members,gt),this.iconCollisionBox=new Ey(qe,f1.members,gt);for(let i=0;i<this.symbolInstances.length;i++){const c=this.symbolInstances.get(i);this.addDebugCollisionBoxes(c.textBoxStartIndex,c.textBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.iconBoxStartIndex,c.iconBoxEndIndex,c,!1),this.addDebugCollisionBoxes(c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c,!1)}}_deserializeCollisionBoxesForSymbol(i,c,d,g,b,w,I,k,D){const N={};for(let U=c;U<d;U++){const V=i.get(U);N.textBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},N.textFeatureIndex=V.featureIndex;break}for(let U=g;U<b;U++){const V=i.get(U);N.verticalTextBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},N.verticalTextFeatureIndex=V.featureIndex;break}for(let U=w;U<I;U++){const V=i.get(U);N.iconBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},N.iconFeatureIndex=V.featureIndex;break}for(let U=k;U<D;U++){const V=i.get(U);N.verticalIconBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},N.verticalIconFeatureIndex=V.featureIndex;break}return N}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const d=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,c){const d=i.placedSymbolArray.get(c),g=d.vertexStartIndex+4*d.numGlyphs;for(let b=d.vertexStartIndex;b<g;b+=4)i.indexArray.emplaceBack(b,b+1,b+2),i.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(i),d=Math.cos(i),g=[],b=[],w=[];for(let I=0;I<this.symbolInstances.length;++I){w.push(I);const k=this.symbolInstances.get(I);g.push(0|Math.round(c*k.anchorX+d*k.anchorY)),b.push(k.featureIndex)}return w.sort((I,k)=>g[I]-g[k]||b[k]-b[I]),w}addToSortKeyRanges(i,c){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===c?d.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const d=this.symbolInstances.get(c);this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach((g,b,w)=>{g>=0&&w.indexOf(g)===b&&this.addIndicesForPlacedSymbol(this.text,g)}),d.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),d.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),d.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let M1,k1;yt("SymbolBucket",th,{omit:["layers","collisionBoxArray","features","compareText"]}),th.MAX_GLYPHS=65535,th.addDynamicAttributes=by;var Sy={get paint(){return k1=k1||new Io({"icon-opacity":new Wt(Ue.paint_symbol["icon-opacity"]),"icon-color":new Wt(Ue.paint_symbol["icon-color"]),"icon-halo-color":new Wt(Ue.paint_symbol["icon-halo-color"]),"icon-halo-width":new Wt(Ue.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Wt(Ue.paint_symbol["icon-halo-blur"]),"icon-translate":new Lt(Ue.paint_symbol["icon-translate"]),"icon-translate-anchor":new Lt(Ue.paint_symbol["icon-translate-anchor"]),"text-opacity":new Wt(Ue.paint_symbol["text-opacity"]),"text-color":new Wt(Ue.paint_symbol["text-color"],{runtimeType:Nr,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new Wt(Ue.paint_symbol["text-halo-color"]),"text-halo-width":new Wt(Ue.paint_symbol["text-halo-width"]),"text-halo-blur":new Wt(Ue.paint_symbol["text-halo-blur"]),"text-translate":new Lt(Ue.paint_symbol["text-translate"]),"text-translate-anchor":new Lt(Ue.paint_symbol["text-translate-anchor"])})},get layout(){return M1=M1||new Io({"symbol-placement":new Lt(Ue.layout_symbol["symbol-placement"]),"symbol-spacing":new Lt(Ue.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Lt(Ue.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Wt(Ue.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Lt(Ue.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Lt(Ue.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Lt(Ue.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Lt(Ue.layout_symbol["icon-ignore-placement"]),"icon-optional":new Lt(Ue.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Lt(Ue.layout_symbol["icon-rotation-alignment"]),"icon-size":new Wt(Ue.layout_symbol["icon-size"]),"icon-text-fit":new Lt(Ue.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Lt(Ue.layout_symbol["icon-text-fit-padding"]),"icon-image":new Wt(Ue.layout_symbol["icon-image"]),"icon-rotate":new Wt(Ue.layout_symbol["icon-rotate"]),"icon-padding":new Wt(Ue.layout_symbol["icon-padding"]),"icon-keep-upright":new Lt(Ue.layout_symbol["icon-keep-upright"]),"icon-offset":new Wt(Ue.layout_symbol["icon-offset"]),"icon-anchor":new Wt(Ue.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Lt(Ue.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Lt(Ue.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Lt(Ue.layout_symbol["text-rotation-alignment"]),"text-field":new Wt(Ue.layout_symbol["text-field"]),"text-font":new Wt(Ue.layout_symbol["text-font"]),"text-size":new Wt(Ue.layout_symbol["text-size"]),"text-max-width":new Wt(Ue.layout_symbol["text-max-width"]),"text-line-height":new Lt(Ue.layout_symbol["text-line-height"]),"text-letter-spacing":new Wt(Ue.layout_symbol["text-letter-spacing"]),"text-justify":new Wt(Ue.layout_symbol["text-justify"]),"text-radial-offset":new Wt(Ue.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Lt(Ue.layout_symbol["text-variable-anchor"]),"text-anchor":new Wt(Ue.layout_symbol["text-anchor"]),"text-max-angle":new Lt(Ue.layout_symbol["text-max-angle"]),"text-writing-mode":new Lt(Ue.layout_symbol["text-writing-mode"]),"text-rotate":new Wt(Ue.layout_symbol["text-rotate"]),"text-padding":new Lt(Ue.layout_symbol["text-padding"]),"text-keep-upright":new Lt(Ue.layout_symbol["text-keep-upright"]),"text-transform":new Wt(Ue.layout_symbol["text-transform"]),"text-offset":new Wt(Ue.layout_symbol["text-offset"]),"text-allow-overlap":new Lt(Ue.layout_symbol["text-allow-overlap"]),"text-overlap":new Lt(Ue.layout_symbol["text-overlap"]),"text-ignore-placement":new Lt(Ue.layout_symbol["text-ignore-placement"]),"text-optional":new Lt(Ue.layout_symbol["text-optional"])})}};class L1{constructor(i){if(i.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=i.property.overrides?i.property.overrides.runtimeType:$i,this.defaultValue=i}evaluate(i){if(i.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(i.formattedSection))return c.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}yt("FormatSectionOverride",L1,{omit:["defaultValue"]});class ap extends xa{constructor(i){super(i,Sy)}recalculate(i,c){if(super.recalculate(i,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const d=this.layout.get("text-writing-mode");if(d){const g=[];for(const b of d)g.indexOf(b)<0&&g.push(b);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(i,c,d,g){const b=this.layout.get(i).evaluate(c,{},d,g),w=this._unevaluatedLayout._values[i];return w.isDataDriven()||Ba(w.value)||!b?b:function(I,k){return k.replace(/{([^{}]+)}/g,(D,N)=>N in I?String(I[N]):"")}(c.properties,b)}createBucket(i){return new th(i)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const i of Sy.paint.overridableProperties){if(!ap.hasPaintOverride(this.layout,i))continue;const c=this.paint.get(i),d=new L1(c),g=new Us(d,c.property.specification);let b=null;b=c.value.kind==="constant"||c.value.kind==="source"?new mn("source",g):new Il("composite",g,c.value.zoomStops),this.paint._values[i]=new _a(c.property,b,c.parameters)}}_handleOverridablePaintPropertyUpdate(i,c,d){return!(!this.layout||c.isDataDriven()||d.isDataDriven())&&ap.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,c){const d=i.get("text-field"),g=Sy.paint.properties[c];let b=!1;const w=I=>{for(const k of I)if(g.overrides&&g.overrides.hasOverride(k))return void(b=!0)};if(d.value.kind==="constant"&&d.value.value instanceof Rr)w(d.value.value.sections);else if(d.value.kind==="source"){const I=D=>{b||(D instanceof zr&&xn(D.value)===ir?w(D.value.sections):D instanceof zs?w(D.sections):D.eachChild(I))},k=d.value;k._styleExpression&&I(k._styleExpression.expression)}return b}}let R1;var VP={get paint(){return R1=R1||new Io({"background-color":new Lt(Ue.paint_background["background-color"]),"background-pattern":new Qh(Ue.paint_background["background-pattern"]),"background-opacity":new Lt(Ue.paint_background["background-opacity"])})}};class GP extends xa{constructor(i){super(i,VP)}}let O1;var qP={get paint(){return O1=O1||new Io({"raster-opacity":new Lt(Ue.paint_raster["raster-opacity"]),"raster-hue-rotate":new Lt(Ue.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Lt(Ue.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Lt(Ue.paint_raster["raster-brightness-max"]),"raster-saturation":new Lt(Ue.paint_raster["raster-saturation"]),"raster-contrast":new Lt(Ue.paint_raster["raster-contrast"]),"raster-resampling":new Lt(Ue.paint_raster["raster-resampling"]),"raster-fade-duration":new Lt(Ue.paint_raster["raster-fade-duration"])})}};class HP extends xa{constructor(i){super(i,qP)}}class ZP extends xa{constructor(i){super(i,{}),this.onAdd=c=>{this.implementation.onAdd&&this.implementation.onAdd(c,c.painter.context.gl)},this.onRemove=c=>{this.implementation.onRemove&&this.implementation.onRemove(c,c.painter.context.gl)},this.implementation=i}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class WP{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const Ty=63710088e-1;class fu{constructor(i,c){if(isNaN(i)||isNaN(c))throw new Error(`Invalid LngLat object: (${i}, ${c})`);if(this.lng=+i,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new fu(te(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const c=Math.PI/180,d=this.lat*c,g=i.lat*c,b=Math.sin(d)*Math.sin(g)+Math.cos(d)*Math.cos(g)*Math.cos((i.lng-this.lng)*c);return Ty*Math.acos(Math.min(b,1))}static convert(i){if(i instanceof fu)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new fu(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new fu(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const D1=2*Math.PI*Ty;function z1(s){return D1*Math.cos(s*Math.PI/180)}function F1(s){return(180+s)/360}function N1(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function B1(s,i){return s/z1(i)}function Cy(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}class lp{constructor(i,c,d=0){this.x=+i,this.y=+c,this.z=+d}static fromLngLat(i,c=0){const d=fu.convert(i);return new lp(F1(d.lng),N1(d.lat),B1(c,d.lat))}toLngLat(){return new fu(360*this.x-180,Cy(this.y))}toAltitude(){return this.z*z1(Cy(this.y))}meterInMercatorCoordinateUnits(){return 1/D1*(i=Cy(this.y),1/Math.cos(i*Math.PI/180));var i}}function U1(s,i,c){var d=2*Math.PI*6378137/256/Math.pow(2,c);return[s*d-2*Math.PI*6378137/2,i*d-2*Math.PI*6378137/2]}class Iy{constructor(i,c,d){if(i<0||i>25||d<0||d>=Math.pow(2,i)||c<0||c>=Math.pow(2,i))throw new Error(`x=${c}, y=${d}, z=${i} outside of bounds. 0<=x<${Math.pow(2,i)}, 0<=y<${Math.pow(2,i)} 0<=z<=25 `);this.z=i,this.x=c,this.y=d,this.key=xd(0,i,i,c,d)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,c,d){const g=(w=this.y,I=this.z,k=U1(256*(b=this.x),256*(w=Math.pow(2,I)-w-1),I),D=U1(256*(b+1),256*(w+1),I),k[0]+","+k[1]+","+D[0]+","+D[1]);var b,w,I,k,D;const N=function(U,V,W){let J,ae="";for(let de=U;de>0;de--)J=1<<de-1,ae+=(V&J?1:0)+(W&J?2:0);return ae}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,c>1?"@2x":"").replace(/{quadkey}/g,N).replace(/{bbox-epsg-3857}/g,g)}isChildOf(i){const c=this.z-i.z;return c>0&&i.x===this.x>>c&&i.y===this.y>>c}getTilePoint(i){const c=Math.pow(2,this.z);return new M((i.x*c-this.x)*wn,(i.y*c-this.y)*wn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class j1{constructor(i,c){this.wrap=i,this.canonical=c,this.key=xd(i,c.z,c.z,c.x,c.y)}}class Ws{constructor(i,c,d,g,b){if(i<d)throw new Error(`overscaledZ should be >= z; overscaledZ = ${i}; z = ${d}`);this.overscaledZ=i,this.wrap=c,this.canonical=new Iy(d,+g,+b),this.key=xd(c,i,d,g,b)}clone(){return new Ws(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-i;return i>this.canonical.z?new Ws(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ws(i,this.wrap,i,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(i,c){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const d=this.canonical.z-i;return i>this.canonical.z?xd(this.wrap*+c,i,this.canonical.z,this.canonical.x,this.canonical.y):xd(this.wrap*+c,i,i,this.canonical.x>>d,this.canonical.y>>d)}isChildOf(i){if(i.wrap!==this.wrap)return!1;const c=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>c&&i.canonical.y===this.canonical.y>>c}children(i){if(this.overscaledZ>=i)return[new Ws(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,d=2*this.canonical.x,g=2*this.canonical.y;return[new Ws(c,this.wrap,c,d,g),new Ws(c,this.wrap,c,d+1,g),new Ws(c,this.wrap,c,d,g+1),new Ws(c,this.wrap,c,d+1,g+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new Ws(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new Ws(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new j1(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(i){return this.canonical.getTilePoint(new lp(i.x-this.wrap,i.y))}}function xd(s,i,c,d,g){(s*=2)<0&&(s=-1*s-1);const b=1<<c;return(b*b*s+b*g+d).toString(36)+c.toString(36)+i.toString(36)}yt("CanonicalTileID",Iy),yt("OverscaledTileID",Ws,{omit:["posMatrix"]});class $1{constructor(i,c,d){if(this.uid=i,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(d&&d!=="mapbox"&&d!=="terrarium")return void Ut(`"${d}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const g=this.dim=c.height-2;this.data=new Uint32Array(c.data.buffer),this.encoding=d||"mapbox";for(let b=0;b<g;b++)this.data[this._idx(-1,b)]=this.data[this._idx(0,b)],this.data[this._idx(g,b)]=this.data[this._idx(g-1,b)],this.data[this._idx(b,-1)]=this.data[this._idx(b,0)],this.data[this._idx(b,g)]=this.data[this._idx(b,g-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(g,-1)]=this.data[this._idx(g-1,0)],this.data[this._idx(-1,g)]=this.data[this._idx(0,g-1)],this.data[this._idx(g,g)]=this.data[this._idx(g-1,g-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let b=0;b<g;b++)for(let w=0;w<g;w++){const I=this.get(b,w);I>this.max&&(this.max=I),I<this.min&&(this.min=I)}}get(i,c){const d=new Uint8Array(this.data.buffer),g=4*this._idx(i,c);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(d[g],d[g+1],d[g+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(i,c){if(i<-1||i>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(i+1)}_unpackMapbox(i,c,d){return(256*i*256+256*c+d)/10-1e4}_unpackTerrarium(i,c,d){return 256*i+c+d/256-32768}getPixels(){return new Zs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(i,c,d){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let g=c*this.dim,b=c*this.dim+this.dim,w=d*this.dim,I=d*this.dim+this.dim;switch(c){case-1:g=b-1;break;case 1:b=g+1}switch(d){case-1:w=I-1;break;case 1:I=w+1}const k=-c*this.dim,D=-d*this.dim;for(let N=w;N<I;N++)for(let U=g;U<b;U++)this.data[this._idx(U,N)]=i.data[this._idx(U+k,N+D)]}}yt("DEMData",$1);class V1{constructor(i){this._stringToNumber={},this._numberToString=[];for(let c=0;c<i.length;c++){const d=i[c];this._stringToNumber[d]=c,this._numberToString[c]=d}}encode(i){return this._stringToNumber[i]}decode(i){if(i>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${i} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[i]}}class G1{constructor(i,c,d,g,b){this.type="Feature",this._vectorTileFeature=i,i._z=c,i._x=d,i._y=g,this.properties=i.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={geometry:this.geometry};for(const c in this)c!=="_geometry"&&c!=="_vectorTileFeature"&&(i[c]=this[c]);return i}}class q1{constructor(i,c){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Wi(wn,16,0),this.grid3D=new Wi(wn,16,0),this.featureIndexArray=new Z,this.promoteId=c}insert(i,c,d,g,b,w){const I=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,g,b);const k=w?this.grid3D:this.grid;for(let D=0;D<c.length;D++){const N=c[D],U=[1/0,1/0,-1/0,-1/0];for(let V=0;V<N.length;V++){const W=N[V];U[0]=Math.min(U[0],W.x),U[1]=Math.min(U[1],W.y),U[2]=Math.max(U[2],W.x),U[3]=Math.max(U[3],W.y)}U[0]<wn&&U[1]<wn&&U[2]>=0&&U[3]>=0&&k.insert(I,U[0],U[1],U[2],U[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new cu.VectorTile(new my(this.rawTileData)).layers,this.sourceLayerCoder=new V1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(i,c,d,g){this.loadVTLayers();const b=i.params||{},w=wn/i.tileSize/i.scale,I=Ii(b.filter),k=i.queryGeometry,D=i.queryPadding*w,N=Z1(k),U=this.grid.query(N.minX-D,N.minY-D,N.maxX+D,N.maxY+D),V=Z1(i.cameraQueryGeometry),W=this.grid3D.query(V.minX-D,V.minY-D,V.maxX+D,V.maxY+D,(de,ge,Ie,_e)=>function(ke,Oe,Xe,Et,Ct){for(const vt of ke)if(Oe<=vt.x&&Xe<=vt.y&&Et>=vt.x&&Ct>=vt.y)return!0;const wt=[new M(Oe,Xe),new M(Oe,Ct),new M(Et,Ct),new M(Et,Xe)];if(ke.length>2){for(const vt of wt)if(Wc(ke,vt))return!0}for(let vt=0;vt<ke.length-1;vt++)if(CI(ke[vt],ke[vt+1],wt))return!0;return!1}(i.cameraQueryGeometry,de-D,ge-D,Ie+D,_e+D));for(const de of W)U.push(de);U.sort(KP);const J={};let ae;for(let de=0;de<U.length;de++){const ge=U[de];if(ge===ae)continue;ae=ge;const Ie=this.featureIndexArray.get(ge);let _e=null;this.loadMatchingFeature(J,Ie.bucketIndex,Ie.sourceLayerIndex,Ie.featureIndex,I,b.layers,b.availableImages,c,d,g,(ke,Oe,Xe)=>(_e||(_e=qa(ke)),Oe.queryIntersectsFeature(k,ke,Xe,_e,this.z,i.transform,w,i.pixelPosMatrix)))}return J}loadMatchingFeature(i,c,d,g,b,w,I,k,D,N,U){const V=this.bucketLayerIDs[c];if(w&&!function(de,ge){for(let Ie=0;Ie<de.length;Ie++)if(ge.indexOf(de[Ie])>=0)return!0;return!1}(w,V))return;const W=this.sourceLayerCoder.decode(d),J=this.vtLayers[W].feature(g);if(b.needGeometry){const de=hc(J,!0);if(!b.filter(new An(this.tileID.overscaledZ),de,this.tileID.canonical))return}else if(!b.filter(new An(this.tileID.overscaledZ),J))return;const ae=this.getId(J,W);for(let de=0;de<V.length;de++){const ge=V[de];if(w&&w.indexOf(ge)<0)continue;const Ie=k[ge];if(!Ie)continue;let _e={};ae&&N&&(_e=N.getState(Ie.sourceLayer||"_geojsonTileLayer",ae));const ke=ne({},D[ge]);ke.paint=H1(ke.paint,Ie.paint,J,_e,I),ke.layout=H1(ke.layout,Ie.layout,J,_e,I);const Oe=!U||U(J,Ie,_e);if(!Oe)continue;const Xe=new G1(J,this.z,this.x,this.y,ae);Xe.layer=ke;let Et=i[ge];Et===void 0&&(Et=i[ge]=[]),Et.push({featureIndex:g,feature:Xe,intersectionZ:Oe})}}lookupSymbolFeatures(i,c,d,g,b,w,I,k){const D={};this.loadVTLayers();const N=Ii(b);for(const U of i)this.loadMatchingFeature(D,d,g,U,N,w,I,k,c);return D}hasLayer(i){for(const c of this.bucketLayerIDs)for(const d of c)if(i===d)return!0;return!1}getId(i,c){let d=i.id;return this.promoteId&&(d=i.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[c]],typeof d=="boolean"&&(d=Number(d))),d}}function H1(s,i,c,d,g){return Ve(s,(b,w)=>{const I=i instanceof Nc?i.get(w):null;return I&&I.evaluate?I.evaluate(c,d,g):I})}function Z1(s){let i=1/0,c=1/0,d=-1/0,g=-1/0;for(const b of s)i=Math.min(i,b.x),c=Math.min(c,b.y),d=Math.max(d,b.x),g=Math.max(g,b.y);return{minX:i,minY:c,maxX:d,maxY:g}}function KP(s,i){return i-s}function W1(s,i,c,d,g){const b=[];for(let w=0;w<s.length;w++){const I=s[w];let k;for(let D=0;D<I.length-1;D++){let N=I[D],U=I[D+1];N.x<i&&U.x<i||(N.x<i?N=new M(i,N.y+(i-N.x)/(U.x-N.x)*(U.y-N.y))._round():U.x<i&&(U=new M(i,N.y+(i-N.x)/(U.x-N.x)*(U.y-N.y))._round()),N.y<c&&U.y<c||(N.y<c?N=new M(N.x+(c-N.y)/(U.y-N.y)*(U.x-N.x),c)._round():U.y<c&&(U=new M(N.x+(c-N.y)/(U.y-N.y)*(U.x-N.x),c)._round()),N.x>=d&&U.x>=d||(N.x>=d?N=new M(d,N.y+(d-N.x)/(U.x-N.x)*(U.y-N.y))._round():U.x>=d&&(U=new M(d,N.y+(d-N.x)/(U.x-N.x)*(U.y-N.y))._round()),N.y>=g&&U.y>=g||(N.y>=g?N=new M(N.x+(g-N.y)/(U.y-N.y)*(U.x-N.x),g)._round():U.y>=g&&(U=new M(N.x+(g-N.y)/(U.y-N.y)*(U.x-N.x),g)._round()),k&&N.equals(k[k.length-1])||(k=[N],b.push(k)),k.push(U)))))}}return b}yt("FeatureIndex",q1,{omit:["rawTileData","sourceLayerCoder"]});class pu extends M{constructor(i,c,d,g){super(i,c),this.angle=d,g!==void 0&&(this.segment=g)}clone(){return new pu(this.x,this.y,this.angle,this.segment)}}function K1(s,i,c,d,g){if(i.segment===void 0||c===0)return!0;let b=i,w=i.segment+1,I=0;for(;I>-c/2;){if(w--,w<0)return!1;I-=s[w].dist(b),b=s[w]}I+=s[w].dist(s[w+1]),w++;const k=[];let D=0;for(;I<c/2;){const N=s[w],U=s[w+1];if(!U)return!1;let V=s[w-1].angleTo(N)-N.angleTo(U);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:I,angleDelta:V}),D+=V;I-k[0].distance>d;)D-=k.shift().angleDelta;if(D>g)return!1;w++,I+=N.dist(U)}return!0}function X1(s){let i=0;for(let c=0;c<s.length-1;c++)i+=s[c].dist(s[c+1]);return i}function J1(s,i,c){return s?.6*i*c:0}function Y1(s,i){return Math.max(s?s.right-s.left:0,i?i.right-i.left:0)}function XP(s,i,c,d,g,b){const w=J1(c,g,b),I=Y1(c,d)*b;let k=0;const D=X1(s)/2;for(let N=0;N<s.length-1;N++){const U=s[N],V=s[N+1],W=U.dist(V);if(k+W>D){const J=(D-k)/W,ae=Ot.number(U.x,V.x,J),de=Ot.number(U.y,V.y,J),ge=new pu(ae,de,V.angleTo(U),N);return ge._round(),!w||K1(s,ge,I,w,i)?ge:void 0}k+=W}}function JP(s,i,c,d,g,b,w,I,k){const D=J1(d,b,w),N=Y1(d,g),U=N*w,V=s[0].x===0||s[0].x===k||s[0].y===0||s[0].y===k;return i-U<i/4&&(i=U+i/4),Q1(s,V?i/2*I%i:(N/2+2*b)*w*I%i,i,D,c,U,V,!1,k)}function Q1(s,i,c,d,g,b,w,I,k){const D=b/2,N=X1(s);let U=0,V=i-c,W=[];for(let J=0;J<s.length-1;J++){const ae=s[J],de=s[J+1],ge=ae.dist(de),Ie=de.angleTo(ae);for(;V+c<U+ge;){V+=c;const _e=(V-U)/ge,ke=Ot.number(ae.x,de.x,_e),Oe=Ot.number(ae.y,de.y,_e);if(ke>=0&&ke<k&&Oe>=0&&Oe<k&&V-D>=0&&V+D<=N){const Xe=new pu(ke,Oe,Ie,J);Xe._round(),d&&!K1(s,Xe,b,d,g)||W.push(Xe)}}U+=ge}return I||W.length||w||(W=Q1(s,U/2,c,d,g,b,w,!0,k)),W}yt("Anchor",pu);const rh=Jo;function eb(s,i,c,d){const g=[],b=s.image,w=b.pixelRatio,I=b.paddedRect.w-2*rh,k=b.paddedRect.h-2*rh,D=s.right-s.left,N=s.bottom-s.top,U=b.stretchX||[[0,I]],V=b.stretchY||[[0,k]],W=(dt,St)=>dt+St[1]-St[0],J=U.reduce(W,0),ae=V.reduce(W,0),de=I-J,ge=k-ae;let Ie=0,_e=J,ke=0,Oe=ae,Xe=0,Et=de,Ct=0,wt=ge;if(b.content&&d){const dt=b.content;Ie=up(U,0,dt[0]),ke=up(V,0,dt[1]),_e=up(U,dt[0],dt[2]),Oe=up(V,dt[1],dt[3]),Xe=dt[0]-Ie,Ct=dt[1]-ke,Et=dt[2]-dt[0]-_e,wt=dt[3]-dt[1]-Oe}const vt=(dt,St,_t,it)=>{const qt=cp(dt.stretch-Ie,_e,D,s.left),Rt=hp(dt.fixed-Xe,Et,dt.stretch,J),mr=cp(St.stretch-ke,Oe,N,s.top),En=hp(St.fixed-Ct,wt,St.stretch,ae),Mn=cp(_t.stretch-Ie,_e,D,s.left),vi=hp(_t.fixed-Xe,Et,_t.stretch,J),xs=cp(it.stretch-ke,Oe,N,s.top),Ao=hp(it.fixed-Ct,wt,it.stretch,ae),Zn=new M(qt,mr),Ri=new M(Mn,mr),Yi=new M(Mn,xs),Yo=new M(qt,xs),Mo=new M(Rt/w,En/w),li=new M(vi/w,Ao/w),_i=i*Math.PI/180;if(_i){const Qo=Math.sin(_i),es=Math.cos(_i),Wn=[es,-Qo,Qo,es];Zn._matMult(Wn),Ri._matMult(Wn),Yo._matMult(Wn),Yi._matMult(Wn)}const po=dt.stretch+dt.fixed,ko=St.stretch+St.fixed;return{tl:Zn,tr:Ri,bl:Yo,br:Yi,tex:{x:b.paddedRect.x+rh+po,y:b.paddedRect.y+rh+ko,w:_t.stretch+_t.fixed-po,h:it.stretch+it.fixed-ko},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Mo,pixelOffsetBR:li,minFontScaleX:Et/w/D,minFontScaleY:wt/w/N,isSDF:c}};if(d&&(b.stretchX||b.stretchY)){const dt=tb(U,de,J),St=tb(V,ge,ae);for(let _t=0;_t<dt.length-1;_t++){const it=dt[_t],qt=dt[_t+1];for(let Rt=0;Rt<St.length-1;Rt++)g.push(vt(it,St[Rt],qt,St[Rt+1]))}}else g.push(vt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:I+1},{fixed:0,stretch:k+1}));return g}function up(s,i,c){let d=0;for(const g of s)d+=Math.max(i,Math.min(c,g[1]))-Math.max(i,Math.min(c,g[0]));return d}function tb(s,i,c){const d=[{fixed:-rh,stretch:0}];for(const[g,b]of s){const w=d[d.length-1];d.push({fixed:g-w.stretch,stretch:w.stretch}),d.push({fixed:g-w.stretch,stretch:w.stretch+(b-g)})}return d.push({fixed:i+rh,stretch:c}),d}function cp(s,i,c,d){return s/i*c+d}function hp(s,i,c,d){return s-i*c/d}class dp{constructor(i,c,d,g,b,w,I,k,D,N){if(this.boxStartIndex=i.length,D){let U=w.top,V=w.bottom;const W=w.collisionPadding;W&&(U-=W[1],V+=W[3]);let J=V-U;J>0&&(J=Math.max(10,J),this.circleDiameter=J)}else{let U=w.top*I-k[0],V=w.bottom*I+k[2],W=w.left*I-k[3],J=w.right*I+k[1];const ae=w.collisionPadding;if(ae&&(W-=ae[0]*I,U-=ae[1]*I,J+=ae[2]*I,V+=ae[3]*I),N){const de=new M(W,U),ge=new M(J,U),Ie=new M(W,V),_e=new M(J,V),ke=N*Math.PI/180;de._rotate(ke),ge._rotate(ke),Ie._rotate(ke),_e._rotate(ke),W=Math.min(de.x,ge.x,Ie.x,_e.x),J=Math.max(de.x,ge.x,Ie.x,_e.x),U=Math.min(de.y,ge.y,Ie.y,_e.y),V=Math.max(de.y,ge.y,Ie.y,_e.y)}i.emplaceBack(c.x,c.y,W,U,J,V,d,g,b)}this.boxEndIndex=i.length}}class YP{constructor(i=[],c=QP){if(this.data=i,this.length=this.data.length,this.compare=c,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const i=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:c,compare:d}=this,g=c[i];for(;i>0;){const b=i-1>>1,w=c[b];if(d(g,w)>=0)break;c[i]=w,i=b}c[i]=g}_down(i){const{data:c,compare:d}=this,g=this.length>>1,b=c[i];for(;i<g;){let w=1+(i<<1),I=c[w];const k=w+1;if(k<this.length&&d(c[k],I)<0&&(w=k,I=c[k]),d(I,b)>=0)break;c[i]=I,i=w}c[i]=b}}function QP(s,i){return s<i?-1:s>i?1:0}function eA(s,i=1,c=!1){let d=1/0,g=1/0,b=-1/0,w=-1/0;const I=s[0];for(let W=0;W<I.length;W++){const J=I[W];(!W||J.x<d)&&(d=J.x),(!W||J.y<g)&&(g=J.y),(!W||J.x>b)&&(b=J.x),(!W||J.y>w)&&(w=J.y)}const k=Math.min(b-d,w-g);let D=k/2;const N=new YP([],tA);if(k===0)return new M(d,g);for(let W=d;W<b;W+=k)for(let J=g;J<w;J+=k)N.push(new nh(W+D,J+D,D,s));let U=function(W){let J=0,ae=0,de=0;const ge=W[0];for(let Ie=0,_e=ge.length,ke=_e-1;Ie<_e;ke=Ie++){const Oe=ge[Ie],Xe=ge[ke],Et=Oe.x*Xe.y-Xe.x*Oe.y;ae+=(Oe.x+Xe.x)*Et,de+=(Oe.y+Xe.y)*Et,J+=3*Et}return new nh(ae/J,de/J,0,W)}(s),V=N.length;for(;N.length;){const W=N.pop();(W.d>U.d||!U.d)&&(U=W,c&&console.log("found best %d after %d probes",Math.round(1e4*W.d)/1e4,V)),W.max-U.d<=i||(D=W.h/2,N.push(new nh(W.p.x-D,W.p.y-D,D,s)),N.push(new nh(W.p.x+D,W.p.y-D,D,s)),N.push(new nh(W.p.x-D,W.p.y+D,D,s)),N.push(new nh(W.p.x+D,W.p.y+D,D,s)),V+=4)}return c&&(console.log(`num probes: ${V}`),console.log(`best distance: ${U.d}`)),U.p}function tA(s,i){return i.max-s.max}function nh(s,i,c,d){this.p=new M(s,i),this.h=c,this.d=function(g,b){let w=!1,I=1/0;for(let k=0;k<b.length;k++){const D=b[k];for(let N=0,U=D.length,V=U-1;N<U;V=N++){const W=D[N],J=D[V];W.y>g.y!=J.y>g.y&&g.x<(J.x-W.x)*(g.y-W.y)/(J.y-W.y)+W.x&&(w=!w),I=Math.min(I,Nx(g,W,J))}}return(w?1:-1)*Math.sqrt(I)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}const Py=Number.POSITIVE_INFINITY;function rb(s,i){return i[1]!==Py?function(c,d,g){let b=0,w=0;switch(d=Math.abs(d),g=Math.abs(g),c){case"top-right":case"top-left":case"top":w=g-7;break;case"bottom-right":case"bottom-left":case"bottom":w=7-g}switch(c){case"top-right":case"bottom-right":case"right":b=-d;break;case"top-left":case"bottom-left":case"left":b=d}return[b,w]}(s,i[0],i[1]):function(c,d){let g=0,b=0;d<0&&(d=0);const w=d/Math.sqrt(2);switch(c){case"top-right":case"top-left":b=w-7;break;case"bottom-right":case"bottom-left":b=7-w;break;case"bottom":b=7-d;break;case"top":b=d-7}switch(c){case"top-right":case"bottom-right":g=-w;break;case"top-left":case"bottom-left":g=w;break;case"left":g=d;break;case"right":g=-d}return[g,b]}(s,i[0])}function Ay(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function rA(s,i,c,d,g,b,w,I,k,D,N){let U=b.textMaxSize.evaluate(i,{});U===void 0&&(U=w);const V=s.layers[0].layout,W=V.get("icon-offset").evaluate(i,{},N),J=ib(c.horizontal),ae=w/24,de=s.tilePixelRatio*ae,ge=s.tilePixelRatio*U/24,Ie=s.tilePixelRatio*I,_e=s.tilePixelRatio*V.get("symbol-spacing"),ke=V.get("text-padding")*s.tilePixelRatio,Oe=function(it,qt,Rt,mr=1){const En=it.get("icon-padding").evaluate(qt,{},Rt),Mn=En&&En.values;return[Mn[0]*mr,Mn[1]*mr,Mn[2]*mr,Mn[3]*mr]}(V,i,N,s.tilePixelRatio),Xe=V.get("text-max-angle")/180*Math.PI,Et=V.get("text-rotation-alignment")!=="viewport"&&V.get("symbol-placement")!=="point",Ct=V.get("icon-rotation-alignment")==="map"&&V.get("symbol-placement")!=="point",wt=V.get("symbol-placement"),vt=_e/2,dt=V.get("icon-text-fit");let St;d&&dt!=="none"&&(s.allowVerticalPlacement&&c.vertical&&(St=P1(d,c.vertical,dt,V.get("icon-text-fit-padding"),W,ae)),J&&(d=P1(d,J,dt,V.get("icon-text-fit-padding"),W,ae)));const _t=(it,qt)=>{qt.x<0||qt.x>=wn||qt.y<0||qt.y>=wn||function(Rt,mr,En,Mn,vi,xs,Ao,Zn,Ri,Yi,Yo,Mo,li,_i,po,ko,Qo,es,Wn,Qi,Sr,bs,eo,mo,Ea){const Ha=Rt.addToLineVertexArray(mr,En);let Za,Rl,Sa,Ks,ts=0,Ol=0,Ed=0,lb=0,Fy=-1,Ny=-1;const Dl={};let ub=ri(""),By=0,Uy=0;if(Zn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[By,Uy]=Zn.layout.get("text-offset").evaluate(Sr,{},mo).map(rs=>rs*Li):(By=Zn.layout.get("text-radial-offset").evaluate(Sr,{},mo)*Li,Uy=Py),Rt.allowVerticalPlacement&&Mn.vertical){const rs=Zn.layout.get("text-rotate").evaluate(Sr,{},mo)+90;Sa=new dp(Ri,mr,Yi,Yo,Mo,Mn.vertical,li,_i,po,rs),Ao&&(Ks=new dp(Ri,mr,Yi,Yo,Mo,Ao,Qo,es,po,rs))}if(vi){const rs=Zn.layout.get("icon-rotate").evaluate(Sr,{}),pl=Zn.layout.get("icon-text-fit")!=="none",Sd=eb(vi,rs,eo,pl),Td=Ao?eb(Ao,rs,eo,pl):void 0;Rl=new dp(Ri,mr,Yi,Yo,Mo,vi,Qo,es,!1,rs),ts=4*Sd.length;const db=Rt.iconSizeData;let fc=null;db.kind==="source"?(fc=[fl*Zn.layout.get("icon-size").evaluate(Sr,{})],fc[0]>du&&Ut(`${Rt.layerIds[0]}: Value for "icon-size" is >= ${_d}. Reduce your "icon-size".`)):db.kind==="composite"&&(fc=[fl*bs.compositeIconSizes[0].evaluate(Sr,{},mo),fl*bs.compositeIconSizes[1].evaluate(Sr,{},mo)],(fc[0]>du||fc[1]>du)&&Ut(`${Rt.layerIds[0]}: Value for "icon-size" is >= ${_d}. Reduce your "icon-size".`)),Rt.addSymbols(Rt.icon,Sd,fc,Qi,Wn,Sr,u.WritingMode.none,mr,Ha.lineStartIndex,Ha.lineLength,-1,mo),Fy=Rt.icon.placedSymbolArray.length-1,Td&&(Ol=4*Td.length,Rt.addSymbols(Rt.icon,Td,fc,Qi,Wn,Sr,u.WritingMode.vertical,mr,Ha.lineStartIndex,Ha.lineLength,-1,mo),Ny=Rt.icon.placedSymbolArray.length-1)}const cb=Object.keys(Mn.horizontal);for(const rs of cb){const pl=Mn.horizontal[rs];if(!Za){ub=ri(pl.text);const Td=Zn.layout.get("text-rotate").evaluate(Sr,{},mo);Za=new dp(Ri,mr,Yi,Yo,Mo,pl,li,_i,po,Td)}const Sd=pl.positionedLines.length===1;if(Ed+=nb(Rt,mr,pl,xs,Zn,po,Sr,ko,Ha,Mn.vertical?u.WritingMode.horizontal:u.WritingMode.horizontalOnly,Sd?cb:[rs],Dl,Fy,bs,mo),Sd)break}Mn.vertical&&(lb+=nb(Rt,mr,Mn.vertical,xs,Zn,po,Sr,ko,Ha,u.WritingMode.vertical,["vertical"],Dl,Ny,bs,mo));const oA=Za?Za.boxStartIndex:Rt.collisionBoxArray.length,sA=Za?Za.boxEndIndex:Rt.collisionBoxArray.length,aA=Sa?Sa.boxStartIndex:Rt.collisionBoxArray.length,lA=Sa?Sa.boxEndIndex:Rt.collisionBoxArray.length,uA=Rl?Rl.boxStartIndex:Rt.collisionBoxArray.length,cA=Rl?Rl.boxEndIndex:Rt.collisionBoxArray.length,hA=Ks?Ks.boxStartIndex:Rt.collisionBoxArray.length,dA=Ks?Ks.boxEndIndex:Rt.collisionBoxArray.length;let Wa=-1;const pp=(rs,pl)=>rs&&rs.circleDiameter?Math.max(rs.circleDiameter,pl):pl;Wa=pp(Za,Wa),Wa=pp(Sa,Wa),Wa=pp(Rl,Wa),Wa=pp(Ks,Wa);const hb=Wa>-1?1:0;hb&&(Wa*=Ea/Li),Rt.glyphOffsetArray.length>=th.MAX_GLYPHS&&Ut("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Sr.sortKey!==void 0&&Rt.addToSortKeyRanges(Rt.symbolInstances.length,Sr.sortKey),Rt.symbolInstances.emplaceBack(mr.x,mr.y,Dl.right>=0?Dl.right:-1,Dl.center>=0?Dl.center:-1,Dl.left>=0?Dl.left:-1,Dl.vertical||-1,Fy,Ny,ub,oA,sA,aA,lA,uA,cA,hA,dA,Yi,Ed,lb,ts,Ol,hb,0,li,By,Uy,Wa)}(s,qt,it,c,d,g,St,s.layers[0],s.collisionBoxArray,i.index,i.sourceLayerIndex,s.index,de,[ke,ke,ke,ke],Et,k,Ie,Oe,Ct,W,i,b,D,N,w)};if(wt==="line")for(const it of W1(i.geometry,0,0,wn,wn)){const qt=JP(it,_e,Xe,c.vertical||J,d,24,ge,s.overscaling,wn);for(const Rt of qt)J&&nA(s,J.text,vt,Rt)||_t(it,Rt)}else if(wt==="line-center"){for(const it of i.geometry)if(it.length>1){const qt=XP(it,Xe,c.vertical||J,d,24,ge);qt&&_t(it,qt)}}else if(i.type==="Polygon")for(const it of ay(i.geometry,0)){const qt=eA(it,16);_t(it[0],new pu(qt.x,qt.y,0))}else if(i.type==="LineString")for(const it of i.geometry)_t(it,new pu(it[0].x,it[0].y,0));else if(i.type==="Point")for(const it of i.geometry)for(const qt of it)_t([qt],new pu(qt.x,qt.y,0))}function nb(s,i,c,d,g,b,w,I,k,D,N,U,V,W,J){const ae=function(Ie,_e,ke,Oe,Xe,Et,Ct,wt){const vt=Oe.layout.get("text-rotate").evaluate(Et,{})*Math.PI/180,dt=[];for(const St of _e.positionedLines)for(const _t of St.positionedGlyphs){if(!_t.rect)continue;const it=_t.rect||{};let qt=b1+1,Rt=!0,mr=1,En=0;const Mn=(Xe||wt)&&_t.vertical,vi=_t.metrics.advance*_t.scale/2;if(wt&&_e.verticalizable&&(En=St.lineOffset/2-(_t.imageName?-(Li-_t.metrics.width*_t.scale)/2:(_t.scale-1)*Li)),_t.imageName){const Wn=Ct[_t.imageName];Rt=Wn.sdf,mr=Wn.pixelRatio,qt=Jo/mr}const xs=Xe?[_t.x+vi,_t.y]:[0,0];let Ao=Xe?[0,0]:[_t.x+vi+ke[0],_t.y+ke[1]-En],Zn=[0,0];Mn&&(Zn=Ao,Ao=[0,0]);const Ri=(_t.metrics.left-qt)*_t.scale-vi+Ao[0],Yi=(-_t.metrics.top-qt)*_t.scale+Ao[1],Yo=Ri+it.w*_t.scale/mr,Mo=Yi+it.h*_t.scale/mr,li=new M(Ri,Yi),_i=new M(Yo,Yi),po=new M(Ri,Mo),ko=new M(Yo,Mo);if(Mn){const Wn=new M(-vi,vi-yd),Qi=-Math.PI/2,Sr=Li/2-vi,bs=new M(5-yd-Sr,-(_t.imageName?Sr:0)),eo=new M(...Zn);li._rotateAround(Qi,Wn)._add(bs)._add(eo),_i._rotateAround(Qi,Wn)._add(bs)._add(eo),po._rotateAround(Qi,Wn)._add(bs)._add(eo),ko._rotateAround(Qi,Wn)._add(bs)._add(eo)}if(vt){const Wn=Math.sin(vt),Qi=Math.cos(vt),Sr=[Qi,-Wn,Wn,Qi];li._matMult(Sr),_i._matMult(Sr),po._matMult(Sr),ko._matMult(Sr)}const Qo=new M(0,0),es=new M(0,0);dt.push({tl:li,tr:_i,bl:po,br:ko,tex:it,writingMode:_e.writingMode,glyphOffset:xs,sectionIndex:_t.sectionIndex,isSDF:Rt,pixelOffsetTL:Qo,pixelOffsetBR:es,minFontScaleX:0,minFontScaleY:0})}return dt}(0,c,I,g,b,w,d,s.allowVerticalPlacement),de=s.textSizeData;let ge=null;de.kind==="source"?(ge=[fl*g.layout.get("text-size").evaluate(w,{})],ge[0]>du&&Ut(`${s.layerIds[0]}: Value for "text-size" is >= ${_d}. Reduce your "text-size".`)):de.kind==="composite"&&(ge=[fl*W.compositeTextSizes[0].evaluate(w,{},J),fl*W.compositeTextSizes[1].evaluate(w,{},J)],(ge[0]>du||ge[1]>du)&&Ut(`${s.layerIds[0]}: Value for "text-size" is >= ${_d}. Reduce your "text-size".`)),s.addSymbols(s.text,ae,ge,I,b,w,D,i,k.lineStartIndex,k.lineLength,V,J);for(const Ie of N)U[Ie]=s.text.placedSymbolArray.length-1;return 4*ae.length}function ib(s){for(const i in s)return s[i];return null}function nA(s,i,c,d){const g=s.compareText;if(i in g){const b=g[i];for(let w=b.length-1;w>=0;w--)if(d.dist(b[w])<c)return!0}else g[i]=[];return g[i].push(d),!1}const ob=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class My{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,d]=new Uint8Array(i,0,2);if(c!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=d>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const b=ob[15&d];if(!b)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(i,2,1),[I]=new Uint32Array(i,4,1);return new My(I,w,b,i)}constructor(i,c=64,d=Float64Array,g){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=d,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const b=ob.indexOf(this.ArrayType),w=2*i*this.ArrayType.BYTES_PER_ELEMENT,I=i*this.IndexArrayType.BYTES_PER_ELEMENT,k=(8-I%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${d}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+I+k,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+w+I+k),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+I+k,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=i)}add(i,c){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=i,this.coords[this._pos++]=c,d}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return ky(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,c,d,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:w,nodeSize:I}=this,k=[0,b.length-1,0],D=[];for(;k.length;){const N=k.pop()||0,U=k.pop()||0,V=k.pop()||0;if(U-V<=I){for(let de=V;de<=U;de++){const ge=w[2*de],Ie=w[2*de+1];ge>=i&&ge<=d&&Ie>=c&&Ie<=g&&D.push(b[de])}continue}const W=V+U>>1,J=w[2*W],ae=w[2*W+1];J>=i&&J<=d&&ae>=c&&ae<=g&&D.push(b[W]),(N===0?i<=J:c<=ae)&&(k.push(V),k.push(W-1),k.push(1-N)),(N===0?d>=J:g>=ae)&&(k.push(W+1),k.push(U),k.push(1-N))}return D}within(i,c,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:b,nodeSize:w}=this,I=[0,g.length-1,0],k=[],D=d*d;for(;I.length;){const N=I.pop()||0,U=I.pop()||0,V=I.pop()||0;if(U-V<=w){for(let de=V;de<=U;de++)ab(b[2*de],b[2*de+1],i,c)<=D&&k.push(g[de]);continue}const W=V+U>>1,J=b[2*W],ae=b[2*W+1];ab(J,ae,i,c)<=D&&k.push(g[W]),(N===0?i-d<=J:c-d<=ae)&&(I.push(V),I.push(W-1),I.push(1-N)),(N===0?i+d>=J:c+d>=ae)&&(I.push(W+1),I.push(U),I.push(1-N))}return k}}function ky(s,i,c,d,g,b){if(g-d<=c)return;const w=d+g>>1;sb(s,i,w,d,g,b),ky(s,i,c,d,w-1,1-b),ky(s,i,c,w+1,g,1-b)}function sb(s,i,c,d,g,b){for(;g>d;){if(g-d>600){const D=g-d+1,N=c-d+1,U=Math.log(D),V=.5*Math.exp(2*U/3),W=.5*Math.sqrt(U*V*(D-V)/D)*(N-D/2<0?-1:1);sb(s,i,c,Math.max(d,Math.floor(c-N*V/D+W)),Math.min(g,Math.floor(c+(D-N)*V/D+W)),b)}const w=i[2*c+b];let I=d,k=g;for(bd(s,i,d,c),i[2*g+b]>w&&bd(s,i,d,g);I<k;){for(bd(s,i,I,k),I++,k--;i[2*I+b]<w;)I++;for(;i[2*k+b]>w;)k--}i[2*d+b]===w?bd(s,i,d,k):(k++,bd(s,i,k,g)),k<=c&&(d=k+1),c<=k&&(g=k-1)}}function bd(s,i,c,d){Ly(s,c,d),Ly(i,2*c,2*d),Ly(i,2*c+1,2*d+1)}function Ly(s,i,c){const d=s[i];s[i]=s[c],s[c]=d}function ab(s,i,c,d){const g=s-c,b=i-d;return g*g+b*b}var Ry;u.PerformanceMarkers=void 0,(Ry=u.PerformanceMarkers||(u.PerformanceMarkers={})).create="create",Ry.load="load",Ry.fullLoad="fullLoad";let fp=null,wd=[];const Oy=1e3/60,Dy="loadTime",zy="fullLoadTime",iA={mark(s){performance.mark(s)},frame(s){const i=s;fp!=null&&wd.push(i-fp),fp=i},clearMetrics(){fp=null,wd=[],performance.clearMeasures(Dy),performance.clearMeasures(zy);for(const s in u.PerformanceMarkers)performance.clearMarks(u.PerformanceMarkers[s])},getPerformanceMetrics(){performance.measure(Dy,u.PerformanceMarkers.create,u.PerformanceMarkers.load),performance.measure(zy,u.PerformanceMarkers.create,u.PerformanceMarkers.fullLoad);const s=performance.getEntriesByName(Dy)[0].duration,i=performance.getEntriesByName(zy)[0].duration,c=wd.length,d=1/(wd.reduce((b,w)=>b+w,0)/c/1e3),g=wd.filter(b=>b>Oy).reduce((b,w)=>b+(w-Oy)/Oy,0);return{loadTime:s,fullLoadTime:i,fps:d,percentDroppedFrames:g/(c+g)*100,totalFrames:c}}};u.AJAXError=gr,u.ARRAY_TYPE=Kc,u.Actor=class{constructor(s,i,c){this.receive=d=>{const g=d.data,b=g.id;if(b&&(!g.targetMapId||this.mapId===g.targetMapId))if(g.type==="<cancel>"){delete this.tasks[b];const w=this.cancelCallbacks[b];delete this.cancelCallbacks[b],w&&w()}else ar()||g.mustQueue?(this.tasks[b]=g,this.taskQueue.push(b),this.invoker.trigger()):this.processTask(b,g)},this.process=()=>{if(!this.taskQueue.length)return;const d=this.taskQueue.shift(),g=this.tasks[d];delete this.tasks[d],this.taskQueue.length&&this.invoker.trigger(),g&&this.processTask(d,g)},this.target=s,this.parent=i,this.mapId=c,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new WP(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=ar()?s:window}send(s,i,c,d,g=!1){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(this.callbacks[b]=c);const w=Tr(this.globalScope)?void 0:[];return this.target.postMessage({id:b,type:s,hasCallback:!!c,targetMapId:d,mustQueue:g,sourceMapId:this.mapId,data:ma(i,w)},w),{cancel:()=>{c&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}processTask(s,i){if(i.type==="<response>"){const c=this.callbacks[s];delete this.callbacks[s],c&&(i.error?c(Xi(i.error)):c(null,Xi(i.data)))}else{let c=!1;const d=Tr(this.globalScope)?void 0:[],g=i.hasCallback?(I,k)=>{c=!0,delete this.cancelCallbacks[s],this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:I?ma(I):null,data:ma(k,d)},d)}:I=>{c=!0};let b=null;const w=Xi(i.data);if(this.parent[i.type])b=this.parent[i.type](i.sourceMapId,w,g);else if(this.parent.getWorkerSource){const I=i.type.split(".");b=this.parent.getWorkerSource(i.sourceMapId,I[0],w.source)[I[1]](w,g)}else g(new Error(`Could not find function ${i.type}`));!c&&b&&b.cancel&&(this.cancelCallbacks[s]=b.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},u.AlphaImage=ud,u.CanonicalTileID=Iy,u.CollisionBoxArray=v,u.CollisionCircleLayoutArray=class extends kl{},u.Color=tr,u.DEMData=$1,u.DataConstantProperty=Lt,u.DictionaryCoder=V1,u.EXTENT=wn,u.ErrorEvent=so,u.EvaluationParameters=An,u.Event=er,u.Evented=wi,u.FeatureIndex=q1,u.FillBucket=cy,u.FillExtrusionBucket=dy,u.GeoJSONFeature=G1,u.ImageAtlas=E1,u.ImagePosition=yy,u.KDBush=My,u.LineBucket=fy,u.LineStripIndexArray=class extends o{},u.LngLat=fu,u.MercatorCoordinate=lp,u.ONE_EM=Li,u.OverscaledTileID=Ws,u.PerformanceUtils=iA,u.Point=M,u.Pos3dArray=class extends jc{},u.PosArray=ie,u.Properties=Io,u.Protobuf=my,u.QuadTriangleArray=class extends Gc{},u.RGBAImage=Zs,u.RasterBoundsArray=class extends ba{},u.RequestPerformance=class{constructor(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let s=performance.getEntriesByName(this._marks.measure);return s.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),s=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),s}},u.SegmentVector=ct,u.SymbolBucket=th,u.Transitionable=Gf,u.TriangleIndexArray=Ke,u.Uniform1f=wa,u.Uniform1i=class extends fo{constructor(s,i){super(s,i),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},u.Uniform2f=class extends fo{constructor(s,i){super(s,i),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},u.Uniform3f=class extends fo{constructor(s,i){super(s,i),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},u.Uniform4f=uc,u.UniformColor=Ji,u.UniformMatrix4f=class extends fo{constructor(s,i){super(s,i),this.current=Mi}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let i=1;i<16;i++)if(s[i]!==this.current[i]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},u.UnwrappedTileID=j1,u.ValidationError=ut,u.ZoomHistory=$r,u.addDynamicAttributes=by,u.arrayBufferToImage=function(s,i){const c=new Image;c.onload=()=>{i(null,c),URL.revokeObjectURL(c.src),c.onload=null,window.requestAnimationFrame(()=>{c.src=qr})},c.onerror=()=>i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const d=new Blob([new Uint8Array(s)],{type:"image/png"});c.src=s.byteLength?URL.createObjectURL(d):qr},u.arrayBufferToImageBitmap=function(s,i){const c=new Blob([new Uint8Array(s)],{type:"image/png"});createImageBitmap(c).then(d=>{i(null,d)}).catch(d=>{i(new Error(`Could not load image because of ${d.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},u.asyncAll=function(s,i,c){if(!s.length)return c(null,[]);let d=s.length;const g=new Array(s.length);let b=null;s.forEach((w,I)=>{i(w,(k,D)=>{k&&(b=k),g[I]=D,--d==0&&c(b,g)})})},u.bezier=Y,u.browser=Nt,u.clamp=Q,u.clipLine=W1,u.clone=function(s){var i=new Kc(16);return i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i[4]=s[4],i[5]=s[5],i[6]=s[6],i[7]=s[7],i[8]=s[8],i[9]=s[9],i[10]=s[10],i[11]=s[11],i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15],i},u.clone$1=Qe,u.collisionCircleLayout=wP,u.config=mt,u.copy=function(s,i){return s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[3],s[4]=i[4],s[5]=i[5],s[6]=i[6],s[7]=i[7],s[8]=i[8],s[9]=i[9],s[10]=i[10],s[11]=i[11],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15],s},u.create=function(){var s=new Kc(16);return Kc!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},u.createExpression=Ua,u.createFilter=Ii,u.createLayout=ai,u.createStyleLayer=function(s){if(s.type==="custom")return new ZP(s);switch(s.type){case"background":return new GP(s);case"circle":return new AI(s);case"fill":return new KI(s);case"fill-extrusion":return new cP(s);case"heatmap":return new kI(s);case"hillshade":return new RI(s);case"line":return new vP(s);case"raster":return new HP(s);case"symbol":return new ap(s)}},u.deepEqual=function s(i,c){if(Array.isArray(i)){if(!Array.isArray(c)||i.length!==c.length)return!1;for(let d=0;d<i.length;d++)if(!s(i[d],c[d]))return!1;return!0}if(typeof i=="object"&&i!==null&&c!==null){if(typeof c!="object"||Object.keys(i).length!==Object.keys(c).length)return!1;for(const d in i)if(!s(i[d],c[d]))return!1;return!0}return i===c},u.defaultEasing=ye,u.derefLayers=function(s){s=s.slice();const i=Object.create(null);for(let c=0;c<s.length;c++)i[s[c].id]=s[c];for(let c=0;c<s.length;c++)"ref"in s[c]&&(s[c]=Ei(s[c],i[s[c].ref]));return s},u.diffStyles=function(s,i){if(!s)return[{command:Mr.setStyle,args:[i]}];let c=[];try{if(!Dt(s.version,i.version))return[{command:Mr.setStyle,args:[i]}];Dt(s.center,i.center)||c.push({command:Mr.setCenter,args:[i.center]}),Dt(s.zoom,i.zoom)||c.push({command:Mr.setZoom,args:[i.zoom]}),Dt(s.bearing,i.bearing)||c.push({command:Mr.setBearing,args:[i.bearing]}),Dt(s.pitch,i.pitch)||c.push({command:Mr.setPitch,args:[i.pitch]}),Dt(s.sprite,i.sprite)||c.push({command:Mr.setSprite,args:[i.sprite]}),Dt(s.glyphs,i.glyphs)||c.push({command:Mr.setGlyphs,args:[i.glyphs]}),Dt(s.transition,i.transition)||c.push({command:Mr.setTransition,args:[i.transition]}),Dt(s.light,i.light)||c.push({command:Mr.setLight,args:[i.light]});const d={},g=[];(function(w,I,k,D){let N;for(N in I=I||{},w=w||{})Object.prototype.hasOwnProperty.call(w,N)&&(Object.prototype.hasOwnProperty.call(I,N)||ks(N,k,D));for(N in I)Object.prototype.hasOwnProperty.call(I,N)&&(Object.prototype.hasOwnProperty.call(w,N)?Dt(w[N],I[N])||(w[N].type==="geojson"&&I[N].type==="geojson"&&ol(w,I,N)?k.push({command:Mr.setGeoJSONSourceData,args:[N,I[N].data]}):Tn(N,I,k,D)):hs(N,I,k))})(s.sources,i.sources,g,d);const b=[];s.layers&&s.layers.forEach(w=>{d[w.source]?c.push({command:Mr.removeLayer,args:[w.id]}):b.push(w)}),c=c.concat(g),function(w,I,k){I=I||[];const D=(w=w||[]).map(Ls),N=I.map(Ls),U=w.reduce(ao,{}),V=I.reduce(ao,{}),W=D.slice(),J=Object.create(null);let ae,de,ge,Ie,_e,ke,Oe;for(ae=0,de=0;ae<D.length;ae++)ge=D[ae],Object.prototype.hasOwnProperty.call(V,ge)?de++:(k.push({command:Mr.removeLayer,args:[ge]}),W.splice(W.indexOf(ge,de),1));for(ae=0,de=0;ae<N.length;ae++)ge=N[N.length-1-ae],W[W.length-1-ae]!==ge&&(Object.prototype.hasOwnProperty.call(U,ge)?(k.push({command:Mr.removeLayer,args:[ge]}),W.splice(W.lastIndexOf(ge,W.length-de),1)):de++,ke=W[W.length-ae],k.push({command:Mr.addLayer,args:[V[ge],ke]}),W.splice(W.length-ae,0,ge),J[ge]=!0);for(ae=0;ae<N.length;ae++)if(ge=N[ae],Ie=U[ge],_e=V[ge],!J[ge]&&!Dt(Ie,_e))if(Dt(Ie.source,_e.source)&&Dt(Ie["source-layer"],_e["source-layer"])&&Dt(Ie.type,_e.type)){for(Oe in tn(Ie.layout,_e.layout,k,ge,null,Mr.setLayoutProperty),tn(Ie.paint,_e.paint,k,ge,null,Mr.setPaintProperty),Dt(Ie.filter,_e.filter)||k.push({command:Mr.setFilter,args:[ge,_e.filter]}),Dt(Ie.minzoom,_e.minzoom)&&Dt(Ie.maxzoom,_e.maxzoom)||k.push({command:Mr.setLayerZoomRange,args:[ge,_e.minzoom,_e.maxzoom]}),Ie)Object.prototype.hasOwnProperty.call(Ie,Oe)&&Oe!=="layout"&&Oe!=="paint"&&Oe!=="filter"&&Oe!=="metadata"&&Oe!=="minzoom"&&Oe!=="maxzoom"&&(Oe.indexOf("paint.")===0?tn(Ie[Oe],_e[Oe],k,ge,Oe.slice(6),Mr.setPaintProperty):Dt(Ie[Oe],_e[Oe])||k.push({command:Mr.setLayerProperty,args:[ge,Oe,_e[Oe]]}));for(Oe in _e)Object.prototype.hasOwnProperty.call(_e,Oe)&&!Object.prototype.hasOwnProperty.call(Ie,Oe)&&Oe!=="layout"&&Oe!=="paint"&&Oe!=="filter"&&Oe!=="metadata"&&Oe!=="minzoom"&&Oe!=="maxzoom"&&(Oe.indexOf("paint.")===0?tn(Ie[Oe],_e[Oe],k,ge,Oe.slice(6),Mr.setPaintProperty):Dt(Ie[Oe],_e[Oe])||k.push({command:Mr.setLayerProperty,args:[ge,Oe,_e[Oe]]}))}else k.push({command:Mr.removeLayer,args:[ge]}),ke=W[W.lastIndexOf(ge)+1],k.push({command:Mr.addLayer,args:[_e,ke]})}(b,i.layers,c)}catch(d){console.warn("Unable to compute style diff:",d),c=[{command:Mr.setStyle,args:[i]}]}return c},u.dot=function(s,i){return s[0]*i[0]+s[1]*i[1]+s[2]*i[2]+s[3]*i[3]},u.earthRadius=Ty,u.emitValidationErrors=Vn,u.emptyStyle=function(){const s={},i=Ue.$version;for(const c in Ue.$root){const d=Ue.$root[c];if(d.required){let g=null;g=c==="version"?i:d.type==="array"?[]:{},g!=null&&(s[c]=g)}}return s},u.equals=function(s,i){var c=s[0],d=s[1],g=s[2],b=s[3],w=s[4],I=s[5],k=s[6],D=s[7],N=s[8],U=s[9],V=s[10],W=s[11],J=s[12],ae=s[13],de=s[14],ge=s[15],Ie=i[0],_e=i[1],ke=i[2],Oe=i[3],Xe=i[4],Et=i[5],Ct=i[6],wt=i[7],vt=i[8],dt=i[9],St=i[10],_t=i[11],it=i[12],qt=i[13],Rt=i[14],mr=i[15];return Math.abs(c-Ie)<=Po*Math.max(1,Math.abs(c),Math.abs(Ie))&&Math.abs(d-_e)<=Po*Math.max(1,Math.abs(d),Math.abs(_e))&&Math.abs(g-ke)<=Po*Math.max(1,Math.abs(g),Math.abs(ke))&&Math.abs(b-Oe)<=Po*Math.max(1,Math.abs(b),Math.abs(Oe))&&Math.abs(w-Xe)<=Po*Math.max(1,Math.abs(w),Math.abs(Xe))&&Math.abs(I-Et)<=Po*Math.max(1,Math.abs(I),Math.abs(Et))&&Math.abs(k-Ct)<=Po*Math.max(1,Math.abs(k),Math.abs(Ct))&&Math.abs(D-wt)<=Po*Math.max(1,Math.abs(D),Math.abs(wt))&&Math.abs(N-vt)<=Po*Math.max(1,Math.abs(N),Math.abs(vt))&&Math.abs(U-dt)<=Po*Math.max(1,Math.abs(U),Math.abs(dt))&&Math.abs(V-St)<=Po*Math.max(1,Math.abs(V),Math.abs(St))&&Math.abs(W-_t)<=Po*Math.max(1,Math.abs(W),Math.abs(_t))&&Math.abs(J-it)<=Po*Math.max(1,Math.abs(J),Math.abs(it))&&Math.abs(ae-qt)<=Po*Math.max(1,Math.abs(ae),Math.abs(qt))&&Math.abs(de-Rt)<=Po*Math.max(1,Math.abs(de),Math.abs(Rt))&&Math.abs(ge-mr)<=Po*Math.max(1,Math.abs(ge),Math.abs(mr))},u.evaluateSizeForFeature=function(s,{uSize:i,uSizeT:c},{lowerSize:d,upperSize:g}){return s.kind==="source"?d/fl:s.kind==="composite"?Ot.number(d/fl,g/fl,c):i},u.evaluateSizeForZoom=function(s,i){let c=0,d=0;if(s.kind==="constant")d=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:g,minZoom:b,maxZoom:w}=s,I=g?Q(vr.interpolationFactor(g,i,b,w),0,1):0;s.kind==="camera"?d=Ot.number(s.minSize,s.maxSize,I):c=I}return{uSizeT:c,uSize:d}},u.evaluateVariableOffset=rb,u.evented=Va,u.extend=ne,u.filterObject=je,u.findLineIntersection=function(s,i,c,d){const g=i.y-s.y,b=i.x-s.x,w=d.y-c.y,I=d.x-c.x,k=w*b-I*g;if(k===0)return null;const D=(I*(s.y-c.y)-w*(s.x-c.x))/k;return new M(s.x+D*b,s.y+D*g)},u.fromScaling=function(s,i){return s[0]=i[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=i[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=i[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},u.getAnchorAlignment=_y,u.getAnchorJustification=Ay,u.getArrayBuffer=dn,u.getDefaultExportFromCjs=E,u.getJSON=function(s,i){return Dn(ne(s,{type:"json"}),i)},u.getOverlapMode=xy,u.getProtocolAction=Lr,u.getRTLTextPluginStatus=dl,u.getReferrer=Ar,u.getVideo=function(s,i){const c=window.document.createElement("video");c.muted=!0,c.onloadstart=function(){i(null,c)};for(let d=0;d<s.length;d++){const g=window.document.createElement("source");ji(s[d])||(c.crossOrigin="Anonymous"),g.src=s[d],c.appendChild(g)}return{cancel:()=>{}}},u.groupByLayout=function(s,i){const c={};for(let g=0;g<s.length;g++){const b=i&&i[s[g].id]||$a(s[g]);i&&(i[s[g].id]=b);let w=c[b];w||(w=c[b]=[]),w.push(s[g])}const d=[];for(const g in c)d.push(c[g]);return d},u.identity=ey,u.interpolate=Ot,u.invert=function(s,i){var c=i[0],d=i[1],g=i[2],b=i[3],w=i[4],I=i[5],k=i[6],D=i[7],N=i[8],U=i[9],V=i[10],W=i[11],J=i[12],ae=i[13],de=i[14],ge=i[15],Ie=c*I-d*w,_e=c*k-g*w,ke=c*D-b*w,Oe=d*k-g*I,Xe=d*D-b*I,Et=g*D-b*k,Ct=N*ae-U*J,wt=N*de-V*J,vt=N*ge-W*J,dt=U*de-V*ae,St=U*ge-W*ae,_t=V*ge-W*de,it=Ie*_t-_e*St+ke*dt+Oe*vt-Xe*wt+Et*Ct;return it?(s[0]=(I*_t-k*St+D*dt)*(it=1/it),s[1]=(g*St-d*_t-b*dt)*it,s[2]=(ae*Et-de*Xe+ge*Oe)*it,s[3]=(V*Xe-U*Et-W*Oe)*it,s[4]=(k*vt-w*_t-D*wt)*it,s[5]=(c*_t-g*vt+b*wt)*it,s[6]=(de*ke-J*Et-ge*_e)*it,s[7]=(N*Et-V*ke+W*_e)*it,s[8]=(w*St-I*vt+D*Ct)*it,s[9]=(d*vt-c*St-b*Ct)*it,s[10]=(J*Xe-ae*ke+ge*Ie)*it,s[11]=(U*ke-N*Xe-W*Ie)*it,s[12]=(I*wt-w*dt-k*Ct)*it,s[13]=(c*dt-d*wt+g*Ct)*it,s[14]=(ae*_e-J*Oe-de*Ie)*it,s[15]=(N*Oe-U*_e+V*Ie)*it,s):null},u.isImageBitmap=sn,u.isSafari=Tr,u.isWorker=ar,u.keysDifference=function(s,i){const c=[];for(const d in s)d in i||c.push(d);return c},u.lazyLoadRTLTextPlugin=function(){_s.isLoading()||_s.isLoaded()||dl()!=="deferred"||Vf()},u.makeRequest=Dn,u.mapObject=Ve,u.mercatorXfromLng=F1,u.mercatorYfromLat=N1,u.mercatorZfromAltitude=B1,u.mul=PI,u.mul$1=function(s,i,c){return s[0]=i[0]*c[0],s[1]=i[1]*c[1],s[2]=i[2]*c[2],s[3]=i[3]*c[3],s},u.multiply=$x,u.nextPowerOfTwo=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},u.operations=Mr,u.ortho=function(s,i,c,d,g,b,w){var I=1/(i-c),k=1/(d-g),D=1/(b-w);return s[0]=-2*I,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*k,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*D,s[11]=0,s[12]=(i+c)*I,s[13]=(g+d)*k,s[14]=(w+b)*D,s[15]=1,s},u.parseCacheControl=function(s){const i={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,d,g,b)=>{const w=g||b;return i[d]=!w||w.toLowerCase(),""}),i["max-age"]){const c=parseInt(i["max-age"],10);isNaN(c)?delete i["max-age"]:i["max-age"]=c}return i},u.parseGlyphPbf=function(s){return new my(s).readFields(RP,[])},u.pbf=p1,u.performSymbolLayout=function(s){s.bucket.createArrays(),s.bucket.tilePixelRatio=wn/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const i=s.bucket.layers[0].layout,c=s.bucket.layers[0]._unevaluatedLayout._values,d={layoutIconSize:c["icon-size"].possiblyEvaluate(new An(s.bucket.zoom+1),s.canonical),layoutTextSize:c["text-size"].possiblyEvaluate(new An(s.bucket.zoom+1),s.canonical),textMaxSize:c["text-size"].possiblyEvaluate(new An(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:D}=s.bucket.textSizeData;d.compositeTextSizes=[c["text-size"].possiblyEvaluate(new An(k),s.canonical),c["text-size"].possiblyEvaluate(new An(D),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:D}=s.bucket.iconSizeData;d.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new An(k),s.canonical),c["icon-size"].possiblyEvaluate(new An(D),s.canonical)]}const g=i.get("text-line-height")*Li,b=i.get("text-rotation-alignment")!=="viewport"&&i.get("symbol-placement")!=="point",w=i.get("text-keep-upright"),I=i.get("text-size");for(const k of s.bucket.features){const D=i.get("text-font").evaluate(k,{},s.canonical).join(","),N=I.evaluate(k,{},s.canonical),U=d.layoutTextSize.evaluate(k,{},s.canonical),V=d.layoutIconSize.evaluate(k,{},s.canonical),W={horizontal:{},vertical:void 0},J=k.text;let ae,de=[0,0];if(J){const _e=J.toString(),ke=i.get("text-letter-spacing").evaluate(k,{},s.canonical)*Li,Oe=ho(_e)?ke:0,Xe=i.get("text-anchor").evaluate(k,{},s.canonical),Et=i.get("text-variable-anchor");if(!Et){const St=i.get("text-radial-offset").evaluate(k,{},s.canonical);de=St?rb(Xe,[St*Li,Py]):i.get("text-offset").evaluate(k,{},s.canonical).map(_t=>_t*Li)}let Ct=b?"center":i.get("text-justify").evaluate(k,{},s.canonical);const wt=i.get("symbol-placement"),vt=wt==="point"?i.get("text-max-width").evaluate(k,{},s.canonical)*Li:0,dt=()=>{s.bucket.allowVerticalPlacement&&Co(_e)&&(W.vertical=ip(J,s.glyphMap,s.glyphPositions,s.imagePositions,D,vt,g,Xe,"left",Oe,de,u.WritingMode.vertical,!0,wt,U,N))};if(!b&&Et){const St=Ct==="auto"?Et.map(it=>Ay(it)):[Ct];let _t=!1;for(let it=0;it<St.length;it++){const qt=St[it];if(!W.horizontal[qt])if(_t)W.horizontal[qt]=W.horizontal[0];else{const Rt=ip(J,s.glyphMap,s.glyphPositions,s.imagePositions,D,vt,g,"center",qt,Oe,de,u.WritingMode.horizontal,!1,wt,U,N);Rt&&(W.horizontal[qt]=Rt,_t=Rt.positionedLines.length===1)}}dt()}else{Ct==="auto"&&(Ct=Ay(Xe));const St=ip(J,s.glyphMap,s.glyphPositions,s.imagePositions,D,vt,g,Xe,Ct,Oe,de,u.WritingMode.horizontal,!1,wt,U,N);St&&(W.horizontal[Ct]=St),dt(),Co(_e)&&b&&w&&(W.vertical=ip(J,s.glyphMap,s.glyphPositions,s.imagePositions,D,vt,g,Xe,Ct,Oe,de,u.WritingMode.vertical,!1,wt,U,N))}}let ge=!1;if(k.icon&&k.icon.name){const _e=s.imageMap[k.icon.name];_e&&(ae=BP(s.imagePositions[k.icon.name],i.get("icon-offset").evaluate(k,{},s.canonical),i.get("icon-anchor").evaluate(k,{},s.canonical)),ge=!!_e.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=ge:s.bucket.sdfIcons!==ge&&Ut("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(_e.pixelRatio!==s.bucket.pixelRatio||i.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const Ie=ib(W.horizontal)||W.vertical;s.bucket.iconsInText=!!Ie&&Ie.iconsInText,(Ie||ae)&&rA(s.bucket,k,W,ae,s.imageMap,d,U,V,de,ge,s.canonical)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},u.perspective=function(s,i,c,d,g){var b,w=1/Math.tan(i/2);return s[0]=w/c,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=w,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,g!=null&&g!==1/0?(s[10]=(g+d)*(b=1/(d-g)),s[14]=2*g*d*b):(s[10]=-1,s[14]=-2*d),s},u.pick=function(s,i){const c={};for(let d=0;d<i.length;d++){const g=i[d];g in s&&(c[g]=s[g])}return c},u.plugin=_s,u.pointGeometry=m,u.polygonIntersectsPolygon=zx,u.potpack=w1,u.register=yt,u.registerForPluginStateChange=function(s){return s({pluginStatus:Pi,pluginURL:Wo}),Va.on("pluginStateChange",s),s},u.renderColorRamp=Zx,u.rotateX=function(s,i,c){var d=Math.sin(c),g=Math.cos(c),b=i[4],w=i[5],I=i[6],k=i[7],D=i[8],N=i[9],U=i[10],V=i[11];return i!==s&&(s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[3],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[4]=b*g+D*d,s[5]=w*g+N*d,s[6]=I*g+U*d,s[7]=k*g+V*d,s[8]=D*g-b*d,s[9]=N*g-w*d,s[10]=U*g-I*d,s[11]=V*g-k*d,s},u.rotateZ=function(s,i,c){var d=Math.sin(c),g=Math.cos(c),b=i[0],w=i[1],I=i[2],k=i[3],D=i[4],N=i[5],U=i[6],V=i[7];return i!==s&&(s[8]=i[8],s[9]=i[9],s[10]=i[10],s[11]=i[11],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[0]=b*g+D*d,s[1]=w*g+N*d,s[2]=I*g+U*d,s[3]=k*g+V*d,s[4]=D*g-b*d,s[5]=N*g-w*d,s[6]=U*g-I*d,s[7]=V*g-k*d,s},u.sameOrigin=ji,u.scale=function(s,i,c){var d=c[0],g=c[1],b=c[2];return s[0]=i[0]*d,s[1]=i[1]*d,s[2]=i[2]*d,s[3]=i[3]*d,s[4]=i[4]*g,s[5]=i[5]*g,s[6]=i[6]*g,s[7]=i[7]*g,s[8]=i[8]*b,s[9]=i[9]*b,s[10]=i[10]*b,s[11]=i[11]*b,s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15],s},u.setRTLTextPlugin=function(s,i,c=!1){if(Pi===ya||Pi===vs||Pi===ou)throw new Error("setRTLTextPlugin cannot be called multiple times.");Wo=Nt.resolveURL(s),Pi=ya,va=i,su(),c||Vf()},u.sphericalToCartesian=function([s,i,c]){return i+=90,i*=Math.PI/180,c*=Math.PI/180,{x:s*Math.cos(i)*Math.sin(c),y:s*Math.sin(i)*Math.sin(c),z:s*Math.cos(c)}},u.toEvaluationFeature=hc,u.transformMat4=Jf,u.translate=function(s,i,c){var d,g,b,w,I,k,D,N,U,V,W,J,ae=c[0],de=c[1],ge=c[2];return i===s?(s[12]=i[0]*ae+i[4]*de+i[8]*ge+i[12],s[13]=i[1]*ae+i[5]*de+i[9]*ge+i[13],s[14]=i[2]*ae+i[6]*de+i[10]*ge+i[14],s[15]=i[3]*ae+i[7]*de+i[11]*ge+i[15]):(g=i[1],b=i[2],w=i[3],I=i[4],k=i[5],D=i[6],N=i[7],U=i[8],V=i[9],W=i[10],J=i[11],s[0]=d=i[0],s[1]=g,s[2]=b,s[3]=w,s[4]=I,s[5]=k,s[6]=D,s[7]=N,s[8]=U,s[9]=V,s[10]=W,s[11]=J,s[12]=d*ae+I*de+U*ge+i[12],s[13]=g*ae+k*de+V*ge+i[13],s[14]=b*ae+D*de+W*ge+i[14],s[15]=w*ae+N*de+J*ge+i[15]),s},u.triggerPluginCompletionEvent=Al,u.unicodeBlockLookup=Ye,u.uniqueId=function(){return Me++},u.v8Spec=Ue,u.validateCustomStyleLayer=function(s){const i=[],c=s.id;return c===void 0&&i.push({message:`layers.${c}: missing required property "id"`}),s.render===void 0&&i.push({message:`layers.${c}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&i.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),i},u.validateLight=co,u.validateStyle=pn,u.vectorTile=cu,u.warnOnce=Ut,u.wrap=te}),l(["./shared"],function(u){class E{constructor(j){this.keyCache={},j&&this.replace(j)}replace(j){this._layerConfigs={},this._layers={},this.update(j,[])}update(j,G){for(const ce of j){this._layerConfigs[ce.id]=ce;const me=this._layers[ce.id]=u.createStyleLayer(ce);me._featureFilter=u.createFilter(me.filter),this.keyCache[ce.id]&&delete this.keyCache[ce.id]}for(const ce of G)delete this.keyCache[ce],delete this._layerConfigs[ce],delete this._layers[ce];this.familiesBySource={};const ee=u.groupByLayout(Object.values(this._layerConfigs),this.keyCache);for(const ce of ee){const me=ce.map(We=>this._layers[We.id]),be=me[0];if(be.visibility==="none")continue;const ve=be.source||"";let pe=this.familiesBySource[ve];pe||(pe=this.familiesBySource[ve]={});const Te=be.sourceLayer||"_geojsonTileLayer";let He=pe[Te];He||(He=pe[Te]=[]),He.push(me)}}}class m{constructor(j){const G={},ee=[];for(const ve in j){const pe=j[ve],Te=G[ve]={};for(const He in pe){const We=pe[+He];if(!We||We.bitmap.width===0||We.bitmap.height===0)continue;const Ze={x:0,y:0,w:We.bitmap.width+2,h:We.bitmap.height+2};ee.push(Ze),Te[He]={rect:Ze,metrics:We.metrics}}}const{w:ce,h:me}=u.potpack(ee),be=new u.AlphaImage({width:ce||1,height:me||1});for(const ve in j){const pe=j[ve];for(const Te in pe){const He=pe[+Te];if(!He||He.bitmap.width===0||He.bitmap.height===0)continue;const We=G[ve][Te].rect;u.AlphaImage.copy(He.bitmap,be,{x:0,y:0},{x:We.x+1,y:We.y+1},He.bitmap)}}this.image=be,this.positions=G}}u.register("GlyphAtlas",m);class S{constructor(j){this.tileID=new u.OverscaledTileID(j.tileID.overscaledZ,j.tileID.wrap,j.tileID.canonical.z,j.tileID.canonical.x,j.tileID.canonical.y),this.uid=j.uid,this.zoom=j.zoom,this.pixelRatio=j.pixelRatio,this.tileSize=j.tileSize,this.source=j.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=j.showCollisionBoxes,this.collectResourceTiming=!!j.collectResourceTiming,this.returnDependencies=!!j.returnDependencies,this.promoteId=j.promoteId}parse(j,G,ee,ce,me){this.status="parsing",this.data=j,this.collisionBoxArray=new u.CollisionBoxArray;const be=new u.DictionaryCoder(Object.keys(j.layers).sort()),ve=new u.FeatureIndex(this.tileID,this.promoteId);ve.bucketLayerIDs=[];const pe={},Te={featureIndex:ve,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ee},He=G.familiesBySource[this.source];for(const sr in He){const Br=j.layers[sr];if(!Br)continue;Br.version===1&&u.warnOnce(`Vector tile source "${this.source}" layer "${sr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ur=be.encode(sr),tr=[];for(let an=0;an<Br.length;an++){const ln=Br.feature(an),Rr=ve.getId(ln,sr);tr.push({feature:ln,id:Rr,index:an,sourceLayerIndex:Ur})}for(const an of He[sr]){const ln=an[0];ln.source!==this.source&&u.warnOnce(`layer.source = ${ln.source} does not equal this.source = ${this.source}`),ln.minzoom&&this.zoom<Math.floor(ln.minzoom)||ln.maxzoom&&this.zoom>=ln.maxzoom||ln.visibility!=="none"&&(M(an,this.zoom,ee),(pe[ln.id]=ln.createBucket({index:ve.bucketLayerIDs.length,layers:an,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ur,sourceID:this.source})).populate(tr,Te,this.tileID.canonical),ve.bucketLayerIDs.push(an.map(Rr=>Rr.id)))}}let We,Ze,Pt,Zt;const xt=u.mapObject(Te.glyphDependencies,sr=>Object.keys(sr).map(Number));Object.keys(xt).length?ce.send("getGlyphs",{uid:this.uid,stacks:xt,source:this.source,tileID:this.tileID,type:"glyphs"},(sr,Br)=>{We||(We=sr,Ze=Br,Kt.call(this))}):Ze={};const Mt=Object.keys(Te.iconDependencies);Mt.length?ce.send("getImages",{icons:Mt,source:this.source,tileID:this.tileID,type:"icons"},(sr,Br)=>{We||(We=sr,Pt=Br,Kt.call(this))}):Pt={};const $t=Object.keys(Te.patternDependencies);function Kt(){if(We)return me(We);if(Ze&&Pt&&Zt){const sr=new m(Ze),Br=new u.ImageAtlas(Pt,Zt);for(const Ur in pe){const tr=pe[Ur];tr instanceof u.SymbolBucket?(M(tr.layers,this.zoom,ee),u.performSymbolLayout({bucket:tr,glyphMap:Ze,glyphPositions:sr.positions,imageMap:Pt,imagePositions:Br.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):tr.hasPattern&&(tr instanceof u.LineBucket||tr instanceof u.FillBucket||tr instanceof u.FillExtrusionBucket)&&(M(tr.layers,this.zoom,ee),tr.addFeatures(Te,this.tileID.canonical,Br.patternPositions))}this.status="done",me(null,{buckets:Object.values(pe).filter(Ur=>!Ur.isEmpty()),featureIndex:ve,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:sr.image,imageAtlas:Br,glyphMap:this.returnDependencies?Ze:null,iconMap:this.returnDependencies?Pt:null,glyphPositions:this.returnDependencies?sr.positions:null})}}$t.length?ce.send("getImages",{icons:$t,source:this.source,tileID:this.tileID,type:"patterns"},(sr,Br)=>{We||(We=sr,Zt=Br,Kt.call(this))}):Zt={},Kt.call(this)}}function M(oe,j,G){const ee=new u.EvaluationParameters(j);for(const ce of oe)ce.recalculate(ee,G)}function z(oe,j){const G=u.getArrayBuffer(oe.request,(ee,ce,me,be)=>{ee?j(ee):ce&&j(null,{vectorTile:new u.vectorTile.VectorTile(new u.Protobuf(ce)),rawData:ce,cacheControl:me,expires:be})});return()=>{G.cancel(),j()}}class H{constructor(j,G,ee,ce){this.actor=j,this.layerIndex=G,this.availableImages=ee,this.loadVectorData=ce||z,this.loading={},this.loaded={}}loadTile(j,G){const ee=j.uid;this.loading||(this.loading={});const ce=!!(j&&j.request&&j.request.collectResourceTiming)&&new u.RequestPerformance(j.request),me=this.loading[ee]=new S(j);me.abort=this.loadVectorData(j,(be,ve)=>{if(delete this.loading[ee],be||!ve)return me.status="done",this.loaded[ee]=me,G(be);const pe=ve.rawData,Te={};ve.expires&&(Te.expires=ve.expires),ve.cacheControl&&(Te.cacheControl=ve.cacheControl);const He={};if(ce){const We=ce.finish();We&&(He.resourceTiming=JSON.parse(JSON.stringify(We)))}me.vectorTile=ve.vectorTile,me.parse(ve.vectorTile,this.layerIndex,this.availableImages,this.actor,(We,Ze)=>{if(We||!Ze)return G(We);G(null,u.extend({rawTileData:pe.slice(0)},Ze,Te,He))}),this.loaded=this.loaded||{},this.loaded[ee]=me})}reloadTile(j,G){const ee=this.loaded,ce=j.uid,me=this;if(ee&&ee[ce]){const be=ee[ce];be.showCollisionBoxes=j.showCollisionBoxes;const ve=(pe,Te)=>{const He=be.reloadCallback;He&&(delete be.reloadCallback,be.parse(be.vectorTile,me.layerIndex,this.availableImages,me.actor,He)),G(pe,Te)};be.status==="parsing"?be.reloadCallback=ve:be.status==="done"&&(be.vectorTile?be.parse(be.vectorTile,this.layerIndex,this.availableImages,this.actor,ve):ve())}}abortTile(j,G){const ee=this.loading,ce=j.uid;ee&&ee[ce]&&ee[ce].abort&&(ee[ce].abort(),delete ee[ce]),G()}removeTile(j,G){const ee=this.loaded,ce=j.uid;ee&&ee[ce]&&delete ee[ce],G()}}class q{constructor(){this.loaded={}}loadTile(j,G){const{uid:ee,encoding:ce,rawImageData:me}=j,be=u.isImageBitmap(me)?this.getImageData(me):me,ve=new u.DEMData(ee,be,ce);this.loaded=this.loaded||{},this.loaded[ee]=ve,G(null,ve)}getImageData(j){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(j.width,j.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=j.width,this.offscreenCanvas.height=j.height,this.offscreenCanvasContext.drawImage(j,0,0,j.width,j.height);const G=this.offscreenCanvasContext.getImageData(-1,-1,j.width+2,j.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new u.RGBAImage({width:G.width,height:G.height},G.data)}removeTile(j){const G=this.loaded,ee=j.uid;G&&G[ee]&&delete G[ee]}}function Y(oe,j){if(oe.length!==0){ye(oe[0],j);for(var G=1;G<oe.length;G++)ye(oe[G],!j)}}function ye(oe,j){for(var G=0,ee=0,ce=0,me=oe.length,be=me-1;ce<me;be=ce++){var ve=(oe[ce][0]-oe[be][0])*(oe[be][1]+oe[ce][1]),pe=G+ve;ee+=Math.abs(G)>=Math.abs(ve)?G-pe+ve:ve-pe+G,G=pe}G+ee>=0!=!!j&&oe.reverse()}var Q=u.getDefaultExportFromCjs(function oe(j,G){var ee,ce=j&&j.type;if(ce==="FeatureCollection")for(ee=0;ee<j.features.length;ee++)oe(j.features[ee],G);else if(ce==="GeometryCollection")for(ee=0;ee<j.geometries.length;ee++)oe(j.geometries[ee],G);else if(ce==="Feature")oe(j.geometry,G);else if(ce==="Polygon")Y(j.coordinates,G);else if(ce==="MultiPolygon")for(ee=0;ee<j.coordinates.length;ee++)Y(j.coordinates[ee],G);return j});const te=u.vectorTile.VectorTileFeature.prototype.toGeoJSON;var ne={exports:{}},Me=u.pointGeometry,Ve=u.vectorTile.VectorTileFeature,je=Qe;function Qe(oe,j){this.options=j||{},this.features=oe,this.length=oe.length}function ot(oe,j){this.id=typeof oe.id=="number"?oe.id:void 0,this.type=oe.type,this.rawGeometry=oe.type===1?[oe.geometry]:oe.geometry,this.properties=oe.tags,this.extent=j||4096}Qe.prototype.feature=function(oe){return new ot(this.features[oe],this.options.extent)},ot.prototype.loadGeometry=function(){var oe=this.rawGeometry;this.geometry=[];for(var j=0;j<oe.length;j++){for(var G=oe[j],ee=[],ce=0;ce<G.length;ce++)ee.push(new Me(G[ce][0],G[ce][1]));this.geometry.push(ee)}return this.geometry},ot.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var oe=this.geometry,j=1/0,G=-1/0,ee=1/0,ce=-1/0,me=0;me<oe.length;me++)for(var be=oe[me],ve=0;ve<be.length;ve++){var pe=be[ve];j=Math.min(j,pe.x),G=Math.max(G,pe.x),ee=Math.min(ee,pe.y),ce=Math.max(ce,pe.y)}return[j,ee,G,ce]},ot.prototype.toGeoJSON=Ve.prototype.toGeoJSON;var Ut=u.pbf,st=je;function Qt(oe){var j=new Ut;return function(G,ee){for(var ce in G.layers)ee.writeMessage(3,ar,G.layers[ce])}(oe,j),j.finish()}function ar(oe,j){var G;j.writeVarintField(15,oe.version||1),j.writeStringField(1,oe.name||""),j.writeVarintField(5,oe.extent||4096);var ee={keys:[],values:[],keycache:{},valuecache:{}};for(G=0;G<oe.length;G++)ee.feature=oe.feature(G),j.writeMessage(2,Xr,ee);var ce=ee.keys;for(G=0;G<ce.length;G++)j.writeStringField(3,ce[G]);var me=ee.values;for(G=0;G<me.length;G++)j.writeMessage(4,pt,me[G])}function Xr(oe,j){var G=oe.feature;G.id!==void 0&&j.writeVarintField(1,G.id),j.writeMessage(2,Tr,oe),j.writeVarintField(3,G.type),j.writeMessage(4,Un,G)}function Tr(oe,j){var G=oe.feature,ee=oe.keys,ce=oe.values,me=oe.keycache,be=oe.valuecache;for(var ve in G.properties){var pe=G.properties[ve],Te=me[ve];if(pe!==null){Te===void 0&&(ee.push(ve),me[ve]=Te=ee.length-1),j.writeVarint(Te);var He=typeof pe;He!=="string"&&He!=="boolean"&&He!=="number"&&(pe=JSON.stringify(pe));var We=He+":"+pe,Ze=be[We];Ze===void 0&&(ce.push(pe),be[We]=Ze=ce.length-1),j.writeVarint(Ze)}}}function sn(oe,j){return(j<<3)+(7&oe)}function qr(oe){return oe<<1^oe>>31}function Un(oe,j){for(var G=oe.loadGeometry(),ee=oe.type,ce=0,me=0,be=G.length,ve=0;ve<be;ve++){var pe=G[ve],Te=1;ee===1&&(Te=pe.length),j.writeVarint(sn(1,Te));for(var He=ee===3?pe.length-1:pe.length,We=0;We<He;We++){We===1&&ee!==1&&j.writeVarint(sn(2,He-1));var Ze=pe[We].x-ce,Pt=pe[We].y-me;j.writeVarint(qr(Ze)),j.writeVarint(qr(Pt)),ce+=Ze,me+=Pt}ee===3&&j.writeVarint(sn(7,1))}}function pt(oe,j){var G=typeof oe;G==="string"?j.writeStringField(1,oe):G==="boolean"?j.writeBooleanField(7,oe):G==="number"&&(oe%1!=0?j.writeDoubleField(3,oe):oe<0?j.writeSVarintField(6,oe):j.writeVarintField(5,oe))}ne.exports=Qt,ne.exports.fromVectorTileJs=Qt,ne.exports.fromGeojsonVt=function(oe,j){j=j||{};var G={};for(var ee in oe)G[ee]=new st(oe[ee].features,j),G[ee].name=ee,G[ee].version=j.version,G[ee].extent=j.extent;return Qt({layers:G})},ne.exports.GeoJSONWrapper=st;var Nt=u.getDefaultExportFromCjs(ne.exports);const mt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:oe=>oe},gr=Math.fround||(Ar=new Float32Array(1),oe=>(Ar[0]=+oe,Ar[0]));var Ar;const Lr=3,yr=5,Dn=6;class dn{constructor(j){this.options=Object.assign(Object.create(mt),j),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(j){const{log:G,minZoom:ee,maxZoom:ce}=this.options;G&&console.time("total time");const me=`prepare ${j.length} points`;G&&console.time(me),this.points=j;const be=[];for(let pe=0;pe<j.length;pe++){const Te=j[pe];if(!Te.geometry)continue;const[He,We]=Te.geometry.coordinates,Ze=gr(vn(He)),Pt=gr(er(We));be.push(Ze,Pt,1/0,pe,-1,1),this.options.reduce&&be.push(0)}let ve=this.trees[ce+1]=this._createTree(be);G&&console.timeEnd(me);for(let pe=ce;pe>=ee;pe--){const Te=+Date.now();ve=this.trees[pe]=this._createTree(this._cluster(ve,pe)),G&&console.log("z%d: %d clusters in %dms",pe,ve.numItems,+Date.now()-Te)}return G&&console.timeEnd("total time"),this}getClusters(j,G){let ee=((j[0]+180)%360+360)%360-180;const ce=Math.max(-90,Math.min(90,j[1]));let me=j[2]===180?180:((j[2]+180)%360+360)%360-180;const be=Math.max(-90,Math.min(90,j[3]));if(j[2]-j[0]>=360)ee=-180,me=180;else if(ee>me){const We=this.getClusters([ee,ce,180,be],G),Ze=this.getClusters([-180,ce,me,be],G);return We.concat(Ze)}const ve=this.trees[this._limitZoom(G)],pe=ve.range(vn(ee),er(be),vn(me),er(ce)),Te=ve.data,He=[];for(const We of pe){const Ze=this.stride*We;He.push(Te[Ze+yr]>1?ji(Te,Ze,this.clusterProps):this.points[Te[Ze+Lr]])}return He}getChildren(j){const G=this._getOriginId(j),ee=this._getOriginZoom(j),ce="No cluster with the specified id.",me=this.trees[ee];if(!me)throw new Error(ce);const be=me.data;if(G*this.stride>=be.length)throw new Error(ce);const ve=this.options.radius/(this.options.extent*Math.pow(2,ee-1)),pe=me.within(be[G*this.stride],be[G*this.stride+1],ve),Te=[];for(const He of pe){const We=He*this.stride;be[We+4]===j&&Te.push(be[We+yr]>1?ji(be,We,this.clusterProps):this.points[be[We+Lr]])}if(Te.length===0)throw new Error(ce);return Te}getLeaves(j,G,ee){const ce=[];return this._appendLeaves(ce,j,G=G||10,ee=ee||0,0),ce}getTile(j,G,ee){const ce=this.trees[this._limitZoom(j)],me=Math.pow(2,j),{extent:be,radius:ve}=this.options,pe=ve/be,Te=(ee-pe)/me,He=(ee+1+pe)/me,We={features:[]};return this._addTileFeatures(ce.range((G-pe)/me,Te,(G+1+pe)/me,He),ce.data,G,ee,me,We),G===0&&this._addTileFeatures(ce.range(1-pe/me,Te,1,He),ce.data,me,ee,me,We),G===me-1&&this._addTileFeatures(ce.range(0,Te,pe/me,He),ce.data,-1,ee,me,We),We.features.length?We:null}getClusterExpansionZoom(j){let G=this._getOriginZoom(j)-1;for(;G<=this.options.maxZoom;){const ee=this.getChildren(j);if(G++,ee.length!==1)break;j=ee[0].properties.cluster_id}return G}_appendLeaves(j,G,ee,ce,me){const be=this.getChildren(G);for(const ve of be){const pe=ve.properties;if(pe&&pe.cluster?me+pe.point_count<=ce?me+=pe.point_count:me=this._appendLeaves(j,pe.cluster_id,ee,ce,me):me<ce?me++:j.push(ve),j.length===ee)break}return me}_createTree(j){const G=new u.KDBush(j.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ee=0;ee<j.length;ee+=this.stride)G.add(j[ee],j[ee+1]);return G.finish(),G.data=j,G}_addTileFeatures(j,G,ee,ce,me,be){for(const ve of j){const pe=ve*this.stride,Te=G[pe+yr]>1;let He,We,Ze;if(Te)He=jo(G,pe,this.clusterProps),We=G[pe],Ze=G[pe+1];else{const xt=this.points[G[pe+Lr]];He=xt.properties;const[Mt,$t]=xt.geometry.coordinates;We=vn(Mt),Ze=er($t)}const Pt={type:1,geometry:[[Math.round(this.options.extent*(We*me-ee)),Math.round(this.options.extent*(Ze*me-ce))]],tags:He};let Zt;Zt=Te||this.options.generateId?G[pe+Lr]:this.points[G[pe+Lr]].id,Zt!==void 0&&(Pt.id=Zt),be.features.push(Pt)}}_limitZoom(j){return Math.max(this.options.minZoom,Math.min(Math.floor(+j),this.options.maxZoom+1))}_cluster(j,G){const{radius:ee,extent:ce,reduce:me,minPoints:be}=this.options,ve=ee/(ce*Math.pow(2,G)),pe=j.data,Te=[],He=this.stride;for(let We=0;We<pe.length;We+=He){if(pe[We+2]<=G)continue;pe[We+2]=G;const Ze=pe[We],Pt=pe[We+1],Zt=j.within(pe[We],pe[We+1],ve),xt=pe[We+yr];let Mt=xt;for(const $t of Zt){const Kt=$t*He;pe[Kt+2]>G&&(Mt+=pe[Kt+yr])}if(Mt>xt&&Mt>=be){let $t,Kt=Ze*xt,sr=Pt*xt,Br=-1;const Ur=((We/He|0)<<5)+(G+1)+this.points.length;for(const tr of Zt){const an=tr*He;if(pe[an+2]<=G)continue;pe[an+2]=G;const ln=pe[an+yr];Kt+=pe[an]*ln,sr+=pe[an+1]*ln,pe[an+4]=Ur,me&&($t||($t=this._map(pe,We,!0),Br=this.clusterProps.length,this.clusterProps.push($t)),me($t,this._map(pe,an)))}pe[We+4]=Ur,Te.push(Kt/Mt,sr/Mt,1/0,Ur,-1,Mt),me&&Te.push(Br)}else{for(let $t=0;$t<He;$t++)Te.push(pe[We+$t]);if(Mt>1)for(const $t of Zt){const Kt=$t*He;if(!(pe[Kt+2]<=G)){pe[Kt+2]=G;for(let sr=0;sr<He;sr++)Te.push(pe[Kt+sr])}}}}return Te}_getOriginId(j){return j-this.points.length>>5}_getOriginZoom(j){return(j-this.points.length)%32}_map(j,G,ee){if(j[G+yr]>1){const be=this.clusterProps[j[G+Dn]];return ee?Object.assign({},be):be}const ce=this.points[j[G+Lr]].properties,me=this.options.map(ce);return ee&&me===ce?Object.assign({},me):me}}function ji(oe,j,G){return{type:"Feature",id:oe[j+Lr],properties:jo(oe,j,G),geometry:{type:"Point",coordinates:[(ee=oe[j],360*(ee-.5)),so(oe[j+1])]}};var ee}function jo(oe,j,G){const ee=oe[j+yr],ce=ee>=1e4?`${Math.round(ee/1e3)}k`:ee>=1e3?Math.round(ee/100)/10+"k":ee,me=oe[j+Dn],be=me===-1?{}:Object.assign({},G[me]);return Object.assign(be,{cluster:!0,cluster_id:oe[j+Lr],point_count:ee,point_count_abbreviated:ce})}function vn(oe){return oe/360+.5}function er(oe){const j=Math.sin(oe*Math.PI/180),G=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return G<0?0:G>1?1:G}function so(oe){const j=(180-360*oe)*Math.PI/180;return 360*Math.atan(Math.exp(j))/Math.PI-90}function wi(oe,j,G,ee){for(var ce,me=ee,be=G-j>>1,ve=G-j,pe=oe[j],Te=oe[j+1],He=oe[G],We=oe[G+1],Ze=j+3;Ze<G;Ze+=3){var Pt=Ue(oe[Ze],oe[Ze+1],pe,Te,He,We);if(Pt>me)ce=Ze,me=Pt;else if(Pt===me){var Zt=Math.abs(Ze-be);Zt<ve&&(ce=Ze,ve=Zt)}}me>ee&&(ce-j>3&&wi(oe,j,ce,ee),oe[ce+2]=me,G-ce>3&&wi(oe,ce,G,ee))}function Ue(oe,j,G,ee,ce,me){var be=ce-G,ve=me-ee;if(be!==0||ve!==0){var pe=((oe-G)*be+(j-ee)*ve)/(be*be+ve*ve);pe>1?(G=ce,ee=me):pe>0&&(G+=be*pe,ee+=ve*pe)}return(be=oe-G)*be+(ve=j-ee)*ve}function Xn(oe,j,G,ee){var ce={id:oe===void 0?null:oe,type:j,geometry:G,tags:ee,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(me){var be=me.geometry,ve=me.type;if(ve==="Point"||ve==="MultiPoint"||ve==="LineString")Ei(me,be);else if(ve==="Polygon"||ve==="MultiLineString")for(var pe=0;pe<be.length;pe++)Ei(me,be[pe]);else if(ve==="MultiPolygon")for(pe=0;pe<be.length;pe++)for(var Te=0;Te<be[pe].length;Te++)Ei(me,be[pe][Te])}(ce),ce}function Ei(oe,j){for(var G=0;G<j.length;G+=3)oe.minX=Math.min(oe.minX,j[G]),oe.minY=Math.min(oe.minY,j[G+1]),oe.maxX=Math.max(oe.maxX,j[G]),oe.maxY=Math.max(oe.maxY,j[G+1])}function Dt(oe,j,G,ee){if(j.geometry){var ce=j.geometry.coordinates,me=j.geometry.type,be=Math.pow(G.tolerance/((1<<G.maxZoom)*G.extent),2),ve=[],pe=j.id;if(G.promoteId?pe=j.properties[G.promoteId]:G.generateId&&(pe=ee||0),me==="Point")Mr(ce,ve);else if(me==="MultiPoint")for(var Te=0;Te<ce.length;Te++)Mr(ce[Te],ve);else if(me==="LineString")hs(ce,ve,be,!1);else if(me==="MultiLineString"){if(G.lineMetrics){for(Te=0;Te<ce.length;Te++)hs(ce[Te],ve=[],be,!1),oe.push(Xn(pe,"LineString",ve,j.properties));return}ks(ce,ve,be,!1)}else if(me==="Polygon")ks(ce,ve,be,!0);else{if(me!=="MultiPolygon"){if(me==="GeometryCollection"){for(Te=0;Te<j.geometry.geometries.length;Te++)Dt(oe,{id:pe,geometry:j.geometry.geometries[Te],properties:j.properties},G,ee);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Te=0;Te<ce.length;Te++){var He=[];ks(ce[Te],He,be,!0),ve.push(He)}}oe.push(Xn(pe,me,ve,j.properties))}}function Mr(oe,j){j.push(Tn(oe[0])),j.push(ol(oe[1])),j.push(0)}function hs(oe,j,G,ee){for(var ce,me,be=0,ve=0;ve<oe.length;ve++){var pe=Tn(oe[ve][0]),Te=ol(oe[ve][1]);j.push(pe),j.push(Te),j.push(0),ve>0&&(be+=ee?(ce*Te-pe*me)/2:Math.sqrt(Math.pow(pe-ce,2)+Math.pow(Te-me,2))),ce=pe,me=Te}var He=j.length-3;j[2]=1,wi(j,0,He,G),j[He+2]=1,j.size=Math.abs(be),j.start=0,j.end=j.size}function ks(oe,j,G,ee){for(var ce=0;ce<oe.length;ce++){var me=[];hs(oe[ce],me,G,ee),j.push(me)}}function Tn(oe){return oe/360+.5}function ol(oe){var j=Math.sin(oe*Math.PI/180),G=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return G<0?0:G>1?1:G}function tn(oe,j,G,ee,ce,me,be,ve){if(ee/=j,me>=(G/=j)&&be<ee)return oe;if(be<G||me>=ee)return null;for(var pe=[],Te=0;Te<oe.length;Te++){var He=oe[Te],We=He.geometry,Ze=He.type,Pt=ce===0?He.minX:He.minY,Zt=ce===0?He.maxX:He.maxY;if(Pt>=G&&Zt<ee)pe.push(He);else if(!(Zt<G||Pt>=ee)){var xt=[];if(Ze==="Point"||Ze==="MultiPoint")Ls(We,xt,G,ee,ce);else if(Ze==="LineString")ao(We,xt,G,ee,ce,!1,ve.lineMetrics);else if(Ze==="MultiLineString")_n(We,xt,G,ee,ce,!1);else if(Ze==="Polygon")_n(We,xt,G,ee,ce,!0);else if(Ze==="MultiPolygon")for(var Mt=0;Mt<We.length;Mt++){var $t=[];_n(We[Mt],$t,G,ee,ce,!0),$t.length&&xt.push($t)}if(xt.length){if(ve.lineMetrics&&Ze==="LineString"){for(Mt=0;Mt<xt.length;Mt++)pe.push(Xn(He.id,Ze,xt[Mt],He.tags));continue}Ze!=="LineString"&&Ze!=="MultiLineString"||(xt.length===1?(Ze="LineString",xt=xt[0]):Ze="MultiLineString"),Ze!=="Point"&&Ze!=="MultiPoint"||(Ze=xt.length===3?"Point":"MultiPoint"),pe.push(Xn(He.id,Ze,xt,He.tags))}}}return pe.length?pe:null}function Ls(oe,j,G,ee,ce){for(var me=0;me<oe.length;me+=3){var be=oe[me+ce];be>=G&&be<=ee&&(j.push(oe[me]),j.push(oe[me+1]),j.push(oe[me+2]))}}function ao(oe,j,G,ee,ce,me,be){for(var ve,pe,Te=ut(oe),He=ce===0?Si:$i,We=oe.start,Ze=0;Ze<oe.length-3;Ze+=3){var Pt=oe[Ze],Zt=oe[Ze+1],xt=oe[Ze+2],Mt=oe[Ze+3],$t=oe[Ze+4],Kt=ce===0?Pt:Zt,sr=ce===0?Mt:$t,Br=!1;be&&(ve=Math.sqrt(Math.pow(Pt-Mt,2)+Math.pow(Zt-$t,2))),Kt<G?sr>G&&(pe=He(Te,Pt,Zt,Mt,$t,G),be&&(Te.start=We+ve*pe)):Kt>ee?sr<ee&&(pe=He(Te,Pt,Zt,Mt,$t,ee),be&&(Te.start=We+ve*pe)):Jn(Te,Pt,Zt,xt),sr<G&&Kt>=G&&(pe=He(Te,Pt,Zt,Mt,$t,G),Br=!0),sr>ee&&Kt<=ee&&(pe=He(Te,Pt,Zt,Mt,$t,ee),Br=!0),!me&&Br&&(be&&(Te.end=We+ve*pe),j.push(Te),Te=ut(oe)),be&&(We+=ve)}var Ur=oe.length-3;Pt=oe[Ur],Zt=oe[Ur+1],xt=oe[Ur+2],(Kt=ce===0?Pt:Zt)>=G&&Kt<=ee&&Jn(Te,Pt,Zt,xt),Ur=Te.length-3,me&&Ur>=3&&(Te[Ur]!==Te[0]||Te[Ur+1]!==Te[1])&&Jn(Te,Te[0],Te[1],Te[2]),Te.length&&j.push(Te)}function ut(oe){var j=[];return j.size=oe.size,j.start=oe.start,j.end=oe.end,j}function _n(oe,j,G,ee,ce,me){for(var be=0;be<oe.length;be++)ao(oe[be],j,G,ee,ce,me,!1)}function Jn(oe,j,G,ee){oe.push(j),oe.push(G),oe.push(ee)}function Si(oe,j,G,ee,ce,me){var be=(me-j)/(ee-j);return oe.push(me),oe.push(G+(ce-G)*be),oe.push(1),be}function $i(oe,j,G,ee,ce,me){var be=(me-G)/(ce-G);return oe.push(j+(ee-j)*be),oe.push(me),oe.push(1),be}function et(oe,j){for(var G=[],ee=0;ee<oe.length;ee++){var ce,me=oe[ee],be=me.type;if(be==="Point"||be==="MultiPoint"||be==="LineString")ce=Gt(me.geometry,j);else if(be==="MultiLineString"||be==="Polygon"){ce=[];for(var ve=0;ve<me.geometry.length;ve++)ce.push(Gt(me.geometry[ve],j))}else if(be==="MultiPolygon")for(ce=[],ve=0;ve<me.geometry.length;ve++){for(var pe=[],Te=0;Te<me.geometry[ve].length;Te++)pe.push(Gt(me.geometry[ve][Te],j));ce.push(pe)}G.push(Xn(me.id,be,ce,me.tags))}return G}function Gt(oe,j){var G=[];G.size=oe.size,oe.start!==void 0&&(G.start=oe.start,G.end=oe.end);for(var ee=0;ee<oe.length;ee+=3)G.push(oe[ee]+j,oe[ee+1],oe[ee+2]);return G}function jt(oe,j){if(oe.transformed)return oe;var G,ee,ce,me=1<<oe.z,be=oe.x,ve=oe.y;for(G=0;G<oe.features.length;G++){var pe=oe.features[G],Te=pe.geometry,He=pe.type;if(pe.geometry=[],He===1)for(ee=0;ee<Te.length;ee+=2)pe.geometry.push(Nr(Te[ee],Te[ee+1],j,me,be,ve));else for(ee=0;ee<Te.length;ee++){var We=[];for(ce=0;ce<Te[ee].length;ce+=2)We.push(Nr(Te[ee][ce],Te[ee][ce+1],j,me,be,ve));pe.geometry.push(We)}}return oe.transformed=!0,oe}function Nr(oe,j,G,ee,ce,me){return[Math.round(G*(oe*ee-ce)),Math.round(G*(j*ee-me))]}function $o(oe,j,G,ee,ce){for(var me=j===ce.maxZoom?0:ce.tolerance/((1<<j)*ce.extent),be={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:G,y:ee,z:j,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ve=0;ve<oe.length;ve++){be.numFeatures++,Bt(be,oe[ve],me,ce);var pe=oe[ve].minX,Te=oe[ve].minY,He=oe[ve].maxX,We=oe[ve].maxY;pe<be.minX&&(be.minX=pe),Te<be.minY&&(be.minY=Te),He>be.maxX&&(be.maxX=He),We>be.maxY&&(be.maxY=We)}return be}function Bt(oe,j,G,ee){var ce=j.geometry,me=j.type,be=[];if(me==="Point"||me==="MultiPoint")for(var ve=0;ve<ce.length;ve+=3)be.push(ce[ve]),be.push(ce[ve+1]),oe.numPoints++,oe.numSimplified++;else if(me==="LineString")Jr(be,ce,oe,G,!1,!1);else if(me==="MultiLineString"||me==="Polygon")for(ve=0;ve<ce.length;ve++)Jr(be,ce[ve],oe,G,me==="Polygon",ve===0);else if(me==="MultiPolygon")for(var pe=0;pe<ce.length;pe++){var Te=ce[pe];for(ve=0;ve<Te.length;ve++)Jr(be,Te[ve],oe,G,!0,ve===0)}if(be.length){var He=j.tags||null;if(me==="LineString"&&ee.lineMetrics){for(var We in He={},j.tags)He[We]=j.tags[We];He.mapbox_clip_start=ce.start/ce.size,He.mapbox_clip_end=ce.end/ce.size}var Ze={geometry:be,type:me==="Polygon"||me==="MultiPolygon"?3:me==="LineString"||me==="MultiLineString"?2:1,tags:He};j.id!==null&&(Ze.id=j.id),oe.features.push(Ze)}}function Jr(oe,j,G,ee,ce,me){var be=ee*ee;if(ee>0&&j.size<(ce?be:ee))G.numPoints+=j.length/3;else{for(var ve=[],pe=0;pe<j.length;pe+=3)(ee===0||j[pe+2]>be)&&(G.numSimplified++,ve.push(j[pe]),ve.push(j[pe+1])),G.numPoints++;ce&&function(Te,He){for(var We=0,Ze=0,Pt=Te.length,Zt=Pt-2;Ze<Pt;Zt=Ze,Ze+=2)We+=(Te[Ze]-Te[Zt])*(Te[Ze+1]+Te[Zt+1]);if(We>0===He)for(Ze=0,Pt=Te.length;Ze<Pt/2;Ze+=2){var xt=Te[Ze],Mt=Te[Ze+1];Te[Ze]=Te[Pt-2-Ze],Te[Ze+1]=Te[Pt-1-Ze],Te[Pt-2-Ze]=xt,Te[Pt-1-Ze]=Mt}}(ve,me),oe.push(ve)}}function ir(oe,j){var G=(j=this.options=function(ce,me){for(var be in me)ce[be]=me[be];return ce}(Object.create(this.options),j)).debug;if(G&&console.time("preprocess data"),j.maxZoom<0||j.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(j.promoteId&&j.generateId)throw new Error("promoteId and generateId cannot be used together.");var ee=function(ce,me){var be=[];if(ce.type==="FeatureCollection")for(var ve=0;ve<ce.features.length;ve++)Dt(be,ce.features[ve],me,ve);else Dt(be,ce.type==="Feature"?ce:{geometry:ce},me);return be}(oe,j);this.tiles={},this.tileCoords=[],G&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",j.indexMaxZoom,j.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ee=function(ce,me){var be=me.buffer/me.extent,ve=ce,pe=tn(ce,1,-1-be,be,0,-1,2,me),Te=tn(ce,1,1-be,2+be,0,-1,2,me);return(pe||Te)&&(ve=tn(ce,1,-be,1+be,0,-1,2,me)||[],pe&&(ve=et(pe,1).concat(ve)),Te&&(ve=ve.concat(et(Te,-1)))),ve}(ee,j),ee.length&&this.splitTile(ee,0,0,0),G&&(ee.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function lo(oe,j,G){return 32*((1<<oe)*G+j)+oe}function Yn(oe,j){return j?oe.properties[j]:oe.id}function jn(oe,j){if(oe==null)return!0;if(oe.type==="Feature")return Yn(oe,j)!=null;if(oe.type==="FeatureCollection"){const G=new Set;for(const ee of oe.features){const ce=Yn(ee,j);if(ce==null||G.has(ce))return!1;G.add(ce)}return!0}return!1}function Ir(oe,j){const G=new Map;if(oe!=null)if(oe.type==="Feature")G.set(Yn(oe,j),oe);else for(const ee of oe.features)G.set(Yn(ee,j),ee);return G}function Ti(oe,j){const G=oe.tileID.canonical;if(!this._geoJSONIndex)return j(null,null);const ee=this._geoJSONIndex.getTile(G.z,G.x,G.y);if(!ee)return j(null,null);const ce=new class{constructor(be){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=u.EXTENT,this.length=be.length,this._features=be}feature(be){return new class{constructor(ve){this._feature=ve,this.extent=u.EXTENT,this.type=ve.type,this.properties=ve.tags,"id"in ve&&!isNaN(ve.id)&&(this.id=parseInt(ve.id,10))}loadGeometry(){if(this._feature.type===1){const ve=[];for(const pe of this._feature.geometry)ve.push([new u.Point(pe[0],pe[1])]);return ve}{const ve=[];for(const pe of this._feature.geometry){const Te=[];for(const He of pe)Te.push(new u.Point(He[0],He[1]));ve.push(Te)}return ve}}toGeoJSON(ve,pe,Te){return te.call(this,ve,pe,Te)}}(this._features[be])}}(ee.features);let me=Nt(ce);me.byteOffset===0&&me.byteLength===me.buffer.byteLength||(me=new Uint8Array(me)),j(null,{vectorTile:ce,rawData:me.buffer})}ir.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ir.prototype.splitTile=function(oe,j,G,ee,ce,me,be){for(var ve=[oe,j,G,ee],pe=this.options,Te=pe.debug;ve.length;){ee=ve.pop(),G=ve.pop(),j=ve.pop(),oe=ve.pop();var He=1<<j,We=lo(j,G,ee),Ze=this.tiles[We];if(!Ze&&(Te>1&&console.time("creation"),Ze=this.tiles[We]=$o(oe,j,G,ee,pe),this.tileCoords.push({z:j,x:G,y:ee}),Te)){Te>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",j,G,ee,Ze.numFeatures,Ze.numPoints,Ze.numSimplified),console.timeEnd("creation"));var Pt="z"+j;this.stats[Pt]=(this.stats[Pt]||0)+1,this.total++}if(Ze.source=oe,ce){if(j===pe.maxZoom||j===ce)continue;var Zt=1<<ce-j;if(G!==Math.floor(me/Zt)||ee!==Math.floor(be/Zt))continue}else if(j===pe.indexMaxZoom||Ze.numPoints<=pe.indexMaxPoints)continue;if(Ze.source=null,oe.length!==0){Te>1&&console.time("clipping");var xt,Mt,$t,Kt,sr,Br,Ur=.5*pe.buffer/pe.extent,tr=.5-Ur,an=.5+Ur,ln=1+Ur;xt=Mt=$t=Kt=null,sr=tn(oe,He,G-Ur,G+an,0,Ze.minX,Ze.maxX,pe),Br=tn(oe,He,G+tr,G+ln,0,Ze.minX,Ze.maxX,pe),oe=null,sr&&(xt=tn(sr,He,ee-Ur,ee+an,1,Ze.minY,Ze.maxY,pe),Mt=tn(sr,He,ee+tr,ee+ln,1,Ze.minY,Ze.maxY,pe),sr=null),Br&&($t=tn(Br,He,ee-Ur,ee+an,1,Ze.minY,Ze.maxY,pe),Kt=tn(Br,He,ee+tr,ee+ln,1,Ze.minY,Ze.maxY,pe),Br=null),Te>1&&console.timeEnd("clipping"),ve.push(xt||[],j+1,2*G,2*ee),ve.push(Mt||[],j+1,2*G,2*ee+1),ve.push($t||[],j+1,2*G+1,2*ee),ve.push(Kt||[],j+1,2*G+1,2*ee+1)}}},ir.prototype.getTile=function(oe,j,G){var ee=this.options,ce=ee.extent,me=ee.debug;if(oe<0||oe>24)return null;var be=1<<oe,ve=lo(oe,j=(j%be+be)%be,G);if(this.tiles[ve])return jt(this.tiles[ve],ce);me>1&&console.log("drilling down to z%d-%d-%d",oe,j,G);for(var pe,Te=oe,He=j,We=G;!pe&&Te>0;)Te--,He=Math.floor(He/2),We=Math.floor(We/2),pe=this.tiles[lo(Te,He,We)];return pe&&pe.source?(me>1&&console.log("found parent tile z%d-%d-%d",Te,He,We),me>1&&console.time("drilling down"),this.splitTile(pe.source,Te,He,We,oe,j,G),me>1&&console.timeEnd("drilling down"),this.tiles[ve]?jt(this.tiles[ve],ce):null):null};class xr extends H{constructor(j,G,ee,ce){super(j,G,ee,Ti),this._dataUpdateable=new Map,this.loadGeoJSON=(me,be)=>{const{promoteId:ve}=me;if(me.request)return u.getJSON(me.request,(pe,Te,He,We)=>{this._dataUpdateable=jn(Te,ve)?Ir(Te,ve):void 0,be(pe,Te,He,We)});if(typeof me.data=="string")try{const pe=JSON.parse(me.data);this._dataUpdateable=jn(pe,ve)?Ir(pe,ve):void 0,be(null,pe)}catch{be(new Error(`Input data given to '${me.source}' is not a valid GeoJSON object.`))}else me.dataDiff?this._dataUpdateable?(function(pe,Te,He){var We,Ze,Pt,Zt;if(Te.removeAll&&pe.clear(),Te.remove)for(const xt of Te.remove)pe.delete(xt);if(Te.add)for(const xt of Te.add){const Mt=Yn(xt,He);Mt!=null&&pe.set(Mt,xt)}if(Te.update)for(const xt of Te.update){let Mt=pe.get(xt.id);if(Mt==null)continue;const $t=!xt.removeAllProperties&&(((We=xt.removeProperties)===null||We===void 0?void 0:We.length)>0||((Ze=xt.addOrUpdateProperties)===null||Ze===void 0?void 0:Ze.length)>0);if((xt.newGeometry||xt.removeAllProperties||$t)&&(Mt={...Mt},pe.set(xt.id,Mt),$t&&(Mt.properties={...Mt.properties})),xt.newGeometry&&(Mt.geometry=xt.newGeometry),xt.removeAllProperties)Mt.properties={};else if(((Pt=xt.removeProperties)===null||Pt===void 0?void 0:Pt.length)>0)for(const Kt of xt.removeProperties)Object.prototype.hasOwnProperty.call(Mt.properties,Kt)&&delete Mt.properties[Kt];if(((Zt=xt.addOrUpdateProperties)===null||Zt===void 0?void 0:Zt.length)>0)for(const{key:Kt,value:sr}of xt.addOrUpdateProperties)Mt.properties[Kt]=sr}}(this._dataUpdateable,me.dataDiff,ve),be(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):be(new Error(`Cannot update existing geojson data in ${me.source}`)):be(new Error(`Input data given to '${me.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},ce&&(this.loadGeoJSON=ce)}loadData(j,G){var ee;(ee=this._pendingRequest)===null||ee===void 0||ee.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const ce=!!(j&&j.request&&j.request.collectResourceTiming)&&new u.RequestPerformance(j.request);this._pendingCallback=G,this._pendingRequest=this.loadGeoJSON(j,(me,be)=>{if(delete this._pendingCallback,delete this._pendingRequest,me||!be)return G(me);if(typeof be!="object")return G(new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`));{Q(be,!0);try{if(j.filter){const pe=u.createExpression(j.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(pe.result==="error")throw new Error(pe.value.map(He=>`${He.key}: ${He.message}`).join(", "));be={type:"FeatureCollection",features:be.features.filter(He=>pe.value.evaluate({zoom:0},He))}}this._geoJSONIndex=j.cluster?new dn(function({superclusterOptions:pe,clusterProperties:Te}){if(!Te||!pe)return pe;const He={},We={},Ze={accumulated:null,zoom:0},Pt={properties:null},Zt=Object.keys(Te);for(const xt of Zt){const[Mt,$t]=Te[xt],Kt=u.createExpression($t),sr=u.createExpression(typeof Mt=="string"?[Mt,["accumulated"],["get",xt]]:Mt);He[xt]=Kt.value,We[xt]=sr.value}return pe.map=xt=>{Pt.properties=xt;const Mt={};for(const $t of Zt)Mt[$t]=He[$t].evaluate(Ze,Pt);return Mt},pe.reduce=(xt,Mt)=>{Pt.properties=Mt;for(const $t of Zt)Ze.accumulated=xt[$t],xt[$t]=We[$t].evaluate(Ze,Pt)},pe}(j)).load(be.features):function(pe,Te){return new ir(pe,Te)}(be,j.geojsonVtOptions)}catch(pe){return G(pe)}this.loaded={};const ve={};if(ce){const pe=ce.finish();pe&&(ve.resourceTiming={},ve.resourceTiming[j.source]=JSON.parse(JSON.stringify(pe)))}G(null,ve)}})}reloadTile(j,G){const ee=this.loaded;return ee&&ee[j.uid]?super.reloadTile(j,G):this.loadTile(j,G)}removeSource(j,G){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),G()}getClusterExpansionZoom(j,G){try{G(null,this._geoJSONIndex.getClusterExpansionZoom(j.clusterId))}catch(ee){G(ee)}}getClusterChildren(j,G){try{G(null,this._geoJSONIndex.getChildren(j.clusterId))}catch(ee){G(ee)}}getClusterLeaves(j,G){try{G(null,this._geoJSONIndex.getLeaves(j.clusterId,j.limit,j.offset))}catch(ee){G(ee)}}}class bo{constructor(j){this.self=j,this.actor=new u.Actor(j,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:H,geojson:xr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(G,ee)=>{if(this.workerSourceTypes[G])throw new Error(`Worker source with name "${G}" already registered.`);this.workerSourceTypes[G]=ee},this.self.registerRTLTextPlugin=G=>{if(u.plugin.isParsed())throw new Error("RTL text plugin already registered.");u.plugin.applyArabicShaping=G.applyArabicShaping,u.plugin.processBidirectionalText=G.processBidirectionalText,u.plugin.processStyledBidirectionalText=G.processStyledBidirectionalText}}setReferrer(j,G){this.referrer=G}setImages(j,G,ee){this.availableImages[j]=G;for(const ce in this.workerSources[j]){const me=this.workerSources[j][ce];for(const be in me)me[be].availableImages=G}ee()}setLayers(j,G,ee){this.getLayerIndex(j).replace(G),ee()}updateLayers(j,G,ee){this.getLayerIndex(j).update(G.layers,G.removedIds),ee()}loadTile(j,G,ee){this.getWorkerSource(j,G.type,G.source).loadTile(G,ee)}loadDEMTile(j,G,ee){this.getDEMWorkerSource(j,G.source).loadTile(G,ee)}reloadTile(j,G,ee){this.getWorkerSource(j,G.type,G.source).reloadTile(G,ee)}abortTile(j,G,ee){this.getWorkerSource(j,G.type,G.source).abortTile(G,ee)}removeTile(j,G,ee){this.getWorkerSource(j,G.type,G.source).removeTile(G,ee)}removeDEMTile(j,G){this.getDEMWorkerSource(j,G.source).removeTile(G)}removeSource(j,G,ee){if(!this.workerSources[j]||!this.workerSources[j][G.type]||!this.workerSources[j][G.type][G.source])return;const ce=this.workerSources[j][G.type][G.source];delete this.workerSources[j][G.type][G.source],ce.removeSource!==void 0?ce.removeSource(G,ee):ee()}loadWorkerSource(j,G,ee){try{this.self.importScripts(G.url),ee()}catch(ce){ee(ce.toString())}}syncRTLPluginState(j,G,ee){try{u.plugin.setState(G);const ce=u.plugin.getPluginURL();if(u.plugin.isLoaded()&&!u.plugin.isParsed()&&ce!=null){this.self.importScripts(ce);const me=u.plugin.isParsed();ee(me?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ce}`),me)}}catch(ce){ee(ce.toString())}}getAvailableImages(j){let G=this.availableImages[j];return G||(G=[]),G}getLayerIndex(j){let G=this.layerIndexes[j];return G||(G=this.layerIndexes[j]=new E),G}getWorkerSource(j,G,ee){if(this.workerSources[j]||(this.workerSources[j]={}),this.workerSources[j][G]||(this.workerSources[j][G]={}),!this.workerSources[j][G][ee]){const ce={send:(me,be,ve)=>{this.actor.send(me,be,ve,j)}};this.workerSources[j][G][ee]=new this.workerSourceTypes[G](ce,this.getLayerIndex(j),this.getAvailableImages(j))}return this.workerSources[j][G][ee]}getDEMWorkerSource(j,G){return this.demWorkerSources[j]||(this.demWorkerSources[j]={}),this.demWorkerSources[j][G]||(this.demWorkerSources[j][G]=new q),this.demWorkerSources[j][G]}}return u.isWorker()&&(self.worker=new bo(self)),bo}),l(["./shared"],function(u){var E="3.2.0";class m{static testProp(o){if(!m.docStyle)return o[0];for(let h=0;h<o.length;h++)if(o[h]in m.docStyle)return o[h];return o[0]}static create(o,h,p){const v=window.document.createElement(o);return h!==void 0&&(v.className=h),p&&p.appendChild(v),v}static createNS(o,h){return window.document.createElementNS(o,h)}static disableDrag(){m.docStyle&&m.selectProp&&(m.userSelect=m.docStyle[m.selectProp],m.docStyle[m.selectProp]="none")}static enableDrag(){m.docStyle&&m.selectProp&&(m.docStyle[m.selectProp]=m.userSelect)}static setTransform(o,h){o.style[m.transformProp]=h}static addEventListener(o,h,p,v={}){o.addEventListener(h,p,"passive"in v?v:v.capture)}static removeEventListener(o,h,p,v={}){o.removeEventListener(h,p,"passive"in v?v:v.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",m.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",m.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",m.suppressClickInternal,!0)},0)}static mousePos(o,h){const p=o.getBoundingClientRect();return new u.Point(h.clientX-p.left-o.clientLeft,h.clientY-p.top-o.clientTop)}static touchPos(o,h){const p=o.getBoundingClientRect(),v=[];for(let x=0;x<h.length;x++)v.push(new u.Point(h[x].clientX-p.left-o.clientLeft,h[x].clientY-p.top-o.clientTop));return v}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}}m.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,m.selectProp=m.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),m.transformProp=m.testProp(["transform","WebkitTransform"]);const S={supported:!1,testSupport:function(_){!H&&z&&(q?Y(_):M=_)}};let M,z,H=!1,q=!1;function Y(_){const o=_.createTexture();_.bindTexture(_.TEXTURE_2D,o);try{if(_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,z),_.isContextLost())return;S.supported=!0}catch{}_.deleteTexture(o),H=!0}var ye,Q;typeof document<"u"&&(z=document.createElement("img"),z.onload=function(){M&&Y(M),M=null,q=!0},z.onerror=function(){H=!0,M=null},z.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(_){let o,h,p,v;_.resetRequestQueue=()=>{o=[],h=0,p=0,v={}},_.addThrottleControl=O=>{const F=p++;return v[F]=O,F},_.removeThrottleControl=O=>{delete v[O],A()},_.getImage=(O,F,B=!0)=>{S.supported&&(O.headers||(O.headers={}),O.headers.accept="image/webp,*/*");const Z={requestParameters:O,supportImageRefresh:B,callback:F,cancelled:!1,completed:!1,cancel:()=>{Z.completed||Z.cancelled||(Z.cancelled=!0,Z.innerRequest&&(Z.innerRequest.cancel(),h--),A())}};return o.push(Z),A(),Z};const x=O=>{const{requestParameters:F,supportImageRefresh:B,callback:Z}=O;return u.extend(F,{type:"image"}),(B!==!1||u.isWorker()||u.getProtocolAction(F.url)||F.headers&&!Object.keys(F.headers).reduce((ie,re)=>ie&&re==="accept",!0)?u.makeRequest:L)(F,(ie,re,ue,se)=>{P(O,Z,ie,re,ue,se)})},P=(O,F,B,Z,ie,re)=>{B?F(B):Z instanceof HTMLImageElement||Z instanceof ImageBitmap?F(null,Z):Z&&((ue,se)=>{typeof createImageBitmap=="function"?u.arrayBufferToImageBitmap(ue,se):u.arrayBufferToImage(ue,se)})(Z,(ue,se)=>{ue!=null?F(ue):se!=null&&F(null,se,{cacheControl:ie,expires:re})}),O.cancelled||(O.completed=!0,h--,A())},A=()=>{const O=(()=>{const F=Object.keys(v);let B=!1;if(F.length>0){for(const Z of F)if(B=v[Z](),B)break}return B})()?u.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:u.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let F=h;F<O&&o.length>0;F++){const B=o.shift();if(B.cancelled){F--;continue}const Z=x(B);h++,B.innerRequest=Z}},L=(O,F)=>{const B=new Image,Z=O.url;let ie=!1;const re=O.credentials;return re&&re==="include"?B.crossOrigin="use-credentials":(re&&re==="same-origin"||!u.sameOrigin(Z))&&(B.crossOrigin="anonymous"),B.fetchPriority="high",B.onload=()=>{F(null,B),B.onerror=B.onload=null},B.onerror=()=>{ie||F(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),B.onerror=B.onload=null},B.src=Z,{cancel:()=>{ie=!0,B.src=""}}}}(ye||(ye={})),ye.resetRequestQueue(),function(_){_.Glyphs="Glyphs",_.Image="Image",_.Source="Source",_.SpriteImage="SpriteImage",_.SpriteJSON="SpriteJSON",_.Style="Style",_.Tile="Tile",_.Unknown="Unknown"}(Q||(Q={}));class te{constructor(o){this._transformRequestFn=o}transformRequest(o,h){return this._transformRequestFn&&this._transformRequestFn(o,h)||{url:o}}normalizeSpriteURL(o,h,p){const v=function(x){const P=x.match(ne);if(!P)throw new Error(`Unable to parse URL "${x}"`);return{protocol:P[1],authority:P[2],path:P[3]||"/",params:P[4]?P[4].split("&"):[]}}(o);return v.path+=`${h}${p}`,function(x){const P=x.params.length?`?${x.params.join("&")}`:"";return`${x.protocol}://${x.authority}${x.path}${P}`}(v)}setTransformRequest(o){this._transformRequestFn=o}}const ne=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Me(_){var o=new u.ARRAY_TYPE(3);return o[0]=_[0],o[1]=_[1],o[2]=_[2],o}var Ve,je=function(_,o,h){return _[0]=o[0]-h[0],_[1]=o[1]-h[1],_[2]=o[2]-h[2],_};Ve=new u.ARRAY_TYPE(3),u.ARRAY_TYPE!=Float32Array&&(Ve[0]=0,Ve[1]=0,Ve[2]=0);var Qe=function(_){var o=_[0],h=_[1];return o*o+h*h};function ot(_){const o=[];if(typeof _=="string")o.push({id:"default",url:_});else if(_&&_.length>0){const h=[];for(const{id:p,url:v}of _){const x=`${p}${v}`;h.indexOf(x)===-1&&(h.push(x),o.push({id:p,url:v}))}}return o}function Ut(_,o,h,p,v){if(p)return void _(p);if(v!==Object.values(o).length||v!==Object.values(h).length)return;const x={};for(const P in o){x[P]={};const A=u.browser.getImageCanvasContext(h[P]),L=o[P];for(const O in L){const{width:F,height:B,x:Z,y:ie,sdf:re,pixelRatio:ue,stretchX:se,stretchY:xe,content:Le}=L[O];x[P][O]={data:null,pixelRatio:ue,sdf:re,stretchX:se,stretchY:xe,content:Le,spriteData:{width:F,height:B,x:Z,y:ie,context:A}}}}_(null,x)}(function(){var _=new u.ARRAY_TYPE(2);u.ARRAY_TYPE!=Float32Array&&(_[0]=0,_[1]=0)})();class st{constructor(o,h,p,v){this.context=o,this.format=p,this.texture=o.gl.createTexture(),this.update(h,v)}update(o,h,p){const{width:v,height:x}=o,P=!(this.size&&this.size[0]===v&&this.size[1]===x||p),{context:A}=this,{gl:L}=A;if(this.useMipmap=!!(h&&h.useMipmap),L.bindTexture(L.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===L.RGBA&&(!h||h.premultiply!==!1)),P)this.size=[v,x],o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||u.isImageBitmap(o)?L.texImage2D(L.TEXTURE_2D,0,this.format,this.format,L.UNSIGNED_BYTE,o):L.texImage2D(L.TEXTURE_2D,0,this.format,v,x,0,this.format,L.UNSIGNED_BYTE,o.data);else{const{x:O,y:F}=p||{x:0,y:0};o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||u.isImageBitmap(o)?L.texSubImage2D(L.TEXTURE_2D,0,O,F,L.RGBA,L.UNSIGNED_BYTE,o):L.texSubImage2D(L.TEXTURE_2D,0,O,F,v,x,L.RGBA,L.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&L.generateMipmap(L.TEXTURE_2D)}bind(o,h,p){const{context:v}=this,{gl:x}=v;x.bindTexture(x.TEXTURE_2D,this.texture),p!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=x.LINEAR),o!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,o),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,p||o),this.filter=o),h!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,h),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}function Qt(_){const{userImage:o}=_;return!!(o&&o.render&&o.render())&&(_.data.replace(new Uint8Array(o.data.buffer)),!0)}class ar extends u.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:h,callback:p}of this.requestors)this._notify(h,p);this.requestors=[]}}getImage(o){const h=this.images[o];if(h&&!h.data&&h.spriteData){const p=h.spriteData;h.data=new u.RGBAImage({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),h.spriteData=null}return h}addImage(o,h){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,h)&&(this.images[o]=h)}_validate(o,h){let p=!0;const v=h.data||h.spriteData;return this._validateStretch(h.stretchX,v&&v.width)||(this.fire(new u.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),p=!1),this._validateStretch(h.stretchY,v&&v.height)||(this.fire(new u.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),p=!1),this._validateContent(h.content,h)||(this.fire(new u.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),p=!1),p}_validateStretch(o,h){if(!o)return!0;let p=0;for(const v of o){if(v[0]<p||v[1]<v[0]||h<v[1])return!1;p=v[1]}return!0}_validateContent(o,h){if(!o)return!0;if(o.length!==4)return!1;const p=h.spriteData,v=p&&p.width||h.data.width,x=p&&p.height||h.data.height;return!(o[0]<0||v<o[0]||o[1]<0||x<o[1]||o[2]<0||v<o[2]||o[3]<0||x<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,h,p=!0){const v=this.getImage(o);if(p&&(v.data.width!==h.data.width||v.data.height!==h.data.height))throw new Error(`size mismatch between old image (${v.data.width}x${v.data.height}) and new image (${h.data.width}x${h.data.height}).`);h.version=v.version+1,this.images[o]=h,this.updatedImages[o]=!0}removeImage(o){const h=this.images[o];delete this.images[o],delete this.patterns[o],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,h){let p=!0;if(!this.isLoaded())for(const v of o)this.images[v]||(p=!1);this.isLoaded()||p?this._notify(o,h):this.requestors.push({ids:o,callback:h})}_notify(o,h){const p={};for(const v of o){let x=this.getImage(v);x||(this.fire(new u.Event("styleimagemissing",{id:v})),x=this.getImage(v)),x?p[v]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,hasRenderCallback:!!(x.userImage&&x.userImage.render)}:u.warnOnce(`Image "${v}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,p)}getPixelSize(){const{width:o,height:h}=this.atlasImage;return{width:o,height:h}}getPattern(o){const h=this.patterns[o],p=this.getImage(o);if(!p)return null;if(h&&h.position.version===p.version)return h.position;if(h)h.position.version=p.version;else{const v={w:p.data.width+2,h:p.data.height+2,x:0,y:0},x=new u.ImagePosition(v,p);this.patterns[o]={bin:v,position:x}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const h=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new st(o,this.atlasImage,h.RGBA),this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const x in this.patterns)o.push(this.patterns[x].bin);const{w:h,h:p}=u.potpack(o),v=this.atlasImage;v.resize({width:h||1,height:p||1});for(const x in this.patterns){const{bin:P}=this.patterns[x],A=P.x+1,L=P.y+1,O=this.getImage(x).data,F=O.width,B=O.height;u.RGBAImage.copy(O,v,{x:0,y:0},{x:A,y:L},{width:F,height:B}),u.RGBAImage.copy(O,v,{x:0,y:B-1},{x:A,y:L-1},{width:F,height:1}),u.RGBAImage.copy(O,v,{x:0,y:0},{x:A,y:L+B},{width:F,height:1}),u.RGBAImage.copy(O,v,{x:F-1,y:0},{x:A-1,y:L},{width:1,height:B}),u.RGBAImage.copy(O,v,{x:0,y:0},{x:A+F,y:L},{width:1,height:B})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const h of o){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const p=this.getImage(h);p||u.warnOnce(`Image with ID: "${h}" was not found`),Qt(p)&&this.updateImage(h,p)}}}const Xr=1e20;function Tr(_,o,h,p,v,x,P,A,L){for(let O=o;O<o+p;O++)sn(_,h*x+O,x,v,P,A,L);for(let O=h;O<h+v;O++)sn(_,O*x+o,1,p,P,A,L)}function sn(_,o,h,p,v,x,P){x[0]=0,P[0]=-Xr,P[1]=Xr,v[0]=_[o];for(let A=1,L=0,O=0;A<p;A++){v[A]=_[o+A*h];const F=A*A;do{const B=x[L];O=(v[A]-v[B]+F-B*B)/(A-B)/2}while(O<=P[L]&&--L>-1);L++,x[L]=A,P[L]=O,P[L+1]=Xr}for(let A=0,L=0;A<p;A++){for(;P[L+1]<A;)L++;const O=x[L],F=A-O;_[o+A*h]=v[O]+F*F}}class qr{constructor(o,h){this.requestManager=o,this.localIdeographFontFamily=h,this.entries={}}setURL(o){this.url=o}getGlyphs(o,h){const p=[];for(const v in o)for(const x of o[v])p.push({stack:v,id:x});u.asyncAll(p,({stack:v,id:x},P)=>{let A=this.entries[v];A||(A=this.entries[v]={glyphs:{},requests:{},ranges:{}});let L=A.glyphs[x];if(L!==void 0)return void P(null,{stack:v,id:x,glyph:L});if(L=this._tinySDF(A,v,x),L)return A.glyphs[x]=L,void P(null,{stack:v,id:x,glyph:L});const O=Math.floor(x/256);if(256*O>65535)return void P(new Error("glyphs > 65535 not supported"));if(A.ranges[O])return void P(null,{stack:v,id:x,glyph:L});if(!this.url)return void P(new Error("glyphsUrl is not set"));let F=A.requests[O];F||(F=A.requests[O]=[],qr.loadGlyphRange(v,O,this.url,this.requestManager,(B,Z)=>{if(Z){for(const ie in Z)this._doesCharSupportLocalGlyph(+ie)||(A.glyphs[+ie]=Z[+ie]);A.ranges[O]=!0}for(const ie of F)ie(B,Z);delete A.requests[O]})),F.push((B,Z)=>{B?P(B):Z&&P(null,{stack:v,id:x,glyph:Z[x]||null})})},(v,x)=>{if(v)h(v);else if(x){const P={};for(const{stack:A,id:L,glyph:O}of x)(P[A]||(P[A]={}))[L]=O&&{id:O.id,bitmap:O.bitmap.clone(),metrics:O.metrics};h(null,P)}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&(u.unicodeBlockLookup["CJK Unified Ideographs"](o)||u.unicodeBlockLookup["Hangul Syllables"](o)||u.unicodeBlockLookup.Hiragana(o)||u.unicodeBlockLookup.Katakana(o))}_tinySDF(o,h,p){const v=this.localIdeographFontFamily;if(!v||!this._doesCharSupportLocalGlyph(p))return;let x=o.tinySDF;if(!x){let A="400";/bold/i.test(h)?A="900":/medium/i.test(h)?A="500":/light/i.test(h)&&(A="200"),x=o.tinySDF=new qr.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:v,fontWeight:A})}const P=x.draw(String.fromCharCode(p));return{id:p,bitmap:new u.AlphaImage({width:P.width||30,height:P.height||30},P.data),metrics:{width:P.glyphWidth||24,height:P.glyphHeight||24,left:P.glyphLeft||0,top:P.glyphTop-27||-8,advance:P.glyphAdvance||24}}}}qr.loadGlyphRange=function(_,o,h,p,v){const x=256*o,P=x+255,A=p.transformRequest(h.replace("{fontstack}",_).replace("{range}",`${x}-${P}`),Q.Glyphs);u.getArrayBuffer(A,(L,O)=>{if(L)v(L);else if(O){const F={};for(const B of u.parseGlyphPbf(O))F[B.id]=B;v(null,F)}})},qr.TinySDF=class{constructor({fontSize:_=24,buffer:o=3,radius:h=8,cutoff:p=.25,fontFamily:v="sans-serif",fontWeight:x="normal",fontStyle:P="normal"}={}){this.buffer=o,this.cutoff=p,this.radius=h;const A=this.size=_+4*o,L=this._createCanvas(A),O=this.ctx=L.getContext("2d",{willReadFrequently:!0});O.font=`${P} ${x} ${_}px ${v}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(A*A),this.gridInner=new Float64Array(A*A),this.f=new Float64Array(A),this.z=new Float64Array(A+1),this.v=new Uint16Array(A)}_createCanvas(_){const o=document.createElement("canvas");return o.width=o.height=_,o}draw(_){const{width:o,actualBoundingBoxAscent:h,actualBoundingBoxDescent:p,actualBoundingBoxLeft:v,actualBoundingBoxRight:x}=this.ctx.measureText(_),P=Math.ceil(h),A=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-v))),L=Math.min(this.size-this.buffer,P+Math.ceil(p)),O=A+2*this.buffer,F=L+2*this.buffer,B=Math.max(O*F,0),Z=new Uint8ClampedArray(B),ie={data:Z,width:O,height:F,glyphWidth:A,glyphHeight:L,glyphTop:P,glyphLeft:0,glyphAdvance:o};if(A===0||L===0)return ie;const{ctx:re,buffer:ue,gridInner:se,gridOuter:xe}=this;re.clearRect(ue,ue,A,L),re.fillText(_,ue,ue+P);const Le=re.getImageData(ue,ue,A,L);xe.fill(Xr,0,B),se.fill(0,0,B);for(let he=0;he<L;he++)for(let Ae=0;Ae<A;Ae++){const ze=Le.data[4*(he*A+Ae)+3]/255;if(ze===0)continue;const Ge=(he+ue)*O+Ae+ue;if(ze===1)xe[Ge]=0,se[Ge]=Xr;else{const qe=.5-ze;xe[Ge]=qe>0?qe*qe:0,se[Ge]=qe<0?qe*qe:0}}Tr(xe,0,0,O,F,O,this.f,this.v,this.z),Tr(se,ue,ue,A,L,O,this.f,this.v,this.z);for(let he=0;he<B;he++){const Ae=Math.sqrt(xe[he])-Math.sqrt(se[he]);Z[he]=Math.round(255-255*(Ae/this.radius+this.cutoff))}return ie}};class Un{constructor(){this.specification=u.v8Spec.light.position}possiblyEvaluate(o,h){return u.sphericalToCartesian(o.expression.evaluate(h))}interpolate(o,h,p){return{x:u.interpolate.number(o.x,h.x,p),y:u.interpolate.number(o.y,h.y,p),z:u.interpolate.number(o.z,h.z,p)}}}let pt,Nt;class mt extends u.Evented{constructor(o){super(),pt=pt||new u.Properties({anchor:new u.DataConstantProperty(u.v8Spec.light.anchor),position:new Un,color:new u.DataConstantProperty(u.v8Spec.light.color),intensity:new u.DataConstantProperty(u.v8Spec.light.intensity)}),this._transitionable=new u.Transitionable(pt),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,h={}){if(!this._validate(u.validateLight,o,h))for(const p in o){const v=o[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),v):this._transitionable.setValue(p,v)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,h,p){return(!p||p.validate!==!1)&&u.emitValidationErrors(this,o.call(u.validateStyle,u.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:u.v8Spec})))}}class gr{constructor(o,h){this.width=o,this.height=h,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,h){const p=o.join(",")+String(h);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(o,h)),this.dashEntry[p]}getDashRanges(o,h,p){const v=[];let x=o.length%2==1?-o[o.length-1]*p:0,P=o[0]*p,A=!0;v.push({left:x,right:P,isDash:A,zeroLength:o[0]===0});let L=o[0];for(let O=1;O<o.length;O++){A=!A;const F=o[O];x=L*p,L+=F,P=L*p,v.push({left:x,right:P,isDash:A,zeroLength:F===0})}return v}addRoundDash(o,h,p){const v=h/2;for(let x=-p;x<=p;x++){const P=this.width*(this.nextRow+p+x);let A=0,L=o[A];for(let O=0;O<this.width;O++){O/L.right>1&&(L=o[++A]);const F=Math.abs(O-L.left),B=Math.abs(O-L.right),Z=Math.min(F,B);let ie;const re=x/p*(v+1);if(L.isDash){const ue=v-Math.abs(re);ie=Math.sqrt(Z*Z+ue*ue)}else ie=v-Math.sqrt(Z*Z+re*re);this.data[P+O]=Math.max(0,Math.min(255,ie+128))}}}addRegularDash(o){for(let A=o.length-1;A>=0;--A){const L=o[A],O=o[A+1];L.zeroLength?o.splice(A,1):O&&O.isDash===L.isDash&&(O.left=L.left,o.splice(A,1))}const h=o[0],p=o[o.length-1];h.isDash===p.isDash&&(h.left=p.left-this.width,p.right=h.right+this.width);const v=this.width*this.nextRow;let x=0,P=o[x];for(let A=0;A<this.width;A++){A/P.right>1&&(P=o[++x]);const L=Math.abs(A-P.left),O=Math.abs(A-P.right),F=Math.min(L,O);this.data[v+A]=Math.max(0,Math.min(255,(P.isDash?F:-F)+128))}}addDash(o,h){const p=h?7:0,v=2*p+1;if(this.nextRow+v>this.height)return u.warnOnce("LineAtlas out of space"),null;let x=0;for(let A=0;A<o.length;A++)x+=o[A];if(x!==0){const A=this.width/x,L=this.getDashRanges(o,this.width,A);h?this.addRoundDash(L,A,p):this.addRegularDash(L)}const P={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:x};return this.nextRow+=v,this.dirty=!0,P}bind(o){const h=o.gl;this.texture?(h.bindTexture(h.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,h.texSubImage2D(h.TEXTURE_2D,0,0,0,this.width,this.height,h.ALPHA,h.UNSIGNED_BYTE,this.data))):(this.texture=h.createTexture(),h.bindTexture(h.TEXTURE_2D,this.texture),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texImage2D(h.TEXTURE_2D,0,h.ALPHA,this.width,this.height,0,h.ALPHA,h.UNSIGNED_BYTE,this.data))}}class Ar{constructor(o,h,p){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=p;const v=this.workerPool.acquire(p);for(let x=0;x<v.length;x++){const P=new Ar.Actor(v[x],h,p);P.name=`Worker ${x}`,this.actors.push(P)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,h,p){u.asyncAll(this.actors,(v,x)=>{v.send(o,h,x)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(h=>{h.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}}function Lr(_,o,h){const p=function(v,x){if(v)return h(v);if(x){const P=u.pick(u.extend(x,_),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);x.vector_layers&&(P.vectorLayers=x.vector_layers,P.vectorLayerIds=P.vectorLayers.map(A=>A.id)),h(null,P)}};return _.url?u.getJSON(o.transformRequest(_.url,Q.Source),p):u.browser.frame(()=>p(null,_))}Ar.Actor=u.Actor;class yr{constructor(o,h){o&&(h?this.setSouthWest(o).setNorthEast(h):Array.isArray(o)&&(o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof u.LngLat?new u.LngLat(o.lng,o.lat):u.LngLat.convert(o),this}setSouthWest(o){return this._sw=o instanceof u.LngLat?new u.LngLat(o.lng,o.lat):u.LngLat.convert(o),this}extend(o){const h=this._sw,p=this._ne;let v,x;if(o instanceof u.LngLat)v=o,x=o;else{if(!(o instanceof yr))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(yr.convert(o)):this.extend(u.LngLat.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(u.LngLat.convert(o)):this;if(v=o._sw,x=o._ne,!v||!x)return this}return h||p?(h.lng=Math.min(v.lng,h.lng),h.lat=Math.min(v.lat,h.lat),p.lng=Math.max(x.lng,p.lng),p.lat=Math.max(x.lat,p.lat)):(this._sw=new u.LngLat(v.lng,v.lat),this._ne=new u.LngLat(x.lng,x.lat)),this}getCenter(){return new u.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new u.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new u.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:h,lat:p}=u.LngLat.convert(o);let v=this._sw.lng<=h&&h<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=h&&h>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&v}static convert(o){return o instanceof yr?o:o&&new yr(o)}static fromLngLat(o,h=0){const p=360*h/40075017,v=p/Math.cos(Math.PI/180*o.lat);return new yr(new u.LngLat(o.lng-v,o.lat-p),new u.LngLat(o.lng+v,o.lat+p))}}class Dn{constructor(o,h,p){this.bounds=yr.convert(this.validateBounds(o)),this.minzoom=h||0,this.maxzoom=p||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const h=Math.pow(2,o.z),p=Math.floor(u.mercatorXfromLng(this.bounds.getWest())*h),v=Math.floor(u.mercatorYfromLat(this.bounds.getNorth())*h),x=Math.ceil(u.mercatorXfromLng(this.bounds.getEast())*h),P=Math.ceil(u.mercatorYfromLat(this.bounds.getSouth())*h);return o.x>=p&&o.x<x&&o.y>=v&&o.y<P}}class dn extends u.Evented{constructor(o,h,p,v){if(super(),this.load=()=>{this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Lr(this._options,this.map._requestManager,(x,P)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),x?this.fire(new u.ErrorEvent(x)):P&&(u.extend(this,P),P.bounds&&(this.tileBounds=new Dn(P.bounds,this.minzoom,this.maxzoom)),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>u.extend({},this._options),this.id=o,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.extend(this,u.pick(h,["url","scheme","tileSize","promoteId"])),this._options=u.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v)}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(o,h){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),v={request:this.map._requestManager.transformRequest(p,Q.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function x(P,A){return delete o.request,o.aborted?h(null):P&&P.status!==404?h(P):(A&&A.resourceTiming&&(o.resourceTiming=A.resourceTiming),this.map._refreshExpiredTiles&&A&&o.setExpiryData(A),o.loadVectorData(A,this.map.painter),h(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}v.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=h:o.request=o.actor.send("reloadTile",v,x.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",v,x.bind(this)))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class ji extends u.Evented{constructor(o,h,p,v){super(),this.id=o,this.dispatcher=p,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.extend({type:"raster"},h),u.extend(this,u.pick(h,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Lr(this._options,this.map._requestManager,(o,h)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new u.ErrorEvent(o)):h&&(u.extend(this,h),h.bounds&&(this.tileBounds=new Dn(h.bounds,this.minzoom,this.maxzoom)),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return u.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,h){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.request=ye.getImage(this.map._requestManager.transformRequest(p,Q.Tile),(v,x,P)=>{if(delete o.request,o.aborted)o.state="unloaded",h(null);else if(v)o.state="errored",h(v);else if(x){this.map._refreshExpiredTiles&&P&&o.setExpiryData(P);const A=this.map.painter.context,L=A.gl;o.texture=this.map.painter.getTileTexture(x.width),o.texture?o.texture.update(x,{useMipmap:!0}):(o.texture=new st(A,x,L.RGBA,{useMipmap:!0}),o.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),A.extTextureFilterAnisotropic&&L.texParameterf(L.TEXTURE_2D,A.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,A.extTextureFilterAnisotropicMax)),o.state="loaded",h(null)}},this.map._refreshExpiredTiles)}abortTile(o,h){o.request&&(o.request.cancel(),delete o.request),h()}unloadTile(o,h){o.texture&&this.map.painter.saveTileTexture(o.texture),h()}hasTransition(){return!1}}class jo extends ji{constructor(o,h,p,v){super(o,h,p,v),this.type="raster-dem",this.maxzoom=22,this._options=u.extend({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(o,h){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function v(x,P){x&&(o.state="errored",h(x)),P&&(o.dem=P,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded",h(null))}o.request=ye.getImage(this.map._requestManager.transformRequest(p,Q.Tile),(function(x,P){if(delete o.request,o.aborted)o.state="unloaded",h(null);else if(x)o.state="errored",h(x);else if(P){this.map._refreshExpiredTiles&&o.setExpiryData(P),delete P.cacheControl,delete P.expires;const A=u.isImageBitmap(P)&&(Nt==null&&(Nt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Nt)?P:u.browser.getImageData(P,1),L={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:A,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",L,v.bind(this)))}}).bind(this),this.map._refreshExpiredTiles),o.neighboringTiles=this._getNeighboringTiles(o.tileID)}_getNeighboringTiles(o){const h=o.canonical,p=Math.pow(2,h.z),v=(h.x-1+p)%p,x=h.x===0?o.wrap-1:o.wrap,P=(h.x+1+p)%p,A=h.x+1===p?o.wrap+1:o.wrap,L={};return L[new u.OverscaledTileID(o.overscaledZ,x,h.z,v,h.y).key]={backfilled:!1},L[new u.OverscaledTileID(o.overscaledZ,A,h.z,P,h.y).key]={backfilled:!1},h.y>0&&(L[new u.OverscaledTileID(o.overscaledZ,x,h.z,v,h.y-1).key]={backfilled:!1},L[new u.OverscaledTileID(o.overscaledZ,o.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},L[new u.OverscaledTileID(o.overscaledZ,A,h.z,P,h.y-1).key]={backfilled:!1}),h.y+1<p&&(L[new u.OverscaledTileID(o.overscaledZ,x,h.z,v,h.y+1).key]={backfilled:!1},L[new u.OverscaledTileID(o.overscaledZ,o.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},L[new u.OverscaledTileID(o.overscaledZ,A,h.z,P,h.y+1).key]={backfilled:!1}),L}unloadTile(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})}}class vn extends u.Evented{constructor(o,h,p,v){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>u.extend({},this._options,{type:this.type,data:this._data}),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=p.getActor(),this.setEventedParent(v),this._data=h.data,this._options=u.extend({},h),this._collectResourceTiming=h.collectResourceTiming,h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const x=u.EXTENT/this.tileSize;this.workerOptions=u.extend({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*x,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*x,extent:u.EXTENT,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:u.EXTENT,radius:(h.clusterRadius||50)*x,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData(),this}updateData(o){return this._updateWorkerData(o),this}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o&&(o.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=o.clusterRadius),o.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=o.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(o,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},h),this}getClusterChildren(o,h){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},h),this}getClusterLeaves(o,h,p,v){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:h,offset:p},v),this}_updateWorkerData(o){const h=u.extend({},this.workerOptions);o?h.dataDiff=o:typeof this._data=="string"?(h.request=this.map._requestManager.transformRequest(u.browser.resolveURL(this._data),Q.Source),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new u.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,h,(p,v)=>{if(this._pendingLoads--,this._removed||v&&v.abandoned)return void this.fire(new u.Event("dataabort",{dataType:"source"}));let x=null;if(v&&v.resourceTiming&&v.resourceTiming[this.id]&&(x=v.resourceTiming[this.id].slice(0)),p)return void this.fire(new u.ErrorEvent(p));const P={dataType:"source"};this._collectResourceTiming&&x&&x.length>0&&u.extend(P,{resourceTiming:x}),this.fire(new u.Event("data",{...P,sourceDataType:"metadata"})),this.fire(new u.Event("data",{...P,sourceDataType:"content"}))})}loaded(){return this._pendingLoads===0}loadTile(o,h){const p=o.actor?"reloadTile":"loadTile";o.actor=this.actor;const v={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};o.request=this.actor.send(p,v,(x,P)=>(delete o.request,o.unloadVectorData(),o.aborted?h(null):x?h(x):(o.loadVectorData(P,this.map.painter,p==="reloadTile"),h(null))))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0}unloadTile(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var er=u.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class so extends u.Evented{constructor(o,h,p,v){super(),this.load=(x,P)=>{this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=ye.getImage(this.map._requestManager.transformRequest(this.url,Q.Image),(A,L)=>{this._request=null,this._loaded=!0,A?this.fire(new u.ErrorEvent(A)):L&&(this.image=L,x&&(this.coordinates=x),P&&P(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const x=this.map.painter.context,P=x.gl;this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,er.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new st(x,this.image,P.RGBA),this.texture.bind(P.LINEAR,P.CLAMP_TO_EDGE));let A=!1;for(const L in this.tiles){const O=this.tiles[L];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture,A=!0)}A&&this.fire(new u.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=o,this.dispatcher=p,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=h}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=o.url,this.load(o.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(o){this.coordinates=o;const h=o.map(u.MercatorCoordinate.fromLngLat);this.tileID=function(v){let x=1/0,P=1/0,A=-1/0,L=-1/0;for(const Z of v)x=Math.min(x,Z.x),P=Math.min(P,Z.y),A=Math.max(A,Z.x),L=Math.max(L,Z.y);const O=Math.max(A-x,L-P),F=Math.max(0,Math.floor(-Math.log(O)/Math.LN2)),B=Math.pow(2,F);return new u.CanonicalTileID(F,Math.floor((x+A)/2*B),Math.floor((P+L)/2*B))}(h),this.minzoom=this.maxzoom=this.tileID.z;const p=h.map(v=>this.tileID.getTilePoint(v)._round());return this._boundsArray=new u.RasterBoundsArray,this._boundsArray.emplaceBack(p[0].x,p[0].y,0,0),this._boundsArray.emplaceBack(p[1].x,p[1].y,u.EXTENT,0),this._boundsArray.emplaceBack(p[3].x,p[3].y,0,u.EXTENT),this._boundsArray.emplaceBack(p[2].x,p[2].y,u.EXTENT,u.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(o,h){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},h(null)):(o.state="errored",h(null))}hasTransition(){return!1}}class wi extends so{constructor(o,h,p,v){super(o,h,p,v),this.load=()=>{this._loaded=!1;const x=this.options;this.urls=[];for(const P of x.urls)this.urls.push(this.map._requestManager.transformRequest(P,Q.Source).url);u.getVideo(this.urls,(P,A)=>{this._loaded=!0,P?this.fire(new u.ErrorEvent(P)):A&&(this.video=A,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const x=this.map.painter.context,P=x.gl;this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,er.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(P.LINEAR,P.CLAMP_TO_EDGE),P.texSubImage2D(P.TEXTURE_2D,0,0,0,P.RGBA,P.UNSIGNED_BYTE,this.video)):(this.texture=new st(x,this.video,P.RGBA),this.texture.bind(P.LINEAR,P.CLAMP_TO_EDGE));let A=!1;for(const L in this.tiles){const O=this.tiles[L];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture,A=!0)}A&&this.fire(new u.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=h}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const h=this.video.seekable;o<h.start(0)||o>h.end(0)?this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class Ue extends so{constructor(o,h,p,v){super(o,h,p,v),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let x=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,x=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,x=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const P=this.map.painter.context,A=P.gl;this.boundsBuffer||(this.boundsBuffer=P.createVertexBuffer(this._boundsArray,er.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(x||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new st(P,this.canvas,A.RGBA,{premultiply:!0});let L=!1;for(const O in this.tiles){const F=this.tiles[O];F.state!=="loaded"&&(F.state="loaded",F.texture=this.texture,L=!0)}L&&this.fire(new u.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(P=>typeof P!="number"))||this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${o}`,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof HTMLCanvasElement||this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${o}`,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const Xn={},Ei=_=>{switch(_){case"geojson":return vn;case"image":return so;case"raster":return ji;case"raster-dem":return jo;case"vector":return dn;case"video":return wi;case"canvas":return Ue}return Xn[_]};function Dt(_,o){const h=u.create();return u.translate(h,h,[1,1,0]),u.scale(h,h,[.5*_.width,.5*_.height,1]),u.multiply(h,h,_.calculatePosMatrix(o.toUnwrapped()))}function Mr(_,o,h,p,v,x){const P=function(B,Z,ie){if(B)for(const re of B){const ue=Z[re];if(ue&&ue.source===ie&&ue.type==="fill-extrusion")return!0}else for(const re in Z){const ue=Z[re];if(ue.source===ie&&ue.type==="fill-extrusion")return!0}return!1}(v&&v.layers,o,_.id),A=x.maxPitchScaleFactor(),L=_.tilesIn(p,A,P);L.sort(hs);const O=[];for(const B of L)O.push({wrappedTileID:B.tileID.wrapped().key,queryResults:B.tile.queryRenderedFeatures(o,h,_._state,B.queryGeometry,B.cameraQueryGeometry,B.scale,v,x,A,Dt(_.transform,B.tileID))});const F=function(B){const Z={},ie={};for(const re of B){const ue=re.queryResults,se=re.wrappedTileID,xe=ie[se]=ie[se]||{};for(const Le in ue){const he=ue[Le],Ae=xe[Le]=xe[Le]||{},ze=Z[Le]=Z[Le]||[];for(const Ge of he)Ae[Ge.featureIndex]||(Ae[Ge.featureIndex]=!0,ze.push(Ge))}}return Z}(O);for(const B in F)F[B].forEach(Z=>{const ie=Z.feature,re=_.getFeatureState(ie.layer["source-layer"],ie.id);ie.source=ie.layer.source,ie.layer["source-layer"]&&(ie.sourceLayer=ie.layer["source-layer"]),ie.state=re});return F}function hs(_,o){const h=_.tileID,p=o.tileID;return h.overscaledZ-p.overscaledZ||h.canonical.y-p.canonical.y||h.wrap-p.wrap||h.canonical.x-p.canonical.x}class ks{constructor(o,h){this.timeAdded=0,this.fadeEndTime=0,this.tileID=o,this.uid=u.uniqueId(),this.uses=0,this.tileSize=h,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const h=o+this.timeAdded;h<this.fadeEndTime||(this.fadeEndTime=h)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,h,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(v,x){const P={};if(!x)return P;for(const A of v){const L=A.layerIds.map(O=>x.getLayer(O)).filter(Boolean);if(L.length!==0){A.layers=L,A.stateDependentLayerIds&&(A.stateDependentLayers=A.stateDependentLayerIds.map(O=>L.filter(F=>F.id===O)[0]));for(const O of L)P[O.id]=A}}return P}(o.buckets,h.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const x=this.buckets[v];if(x instanceof u.SymbolBucket){if(this.hasSymbolBuckets=!0,!p)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const x=this.buckets[v];if(x instanceof u.SymbolBucket&&x.hasRTLText){this.hasRTLText=!0,u.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const v in this.buckets){const x=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,h.style.getLayer(v).queryRadius(x))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new u.CollisionBoxArray}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const p in this.buckets){const v=this.buckets[p];v.uploadPending()&&v.upload(o)}const h=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new st(o,this.imageAtlas.image,h.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new st(o,this.glyphAtlasImage,h.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,h,p,v,x,P,A,L,O,F){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:x,scale:P,tileSize:this.tileSize,pixelPosMatrix:F,transform:L,params:A,queryPadding:this.queryPadding*O},o,h,p):{}}querySourceFeatures(o,h){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const v=p.loadVTLayers(),x=h&&h.sourceLayer?h.sourceLayer:"",P=v._geojsonTileLayer||v[x];if(!P)return;const A=u.createFilter(h&&h.filter),{z:L,x:O,y:F}=this.tileID.canonical,B={z:L,x:O,y:F};for(let Z=0;Z<P.length;Z++){const ie=P.feature(Z);if(A.needGeometry){const se=u.toEvaluationFeature(ie,!0);if(!A.filter(new u.EvaluationParameters(this.tileID.overscaledZ),se,this.tileID.canonical))continue}else if(!A.filter(new u.EvaluationParameters(this.tileID.overscaledZ),ie))continue;const re=p.getId(ie,x),ue=new u.GeoJSONFeature(ie,L,O,F,re);ue.tile=B,o.push(ue)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const h=this.expirationTime;if(o.cacheControl){const p=u.parseCacheControl(o.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const p=Date.now();let v=!1;if(this.expirationTime>p)v=!1;else if(h)if(this.expirationTime<h)v=!0;else{const x=this.expirationTime-h;x?this.expirationTime=p+Math.max(x,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,h){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const p=this.latestFeatureIndex.loadVTLayers();for(const v in this.buckets){if(!h.style.hasLayer(v))continue;const x=this.buckets[v],P=x.layers[0].sourceLayer||"_geojsonTileLayer",A=p[P],L=o[P];if(!A||!L||Object.keys(L).length===0)continue;x.update(L,A,this.imageAtlas&&this.imageAtlas.patternPositions||{});const O=h&&h.style&&h.style.getLayer(v);O&&(this.queryPadding=Math.max(this.queryPadding,O.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<u.browser.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=u.browser.now()+o}setDependencies(o,h){const p={};for(const v of h)p[v]=!0;this.dependencies[o]=p}hasDependency(o,h){for(const p of o){const v=this.dependencies[p];if(v){for(const x of h)if(v[x])return!0}}return!1}}class Tn{constructor(o,h){this.max=o,this.onRemove=h,this.reset()}reset(){for(const o in this.data)for(const h of this.data[o])h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value);return this.data={},this.order=[],this}add(o,h,p){const v=o.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const x={value:h,timeout:void 0};if(p!==void 0&&(x.timeout=setTimeout(()=>{this.remove(o,x)},p)),this.data[v].push(x),this.order.push(v),this.order.length>this.max){const P=this._getAndRemoveByKey(this.order[0]);P&&this.onRemove(P)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const h=this.data[o].shift();return h.timeout&&clearTimeout(h.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),h.value}getByKey(o){const h=this.data[o];return h?h[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,h){if(!this.has(o))return this;const p=o.wrapped().key,v=h===void 0?0:this.data[p].indexOf(h),x=this.data[p][v];return this.data[p].splice(v,1),x.timeout&&clearTimeout(x.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(x.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}filter(o){const h=[];for(const p in this.data)for(const v of this.data[p])o(v.value)||h.push(v);for(const p of h)this.remove(p.value.tileID,p)}}class ol{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,h,p){const v=String(h);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][v]=this.stateChanges[o][v]||{},u.extend(this.stateChanges[o][v],p),this.deletedStates[o]===null){this.deletedStates[o]={};for(const x in this.state[o])x!==v&&(this.deletedStates[o][x]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][v]===null){this.deletedStates[o][v]={};for(const x in this.state[o][v])p[x]||(this.deletedStates[o][v][x]=null)}else for(const x in p)this.deletedStates[o]&&this.deletedStates[o][v]&&this.deletedStates[o][v][x]===null&&delete this.deletedStates[o][v][x]}removeFeatureState(o,h,p){if(this.deletedStates[o]===null)return;const v=String(h);if(this.deletedStates[o]=this.deletedStates[o]||{},p&&h!==void 0)this.deletedStates[o][v]!==null&&(this.deletedStates[o][v]=this.deletedStates[o][v]||{},this.deletedStates[o][v][p]=null);else if(h!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][v])for(p in this.deletedStates[o][v]={},this.stateChanges[o][v])this.deletedStates[o][v][p]=null;else this.deletedStates[o][v]=null;else this.deletedStates[o]=null}getState(o,h){const p=String(h),v=u.extend({},(this.state[o]||{})[p],(this.stateChanges[o]||{})[p]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const x=this.deletedStates[o][h];if(x===null)return{};for(const P in x)delete v[P]}return v}initializeTileState(o,h){o.setFeatureState(this.state,h)}coalesceChanges(o,h){const p={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const x={};for(const P in this.stateChanges[v])this.state[v][P]||(this.state[v][P]={}),u.extend(this.state[v][P],this.stateChanges[v][P]),x[P]=this.state[v][P];p[v]=x}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const x={};if(this.deletedStates[v]===null)for(const P in this.state[v])x[P]={},this.state[v][P]={};else for(const P in this.deletedStates[v]){if(this.deletedStates[v][P]===null)this.state[v][P]={};else for(const A of Object.keys(this.deletedStates[v][P]))delete this.state[v][P][A];x[P]=this.state[v][P]}p[v]=p[v]||{},u.extend(p[v],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const v in o)o[v].setFeatureState(p,h)}}class tn extends u.Evented{constructor(o,h,p){super(),this.id=o,this.dispatcher=p,this.on("data",v=>{v.dataType==="source"&&v.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&v.dataType==="source"&&v.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((v,x,P,A)=>{const L=new(Ei(x.type))(v,x,P,A);if(L.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${L.id}`);return L})(o,h,p,this),this._tiles={},this._cache=new Tn(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ol,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o in this._tiles){const h=this._tiles[o];if(h.state!=="loaded"&&h.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,h){return this._source.loadTile(o,h)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){this._source.abortTile&&this._source.abortTile(o,()=>{}),this._source.fire(new u.Event("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const h in this._tiles){const p=this._tiles[h];p.upload(o),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(Ls).map(o=>o.key)}getRenderableIds(o){const h=[];for(const p in this._tiles)this._isIdRenderable(p,o)&&h.push(this._tiles[p]);return o?h.sort((p,v)=>{const x=p.tileID,P=v.tileID,A=new u.Point(x.canonical.x,x.canonical.y)._rotate(this.transform.angle),L=new u.Point(P.canonical.x,P.canonical.y)._rotate(this.transform.angle);return x.overscaledZ-P.overscaledZ||L.y-A.y||L.x-A.x}).map(p=>p.tileID.key):h.map(p=>p.tileID).sort(Ls).map(p=>p.key)}hasRenderableParent(o){const h=this.findLoadedParent(o,0);return!!h&&this._isIdRenderable(h.tileID.key)}_isIdRenderable(o,h){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(h||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")}}_reloadTile(o,h){const p=this._tiles[o];p&&(p.state!=="loading"&&(p.state=h),this._loadTile(p,this._tileLoaded.bind(this,p,o,h)))}_tileLoaded(o,h,p,v){if(v)return o.state="errored",void(v.status!==404?this._source.fire(new u.ErrorEvent(v,{tile:o})):this.update(this.transform,this.terrain));o.timeAdded=u.browser.now(),p==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(h,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new u.Event("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const h=this.getRenderableIds();for(let v=0;v<h.length;v++){const x=h[v];if(o.neighboringTiles&&o.neighboringTiles[x]){const P=this.getTileByID(x);p(o,P),p(P,o)}}function p(v,x){v.needsHillshadePrepare=!0,v.needsTerrainPrepare=!0;let P=x.tileID.canonical.x-v.tileID.canonical.x;const A=x.tileID.canonical.y-v.tileID.canonical.y,L=Math.pow(2,v.tileID.canonical.z),O=x.tileID.key;P===0&&A===0||Math.abs(A)>1||(Math.abs(P)>1&&(Math.abs(P+L)===1?P+=L:Math.abs(P-L)===1&&(P-=L)),x.dem&&v.dem&&(v.dem.backfillBorder(x.dem,P,A),v.neighboringTiles&&v.neighboringTiles[O]&&(v.neighboringTiles[O].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,h,p,v){for(const x in this._tiles){let P=this._tiles[x];if(v[x]||!P.hasData()||P.tileID.overscaledZ<=h||P.tileID.overscaledZ>p)continue;let A=P.tileID;for(;P&&P.tileID.overscaledZ>h+1;){const O=P.tileID.scaledTo(P.tileID.overscaledZ-1);P=this._tiles[O.key],P&&P.hasData()&&(A=O)}let L=A;for(;L.overscaledZ>h;)if(L=L.scaledTo(L.overscaledZ-1),o[L.key]){v[A.key]=A;break}}}findLoadedParent(o,h){if(o.key in this._loadedParentTiles){const p=this._loadedParentTiles[o.key];return p&&p.tileID.overscaledZ>=h?p:null}for(let p=o.overscaledZ-1;p>=h;p--){const v=o.scaledTo(p),x=this._getLoadedTile(v);if(x)return x}}_getLoadedTile(o){const h=this._tiles[o.key];return h&&h.hasData()?h:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const h=Math.ceil(o.width/this._source.tileSize)+1,p=Math.ceil(o.height/this._source.tileSize)+1,v=Math.floor(h*p*(this._maxTileCacheZoomLevels===null?u.config.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(x)}handleWrapJump(o){const h=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,h){const p={};for(const v in this._tiles){const x=this._tiles[v];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+h),p[x.tileID.key]=x}this._tiles=p;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(v,this._tiles[v])}}update(o,h){if(this.transform=o,this.terrain=h,!this._sourceLoaded||this._paused)return;let p;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(F=>new u.OverscaledTileID(F.canonical.z,F.wrap,F.canonical.z,F.canonical.x,F.canonical.y)):(p=o.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:h}),this._source.hasTile&&(p=p.filter(F=>this._source.hasTile(F)))):p=[];const v=o.coveringZoomLevel(this._source),x=Math.max(v-tn.maxOverzooming,this._source.minzoom),P=Math.max(v+tn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const F={};for(const B of p)if(B.canonical.z>this._source.minzoom){const Z=B.scaledTo(B.canonical.z-1);F[Z.key]=Z;const ie=B.scaledTo(Math.max(this._source.minzoom,Math.min(B.canonical.z,5)));F[ie.key]=ie}p=p.concat(Object.values(F))}const A=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,A&&this.fire(new u.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const L=this._updateRetainedTiles(p,v);if(ao(this._source.type)){const F={},B={},Z=Object.keys(L),ie=u.browser.now();for(const re of Z){const ue=L[re],se=this._tiles[re];if(!se||se.fadeEndTime!==0&&se.fadeEndTime<=ie)continue;const xe=this.findLoadedParent(ue,x);xe&&(this._addTile(xe.tileID),F[xe.tileID.key]=xe.tileID),B[re]=ue}this._retainLoadedChildren(B,v,P,L);for(const re in F)L[re]||(this._coveredTiles[re]=!0,L[re]=F[re]);if(h){const re={},ue={};for(const se of p)this._tiles[se.key].hasData()?re[se.key]=se:ue[se.key]=se;for(const se in ue){const xe=ue[se].children(this._source.maxzoom);this._tiles[xe[0].key]&&this._tiles[xe[1].key]&&this._tiles[xe[2].key]&&this._tiles[xe[3].key]&&(re[xe[0].key]=L[xe[0].key]=xe[0],re[xe[1].key]=L[xe[1].key]=xe[1],re[xe[2].key]=L[xe[2].key]=xe[2],re[xe[3].key]=L[xe[3].key]=xe[3],delete ue[se])}for(const se in ue){const xe=this.findLoadedParent(ue[se],this._source.minzoom);if(xe){re[xe.tileID.key]=L[xe.tileID.key]=xe.tileID;for(const Le in re)re[Le].isChildOf(xe.tileID)&&delete re[Le]}}for(const se in this._tiles)re[se]||(this._coveredTiles[se]=!0)}}for(const F in L)this._tiles[F].clearFadeHold();const O=u.keysDifference(this._tiles,L);for(const F of O){const B=this._tiles[F];B.hasSymbolBuckets&&!B.holdingForFade()?B.setHoldDuration(this.map._fadeDuration):B.hasSymbolBuckets&&!B.symbolFadeFinished()||this._removeTile(F)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,h){const p={},v={},x=Math.max(h-tn.maxOverzooming,this._source.minzoom),P=Math.max(h+tn.maxUnderzooming,this._source.minzoom),A={};for(const L of o){const O=this._addTile(L);p[L.key]=L,O.hasData()||h<this._source.maxzoom&&(A[L.key]=L)}this._retainLoadedChildren(A,h,P,p);for(const L of o){let O=this._tiles[L.key];if(O.hasData())continue;if(h+1>this._source.maxzoom){const B=L.children(this._source.maxzoom)[0],Z=this.getTile(B);if(Z&&Z.hasData()){p[B.key]=B;continue}}else{const B=L.children(this._source.maxzoom);if(p[B[0].key]&&p[B[1].key]&&p[B[2].key]&&p[B[3].key])continue}let F=O.wasRequested();for(let B=L.overscaledZ-1;B>=x;--B){const Z=L.scaledTo(B);if(v[Z.key])break;if(v[Z.key]=!0,O=this.getTile(Z),!O&&F&&(O=this._addTile(Z)),O){const ie=O.hasData();if((F||ie)&&(p[Z.key]=Z),F=O.wasRequested(),ie)break}}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const h=[];let p,v=this._tiles[o].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){p=this._loadedParentTiles[v.key];break}h.push(v.key);const x=v.scaledTo(v.overscaledZ-1);if(p=this._getLoadedTile(x),p)break;v=x}for(const x of h)this._loadedParentTiles[x]=p}}_addTile(o){let h=this._tiles[o.key];if(h)return h;h=this._cache.getAndRemove(o),h&&(this._setTileReloadTimer(o.key,h),h.tileID=o,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,h)));const p=h;return h||(h=new ks(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(h,this._tileLoaded.bind(this,h,o.key,h.state))),h.uses++,this._tiles[o.key]=h,p||this._source.fire(new u.Event("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h}_setTileReloadTimer(o,h){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const p=h.getExpiryTimeout();p&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},p))}_removeTile(o){const h=this._tiles[o];h&&(h.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),h.uses>0||(h.hasData()&&h.state!=="reloading"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,h,p){const v=[],x=this.transform;if(!x)return v;const P=p?x.getCameraQueryGeometry(o):o,A=o.map(re=>x.pointCoordinate(re,this.terrain)),L=P.map(re=>x.pointCoordinate(re,this.terrain)),O=this.getIds();let F=1/0,B=1/0,Z=-1/0,ie=-1/0;for(const re of L)F=Math.min(F,re.x),B=Math.min(B,re.y),Z=Math.max(Z,re.x),ie=Math.max(ie,re.y);for(let re=0;re<O.length;re++){const ue=this._tiles[O[re]];if(ue.holdingForFade())continue;const se=ue.tileID,xe=Math.pow(2,x.zoom-ue.tileID.overscaledZ),Le=h*ue.queryPadding*u.EXTENT/ue.tileSize/xe,he=[se.getTilePoint(new u.MercatorCoordinate(F,B)),se.getTilePoint(new u.MercatorCoordinate(Z,ie))];if(he[0].x-Le<u.EXTENT&&he[0].y-Le<u.EXTENT&&he[1].x+Le>=0&&he[1].y+Le>=0){const Ae=A.map(Ge=>se.getTilePoint(Ge)),ze=L.map(Ge=>se.getTilePoint(Ge));v.push({tile:ue,tileID:se,queryGeometry:Ae,cameraQueryGeometry:ze,scale:xe})}}return v}getVisibleCoordinates(o){const h=this.getRenderableIds(o).map(p=>this._tiles[p].tileID);for(const p of h)p.posMatrix=this.transform.calculatePosMatrix(p.toUnwrapped());return h}hasTransition(){if(this._source.hasTransition())return!0;if(ao(this._source.type)){const o=u.browser.now();for(const h in this._tiles)if(this._tiles[h].fadeEndTime>=o)return!0}return!1}setFeatureState(o,h,p){this._state.updateState(o=o||"_geojsonTileLayer",h,p)}removeFeatureState(o,h,p){this._state.removeFeatureState(o=o||"_geojsonTileLayer",h,p)}getFeatureState(o,h){return this._state.getState(o=o||"_geojsonTileLayer",h)}setDependencies(o,h,p){const v=this._tiles[o];v&&v.setDependencies(h,p)}reloadTilesForDependencies(o,h){for(const p in this._tiles)this._tiles[p].hasDependency(o,h)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(o,h))}}function Ls(_,o){const h=Math.abs(2*_.wrap)-+(_.wrap<0),p=Math.abs(2*o.wrap)-+(o.wrap<0);return _.overscaledZ-o.overscaledZ||p-h||o.canonical.y-_.canonical.y||o.canonical.x-_.canonical.x}function ao(_){return _==="raster"||_==="image"||_==="video"}tn.maxOverzooming=10,tn.maxUnderzooming=3;const ut="mapboxgl_preloaded_worker_pool";class _n{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<_n.workerCount;)this.workers.push(new Worker(u.config.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(h=>{h.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ut]}numActive(){return Object.keys(this.active).length}}const Jn=Math.floor(u.browser.hardwareConcurrency/2);let Si;function $i(){return Si||(Si=new _n),Si}_n.workerCount=u.isSafari(globalThis)?Math.max(Math.min(Jn,3),1):1;class et{constructor(o,h){this.reset(o,h)}reset(o,h){this.points=o||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=u.clamp(o,0,1);let h=1,p=this._distances[h];const v=o*this.paddedLength+this.padding;for(;p<v&&h<this._distances.length;)p=this._distances[++h];const x=h-1,P=this._distances[x],A=p-P,L=A>0?(v-P)/A:0;return this.points[x].mult(1-L).add(this.points[h].mult(L))}}function Gt(_,o){let h=!0;return _==="always"||_!=="never"&&o!=="never"||(h=!1),h}class jt{constructor(o,h,p){const v=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(o/p),this.yCellCount=Math.ceil(h/p);for(let P=0;P<this.xCellCount*this.yCellCount;P++)v.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=h,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,h,p,v,x){this._forEachCell(h,p,v,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(x)}insertCircle(o,h,p,v){this._forEachCell(h-v,p-v,h+v,p+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(h),this.circles.push(p),this.circles.push(v)}_insertBoxCell(o,h,p,v,x,P){this.boxCells[x].push(P)}_insertCircleCell(o,h,p,v,x,P){this.circleCells[x].push(P)}_query(o,h,p,v,x,P,A){if(p<0||o>this.width||v<0||h>this.height)return[];const L=[];if(o<=0&&h<=0&&this.width<=p&&this.height<=v){if(x)return[{key:null,x1:o,y1:h,x2:p,y2:v}];for(let O=0;O<this.boxKeys.length;O++)L.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const F=this.circles[3*O],B=this.circles[3*O+1],Z=this.circles[3*O+2];L.push({key:this.circleKeys[O],x1:F-Z,y1:B-Z,x2:F+Z,y2:B+Z})}}else this._forEachCell(o,h,p,v,this._queryCell,L,{hitTest:x,overlapMode:P,seenUids:{box:{},circle:{}}},A);return L}query(o,h,p,v){return this._query(o,h,p,v,!1,null)}hitTest(o,h,p,v,x,P){return this._query(o,h,p,v,!0,x,P).length>0}hitTestCircle(o,h,p,v,x){const P=o-p,A=o+p,L=h-p,O=h+p;if(A<0||P>this.width||O<0||L>this.height)return!1;const F=[];return this._forEachCell(P,L,A,O,this._queryCellCircle,F,{hitTest:!0,overlapMode:v,circle:{x:o,y:h,radius:p},seenUids:{box:{},circle:{}}},x),F.length>0}_queryCell(o,h,p,v,x,P,A,L){const{seenUids:O,hitTest:F,overlapMode:B}=A,Z=this.boxCells[x];if(Z!==null){const re=this.bboxes;for(const ue of Z)if(!O.box[ue]){O.box[ue]=!0;const se=4*ue,xe=this.boxKeys[ue];if(o<=re[se+2]&&h<=re[se+3]&&p>=re[se+0]&&v>=re[se+1]&&(!L||L(xe))&&(!F||!Gt(B,xe.overlapMode))&&(P.push({key:xe,x1:re[se],y1:re[se+1],x2:re[se+2],y2:re[se+3]}),F))return!0}}const ie=this.circleCells[x];if(ie!==null){const re=this.circles;for(const ue of ie)if(!O.circle[ue]){O.circle[ue]=!0;const se=3*ue,xe=this.circleKeys[ue];if(this._circleAndRectCollide(re[se],re[se+1],re[se+2],o,h,p,v)&&(!L||L(xe))&&(!F||!Gt(B,xe.overlapMode))){const Le=re[se],he=re[se+1],Ae=re[se+2];if(P.push({key:xe,x1:Le-Ae,y1:he-Ae,x2:Le+Ae,y2:he+Ae}),F)return!0}}}return!1}_queryCellCircle(o,h,p,v,x,P,A,L){const{circle:O,seenUids:F,overlapMode:B}=A,Z=this.boxCells[x];if(Z!==null){const re=this.bboxes;for(const ue of Z)if(!F.box[ue]){F.box[ue]=!0;const se=4*ue,xe=this.boxKeys[ue];if(this._circleAndRectCollide(O.x,O.y,O.radius,re[se+0],re[se+1],re[se+2],re[se+3])&&(!L||L(xe))&&!Gt(B,xe.overlapMode))return P.push(!0),!0}}const ie=this.circleCells[x];if(ie!==null){const re=this.circles;for(const ue of ie)if(!F.circle[ue]){F.circle[ue]=!0;const se=3*ue,xe=this.circleKeys[ue];if(this._circlesCollide(re[se],re[se+1],re[se+2],O.x,O.y,O.radius)&&(!L||L(xe))&&!Gt(B,xe.overlapMode))return P.push(!0),!0}}}_forEachCell(o,h,p,v,x,P,A,L){const O=this._convertToXCellCoord(o),F=this._convertToYCellCoord(h),B=this._convertToXCellCoord(p),Z=this._convertToYCellCoord(v);for(let ie=O;ie<=B;ie++)for(let re=F;re<=Z;re++)if(x.call(this,o,h,p,v,this.xCellCount*re+ie,P,A,L))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,h,p,v,x,P){const A=v-o,L=x-h,O=p+P;return O*O>A*A+L*L}_circleAndRectCollide(o,h,p,v,x,P,A){const L=(P-v)/2,O=Math.abs(o-(v+L));if(O>L+p)return!1;const F=(A-x)/2,B=Math.abs(h-(x+F));if(B>F+p)return!1;if(O<=L||B<=F)return!0;const Z=O-L,ie=B-F;return Z*Z+ie*ie<=p*p}}function Nr(_,o,h,p,v){const x=u.create();return o?(u.scale(x,x,[1/v,1/v,1]),h||u.rotateZ(x,x,p.angle)):u.multiply(x,p.labelPlaneMatrix,_),x}function $o(_,o,h,p,v){if(o){const x=u.clone(_);return u.scale(x,x,[v,v,1]),h||u.rotateZ(x,x,-p.angle),x}return p.glCoordMatrix}function Bt(_,o,h){let p;h?(p=[_.x,_.y,h(_.x,_.y),1],u.transformMat4(p,p,o)):(p=[_.x,_.y,0,1],ce(p,p,o));const v=p[3];return{point:new u.Point(p[0]/v,p[1]/v),signedDistanceFromCamera:v}}function Jr(_,o){return .5+_/o*.5}function ir(_,o){const h=_[0]/_[3],p=_[1]/_[3];return h>=-o[0]&&h<=o[0]&&p>=-o[1]&&p<=o[1]}function lo(_,o,h,p,v,x,P,A,L,O){const F=p?_.textSizeData:_.iconSizeData,B=u.evaluateSizeForZoom(F,h.transform.zoom),Z=[256/h.width*2+1,256/h.height*2+1],ie=p?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;ie.clear();const re=_.lineVertexArray,ue=p?_.text.placedSymbolArray:_.icon.placedSymbolArray,se=h.transform.width/h.transform.height;let xe=!1;for(let Le=0;Le<ue.length;Le++){const he=ue.get(Le);if(he.hidden||he.writingMode===u.WritingMode.vertical&&!xe){ee(he.numGlyphs,ie);continue}let Ae;if(xe=!1,O?(Ae=[he.anchorX,he.anchorY,O(he.anchorX,he.anchorY),1],u.transformMat4(Ae,Ae,o)):(Ae=[he.anchorX,he.anchorY,0,1],ce(Ae,Ae,o)),!ir(Ae,Z)){ee(he.numGlyphs,ie);continue}const ze=Jr(h.transform.cameraToCenterDistance,Ae[3]),Ge=u.evaluateSizeForFeature(F,B,he),qe=P?Ge/ze:Ge*ze,Je=new u.Point(he.anchorX,he.anchorY),Ke=Bt(Je,v,O).point,gt={projections:{},offsets:{}},It=Ir(he,qe,!1,A,o,v,x,_.glyphOffsetArray,re,ie,Ke,Je,gt,se,L,O);xe=It.useVertical,(It.notEnoughRoom||xe||It.needsFlipping&&Ir(he,qe,!0,A,o,v,x,_.glyphOffsetArray,re,ie,Ke,Je,gt,se,L,O).notEnoughRoom)&&ee(he.numGlyphs,ie)}p?_.text.dynamicLayoutVertexBuffer.updateData(ie):_.icon.dynamicLayoutVertexBuffer.updateData(ie)}function Yn(_,o,h,p,v,x,P,A,L,O,F,B,Z){const ie=A.glyphStartIndex+A.numGlyphs,re=A.lineStartIndex,ue=A.lineStartIndex+A.lineLength,se=o.getoffsetX(A.glyphStartIndex),xe=o.getoffsetX(ie-1),Le=j(_*se,h,p,v,x,P,A.segment,re,ue,L,O,F,B,Z);if(!Le)return null;const he=j(_*xe,h,p,v,x,P,A.segment,re,ue,L,O,F,B,Z);return he?{first:Le,last:he}:null}function jn(_,o,h,p){return _===u.WritingMode.horizontal&&Math.abs(h.y-o.y)>Math.abs(h.x-o.x)*p?{useVertical:!0}:(_===u.WritingMode.vertical?o.y<h.y:o.x>h.x)?{needsFlipping:!0}:null}function Ir(_,o,h,p,v,x,P,A,L,O,F,B,Z,ie,re,ue){const se=o/24,xe=_.lineOffsetX*se,Le=_.lineOffsetY*se;let he;if(_.numGlyphs>1){const Ae=_.glyphStartIndex+_.numGlyphs,ze=_.lineStartIndex,Ge=_.lineStartIndex+_.lineLength,qe=Yn(se,A,xe,Le,h,F,B,_,L,x,Z,re,ue);if(!qe)return{notEnoughRoom:!0};const Je=Bt(qe.first.point,P,ue).point,Ke=Bt(qe.last.point,P,ue).point;if(p&&!h){const gt=jn(_.writingMode,Je,Ke,ie);if(gt)return gt}he=[qe.first];for(let gt=_.glyphStartIndex+1;gt<Ae-1;gt++)he.push(j(se*A.getoffsetX(gt),xe,Le,h,F,B,_.segment,ze,Ge,L,x,Z,re,ue));he.push(qe.last)}else{if(p&&!h){const ze=Bt(B,v,ue).point,Ge=_.lineStartIndex+_.segment+1,qe=new u.Point(L.getx(Ge),L.gety(Ge)),Je=Bt(qe,v,ue),Ke=Je.signedDistanceFromCamera>0?Je.point:Ti(B,qe,ze,1,v,ue),gt=jn(_.writingMode,ze,Ke,ie);if(gt)return gt}const Ae=j(se*A.getoffsetX(_.glyphStartIndex),xe,Le,h,F,B,_.segment,_.lineStartIndex,_.lineStartIndex+_.lineLength,L,x,Z,re,ue);if(!Ae)return{notEnoughRoom:!0};he=[Ae]}for(const Ae of he)u.addDynamicAttributes(O,Ae.point,Ae.angle);return{}}function Ti(_,o,h,p,v,x){const P=Bt(_.add(_.sub(o)._unit()),v,x).point,A=h.sub(P);return h.add(A._mult(p/A.mag()))}function xr(_,o){const{projectionCache:h,lineVertexArray:p,labelPlaneMatrix:v,tileAnchorPoint:x,distanceFromAnchor:P,getElevation:A,previousVertex:L,direction:O,absOffsetX:F}=o;if(h.projections[_])return h.projections[_];const B=new u.Point(p.getx(_),p.gety(_)),Z=Bt(B,v,A);if(Z.signedDistanceFromCamera>0)return h.projections[_]=Z.point,Z.point;const ie=_-O;return Ti(P===0?x:new u.Point(p.getx(ie),p.gety(ie)),B,L,F-P+1,v,A)}function bo(_,o,h){return _._unit()._perp()._mult(o*h)}function oe(_,o,h,p,v,x,P,A){const{projectionCache:L,direction:O}=A;if(L.offsets[_])return L.offsets[_];const F=h.add(o);if(_+O<p||_+O>=v)return L.offsets[_]=F,F;const B=xr(_+O,A),Z=bo(B.sub(h),P,O),ie=h.add(Z),re=B.add(Z);return L.offsets[_]=u.findLineIntersection(x,F,ie,re)||F,L.offsets[_]}function j(_,o,h,p,v,x,P,A,L,O,F,B,Z,ie){const re=p?_-o:_+o;let ue=re>0?1:-1,se=0;p&&(ue*=-1,se=Math.PI),ue<0&&(se+=Math.PI);let xe,Le,he=ue>0?A+P:A+P+1,Ae=v,ze=v,Ge=0,qe=0;const Je=Math.abs(re),Ke=[];let gt;for(;Ge+qe<=Je;){if(he+=ue,he<A||he>=L)return null;Ge+=qe,ze=Ae,Le=xe;const ct={projectionCache:B,lineVertexArray:O,labelPlaneMatrix:F,tileAnchorPoint:x,distanceFromAnchor:Ge,getElevation:ie,previousVertex:ze,direction:ue,absOffsetX:Je};if(Ae=xr(he,ct),h===0)Ke.push(ze),gt=Ae.sub(ze);else{let Ht;const bt=Ae.sub(ze);Ht=bt.mag()===0?bo(xr(he+ue,ct).sub(Ae),h,ue):bo(bt,h,ue),Le||(Le=ze.add(Ht)),xe=oe(he,Ht,Ae,A,L,Le,h,ct),Ke.push(Le),gt=xe.sub(Le)}qe=gt.mag()}const It=gt._mult((Je-Ge)/qe)._add(Le||ze),pr=se+Math.atan2(Ae.y-ze.y,Ae.x-ze.x);return Ke.push(It),{point:It,angle:Z?pr:0,path:Ke}}const G=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ee(_,o){for(let h=0;h<_;h++){const p=o.length;o.resize(p+4),o.float32.set(G,3*p)}}function ce(_,o,h){const p=o[0],v=o[1];return _[0]=h[0]*p+h[4]*v+h[12],_[1]=h[1]*p+h[5]*v+h[13],_[3]=h[3]*p+h[7]*v+h[15],_}const me=100;class be{constructor(o,h=new jt(o.width+200,o.height+200,25),p=new jt(o.width+200,o.height+200,25)){this.transform=o,this.grid=h,this.ignoredGrid=p,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+me,this.screenBottomBoundary=o.height+me,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,h,p,v,x,P){const A=this.projectAndGetPerspectiveRatio(v,o.anchorPointX,o.anchorPointY,P),L=p*A.perspectiveRatio,O=o.x1*L+A.point.x,F=o.y1*L+A.point.y,B=o.x2*L+A.point.x,Z=o.y2*L+A.point.y;return!this.isInsideGrid(O,F,B,Z)||h!=="always"&&this.grid.hitTest(O,F,B,Z,h,x)||A.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[O,F,B,Z],offscreen:this.isOffscreen(O,F,B,Z)}}placeCollisionCircles(o,h,p,v,x,P,A,L,O,F,B,Z,ie,re){const ue=[],se=new u.Point(h.anchorX,h.anchorY),xe=Bt(se,P,re),Le=Jr(this.transform.cameraToCenterDistance,xe.signedDistanceFromCamera),he=(F?x/Le:x*Le)/u.ONE_EM,Ae=Bt(se,A,re).point,ze=Yn(he,v,h.lineOffsetX*he,h.lineOffsetY*he,!1,Ae,se,h,p,A,{projections:{},offsets:{}},!1,re);let Ge=!1,qe=!1,Je=!0;if(ze){const Ke=.5*Z*Le+ie,gt=new u.Point(-100,-100),It=new u.Point(this.screenRightBoundary,this.screenBottomBoundary),pr=new et,ct=ze.first,Ht=ze.last;let bt=[];for(let Er=ct.path.length-1;Er>=1;Er--)bt.push(ct.path[Er]);for(let Er=1;Er<Ht.path.length;Er++)bt.push(Ht.path[Er]);const Vr=2.5*Ke;if(L){const Er=bt.map(nr=>Bt(nr,L,re));bt=Er.some(nr=>nr.signedDistanceFromCamera<=0)?[]:Er.map(nr=>nr.point)}let Or=[];if(bt.length>0){const Er=bt[0].clone(),nr=bt[0].clone();for(let Rn=1;Rn<bt.length;Rn++)Er.x=Math.min(Er.x,bt[Rn].x),Er.y=Math.min(Er.y,bt[Rn].y),nr.x=Math.max(nr.x,bt[Rn].x),nr.y=Math.max(nr.y,bt[Rn].y);Or=Er.x>=gt.x&&nr.x<=It.x&&Er.y>=gt.y&&nr.y<=It.y?[bt]:nr.x<gt.x||Er.x>It.x||nr.y<gt.y||Er.y>It.y?[]:u.clipLine([bt],gt.x,gt.y,It.x,It.y)}for(const Er of Or){pr.reset(Er,.25*Ke);let nr=0;nr=pr.length<=.5*Ke?1:Math.ceil(pr.paddedLength/Vr)+1;for(let Rn=0;Rn<nr;Rn++){const Fi=Rn/Math.max(nr-1,1),ri=pr.lerp(Fi),Ai=ri.x+me,Ko=ri.y+me;ue.push(Ai,Ko,Ke,0);const qs=Ai-Ke,Hs=Ko-Ke,fo=Ai+Ke,wa=Ko+Ke;if(Je=Je&&this.isOffscreen(qs,Hs,fo,wa),qe=qe||this.isInsideGrid(qs,Hs,fo,wa),o!=="always"&&this.grid.hitTestCircle(Ai,Ko,Ke,o,B)&&(Ge=!0,!O))return{circles:[],offscreen:!1,collisionDetected:Ge}}}}return{circles:!O&&Ge||!qe||Le<this.perspectiveRatioCutoff?[]:ue,offscreen:Je,collisionDetected:Ge}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let p=1/0,v=1/0,x=-1/0,P=-1/0;for(const F of o){const B=new u.Point(F.x+me,F.y+me);p=Math.min(p,B.x),v=Math.min(v,B.y),x=Math.max(x,B.x),P=Math.max(P,B.y),h.push(B)}const A=this.grid.query(p,v,x,P).concat(this.ignoredGrid.query(p,v,x,P)),L={},O={};for(const F of A){const B=F.key;if(L[B.bucketInstanceId]===void 0&&(L[B.bucketInstanceId]={}),L[B.bucketInstanceId][B.featureIndex])continue;const Z=[new u.Point(F.x1,F.y1),new u.Point(F.x2,F.y1),new u.Point(F.x2,F.y2),new u.Point(F.x1,F.y2)];u.polygonIntersectsPolygon(h,Z)&&(L[B.bucketInstanceId][B.featureIndex]=!0,O[B.bucketInstanceId]===void 0&&(O[B.bucketInstanceId]=[]),O[B.bucketInstanceId].push(B.featureIndex))}return O}insertCollisionBox(o,h,p,v,x,P){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:x,collisionGroupID:P,overlapMode:h},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,h,p,v,x,P){const A=p?this.ignoredGrid:this.grid,L={bucketInstanceId:v,featureIndex:x,collisionGroupID:P,overlapMode:h};for(let O=0;O<o.length;O+=4)A.insertCircle(L,o[O],o[O+1],o[O+2])}projectAndGetPerspectiveRatio(o,h,p,v){let x;return v?(x=[h,p,v(h,p),1],u.transformMat4(x,x,o)):(x=[h,p,0,1],ce(x,x,o)),{point:new u.Point((x[0]/x[3]+1)/2*this.transform.width+me,(-x[1]/x[3]+1)/2*this.transform.height+me),perspectiveRatio:.5+this.transform.cameraToCenterDistance/x[3]*.5}}isOffscreen(o,h,p,v){return p<me||o>=this.screenRightBoundary||v<me||h>this.screenBottomBoundary}isInsideGrid(o,h,p,v){return p>=0&&o<this.gridRightBoundary&&v>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const o=u.identity([]);return u.translate(o,o,[-100,-100,0]),o}}function ve(_,o,h){return o*(u.EXTENT/(_.tileSize*Math.pow(2,h-_.tileID.overscaledZ)))}class pe{constructor(o,h,p,v){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?h:-h))):v&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class Te{constructor(o,h,p,v,x){this.text=new pe(o?o.text:null,h,p,x),this.icon=new pe(o?o.icon:null,h,v,x)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class He{constructor(o,h,p){this.text=o,this.icon=h,this.skipFade=p}}class We{constructor(){this.invProjMatrix=u.create(),this.viewportMatrix=u.create(),this.circles=[]}}class Ze{constructor(o,h,p,v,x){this.bucketInstanceId=o,this.featureIndex=h,this.sourceLayerIndex=p,this.bucketIndex=v,this.tileID=x}}class Pt{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const h=++this.maxGroupID;this.collisionGroups[o]={ID:h,predicate:p=>p.collisionGroupID===h}}return this.collisionGroups[o]}}function Zt(_,o,h,p,v){const{horizontalAlign:x,verticalAlign:P}=u.getAnchorAlignment(_),A=-(x-.5)*o,L=-(P-.5)*h,O=u.evaluateVariableOffset(_,p);return new u.Point(A+O[0]*v,L+O[1]*v)}function xt(_,o,h,p,v,x){const{x1:P,x2:A,y1:L,y2:O,anchorPointX:F,anchorPointY:B}=_,Z=new u.Point(o,h);return p&&Z._rotate(v?x:-x),{x1:P+Z.x,y1:L+Z.y,x2:A+Z.x,y2:O+Z.y,anchorPointX:F,anchorPointY:B}}class Mt{constructor(o,h,p,v,x){this.transform=o.clone(),this.terrain=h,this.collisionIndex=new be(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Pt(v),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,h,p,v){const x=p.getBucket(h),P=p.latestFeatureIndex;if(!x||!P||h.id!==x.layerIds[0])return;const A=p.collisionBoxArray,L=x.layers[0].layout,O=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),F=p.tileSize/u.EXTENT,B=this.transform.calculatePosMatrix(p.tileID.toUnwrapped()),Z=L.get("text-pitch-alignment")==="map",ie=L.get("text-rotation-alignment")==="map",re=ve(p,1,this.transform.zoom),ue=Nr(B,Z,ie,this.transform,re);let se=null;if(Z){const Le=$o(B,Z,ie,this.transform,re);se=u.multiply([],this.transform.labelPlaneMatrix,Le)}this.retainedQueryData[x.bucketInstanceId]=new Ze(x.bucketInstanceId,P,x.sourceLayerIndex,x.index,p.tileID);const xe={bucket:x,layout:L,posMatrix:B,textLabelPlaneMatrix:ue,labelToScreenMatrix:se,scale:O,textPixelRatio:F,holdingForFade:p.holdingForFade(),collisionBoxArray:A,partiallyEvaluatedTextSize:u.evaluateSizeForZoom(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(v)for(const Le of x.sortKeyRanges){const{sortKey:he,symbolInstanceStart:Ae,symbolInstanceEnd:ze}=Le;o.push({sortKey:he,symbolInstanceStart:Ae,symbolInstanceEnd:ze,parameters:xe})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:xe})}attemptAnchorPlacement(o,h,p,v,x,P,A,L,O,F,B,Z,ie,re,ue,se){const xe=[Z.textOffset0,Z.textOffset1],Le=Zt(o,p,v,xe,x),he=this.collisionIndex.placeCollisionBox(xt(h,Le.x,Le.y,P,A,this.transform.angle),B,L,O,F.predicate,se);if((!ue||this.collisionIndex.placeCollisionBox(xt(ue,Le.x,Le.y,P,A,this.transform.angle),B,L,O,F.predicate,se).box.length!==0)&&he.box.length>0){let Ae;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID].text&&(Ae=this.prevPlacement.variableOffsets[Z.crossTileID].anchor),Z.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Z.crossTileID]={textOffset:xe,width:p,height:v,anchor:o,textBoxScale:x,prevAnchor:Ae},this.markUsedJustification(ie,o,Z,re),ie.allowVerticalPlacement&&(this.markUsedOrientation(ie,re,Z),this.placedOrientations[Z.crossTileID]=re),{shift:Le,placedGlyphBoxes:he}}}placeLayerBucketPart(o,h,p){const{bucket:v,layout:x,posMatrix:P,textLabelPlaneMatrix:A,labelToScreenMatrix:L,textPixelRatio:O,holdingForFade:F,collisionBoxArray:B,partiallyEvaluatedTextSize:Z,collisionGroup:ie}=o.parameters,re=x.get("text-optional"),ue=x.get("icon-optional"),se=u.getOverlapMode(x,"text-overlap","text-allow-overlap"),xe=se==="always",Le=u.getOverlapMode(x,"icon-overlap","icon-allow-overlap"),he=Le==="always",Ae=x.get("text-rotation-alignment")==="map",ze=x.get("text-pitch-alignment")==="map",Ge=x.get("icon-text-fit")!=="none",qe=x.get("symbol-z-order")==="viewport-y",Je=xe&&(he||!v.hasIconData()||ue),Ke=he&&(xe||!v.hasTextData()||re);!v.collisionArrays&&B&&v.deserializeCollisionBoxes(B);const gt=this.retainedQueryData[v.bucketInstanceId].tileID,It=this.terrain?(ct,Ht)=>this.terrain.getElevation(gt,ct,Ht):null,pr=(ct,Ht)=>{if(h[ct.crossTileID])return;if(F)return void(this.placements[ct.crossTileID]=new He(!1,!1,!1));let bt=!1,Vr=!1,Or=!0,Er=null,nr={box:null,offscreen:null},Rn={box:null,offscreen:null},Fi=null,ri=null,Ai=null,Ko=0,qs=0,Hs=0;Ht.textFeatureIndex?Ko=Ht.textFeatureIndex:ct.useRuntimeCollisionCircles&&(Ko=ct.featureIndex),Ht.verticalTextFeatureIndex&&(qs=Ht.verticalTextFeatureIndex);const fo=Ht.textBox;if(fo){const Ji=Kr=>{let gi=u.WritingMode.horizontal;if(v.allowVerticalPlacement&&!Kr&&this.prevPlacement){const ki=this.prevPlacement.placedOrientations[ct.crossTileID];ki&&(this.placedOrientations[ct.crossTileID]=ki,gi=ki,this.markUsedOrientation(v,gi,ct))}return gi},Mi=(Kr,gi)=>{if(v.allowVerticalPlacement&&ct.numVerticalGlyphVertices>0&&Ht.verticalTextBox){for(const ki of v.writingModes)if(ki===u.WritingMode.vertical?(nr=gi(),Rn=nr):nr=Kr(),nr&&nr.box&&nr.box.length)break}else nr=Kr()};if(x.get("text-variable-anchor")){let Kr=x.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ct.crossTileID]){const en=this.prevPlacement.variableOffsets[ct.crossTileID];Kr.indexOf(en.anchor)>0&&(Kr=Kr.filter(yi=>yi!==en.anchor),Kr.unshift(en.anchor))}const gi=(en,yi,Xo)=>{const Zc=en.x2-en.x1,Ga=en.y2-en.y1,Xg=ct.textBoxScale,Zf=Ge&&Le==="never"?yi:null;let wn={box:[],offscreen:!1};const sd=se!=="never"?2*Kr.length:Kr.length;for(let cc=0;cc<sd;++cc){const qa=this.attemptAnchorPlacement(Kr[cc%Kr.length],en,Zc,Ga,Xg,Ae,ze,O,P,ie,cc>=Kr.length?se:"never",ct,v,Xo,Zf,It);if(qa&&(wn=qa.placedGlyphBoxes,wn&&wn.box&&wn.box.length)){bt=!0,Er=qa.shift;break}}return wn};Mi(()=>gi(fo,Ht.iconBox,u.WritingMode.horizontal),()=>{const en=Ht.verticalTextBox;return v.allowVerticalPlacement&&!(nr&&nr.box&&nr.box.length)&&ct.numVerticalGlyphVertices>0&&en?gi(en,Ht.verticalIconBox,u.WritingMode.vertical):{box:null,offscreen:null}}),nr&&(bt=nr.box,Or=nr.offscreen);const ki=Ji(nr&&nr.box);if(!bt&&this.prevPlacement){const en=this.prevPlacement.variableOffsets[ct.crossTileID];en&&(this.variableOffsets[ct.crossTileID]=en,this.markUsedJustification(v,en.anchor,ct,ki))}}else{const Kr=(gi,ki)=>{const en=this.collisionIndex.placeCollisionBox(gi,se,O,P,ie.predicate,It);return en&&en.box&&en.box.length&&(this.markUsedOrientation(v,ki,ct),this.placedOrientations[ct.crossTileID]=ki),en};Mi(()=>Kr(fo,u.WritingMode.horizontal),()=>{const gi=Ht.verticalTextBox;return v.allowVerticalPlacement&&ct.numVerticalGlyphVertices>0&&gi?Kr(gi,u.WritingMode.vertical):{box:null,offscreen:null}}),Ji(nr&&nr.box&&nr.box.length)}}if(Fi=nr,bt=Fi&&Fi.box&&Fi.box.length>0,Or=Fi&&Fi.offscreen,ct.useRuntimeCollisionCircles){const Ji=v.text.placedSymbolArray.get(ct.centerJustifiedTextSymbolIndex),Mi=u.evaluateSizeForFeature(v.textSizeData,Z,Ji),Kr=x.get("text-padding");ri=this.collisionIndex.placeCollisionCircles(se,Ji,v.lineVertexArray,v.glyphOffsetArray,Mi,P,A,L,p,ze,ie.predicate,ct.collisionCircleDiameter,Kr,It),ri.circles.length&&ri.collisionDetected&&!p&&u.warnOnce("Collisions detected, but collision boxes are not shown"),bt=xe||ri.circles.length>0&&!ri.collisionDetected,Or=Or&&ri.offscreen}if(Ht.iconFeatureIndex&&(Hs=Ht.iconFeatureIndex),Ht.iconBox){const Ji=Mi=>{const Kr=Ge&&Er?xt(Mi,Er.x,Er.y,Ae,ze,this.transform.angle):Mi;return this.collisionIndex.placeCollisionBox(Kr,Le,O,P,ie.predicate,It)};Rn&&Rn.box&&Rn.box.length&&Ht.verticalIconBox?(Ai=Ji(Ht.verticalIconBox),Vr=Ai.box.length>0):(Ai=Ji(Ht.iconBox),Vr=Ai.box.length>0),Or=Or&&Ai.offscreen}const wa=re||ct.numHorizontalGlyphVertices===0&&ct.numVerticalGlyphVertices===0,uc=ue||ct.numIconVertices===0;if(wa||uc?uc?wa||(Vr=Vr&&bt):bt=Vr&&bt:Vr=bt=Vr&&bt,bt&&Fi&&Fi.box&&this.collisionIndex.insertCollisionBox(Fi.box,se,x.get("text-ignore-placement"),v.bucketInstanceId,Rn&&Rn.box&&qs?qs:Ko,ie.ID),Vr&&Ai&&this.collisionIndex.insertCollisionBox(Ai.box,Le,x.get("icon-ignore-placement"),v.bucketInstanceId,Hs,ie.ID),ri&&(bt&&this.collisionIndex.insertCollisionCircles(ri.circles,se,x.get("text-ignore-placement"),v.bucketInstanceId,Ko,ie.ID),p)){const Ji=v.bucketInstanceId;let Mi=this.collisionCircleArrays[Ji];Mi===void 0&&(Mi=this.collisionCircleArrays[Ji]=new We);for(let Kr=0;Kr<ri.circles.length;Kr+=4)Mi.circles.push(ri.circles[Kr+0]),Mi.circles.push(ri.circles[Kr+1]),Mi.circles.push(ri.circles[Kr+2]),Mi.circles.push(ri.collisionDetected?1:0)}if(ct.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(v.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ct.crossTileID]=new He(bt||Je,Vr||Ke,Or||v.justReloaded),h[ct.crossTileID]=!0};if(qe){if(o.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ct=v.getSortedSymbolIndexes(this.transform.angle);for(let Ht=ct.length-1;Ht>=0;--Ht){const bt=ct[Ht];pr(v.symbolInstances.get(bt),v.collisionArrays[bt])}}else for(let ct=o.symbolInstanceStart;ct<o.symbolInstanceEnd;ct++)pr(v.symbolInstances.get(ct),v.collisionArrays[ct]);if(p&&v.bucketInstanceId in this.collisionCircleArrays){const ct=this.collisionCircleArrays[v.bucketInstanceId];u.invert(ct.invProjMatrix,P),ct.viewportMatrix=this.collisionIndex.getViewportMatrix()}v.justReloaded=!1}markUsedJustification(o,h,p,v){let x;x=v===u.WritingMode.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[u.getAnchorJustification(h)];const P=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const A of P)A>=0&&(o.text.placedSymbolArray.get(A).crossTileID=x>=0&&A!==x?0:p.crossTileID)}markUsedOrientation(o,h,p){const v=h===u.WritingMode.horizontal||h===u.WritingMode.horizontalOnly?h:0,x=h===u.WritingMode.vertical?h:0,P=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const A of P)o.text.placedSymbolArray.get(A).placedOrientation=v;p.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let p=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const v=h?h.symbolFadeChange(o):1,x=h?h.opacities:{},P=h?h.variableOffsets:{},A=h?h.placedOrientations:{};for(const L in this.placements){const O=this.placements[L],F=x[L];F?(this.opacities[L]=new Te(F,v,O.text,O.icon),p=p||O.text!==F.text.placed||O.icon!==F.icon.placed):(this.opacities[L]=new Te(null,v,O.text,O.icon,O.skipFade),p=p||O.text||O.icon)}for(const L in x){const O=x[L];if(!this.opacities[L]){const F=new Te(O,v,!1,!1);F.isHidden()||(this.opacities[L]=F,p=p||O.text.placed||O.icon.placed)}}for(const L in P)this.variableOffsets[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.variableOffsets[L]=P[L]);for(const L in A)this.placedOrientations[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.placedOrientations[L]=A[L]);if(h&&h.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:o)}updateLayerOpacities(o,h){const p={};for(const v of h){const x=v.getBucket(o);x&&v.latestFeatureIndex&&o.id===x.layerIds[0]&&this.updateBucketOpacities(x,p,v.collisionBoxArray)}}updateBucketOpacities(o,h,p){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const v=o.layers[0].layout,x=new Te(null,0,!1,!1,!0),P=v.get("text-allow-overlap"),A=v.get("icon-allow-overlap"),L=v.get("text-variable-anchor"),O=v.get("text-rotation-alignment")==="map",F=v.get("text-pitch-alignment")==="map",B=v.get("icon-text-fit")!=="none",Z=new Te(null,0,P&&(A||!o.hasIconData()||v.get("icon-optional")),A&&(P||!o.hasTextData()||v.get("text-optional")),!0);!o.collisionArrays&&p&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(p);const ie=(re,ue,se)=>{for(let xe=0;xe<ue/4;xe++)re.opacityVertexArray.emplaceBack(se);re.hasVisibleVertices=re.hasVisibleVertices||se!==Cn};for(let re=0;re<o.symbolInstances.length;re++){const ue=o.symbolInstances.get(re),{numHorizontalGlyphVertices:se,numVerticalGlyphVertices:xe,crossTileID:Le}=ue;let he=this.opacities[Le];h[Le]?he=x:he||(he=Z,this.opacities[Le]=he),h[Le]=!0;const Ae=ue.numIconVertices>0,ze=this.placedOrientations[ue.crossTileID],Ge=ze===u.WritingMode.vertical,qe=ze===u.WritingMode.horizontal||ze===u.WritingMode.horizontalOnly;if(se>0||xe>0){const Je=Rr(he.text);ie(o.text,se,Ge?Cn:Je),ie(o.text,xe,qe?Cn:Je);const Ke=he.text.isHidden();[ue.rightJustifiedTextSymbolIndex,ue.centerJustifiedTextSymbolIndex,ue.leftJustifiedTextSymbolIndex].forEach(pr=>{pr>=0&&(o.text.placedSymbolArray.get(pr).hidden=Ke||Ge?1:0)}),ue.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(ue.verticalPlacedTextSymbolIndex).hidden=Ke||qe?1:0);const gt=this.variableOffsets[ue.crossTileID];gt&&this.markUsedJustification(o,gt.anchor,ue,ze);const It=this.placedOrientations[ue.crossTileID];It&&(this.markUsedJustification(o,"left",ue,It),this.markUsedOrientation(o,It,ue))}if(Ae){const Je=Rr(he.icon),Ke=!(B&&ue.verticalPlacedIconSymbolIndex&&Ge);ue.placedIconSymbolIndex>=0&&(ie(o.icon,ue.numIconVertices,Ke?Je:Cn),o.icon.placedSymbolArray.get(ue.placedIconSymbolIndex).hidden=he.icon.isHidden()),ue.verticalPlacedIconSymbolIndex>=0&&(ie(o.icon,ue.numVerticalIconVertices,Ke?Cn:Je),o.icon.placedSymbolArray.get(ue.verticalPlacedIconSymbolIndex).hidden=he.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Je=o.collisionArrays[re];if(Je){let Ke=new u.Point(0,0);if(Je.textBox||Je.verticalTextBox){let It=!0;if(L){const pr=this.variableOffsets[Le];pr?(Ke=Zt(pr.anchor,pr.width,pr.height,pr.textOffset,pr.textBoxScale),O&&Ke._rotate(F?this.transform.angle:-this.transform.angle)):It=!1}Je.textBox&&$t(o.textCollisionBox.collisionVertexArray,he.text.placed,!It||Ge,Ke.x,Ke.y),Je.verticalTextBox&&$t(o.textCollisionBox.collisionVertexArray,he.text.placed,!It||qe,Ke.x,Ke.y)}const gt=!!(!qe&&Je.verticalIconBox);Je.iconBox&&$t(o.iconCollisionBox.collisionVertexArray,he.icon.placed,gt,B?Ke.x:0,B?Ke.y:0),Je.verticalIconBox&&$t(o.iconCollisionBox.collisionVertexArray,he.icon.placed,!gt,B?Ke.x:0,B?Ke.y:0)}}}if(o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);if(o.bucketInstanceId in this.collisionCircleArrays){const re=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=re.invProjMatrix,o.placementViewportMatrix=re.viewportMatrix,o.collisionCircleArray=re.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,h){const p=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*p>o}setStale(){this.stale=!0}}function $t(_,o,h,p,v){_.emplaceBack(o?1:0,h?1:0,p||0,v||0),_.emplaceBack(o?1:0,h?1:0,p||0,v||0),_.emplaceBack(o?1:0,h?1:0,p||0,v||0),_.emplaceBack(o?1:0,h?1:0,p||0,v||0)}const Kt=Math.pow(2,25),sr=Math.pow(2,24),Br=Math.pow(2,17),Ur=Math.pow(2,16),tr=Math.pow(2,9),an=Math.pow(2,8),ln=Math.pow(2,1);function Rr(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const o=_.placed?1:0,h=Math.floor(127*_.opacity);return h*Kt+o*sr+h*Br+o*Ur+h*tr+o*an+h*ln+o}const Cn=0;class Ci{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,h,p,v,x){const P=this._bucketParts;for(;this._currentTileIndex<o.length;)if(h.getBucketParts(P,v,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((A,L)=>A.sortKey-L.sortKey));this._currentPartIndex<P.length;)if(h.placeLayerBucketPart(P[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,x())return!0;return!1}}class aa{constructor(o,h,p,v,x,P,A,L){this.placement=new Mt(o,h,P,A,L),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(o,h,p){const v=u.browser.now(),x=()=>!this._forceFullPlacement&&u.browser.now()-v>2;for(;this._currentPlacementIndex>=0;){const P=h[o[this._currentPlacementIndex]],A=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=A)&&(!P.maxzoom||P.maxzoom>A)){if(this._inProgressLayer||(this._inProgressLayer=new Ci(P)),this._inProgressLayer.continuePlacement(p[P.source],this.placement,this._showCollisionBoxes,P,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Yr=512/u.EXTENT/2;class xn{constructor(o,h,p){this.tileID=o,this.bucketInstanceId=p,this._symbolsByKey={};const v=new Map;for(let x=0;x<h.length;x++){const P=h.get(x),A=P.key,L=v.get(A);L?L.push(P):v.set(A,[P])}for(const[x,P]of v){const A={positions:P.map(L=>({x:Math.floor(L.anchorX*Yr),y:Math.floor(L.anchorY*Yr)})),crossTileIDs:P.map(L=>L.crossTileID)};if(A.positions.length>128){const L=new u.KDBush(A.positions.length,16,Uint16Array);for(const{x:O,y:F}of A.positions)L.add(O,F);L.finish(),delete A.positions,A.index=L}this._symbolsByKey[x]=A}}getScaledCoordinates(o,h){const{x:p,y:v,z:x}=this.tileID.canonical,{x:P,y:A,z:L}=h.canonical,O=Yr/Math.pow(2,L-x),F=(A*u.EXTENT+o.anchorY)*O,B=v*u.EXTENT*Yr;return{x:Math.floor((P*u.EXTENT+o.anchorX)*O-p*u.EXTENT*Yr),y:Math.floor(F-B)}}findMatches(o,h,p){const v=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z);for(let x=0;x<o.length;x++){const P=o.get(x);if(P.crossTileID)continue;const A=this._symbolsByKey[P.key];if(!A)continue;const L=this.getScaledCoordinates(P,h);if(A.index){const O=A.index.range(L.x-v,L.y-v,L.x+v,L.y+v).sort();for(const F of O){const B=A.crossTileIDs[F];if(!p[B]){p[B]=!0,P.crossTileID=B;break}}}else if(A.positions)for(let O=0;O<A.positions.length;O++){const F=A.positions[O],B=A.crossTileIDs[O];if(Math.abs(F.x-L.x)<=v&&Math.abs(F.y-L.y)<=v&&!p[B]){p[B]=!0,P.crossTileID=B;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class Rs{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class zr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const h=Math.round((o-this.lng)/360);if(h!==0)for(const p in this.indexes){const v=this.indexes[p],x={};for(const P in v){const A=v[P];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+h),x[A.tileID.key]=A}this.indexes[p]=x}this.lng=o}addBucket(o,h,p){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let x=0;x<h.symbolInstances.length;x++)h.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const v=this.usedCrossTileIDs[o.overscaledZ];for(const x in this.indexes){const P=this.indexes[x];if(Number(x)>o.overscaledZ)for(const A in P){const L=P[A];L.tileID.isChildOf(o)&&L.findMatches(h.symbolInstances,o,v)}else{const A=P[o.scaledTo(Number(x)).key];A&&A.findMatches(h.symbolInstances,o,v)}}for(let x=0;x<h.symbolInstances.length;x++){const P=h.symbolInstances.get(x);P.crossTileID||(P.crossTileID=p.generate(),v[P.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new xn(o,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(o,h){for(const p of h.getCrossTileIDsLists())for(const v of p)delete this.usedCrossTileIDs[o][v]}removeStaleBuckets(o){let h=!1;for(const p in this.indexes){const v=this.indexes[p];for(const x in v)o[v[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,v[x]),delete v[x],h=!0)}return h}}class Hr{constructor(){this.layerIndexes={},this.crossTileIDs=new Rs,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,h,p){let v=this.layerIndexes[o.id];v===void 0&&(v=this.layerIndexes[o.id]=new zr);let x=!1;const P={};v.handleWrapJump(p);for(const A of h){const L=A.getBucket(o);L&&o.id===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(A.tileID,L,this.crossTileIDs)&&(x=!0),P[L.bucketInstanceId]=!0)}return v.removeStaleBuckets(P)&&(x=!0),x}pruneUnusedLayers(o){const h={};o.forEach(p=>{h[p]=!0});for(const p in this.layerIndexes)h[p]||delete this.layerIndexes[p]}}const wo=(_,o)=>u.emitValidationErrors(_,o&&o.filter(h=>h.identifier!=="source.canvas")),fn=u.pick(u.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Qn=u.pick(u.operations,["setCenter","setZoom","setBearing","setPitch"]),uo=u.emptyStyle();class Vi extends u.Evented{constructor(o,h={}){super(),this.map=o,this.dispatcher=new Ar($i(),this,o._getMapId()),this.imageManager=new ar,this.imageManager.setEventedParent(this),this.glyphManager=new qr(o._requestManager,h.localIdeographFontFamily),this.lineAtlas=new gr(256,512),this.crossTileSymbolIndex=new Hr,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",u.getReferrer());const p=this;this._rtlTextPluginCallback=Vi.registerForPluginStateChange(v=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:v.pluginStatus,pluginURL:v.pluginURL},(x,P)=>{if(u.triggerPluginCompletionEvent(x),P&&P.every(A=>A))for(const A in p.sourceCaches){const L=p.sourceCaches[A].getSource().type;L!=="vector"&&L!=="geojson"||p.sourceCaches[A].reload()}})}),this.on("data",v=>{if(v.dataType!=="source"||v.sourceDataType!=="metadata")return;const x=this.sourceCaches[v.sourceId];if(!x)return;const P=x.getSource();if(P&&P.vectorLayerIds)for(const A in this._layers){const L=this._layers[A];L.source===P.id&&this._validateLayer(L)}})}loadURL(o,h={},p){this.fire(new u.Event("dataloading",{dataType:"style"})),h.validate=typeof h.validate!="boolean"||h.validate;const v=this.map._requestManager.transformRequest(o,Q.Style);this._request=u.getJSON(v,(x,P)=>{this._request=null,x?this.fire(new u.ErrorEvent(x)):P&&this._load(P,h,p)})}loadJSON(o,h={},p){this.fire(new u.Event("dataloading",{dataType:"style"})),this._request=u.browser.frame(()=>{this._request=null,h.validate=h.validate!==!1,this._load(o,h,p)})}loadEmpty(){this.fire(new u.Event("dataloading",{dataType:"style"})),this._load(uo,{validate:!1})}_load(o,h,p){const v=h.transformStyle?h.transformStyle(p,o):o;if(!h.validate||!wo(this,u.validateStyle(v))){this._loaded=!0,this.stylesheet=v;for(const x in v.sources)this.addSource(x,v.sources[x],{validate:!1});v.sprite?this._loadSprite(v.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(v.glyphs),this._createLayers(),this.light=new mt(this.stylesheet.light),this.map.setTerrain(this.stylesheet.terrain),this.fire(new u.Event("data",{dataType:"style"})),this.fire(new u.Event("style.load"))}}_createLayers(){const o=u.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",o),this._order=o.map(h=>h.id),this._layers={},this._serializedLayers=null;for(const h of o){const p=u.createStyleLayer(h);p.setEventedParent(this,{layer:{id:h.id}}),this._layers[h.id]=p}}_loadSprite(o,h=!1,p=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(v,x,P,A){const L=ot(v),O=L.length,F=P>1?"@2x":"",B={},Z={},ie={};for(const{id:re,url:ue}of L){const se=x.transformRequest(x.normalizeSpriteURL(ue,F,".json"),Q.SpriteJSON),xe=`${re}_${se.url}`;B[xe]=u.getJSON(se,(Ae,ze)=>{delete B[xe],Z[re]=ze,Ut(A,Z,ie,Ae,O)});const Le=x.transformRequest(x.normalizeSpriteURL(ue,F,".png"),Q.SpriteImage),he=`${re}_${Le.url}`;B[he]=ye.getImage(Le,(Ae,ze)=>{delete B[he],ie[re]=ze,Ut(A,Z,ie,Ae,O)})}return{cancel(){for(const re of Object.values(B))re.cancel()}}}(o,this.map._requestManager,this.map.getPixelRatio(),(v,x)=>{if(this._spriteRequest=null,v)this.fire(new u.ErrorEvent(v));else if(x)for(const P in x){this._spritesImagesIds[P]=[];const A=this._spritesImagesIds[P]?this._spritesImagesIds[P].filter(L=>!(L in x)):[];for(const L of A)this.imageManager.removeImage(L),this._changedImages[L]=!0;for(const L in x[P]){const O=P==="default"?L:`${P}:${L}`;this._spritesImagesIds[P].push(O),O in this.imageManager.images?this.imageManager.updateImage(O,x[P][L],!1):this.imageManager.addImage(O,x[P][L]),h&&(this._changedImages[O]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),h&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"})),p&&p(v)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))}_validateLayer(o){const h=this.sourceCaches[o.source];if(!h)return;const p=o.sourceLayer;if(!p)return;const v=h.getSource();(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(p)===-1)&&this.fire(new u.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${v.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o){const h=this._serializedAllLayers();if(!o||o.length===0)return Object.values(h);const p=[];for(const v of o)h[v]&&p.push(h[v]);return p}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const h=Object.keys(this._layers);for(const p of h){const v=this._layers[p];v.type!=="custom"&&(o[p]=v.serialize())}return o}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const h=this._changed;if(this._changed){const v=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(v.length||x.length)&&this._updateWorkerLayers(v,x);for(const P in this._updatedSources){const A=this._updatedSources[P];if(A==="reload")this._reloadSource(P);else{if(A!=="clear")throw new Error(`Invalid action ${A}`);this._clearSource(P)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}const p={};for(const v in this.sourceCaches){const x=this.sourceCaches[v];p[v]=x.used,x.used=!1}for(const v of this._order){const x=this._layers[v];x.recalculate(o,this._availableImages),!x.isHidden(o.zoom)&&x.source&&(this.sourceCaches[x.source].used=!0)}for(const v in p){const x=this.sourceCaches[v];p[v]!==x.used&&x.fire(new u.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:v}))}this.light.recalculate(o),this.z=o.zoom,h&&this.fire(new u.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const h in this.sourceCaches)this.sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(o),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,h={}){this._checkLoaded();const p=this.serialize();if(o=h.transformStyle?h.transformStyle(p,o):o,wo(this,u.validateStyle(o)))return!1;(o=u.clone$1(o)).layers=u.derefLayers(o.layers);const v=u.diffStyles(p,o).filter(P=>!(P.command in Qn));if(v.length===0)return!1;const x=v.filter(P=>!(P.command in fn));if(x.length>0)throw new Error(`Unimplemented: ${x.map(P=>P.command).join(", ")}.`);for(const P of v)P.command!=="setTransition"&&this[P.command].apply(this,P.args);return this.stylesheet=o,!0}addImage(o,h){if(this.getImage(o))return this.fire(new u.ErrorEvent(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,h),this._afterImageUpdated(o)}updateImage(o,h){this.imageManager.updateImage(o,h)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new u.ErrorEvent(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,h,p={}){if(this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(u.validateStyle.source,`sources.${o}`,h,null,p))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const v=this.sourceCaches[o]=new tn(o,h,this.dispatcher);v.style=this,v.setEventedParent(this,()=>({isSourceLoaded:v.loaded(),source:v.serialize(),sourceId:o})),v.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===o)return this.fire(new u.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${p}" is using it.`)));const h=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],h.fire(new u.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),h.setEventedParent(null),h.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,h){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error(`There is no source with this ID=${o}`);const p=this.sourceCaches[o].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(h),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,h,p={}){this._checkLoaded();const v=o.id;if(this.getLayer(v))return void this.fire(new u.ErrorEvent(new Error(`Layer "${v}" already exists on this map.`)));let x;if(o.type==="custom"){if(wo(this,u.validateCustomStyleLayer(o)))return;x=u.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(v,o.source),o=u.clone$1(o),o=u.extend(o,{source:v})),this._validate(u.validateStyle.layer,`layers.${v}`,o,{arrayIndex:-1},p))return;x=u.createStyleLayer(o),this._validateLayer(x),x.setEventedParent(this,{layer:{id:v}})}const P=h?this._order.indexOf(h):this._order.length;if(h&&P===-1)this.fire(new u.ErrorEvent(new Error(`Cannot add layer "${v}" before non-existing layer "${h}".`)));else{if(this._order.splice(P,0,v),this._layerOrderChanged=!0,this._layers[v]=x,this._removedLayers[v]&&x.source&&x.type!=="custom"){const A=this._removedLayers[v];delete this._removedLayers[v],A.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}moveLayer(o,h){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new u.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===h)return;const p=this._order.indexOf(o);this._order.splice(p,1);const v=h?this._order.indexOf(h):this._order.length;h&&v===-1?this.fire(new u.ErrorEvent(new Error(`Cannot move layer "${o}" before non-existing layer "${h}".`))):(this._order.splice(v,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const h=this._layers[o];if(!h)return void this.fire(new u.ErrorEvent(new Error(`Cannot remove non-existing layer "${o}".`)));h.setEventedParent(null);const p=this._order.indexOf(o);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=h,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],h.onRemove&&h.onRemove(this.map)}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,h,p){this._checkLoaded();const v=this.getLayer(o);v?v.minzoom===h&&v.maxzoom===p||(h!=null&&(v.minzoom=h),p!=null&&(v.maxzoom=p),this._updateLayer(v)):this.fire(new u.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,h,p={}){this._checkLoaded();const v=this.getLayer(o);if(v){if(!u.deepEqual(v.filter,h))return h==null?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(u.validateStyle.filter,`layers.${v.id}.filter`,h,null,p)||(v.filter=u.clone$1(h),this._updateLayer(v)))}else this.fire(new u.ErrorEvent(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return u.clone$1(this.getLayer(o).filter)}setLayoutProperty(o,h,p,v={}){this._checkLoaded();const x=this.getLayer(o);x?u.deepEqual(x.getLayoutProperty(h),p)||(x.setLayoutProperty(h,p,v),this._updateLayer(x)):this.fire(new u.ErrorEvent(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,h){const p=this.getLayer(o);if(p)return p.getLayoutProperty(h);this.fire(new u.ErrorEvent(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,h,p,v={}){this._checkLoaded();const x=this.getLayer(o);x?u.deepEqual(x.getPaintProperty(h),p)||(x.setPaintProperty(h,p,v)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new u.ErrorEvent(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,h){return this.getLayer(o).getPaintProperty(h)}setFeatureState(o,h){this._checkLoaded();const p=o.source,v=o.sourceLayer,x=this.sourceCaches[p];if(x===void 0)return void this.fire(new u.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const P=x.getSource().type;P==="geojson"&&v?this.fire(new u.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):P!=="vector"||v?(o.id===void 0&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided."))),x.setFeatureState(v,o.id,h)):this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,h){this._checkLoaded();const p=o.source,v=this.sourceCaches[p];if(v===void 0)return void this.fire(new u.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const x=v.getSource().type,P=x==="vector"?o.sourceLayer:void 0;x!=="vector"||P?h&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new u.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):v.removeFeatureState(P,o.id,h):this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const h=o.source,p=o.sourceLayer,v=this.sourceCaches[h];if(v!==void 0)return v.getSource().type!=="vector"||p?(o.id===void 0&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided."))),v.getFeatureState(p,o.id)):void this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return u.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=u.mapObject(this.sourceCaches,v=>v.serialize()),h=this._serializeByIds(this._order),p=this.stylesheet;return u.filterObject({version:p.version,name:p.name,metadata:p.metadata,light:p.light,center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,sprite:p.sprite,glyphs:p.glyphs,transition:p.transition,sources:o,layers:h},v=>v!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const h=P=>this._layers[P].type==="fill-extrusion",p={},v=[];for(let P=this._order.length-1;P>=0;P--){const A=this._order[P];if(h(A)){p[A]=P;for(const L of o){const O=L[A];if(O)for(const F of O)v.push(F)}}}v.sort((P,A)=>A.intersectionZ-P.intersectionZ);const x=[];for(let P=this._order.length-1;P>=0;P--){const A=this._order[P];if(h(A))for(let L=v.length-1;L>=0;L--){const O=v[L].feature;if(p[O.layer.id]<P)break;x.push(O),v.pop()}else for(const L of o){const O=L[A];if(O)for(const F of O)x.push(F.feature)}}return x}queryRenderedFeatures(o,h,p){h&&h.filter&&this._validate(u.validateStyle.filter,"queryRenderedFeatures.filter",h.filter,null,h);const v={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new u.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const A of h.layers){const L=this._layers[A];if(!L)return this.fire(new u.ErrorEvent(new Error(`The layer '${A}' does not exist in the map's style and cannot be queried for features.`))),[];v[L.source]=!0}}const x=[];h.availableImages=this._availableImages;const P=this._serializedAllLayers();for(const A in this.sourceCaches)h.layers&&!v[A]||x.push(Mr(this.sourceCaches[A],this._layers,P,o,h,p));return this.placement&&x.push(function(A,L,O,F,B,Z,ie){const re={},ue=Z.queryRenderedSymbols(F),se=[];for(const xe of Object.keys(ue).map(Number))se.push(ie[xe]);se.sort(hs);for(const xe of se){const Le=xe.featureIndex.lookupSymbolFeatures(ue[xe.bucketInstanceId],L,xe.bucketIndex,xe.sourceLayerIndex,B.filter,B.layers,B.availableImages,A);for(const he in Le){const Ae=re[he]=re[he]||[],ze=Le[he];ze.sort((Ge,qe)=>{const Je=xe.featureSortOrder;if(Je){const Ke=Je.indexOf(Ge.featureIndex);return Je.indexOf(qe.featureIndex)-Ke}return qe.featureIndex-Ge.featureIndex});for(const Ge of ze)Ae.push(Ge)}}for(const xe in re)re[xe].forEach(Le=>{const he=Le.feature,Ae=O[A[xe].source].getFeatureState(he.layer["source-layer"],he.id);he.source=he.layer.source,he.layer["source-layer"]&&(he.sourceLayer=he.layer["source-layer"]),he.state=Ae});return re}(this._layers,P,this.sourceCaches,o,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(o,h){h&&h.filter&&this._validate(u.validateStyle.filter,"querySourceFeatures.filter",h.filter,null,h);const p=this.sourceCaches[o];return p?function(v,x){const P=v.getRenderableIds().map(O=>v.getTileByID(O)),A=[],L={};for(let O=0;O<P.length;O++){const F=P[O],B=F.tileID.canonical.key;L[B]||(L[B]=!0,F.querySourceFeatures(A,x))}return A}(p,h):[]}addSourceType(o,h,p){return Ei(o)?p(new Error(`A source type called "${o}" already exists.`)):(((v,x)=>{Xn[v]=x})(o,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:h.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(o,h={}){this._checkLoaded();const p=this.light.getLight();let v=!1;for(const P in o)if(!u.deepEqual(o[P],p[P])){v=!0;break}if(!v)return;const x={now:u.browser.now(),transition:u.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,h),this.light.updateTransitions(x)}_validate(o,h,p,v,x={}){return(!x||x.validate!==!1)&&wo(this,o.call(u.validateStyle,u.extend({key:h,style:this.serialize(),value:p,styleSpec:u.v8Spec},v)))}_remove(o=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),u.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const h in this._layers)this._layers[h].setEventedParent(null);for(const h in this.sourceCaches){const p=this.sourceCaches[h];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(o)}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const h in this.sourceCaches)this.sourceCaches[h].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,h,p,v,x=!1){let P=!1,A=!1;const L={};for(const O of this._order){const F=this._layers[O];if(F.type!=="symbol")continue;if(!L[F.source]){const Z=this.sourceCaches[F.source];L[F.source]=Z.getRenderableIds(!0).map(ie=>Z.getTileByID(ie)).sort((ie,re)=>re.tileID.overscaledZ-ie.tileID.overscaledZ||(ie.tileID.isLessThan(re.tileID)?-1:1))}const B=this.crossTileSymbolIndex.addLayer(F,L[F.source],o.center.lng);P=P||B}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(u.browser.now(),o.zoom))&&(this.pauseablePlacement=new aa(o,this.map.terrain,this._order,x,h,p,v,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(u.browser.now()),A=!0),P&&this.pauseablePlacement.placement.setStale()),A||P)for(const O of this._order){const F=this._layers[O];F.type==="symbol"&&this.placement.updateLayerOpacities(F,L[F.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(u.browser.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,h,p){this.imageManager.getImages(h.icons,p),this._updateTilesForChangedImages();const v=this.sourceCaches[h.source];v&&v.setDependencies(h.tileID.key,h.type,h.icons)}getGlyphs(o,h,p){this.glyphManager.getGlyphs(h.stacks,p);const v=this.sourceCaches[h.source];v&&v.setDependencies(h.tileID.key,h.type,[""])}getResource(o,h,p){return u.makeRequest(h,p)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,h={}){this._checkLoaded(),o&&this._validate(u.validateStyle.glyphs,"glyphs",o,null,h)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}addSprite(o,h,p={},v){this._checkLoaded();const x=[{id:o,url:h}],P=[...ot(this.stylesheet.sprite),...x];this._validate(u.validateStyle.sprite,"sprite",P,null,p)||(this.stylesheet.sprite=P,this._loadSprite(x,!0,v))}removeSprite(o){this._checkLoaded();const h=ot(this.stylesheet.sprite);if(h.find(p=>p.id===o)){if(this._spritesImagesIds[o])for(const p of this._spritesImagesIds[o])this.imageManager.removeImage(p),this._changedImages[p]=!0;h.splice(h.findIndex(p=>p.id===o),1),this.stylesheet.sprite=h.length>0?h:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))}else this.fire(new u.ErrorEvent(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return ot(this.stylesheet.sprite)}setSprite(o,h={},p){this._checkLoaded(),o&&this._validate(u.validateStyle.sprite,"sprite",o,null,h)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,p):(this._unloadSprite(),p&&p(null)))}}Vi.registerForPluginStateChange=u.registerForPluginStateChange;var Eo=u.createLayout([{name:"a_pos",type:"Int16",components:2}]),Os="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Vo={prelude:fr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:fr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:fr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:fr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:fr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:fr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:fr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:fr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:fr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:fr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:fr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:fr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:fr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:fr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:fr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:fr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:fr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:fr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:fr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:fr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:fr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:fr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:fr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:fr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:fr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:fr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:fr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Os),terrainDepth:fr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Os),terrainCoords:fr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Os)};function fr(_,o){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=o.match(/attribute ([\w]+) ([\w]+)/g),v=_.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=x?x.concat(v):v,A={};return{fragmentSource:_=_.replace(h,(L,O,F,B,Z)=>(A[Z]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
varying ${F} ${B} ${Z};
#else
uniform ${F} ${B} u_${Z};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Z}
    ${F} ${B} ${Z} = u_${Z};
#endif
`)),vertexSource:o=o.replace(h,(L,O,F,B,Z)=>{const ie=B==="float"?"vec2":"vec4",re=Z.match(/color/)?"color":ie;return A[Z]?O==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
uniform lowp float u_${Z}_t;
attribute ${F} ${ie} a_${Z};
varying ${F} ${B} ${Z};
#else
uniform ${F} ${B} u_${Z};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${Z}
    ${Z} = a_${Z};
#else
    ${F} ${B} ${Z} = u_${Z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Z}
    ${Z} = unpack_mix_${re}(a_${Z}, u_${Z}_t);
#else
    ${F} ${B} ${Z} = u_${Z};
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
uniform lowp float u_${Z}_t;
attribute ${F} ${ie} a_${Z};
#else
uniform ${F} ${B} u_${Z};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${Z}
    ${F} ${B} ${Z} = a_${Z};
#else
    ${F} ${B} ${Z} = u_${Z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Z}
    ${F} ${B} ${Z} = unpack_mix_${re}(a_${Z}, u_${Z}_t);
#else
    ${F} ${B} ${Z} = u_${Z};
#endif
`}),staticAttributes:p,staticUniforms:P}}class Sl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,h,p,v,x,P,A,L,O){this.context=o;let F=this.boundPaintVertexBuffers.length!==v.length;for(let B=0;!F&&B<v.length;B++)this.boundPaintVertexBuffers[B]!==v[B]&&(F=!0);!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==p||F||this.boundIndexBuffer!==x||this.boundVertexOffset!==P||this.boundDynamicVertexBuffer!==A||this.boundDynamicVertexBuffer2!==L||this.boundDynamicVertexBuffer3!==O?this.freshBind(h,p,v,x,P,A,L,O):(o.bindVertexArray.set(this.vao),A&&A.bind(),x&&x.dynamicDraw&&x.bind(),L&&L.bind(),O&&O.bind())}freshBind(o,h,p,v,x,P,A,L){const O=o.numAttributes,F=this.context,B=F.gl;this.vao&&this.destroy(),this.vao=F.createVertexArray(),F.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=v,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=P,this.boundDynamicVertexBuffer2=A,this.boundDynamicVertexBuffer3=L,h.enableAttributes(B,o);for(const Z of p)Z.enableAttributes(B,o);P&&P.enableAttributes(B,o),A&&A.enableAttributes(B,o),L&&L.enableAttributes(B,o),h.bind(),h.setVertexAttribPointers(B,o,x);for(const Z of p)Z.bind(),Z.setVertexAttribPointers(B,o,x);P&&(P.bind(),P.setVertexAttribPointers(B,o,x)),v&&v.bind(),A&&(A.bind(),A.setVertexAttribPointers(B,o,x)),L&&(L.bind(),L.setVertexAttribPointers(B,o,x)),F.currentNumAttributes=O}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function ds(_){const o=[];for(let h=0;h<_.length;h++){if(_[h]===null)continue;const p=_[h].split(" ");o.push(p.pop())}return o}class ic{constructor(o,h,p,v,x,P,A){const L=o.gl;this.program=L.createProgram();const O=ds(p.staticAttributes),F=v?v.getBinderAttributes():[],B=O.concat(F),Z=Vo.prelude.staticUniforms?ds(Vo.prelude.staticUniforms):[],ie=p.staticUniforms?ds(p.staticUniforms):[],re=v?v.getBinderUniforms():[],ue=Z.concat(ie).concat(re),se=[];for(const qe of ue)se.indexOf(qe)<0&&se.push(qe);const xe=v?v.defines():[];P&&xe.push("#define OVERDRAW_INSPECTOR;"),A&&xe.push("#define TERRAIN3D;");const Le=xe.concat(Vo.prelude.fragmentSource,p.fragmentSource).join(`
`),he=xe.concat(Vo.prelude.vertexSource,p.vertexSource).join(`
`),Ae=L.createShader(L.FRAGMENT_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);L.shaderSource(Ae,Le),L.compileShader(Ae),L.attachShader(this.program,Ae);const ze=L.createShader(L.VERTEX_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);L.shaderSource(ze,he),L.compileShader(ze),L.attachShader(this.program,ze),this.attributes={};const Ge={};this.numAttributes=B.length;for(let qe=0;qe<this.numAttributes;qe++)B[qe]&&(L.bindAttribLocation(this.program,qe,B[qe]),this.attributes[B[qe]]=qe);L.linkProgram(this.program),L.deleteShader(ze),L.deleteShader(Ae);for(let qe=0;qe<se.length;qe++){const Je=se[qe];if(Je&&!Ge[Je]){const Ke=L.getUniformLocation(this.program,Je);Ke&&(Ge[Je]=Ke)}}this.fixedUniforms=x(o,Ge),this.terrainUniforms=((qe,Je)=>({u_depth:new u.Uniform1i(qe,Je.u_depth),u_terrain:new u.Uniform1i(qe,Je.u_terrain),u_terrain_dim:new u.Uniform1f(qe,Je.u_terrain_dim),u_terrain_matrix:new u.UniformMatrix4f(qe,Je.u_terrain_matrix),u_terrain_unpack:new u.Uniform4f(qe,Je.u_terrain_unpack),u_terrain_exaggeration:new u.Uniform1f(qe,Je.u_terrain_exaggeration)}))(o,Ge),this.binderUniforms=v?v.getUniforms(o,Ge):[]}draw(o,h,p,v,x,P,A,L,O,F,B,Z,ie,re,ue,se,xe,Le){const he=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(p),o.setStencilMode(v),o.setColorMode(x),o.setCullFace(P),L){o.activeTexture.set(he.TEXTURE2),he.bindTexture(he.TEXTURE_2D,L.depthTexture),o.activeTexture.set(he.TEXTURE3),he.bindTexture(he.TEXTURE_2D,L.texture);for(const ze in this.terrainUniforms)this.terrainUniforms[ze].set(L[ze])}for(const ze in this.fixedUniforms)this.fixedUniforms[ze].set(A[ze]);ue&&ue.setUniforms(o,this.binderUniforms,ie,{zoom:re});let Ae=0;switch(h){case he.LINES:Ae=2;break;case he.TRIANGLES:Ae=3;break;case he.LINE_STRIP:Ae=1}for(const ze of Z.get()){const Ge=ze.vaos||(ze.vaos={});(Ge[O]||(Ge[O]=new Sl)).bind(o,this,F,ue?ue.getPaintVertexBuffers():[],B,ze.vertexOffset,se,xe,Le),he.drawElements(h,ze.primitiveLength*Ae,he.UNSIGNED_SHORT,ze.primitiveOffset*Ae*2)}}}function tu(_,o,h){const p=1/ve(h,1,o.transform.tileZoom),v=Math.pow(2,h.tileID.overscaledZ),x=h.tileSize*Math.pow(2,o.transform.tileZoom)/v,P=x*(h.tileID.canonical.x+h.tileID.wrap*v),A=x*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[p,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[P>>16,A>>16],u_pixel_coord_lower:[65535&P,65535&A]}}const sl=(_,o,h,p)=>{const v=o.style.light,x=v.properties.get("position"),P=[x.x,x.y,x.z],A=function(){var O=new u.ARRAY_TYPE(9);return u.ARRAY_TYPE!=Float32Array&&(O[1]=0,O[2]=0,O[3]=0,O[5]=0,O[6]=0,O[7]=0),O[0]=1,O[4]=1,O[8]=1,O}();v.properties.get("anchor")==="viewport"&&function(O,F){var B=Math.sin(F),Z=Math.cos(F);O[0]=Z,O[1]=B,O[2]=0,O[3]=-B,O[4]=Z,O[5]=0,O[6]=0,O[7]=0,O[8]=1}(A,-o.transform.angle),function(O,F,B){var Z=F[0],ie=F[1],re=F[2];O[0]=Z*B[0]+ie*B[3]+re*B[6],O[1]=Z*B[1]+ie*B[4]+re*B[7],O[2]=Z*B[2]+ie*B[5]+re*B[8]}(P,P,A);const L=v.properties.get("color");return{u_matrix:_,u_lightpos:P,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[L.r,L.g,L.b],u_vertical_gradient:+h,u_opacity:p}},al=(_,o,h,p,v,x,P)=>u.extend(sl(_,o,h,p),tu(x,o,P),{u_height_factor:-Math.pow(2,v.overscaledZ)/P.tileSize/8}),C=_=>({u_matrix:_}),y=(_,o,h,p)=>u.extend(C(_),tu(h,o,p)),T=(_,o)=>({u_matrix:_,u_world:o}),R=(_,o,h,p,v)=>u.extend(y(_,o,h,p),{u_world:v}),$=(_,o,h,p)=>{const v=_.transform;let x,P;if(p.paint.get("circle-pitch-alignment")==="map"){const A=ve(h,1,v.zoom);x=!0,P=[A,A]}else x=!1,P=v.pixelsToGLUnits;return{u_camera_to_center_distance:v.cameraToCenterDistance,u_scale_with_map:+(p.paint.get("circle-pitch-scale")==="map"),u_matrix:_.translatePosMatrix(o.posMatrix,h,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+x,u_device_pixel_ratio:_.pixelRatio,u_extrude_scale:P}},K=(_,o,h)=>{const p=ve(h,1,o.zoom),v=Math.pow(2,o.zoom-h.tileID.overscaledZ),x=h.tileID.overscaleFactor();return{u_matrix:_,u_camera_to_center_distance:o.cameraToCenterDistance,u_pixels_to_tile_units:p,u_extrude_scale:[o.pixelsToGLUnits[0]/(p*v),o.pixelsToGLUnits[1]/(p*v)],u_overscale_factor:x}},X=(_,o,h=1)=>({u_matrix:_,u_color:o,u_overlay:0,u_overlay_scale:h}),le=_=>({u_matrix:_}),we=(_,o,h,p)=>({u_matrix:_,u_extrude_scale:ve(o,1,h),u_intensity:p});function Ce(_,o){const h=Math.pow(2,o.canonical.z),p=o.canonical.y;return[new u.MercatorCoordinate(0,p/h).toLngLat().lat,new u.MercatorCoordinate(0,(p+1)/h).toLngLat().lat]}const Re=(_,o,h,p)=>{const v=_.transform;return{u_matrix:Tt(_,o,h,p),u_ratio:1/ve(o,1,v.zoom),u_device_pixel_ratio:_.pixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},fe=(_,o,h,p,v)=>u.extend(Re(_,o,h,v),{u_image:0,u_image_height:p}),$e=(_,o,h,p,v)=>{const x=_.transform,P=tt(o,x);return{u_matrix:Tt(_,o,h,v),u_texsize:o.imageAtlasTexture.size,u_ratio:1/ve(o,1,x.zoom),u_device_pixel_ratio:_.pixelRatio,u_image:0,u_scale:[P,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},at=(_,o,h,p,v,x)=>{const P=_.lineAtlas,A=tt(o,_.transform),L=h.layout.get("line-cap")==="round",O=P.getDash(p.from,L),F=P.getDash(p.to,L),B=O.width*v.fromScale,Z=F.width*v.toScale;return u.extend(Re(_,o,h,x),{u_patternscale_a:[A/B,-O.height/2],u_patternscale_b:[A/Z,-F.height/2],u_sdfgamma:P.width/(256*Math.min(B,Z)*_.pixelRatio)/2,u_image:0,u_tex_y_a:O.y,u_tex_y_b:F.y,u_mix:v.t})};function tt(_,o){return 1/ve(_,1,o.tileZoom)}function Tt(_,o,h,p){return _.translatePosMatrix(p?p.posMatrix:o.tileID.posMatrix,o,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}const Be=(_,o,h,p,v)=>{return{u_matrix:_,u_tl_parent:o,u_scale_parent:h,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(P=v.paint.get("raster-saturation"),P>0?1-1/(1.001-P):-P),u_contrast_factor:(x=v.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:Pe(v.paint.get("raster-hue-rotate"))};var x,P};function Pe(_){_*=Math.PI/180;const o=Math.sin(_),h=Math.cos(_);return[(2*h+1)/3,(-Math.sqrt(3)*o-h+1)/3,(Math.sqrt(3)*o-h+1)/3]}const rt=(_,o,h,p,v,x,P,A,L,O)=>{const F=v.transform;return{u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:F.cameraToCenterDistance,u_pitch:F.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:F.width/F.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:P,u_coord_matrix:A,u_is_text:+L,u_pitch_with_map:+p,u_texsize:O,u_texture:0}},rr=(_,o,h,p,v,x,P,A,L,O,F)=>{const B=v.transform;return u.extend(rt(_,o,h,p,v,x,P,A,L,O),{u_gamma_scale:p?Math.cos(B._pitch)*B.cameraToCenterDistance:1,u_device_pixel_ratio:v.pixelRatio,u_is_halo:+F})},Ot=(_,o,h,p,v,x,P,A,L,O)=>u.extend(rr(_,o,h,p,v,x,P,A,!0,L,!0),{u_texsize_icon:O,u_texture_icon:1}),vr=(_,o,h)=>({u_matrix:_,u_opacity:o,u_color:h}),Ft=(_,o,h,p,v,x)=>u.extend(function(P,A,L,O){const F=L.imageManager.getPattern(P.from.toString()),B=L.imageManager.getPattern(P.to.toString()),{width:Z,height:ie}=L.imageManager.getPixelSize(),re=Math.pow(2,O.tileID.overscaledZ),ue=O.tileSize*Math.pow(2,L.transform.tileZoom)/re,se=ue*(O.tileID.canonical.x+O.tileID.wrap*re),xe=ue*O.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:F.tl,u_pattern_br_a:F.br,u_pattern_tl_b:B.tl,u_pattern_br_b:B.br,u_texsize:[Z,ie],u_mix:A.t,u_pattern_size_a:F.displaySize,u_pattern_size_b:B.displaySize,u_scale_a:A.fromScale,u_scale_b:A.toScale,u_tile_units_to_pixels:1/ve(O,1,L.transform.tileZoom),u_pixel_coord_upper:[se>>16,xe>>16],u_pixel_coord_lower:[65535&se,65535&xe]}}(p,x,h,v),{u_matrix:_,u_opacity:o}),Pr={fillExtrusion:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_lightpos:new u.Uniform3f(_,o.u_lightpos),u_lightintensity:new u.Uniform1f(_,o.u_lightintensity),u_lightcolor:new u.Uniform3f(_,o.u_lightcolor),u_vertical_gradient:new u.Uniform1f(_,o.u_vertical_gradient),u_opacity:new u.Uniform1f(_,o.u_opacity)}),fillExtrusionPattern:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_lightpos:new u.Uniform3f(_,o.u_lightpos),u_lightintensity:new u.Uniform1f(_,o.u_lightintensity),u_lightcolor:new u.Uniform3f(_,o.u_lightcolor),u_vertical_gradient:new u.Uniform1f(_,o.u_vertical_gradient),u_height_factor:new u.Uniform1f(_,o.u_height_factor),u_image:new u.Uniform1i(_,o.u_image),u_texsize:new u.Uniform2f(_,o.u_texsize),u_pixel_coord_upper:new u.Uniform2f(_,o.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(_,o.u_pixel_coord_lower),u_scale:new u.Uniform3f(_,o.u_scale),u_fade:new u.Uniform1f(_,o.u_fade),u_opacity:new u.Uniform1f(_,o.u_opacity)}),fill:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix)}),fillPattern:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_image:new u.Uniform1i(_,o.u_image),u_texsize:new u.Uniform2f(_,o.u_texsize),u_pixel_coord_upper:new u.Uniform2f(_,o.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(_,o.u_pixel_coord_lower),u_scale:new u.Uniform3f(_,o.u_scale),u_fade:new u.Uniform1f(_,o.u_fade)}),fillOutline:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_world:new u.Uniform2f(_,o.u_world)}),fillOutlinePattern:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_world:new u.Uniform2f(_,o.u_world),u_image:new u.Uniform1i(_,o.u_image),u_texsize:new u.Uniform2f(_,o.u_texsize),u_pixel_coord_upper:new u.Uniform2f(_,o.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(_,o.u_pixel_coord_lower),u_scale:new u.Uniform3f(_,o.u_scale),u_fade:new u.Uniform1f(_,o.u_fade)}),circle:(_,o)=>({u_camera_to_center_distance:new u.Uniform1f(_,o.u_camera_to_center_distance),u_scale_with_map:new u.Uniform1i(_,o.u_scale_with_map),u_pitch_with_map:new u.Uniform1i(_,o.u_pitch_with_map),u_extrude_scale:new u.Uniform2f(_,o.u_extrude_scale),u_device_pixel_ratio:new u.Uniform1f(_,o.u_device_pixel_ratio),u_matrix:new u.UniformMatrix4f(_,o.u_matrix)}),collisionBox:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_camera_to_center_distance:new u.Uniform1f(_,o.u_camera_to_center_distance),u_pixels_to_tile_units:new u.Uniform1f(_,o.u_pixels_to_tile_units),u_extrude_scale:new u.Uniform2f(_,o.u_extrude_scale),u_overscale_factor:new u.Uniform1f(_,o.u_overscale_factor)}),collisionCircle:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_inv_matrix:new u.UniformMatrix4f(_,o.u_inv_matrix),u_camera_to_center_distance:new u.Uniform1f(_,o.u_camera_to_center_distance),u_viewport_size:new u.Uniform2f(_,o.u_viewport_size)}),debug:(_,o)=>({u_color:new u.UniformColor(_,o.u_color),u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_overlay:new u.Uniform1i(_,o.u_overlay),u_overlay_scale:new u.Uniform1f(_,o.u_overlay_scale)}),clippingMask:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix)}),heatmap:(_,o)=>({u_extrude_scale:new u.Uniform1f(_,o.u_extrude_scale),u_intensity:new u.Uniform1f(_,o.u_intensity),u_matrix:new u.UniformMatrix4f(_,o.u_matrix)}),heatmapTexture:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_world:new u.Uniform2f(_,o.u_world),u_image:new u.Uniform1i(_,o.u_image),u_color_ramp:new u.Uniform1i(_,o.u_color_ramp),u_opacity:new u.Uniform1f(_,o.u_opacity)}),hillshade:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_image:new u.Uniform1i(_,o.u_image),u_latrange:new u.Uniform2f(_,o.u_latrange),u_light:new u.Uniform2f(_,o.u_light),u_shadow:new u.UniformColor(_,o.u_shadow),u_highlight:new u.UniformColor(_,o.u_highlight),u_accent:new u.UniformColor(_,o.u_accent)}),hillshadePrepare:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_image:new u.Uniform1i(_,o.u_image),u_dimension:new u.Uniform2f(_,o.u_dimension),u_zoom:new u.Uniform1f(_,o.u_zoom),u_unpack:new u.Uniform4f(_,o.u_unpack)}),line:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_ratio:new u.Uniform1f(_,o.u_ratio),u_device_pixel_ratio:new u.Uniform1f(_,o.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(_,o.u_units_to_pixels)}),lineGradient:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_ratio:new u.Uniform1f(_,o.u_ratio),u_device_pixel_ratio:new u.Uniform1f(_,o.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(_,o.u_units_to_pixels),u_image:new u.Uniform1i(_,o.u_image),u_image_height:new u.Uniform1f(_,o.u_image_height)}),linePattern:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_texsize:new u.Uniform2f(_,o.u_texsize),u_ratio:new u.Uniform1f(_,o.u_ratio),u_device_pixel_ratio:new u.Uniform1f(_,o.u_device_pixel_ratio),u_image:new u.Uniform1i(_,o.u_image),u_units_to_pixels:new u.Uniform2f(_,o.u_units_to_pixels),u_scale:new u.Uniform3f(_,o.u_scale),u_fade:new u.Uniform1f(_,o.u_fade)}),lineSDF:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_ratio:new u.Uniform1f(_,o.u_ratio),u_device_pixel_ratio:new u.Uniform1f(_,o.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(_,o.u_units_to_pixels),u_patternscale_a:new u.Uniform2f(_,o.u_patternscale_a),u_patternscale_b:new u.Uniform2f(_,o.u_patternscale_b),u_sdfgamma:new u.Uniform1f(_,o.u_sdfgamma),u_image:new u.Uniform1i(_,o.u_image),u_tex_y_a:new u.Uniform1f(_,o.u_tex_y_a),u_tex_y_b:new u.Uniform1f(_,o.u_tex_y_b),u_mix:new u.Uniform1f(_,o.u_mix)}),raster:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_tl_parent:new u.Uniform2f(_,o.u_tl_parent),u_scale_parent:new u.Uniform1f(_,o.u_scale_parent),u_buffer_scale:new u.Uniform1f(_,o.u_buffer_scale),u_fade_t:new u.Uniform1f(_,o.u_fade_t),u_opacity:new u.Uniform1f(_,o.u_opacity),u_image0:new u.Uniform1i(_,o.u_image0),u_image1:new u.Uniform1i(_,o.u_image1),u_brightness_low:new u.Uniform1f(_,o.u_brightness_low),u_brightness_high:new u.Uniform1f(_,o.u_brightness_high),u_saturation_factor:new u.Uniform1f(_,o.u_saturation_factor),u_contrast_factor:new u.Uniform1f(_,o.u_contrast_factor),u_spin_weights:new u.Uniform3f(_,o.u_spin_weights)}),symbolIcon:(_,o)=>({u_is_size_zoom_constant:new u.Uniform1i(_,o.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(_,o.u_is_size_feature_constant),u_size_t:new u.Uniform1f(_,o.u_size_t),u_size:new u.Uniform1f(_,o.u_size),u_camera_to_center_distance:new u.Uniform1f(_,o.u_camera_to_center_distance),u_pitch:new u.Uniform1f(_,o.u_pitch),u_rotate_symbol:new u.Uniform1i(_,o.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(_,o.u_aspect_ratio),u_fade_change:new u.Uniform1f(_,o.u_fade_change),u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(_,o.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(_,o.u_coord_matrix),u_is_text:new u.Uniform1i(_,o.u_is_text),u_pitch_with_map:new u.Uniform1i(_,o.u_pitch_with_map),u_texsize:new u.Uniform2f(_,o.u_texsize),u_texture:new u.Uniform1i(_,o.u_texture)}),symbolSDF:(_,o)=>({u_is_size_zoom_constant:new u.Uniform1i(_,o.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(_,o.u_is_size_feature_constant),u_size_t:new u.Uniform1f(_,o.u_size_t),u_size:new u.Uniform1f(_,o.u_size),u_camera_to_center_distance:new u.Uniform1f(_,o.u_camera_to_center_distance),u_pitch:new u.Uniform1f(_,o.u_pitch),u_rotate_symbol:new u.Uniform1i(_,o.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(_,o.u_aspect_ratio),u_fade_change:new u.Uniform1f(_,o.u_fade_change),u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(_,o.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(_,o.u_coord_matrix),u_is_text:new u.Uniform1i(_,o.u_is_text),u_pitch_with_map:new u.Uniform1i(_,o.u_pitch_with_map),u_texsize:new u.Uniform2f(_,o.u_texsize),u_texture:new u.Uniform1i(_,o.u_texture),u_gamma_scale:new u.Uniform1f(_,o.u_gamma_scale),u_device_pixel_ratio:new u.Uniform1f(_,o.u_device_pixel_ratio),u_is_halo:new u.Uniform1i(_,o.u_is_halo)}),symbolTextAndIcon:(_,o)=>({u_is_size_zoom_constant:new u.Uniform1i(_,o.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(_,o.u_is_size_feature_constant),u_size_t:new u.Uniform1f(_,o.u_size_t),u_size:new u.Uniform1f(_,o.u_size),u_camera_to_center_distance:new u.Uniform1f(_,o.u_camera_to_center_distance),u_pitch:new u.Uniform1f(_,o.u_pitch),u_rotate_symbol:new u.Uniform1i(_,o.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(_,o.u_aspect_ratio),u_fade_change:new u.Uniform1f(_,o.u_fade_change),u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(_,o.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(_,o.u_coord_matrix),u_is_text:new u.Uniform1i(_,o.u_is_text),u_pitch_with_map:new u.Uniform1i(_,o.u_pitch_with_map),u_texsize:new u.Uniform2f(_,o.u_texsize),u_texsize_icon:new u.Uniform2f(_,o.u_texsize_icon),u_texture:new u.Uniform1i(_,o.u_texture),u_texture_icon:new u.Uniform1i(_,o.u_texture_icon),u_gamma_scale:new u.Uniform1f(_,o.u_gamma_scale),u_device_pixel_ratio:new u.Uniform1f(_,o.u_device_pixel_ratio),u_is_halo:new u.Uniform1i(_,o.u_is_halo)}),background:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_opacity:new u.Uniform1f(_,o.u_opacity),u_color:new u.UniformColor(_,o.u_color)}),backgroundPattern:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_opacity:new u.Uniform1f(_,o.u_opacity),u_image:new u.Uniform1i(_,o.u_image),u_pattern_tl_a:new u.Uniform2f(_,o.u_pattern_tl_a),u_pattern_br_a:new u.Uniform2f(_,o.u_pattern_br_a),u_pattern_tl_b:new u.Uniform2f(_,o.u_pattern_tl_b),u_pattern_br_b:new u.Uniform2f(_,o.u_pattern_br_b),u_texsize:new u.Uniform2f(_,o.u_texsize),u_mix:new u.Uniform1f(_,o.u_mix),u_pattern_size_a:new u.Uniform2f(_,o.u_pattern_size_a),u_pattern_size_b:new u.Uniform2f(_,o.u_pattern_size_b),u_scale_a:new u.Uniform1f(_,o.u_scale_a),u_scale_b:new u.Uniform1f(_,o.u_scale_b),u_pixel_coord_upper:new u.Uniform2f(_,o.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(_,o.u_pixel_coord_lower),u_tile_units_to_pixels:new u.Uniform1f(_,o.u_tile_units_to_pixels)}),terrain:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_texture:new u.Uniform1i(_,o.u_texture),u_ele_delta:new u.Uniform1f(_,o.u_ele_delta)}),terrainDepth:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_ele_delta:new u.Uniform1f(_,o.u_ele_delta)}),terrainCoords:(_,o)=>({u_matrix:new u.UniformMatrix4f(_,o.u_matrix),u_texture:new u.Uniform1i(_,o.u_texture),u_terrain_coords_id:new u.Uniform1f(_,o.u_terrain_coords_id),u_ele_delta:new u.Uniform1f(_,o.u_ele_delta)})};class Gi{constructor(o,h,p){this.context=o;const v=o.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const h=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Cr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class In{constructor(o,h,p,v){this.length=h.length,this.attributes=p,this.itemSize=h.bytesPerElement,this.dynamicDraw=v,this.context=o;const x=o.gl;this.buffer=x.createBuffer(),o.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,h){for(let p=0;p<this.attributes.length;p++){const v=h.attributes[this.attributes[p].name];v!==void 0&&o.enableVertexAttribArray(v)}}setVertexAttribPointers(o,h,p){for(let v=0;v<this.attributes.length;v++){const x=this.attributes[v],P=h.attributes[x.name];P!==void 0&&o.vertexAttribPointer(P,x.components,o[Cr[x.type]],!1,this.itemSize,x.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ln=new WeakMap;function Go(_){if(Ln.has(_))return Ln.get(_);{const o=_.getParameter(_.VERSION).startsWith("WebGL 2.0");return Ln.set(_,o),o}}class br{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class pi extends br{getDefault(){return u.Color.transparent}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class ll extends br{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class ul extends br{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class la extends br{getDefault(){return[!0,!0,!0,!0]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class ru extends br{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class cl extends br{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Tl extends br{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const h=this.current;(o.func!==h.func||o.ref!==h.ref||o.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Cl extends br{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class nu extends br{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=o,this.dirty=!1}}class Ds extends br{getDefault(){return[0,1]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class hl extends br{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=o,this.dirty=!1}}class zs extends br{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Oa extends br{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.BLEND):h.disable(h.BLEND),this.current=o,this.dirty=!1}}class ua extends br{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class zn extends br{getDefault(){return u.Color.transparent}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Da extends br{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class za extends br{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=o,this.dirty=!1}}class Fa extends br{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class qi extends br{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class Na extends br{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class Fs extends br{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Ns extends br{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class iu extends br{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class qo extends br{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class kr extends br{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class ca extends br{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Bs extends br{getDefault(){return null}set(o){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Hi extends br{getDefault(){return null}set(o){var h;if(o===this.current&&!this.dirty)return;const p=this.gl;Go(p)?p.bindVertexArray(o):(h=p.getExtension("OES_vertex_array_object"))===null||h===void 0||h.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class mi extends br{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class ha extends br{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class So extends br{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class da extends br{constructor(o,h){super(o),this.context=o,this.parent=h}getDefault(){return null}}class fs extends da{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Us extends da{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Ba extends da{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_STENCIL_ATTACHMENT,h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Ua{constructor(o,h,p,v,x){this.context=o,this.width=h,this.height=p;const P=o.gl,A=this.framebuffer=P.createFramebuffer();if(this.colorAttachment=new fs(o,A),v)this.depthAttachment=x?new Ba(o,A):new Us(o,A);else if(x)throw new Error("Stencil cannot be setted without depth");if(P.checkFramebufferStatus(P.FRAMEBUFFER)!==P.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const o=this.context.gl,h=this.colorAttachment.get();if(h&&o.deleteTexture(h),this.depthAttachment){const p=this.depthAttachment.get();p&&o.deleteRenderbuffer(p)}o.deleteFramebuffer(this.framebuffer)}}class mn{constructor(o,h,p){this.blendFunction=o,this.blendColor=h,this.mask=p}}mn.Replace=[1,0],mn.disabled=new mn(mn.Replace,u.Color.transparent,[!1,!1,!1,!1]),mn.unblended=new mn(mn.Replace,u.Color.transparent,[!0,!0,!0,!0]),mn.alphaBlended=new mn([1,771],u.Color.transparent,[!0,!0,!0,!0]);class Il{constructor(o){var h,p;if(this.gl=o,this.clearColor=new pi(this),this.clearDepth=new ll(this),this.clearStencil=new ul(this),this.colorMask=new la(this),this.depthMask=new ru(this),this.stencilMask=new cl(this),this.stencilFunc=new Tl(this),this.stencilOp=new Cl(this),this.stencilTest=new nu(this),this.depthRange=new Ds(this),this.depthTest=new hl(this),this.depthFunc=new zs(this),this.blend=new Oa(this),this.blendFunc=new ua(this),this.blendColor=new zn(this),this.blendEquation=new Da(this),this.cullFace=new za(this),this.cullFaceSide=new Fa(this),this.frontFace=new qi(this),this.program=new Na(this),this.activeTexture=new Fs(this),this.viewport=new Ns(this),this.bindFramebuffer=new iu(this),this.bindRenderbuffer=new qo(this),this.bindTexture=new kr(this),this.bindVertexBuffer=new ca(this),this.bindElementBuffer=new Bs(this),this.bindVertexArray=new Hi(this),this.pixelStoreUnpack=new mi(this),this.pixelStoreUnpackPremultiplyAlpha=new ha(this),this.pixelStoreUnpackFlipY=new So(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),Go(o)){this.HALF_FLOAT=o.HALF_FLOAT;const v=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(h=o.RGBA16F)!==null&&h!==void 0?h:v==null?void 0:v.RGBA16F_EXT,this.RGB16F=(p=o.RGB16F)!==null&&p!==void 0?p:v==null?void 0:v.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const v=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=v==null?void 0:v.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,h){return new Gi(this,o,h)}createVertexBuffer(o,h,p){return new In(this,o,h,p)}createRenderbuffer(o,h,p){const v=this.gl,x=v.createRenderbuffer();return this.bindRenderbuffer.set(x),v.renderbufferStorage(v.RENDERBUFFER,o,h,p),this.bindRenderbuffer.set(null),x}createFramebuffer(o,h,p,v){return new Ua(this,o,h,p,v)}clear({color:o,depth:h,stencil:p}){const v=this.gl;let x=0;o&&(x|=v.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(x|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),p!==void 0&&(x|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),v.clear(x)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){u.deepEqual(o.blendFunction,mn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return Go(this.gl)?this.gl.createVertexArray():(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var h;return Go(this.gl)?this.gl.deleteVertexArray(o):(h=this.gl.getExtension("OES_vertex_array_object"))===null||h===void 0?void 0:h.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}class cr{constructor(o,h,p){this.func=o,this.mask=h,this.range=p}}cr.ReadOnly=!1,cr.ReadWrite=!0,cr.disabled=new cr(519,cr.ReadOnly,[0,1]);const Ho=7680;class wr{constructor(o,h,p,v,x,P){this.test=o,this.ref=h,this.mask=p,this.fail=v,this.depthFail=x,this.pass=P}}wr.disabled=new wr({func:519,mask:0},0,0,Ho,Ho,Ho);class hr{constructor(o,h,p){this.enable=o,this.mode=h,this.frontFace=p}}let To;function Ii(_,o,h,p,v,x,P){const A=_.context,L=A.gl,O=_.useProgram("collisionBox"),F=[];let B=0,Z=0;for(let he=0;he<p.length;he++){const Ae=p[he],ze=o.getTile(Ae),Ge=ze.getBucket(h);if(!Ge)continue;let qe=Ae.posMatrix;v[0]===0&&v[1]===0||(qe=_.translatePosMatrix(Ae.posMatrix,ze,v,x));const Je=P?Ge.textCollisionBox:Ge.iconCollisionBox,Ke=Ge.collisionCircleArray;if(Ke.length>0){const gt=u.create(),It=qe;u.mul(gt,Ge.placementInvProjMatrix,_.transform.glCoordMatrix),u.mul(gt,gt,Ge.placementViewportMatrix),F.push({circleArray:Ke,circleOffset:Z,transform:It,invTransform:gt,coord:Ae}),B+=Ke.length/4,Z=B}Je&&O.draw(A,L.LINES,cr.disabled,wr.disabled,_.colorModeForRenderPass(),hr.disabled,K(qe,_.transform,ze),_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ae),h.id,Je.layoutVertexBuffer,Je.indexBuffer,Je.segments,null,_.transform.zoom,null,null,Je.collisionVertexBuffer)}if(!P||!F.length)return;const ie=_.useProgram("collisionCircle"),re=new u.CollisionCircleLayoutArray;re.resize(4*B),re._trim();let ue=0;for(const he of F)for(let Ae=0;Ae<he.circleArray.length/4;Ae++){const ze=4*Ae,Ge=he.circleArray[ze+0],qe=he.circleArray[ze+1],Je=he.circleArray[ze+2],Ke=he.circleArray[ze+3];re.emplace(ue++,Ge,qe,Je,Ke,0),re.emplace(ue++,Ge,qe,Je,Ke,1),re.emplace(ue++,Ge,qe,Je,Ke,2),re.emplace(ue++,Ge,qe,Je,Ke,3)}(!To||To.length<2*B)&&(To=function(he){const Ae=2*he,ze=new u.QuadTriangleArray;ze.resize(Ae),ze._trim();for(let Ge=0;Ge<Ae;Ge++){const qe=6*Ge;ze.uint16[qe+0]=4*Ge+0,ze.uint16[qe+1]=4*Ge+1,ze.uint16[qe+2]=4*Ge+2,ze.uint16[qe+3]=4*Ge+2,ze.uint16[qe+4]=4*Ge+3,ze.uint16[qe+5]=4*Ge+0}return ze}(B));const se=A.createIndexBuffer(To,!0),xe=A.createVertexBuffer(re,u.collisionCircleLayout.members,!0);for(const he of F){const Ae={u_matrix:he.transform,u_inv_matrix:he.invTransform,u_camera_to_center_distance:(Le=_.transform).cameraToCenterDistance,u_viewport_size:[Le.width,Le.height]};ie.draw(A,L.TRIANGLES,cr.disabled,wr.disabled,_.colorModeForRenderPass(),hr.disabled,Ae,_.style.map.terrain&&_.style.map.terrain.getTerrainData(he.coord),h.id,xe,se,u.SegmentVector.simpleSegment(0,2*he.circleOffset,he.circleArray.length,he.circleArray.length/2),null,_.transform.zoom,null,null,null)}var Le;xe.destroy(),se.destroy()}hr.disabled=new hr(!1,1029,2305),hr.backCCW=new hr(!0,1029,2305);const ps=u.identity(new Float32Array(16));function ms(_,o,h,p,v,x){const{horizontalAlign:P,verticalAlign:A}=u.getAnchorAlignment(_),L=-(P-.5)*o,O=-(A-.5)*h,F=u.evaluateVariableOffset(_,p);return new u.Point((L/v+F[0])*x,(O/v+F[1])*x)}function gs(_,o,h,p,v,x,P,A,L,O,F){const B=_.text.placedSymbolArray,Z=_.text.dynamicLayoutVertexArray,ie=_.icon.dynamicLayoutVertexArray,re={};Z.clear();for(let ue=0;ue<B.length;ue++){const se=B.get(ue),xe=se.hidden||!se.crossTileID||_.allowVerticalPlacement&&!se.placedOrientation?null:p[se.crossTileID];if(xe){const Le=new u.Point(se.anchorX,se.anchorY),he=Bt(Le,h?P:x,F),Ae=Jr(v.cameraToCenterDistance,he.signedDistanceFromCamera);let ze=u.evaluateSizeForFeature(_.textSizeData,L,se)*Ae/u.ONE_EM;h&&(ze*=_.tilePixelRatio/A);const{width:Ge,height:qe,anchor:Je,textOffset:Ke,textBoxScale:gt}=xe,It=ms(Je,Ge,qe,Ke,gt,ze),pr=h?Bt(Le.add(It),x,F).point:he.point.add(o?It.rotate(-v.angle):It),ct=_.allowVerticalPlacement&&se.placedOrientation===u.WritingMode.vertical?Math.PI/2:0;for(let Ht=0;Ht<se.numGlyphs;Ht++)u.addDynamicAttributes(Z,pr,ct);O&&se.associatedIconIndex>=0&&(re[se.associatedIconIndex]={shiftedAnchor:pr,angle:ct})}else ee(se.numGlyphs,Z)}if(O){ie.clear();const ue=_.icon.placedSymbolArray;for(let se=0;se<ue.length;se++){const xe=ue.get(se);if(xe.hidden)ee(xe.numGlyphs,ie);else{const Le=re[se];if(Le)for(let he=0;he<xe.numGlyphs;he++)u.addDynamicAttributes(ie,Le.shiftedAnchor,Le.angle);else ee(xe.numGlyphs,ie)}}_.icon.dynamicLayoutVertexBuffer.updateData(ie)}_.text.dynamicLayoutVertexBuffer.updateData(Z)}function js(_,o,h){return h.iconsInText&&o?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function $s(_,o,h,p,v,x,P,A,L,O,F,B){const Z=_.context,ie=Z.gl,re=_.transform,ue=A==="map",se=L==="map",xe=A!=="viewport"&&h.layout.get("symbol-placement")!=="point",Le=ue&&!se&&!xe,he=!h.layout.get("symbol-sort-key").isConstant();let Ae=!1;const ze=_.depthModeForSublayer(0,cr.ReadOnly),Ge=h.layout.get("text-variable-anchor"),qe=[];for(const Je of p){const Ke=o.getTile(Je),gt=Ke.getBucket(h);if(!gt)continue;const It=v?gt.text:gt.icon;if(!It||!It.segments.get().length||!It.hasVisibleVertices)continue;const pr=It.programConfigurations.get(h.id),ct=v||gt.sdfIcons,Ht=v?gt.textSizeData:gt.iconSizeData,bt=se||re.pitch!==0,Vr=_.useProgram(js(ct,v,gt),pr),Or=u.evaluateSizeForZoom(Ht,re.zoom),Er=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Je);let nr,Rn,Fi,ri,Ai=[0,0],Ko=null;if(v)Rn=Ke.glyphAtlasTexture,Fi=ie.LINEAR,nr=Ke.glyphAtlasTexture.size,gt.iconsInText&&(Ai=Ke.imageAtlasTexture.size,Ko=Ke.imageAtlasTexture,ri=bt||_.options.rotating||_.options.zooming||Ht.kind==="composite"||Ht.kind==="camera"?ie.LINEAR:ie.NEAREST);else{const yi=h.layout.get("icon-size").constantOr(0)!==1||gt.iconsNeedLinear;Rn=Ke.imageAtlasTexture,Fi=ct||_.options.rotating||_.options.zooming||yi||bt?ie.LINEAR:ie.NEAREST,nr=Ke.imageAtlasTexture.size}const qs=ve(Ke,1,_.transform.zoom),Hs=Nr(Je.posMatrix,se,ue,_.transform,qs),fo=$o(Je.posMatrix,se,ue,_.transform,qs),wa=Ge&&gt.hasTextData(),uc=h.layout.get("icon-text-fit")!=="none"&&wa&&gt.hasIconData();if(xe){const yi=_.style.map.terrain?(Zc,Ga)=>_.style.map.terrain.getElevation(Je,Zc,Ga):null,Xo=h.layout.get("text-rotation-alignment")==="map";lo(gt,Je.posMatrix,_,v,Hs,fo,se,O,Xo,yi)}const Ji=_.translatePosMatrix(Je.posMatrix,Ke,x,P),Mi=xe||v&&Ge||uc?ps:Hs,Kr=_.translatePosMatrix(fo,Ke,x,P,!0),gi=ct&&h.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ki;ki=ct?gt.iconsInText?Ot(Ht.kind,Or,Le,se,_,Ji,Mi,Kr,nr,Ai):rr(Ht.kind,Or,Le,se,_,Ji,Mi,Kr,v,nr,!0):rt(Ht.kind,Or,Le,se,_,Ji,Mi,Kr,v,nr);const en={program:Vr,buffers:It,uniformValues:ki,atlasTexture:Rn,atlasTextureIcon:Ko,atlasInterpolation:Fi,atlasInterpolationIcon:ri,isSDF:ct,hasHalo:gi};if(he&&gt.canOverlap){Ae=!0;const yi=It.segments.get();for(const Xo of yi)qe.push({segments:new u.SegmentVector([Xo]),sortKey:Xo.sortKey,state:en,terrainData:Er})}else qe.push({segments:It.segments,sortKey:0,state:en,terrainData:Er})}Ae&&qe.sort((Je,Ke)=>Je.sortKey-Ke.sortKey);for(const Je of qe){const Ke=Je.state;if(Z.activeTexture.set(ie.TEXTURE0),Ke.atlasTexture.bind(Ke.atlasInterpolation,ie.CLAMP_TO_EDGE),Ke.atlasTextureIcon&&(Z.activeTexture.set(ie.TEXTURE1),Ke.atlasTextureIcon&&Ke.atlasTextureIcon.bind(Ke.atlasInterpolationIcon,ie.CLAMP_TO_EDGE)),Ke.isSDF){const gt=Ke.uniformValues;Ke.hasHalo&&(gt.u_is_halo=1,fa(Ke.buffers,Je.segments,h,_,Ke.program,ze,F,B,gt,Je.terrainData)),gt.u_is_halo=0}fa(Ke.buffers,Je.segments,h,_,Ke.program,ze,F,B,Ke.uniformValues,Je.terrainData)}}function fa(_,o,h,p,v,x,P,A,L,O){const F=p.context;v.draw(F,F.gl.TRIANGLES,x,P,A,hr.disabled,L,O,h.id,_.layoutVertexBuffer,_.indexBuffer,o,h.paint,p.transform.zoom,_.programConfigurations.get(h.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function pa(_,o,h,p,v){if(!h||!p||!p.imageAtlas)return;const x=p.imageAtlas.patternPositions;let P=x[h.to.toString()],A=x[h.from.toString()];if(!P||!A){const L=v.getPaintProperty(o);P=x[L],A=x[L]}P&&A&&_.setConstantPatternPositions(P,A)}function ja(_,o,h,p,v,x,P){const A=_.context.gl,L="fill-pattern",O=h.paint.get(L),F=O&&O.constantOr(1),B=h.getCrossfadeParameters();let Z,ie,re,ue,se;P?(ie=F&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Z=A.LINES):(ie=F?"fillPattern":"fill",Z=A.TRIANGLES);const xe=O.constantOr(null);for(const Le of p){const he=o.getTile(Le);if(F&&!he.patternsLoaded())continue;const Ae=he.getBucket(h);if(!Ae)continue;const ze=Ae.programConfigurations.get(h.id),Ge=_.useProgram(ie,ze),qe=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Le);F&&(_.context.activeTexture.set(A.TEXTURE0),he.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),ze.updatePaintBuffers(B)),pa(ze,L,xe,he,h);const Je=qe?Le:null,Ke=_.translatePosMatrix(Je?Je.posMatrix:Le.posMatrix,he,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(P){ue=Ae.indexBuffer2,se=Ae.segments2;const gt=[A.drawingBufferWidth,A.drawingBufferHeight];re=ie==="fillOutlinePattern"&&F?R(Ke,_,B,he,gt):T(Ke,gt)}else ue=Ae.indexBuffer,se=Ae.segments,re=F?y(Ke,_,B,he):C(Ke);Ge.draw(_.context,Z,v,_.stencilModeForClipping(Le),x,hr.disabled,re,qe,h.id,Ae.layoutVertexBuffer,ue,se,h.paint,_.transform.zoom,ze)}}function $a(_,o,h,p,v,x,P){const A=_.context,L=A.gl,O="fill-extrusion-pattern",F=h.paint.get(O),B=F.constantOr(1),Z=h.getCrossfadeParameters(),ie=h.paint.get("fill-extrusion-opacity"),re=F.constantOr(null);for(const ue of p){const se=o.getTile(ue),xe=se.getBucket(h);if(!xe)continue;const Le=_.style.map.terrain&&_.style.map.terrain.getTerrainData(ue),he=xe.programConfigurations.get(h.id),Ae=_.useProgram(B?"fillExtrusionPattern":"fillExtrusion",he);B&&(_.context.activeTexture.set(L.TEXTURE0),se.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),he.updatePaintBuffers(Z)),pa(he,O,re,se,h);const ze=_.translatePosMatrix(ue.posMatrix,se,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Ge=h.paint.get("fill-extrusion-vertical-gradient"),qe=B?al(ze,_,Ge,ie,ue,Z,se):sl(ze,_,Ge,ie);Ae.draw(A,A.gl.TRIANGLES,v,x,P,hr.backCCW,qe,Le,h.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,h.paint,_.transform.zoom,he,_.style.map.terrain&&xe.centroidVertexBuffer)}}function Vs(_,o,h,p,v,x,P){const A=_.context,L=A.gl,O=h.fbo;if(!O)return;const F=_.useProgram("hillshade"),B=_.style.map.terrain&&_.style.map.terrain.getTerrainData(o);A.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,O.colorAttachment.get()),F.draw(A,L.TRIANGLES,v,x,P,hr.disabled,((Z,ie,re,ue)=>{const se=re.paint.get("hillshade-shadow-color"),xe=re.paint.get("hillshade-highlight-color"),Le=re.paint.get("hillshade-accent-color");let he=re.paint.get("hillshade-illumination-direction")*(Math.PI/180);re.paint.get("hillshade-illumination-anchor")==="viewport"&&(he-=Z.transform.angle);const Ae=!Z.options.moving;return{u_matrix:ue?ue.posMatrix:Z.transform.calculatePosMatrix(ie.tileID.toUnwrapped(),Ae),u_image:0,u_latrange:Ce(0,ie.tileID),u_light:[re.paint.get("hillshade-exaggeration"),he],u_shadow:se,u_highlight:xe,u_accent:Le}})(_,h,p,B?o:null),B,p.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}function un(_,o,h,p,v,x){const P=_.context,A=P.gl,L=o.dem;if(L&&L.data){const O=L.dim,F=L.stride,B=L.getPixels();if(P.activeTexture.set(A.TEXTURE1),P.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||_.getTileTexture(F),o.demTexture){const ie=o.demTexture;ie.update(B,{premultiply:!1}),ie.bind(A.NEAREST,A.CLAMP_TO_EDGE)}else o.demTexture=new st(P,B,A.RGBA,{premultiply:!1}),o.demTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE);P.activeTexture.set(A.TEXTURE0);let Z=o.fbo;if(!Z){const ie=new st(P,{width:O,height:O,data:null},A.RGBA);ie.bind(A.LINEAR,A.CLAMP_TO_EDGE),Z=o.fbo=P.createFramebuffer(O,O,!0,!1),Z.colorAttachment.set(ie.texture)}P.bindFramebuffer.set(Z.framebuffer),P.viewport.set([0,0,O,O]),_.useProgram("hillshadePrepare").draw(P,A.TRIANGLES,p,v,x,hr.disabled,((ie,re)=>{const ue=re.stride,se=u.create();return u.ortho(se,0,u.EXTENT,-u.EXTENT,0,0,1),u.translate(se,se,[0,-u.EXTENT,0]),{u_matrix:se,u_image:1,u_dimension:[ue,ue],u_zoom:ie.overscaledZ,u_unpack:re.getUnpackVector()}})(o.tileID,L),null,h.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function Zi(_,o,h,p,v,x){const P=p.paint.get("raster-fade-duration");if(!x&&P>0){const A=u.browser.now(),L=(A-_.timeAdded)/P,O=o?(A-o.timeAdded)/P:-1,F=h.getSource(),B=v.coveringZoomLevel({tileSize:F.tileSize,roundZoom:F.roundZoom}),Z=!o||Math.abs(o.tileID.overscaledZ-B)>Math.abs(_.tileID.overscaledZ-B),ie=Z&&_.refreshedUponExpiration?1:u.clamp(Z?L:1-O,0,1);return _.refreshedUponExpiration&&L>=1&&(_.refreshedUponExpiration=!1),o?{opacity:1,mix:1-ie}:{opacity:ie,mix:0}}return{opacity:1,mix:0}}const Ee=new u.Color(1,0,0,1),Fe=new u.Color(0,1,0,1),ft=new u.Color(0,0,1,1),At=new u.Color(1,0,1,1),Fr=new u.Color(0,1,1,1);function dr(_,o,h,p){nn(_,0,o+h/2,_.transform.width,h,p)}function Qr(_,o,h,p){nn(_,o-h/2,0,h,_.transform.height,p)}function nn(_,o,h,p,v,x){const P=_.context,A=P.gl;A.enable(A.SCISSOR_TEST),A.scissor(o*_.pixelRatio,h*_.pixelRatio,p*_.pixelRatio,v*_.pixelRatio),P.clear({color:x}),A.disable(A.SCISSOR_TEST)}function zi(_,o,h){const p=_.context,v=p.gl,x=h.posMatrix,P=_.useProgram("debug"),A=cr.disabled,L=wr.disabled,O=_.colorModeForRenderPass(),F="$debug",B=_.style.map.terrain&&_.style.map.terrain.getTerrainData(h);p.activeTexture.set(v.TEXTURE0);const Z=o.getTileByID(h.key).latestRawTileData,ie=Math.floor((Z&&Z.byteLength||0)/1024),re=o.getTile(h).tileSize,ue=512/Math.min(re,512)*(h.overscaledZ/_.transform.zoom)*.5;let se=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(se+=` => ${h.overscaledZ}`),function(xe,Le){xe.initDebugOverlayCanvas();const he=xe.debugOverlayCanvas,Ae=xe.context.gl,ze=xe.debugOverlayCanvas.getContext("2d");ze.clearRect(0,0,he.width,he.height),ze.shadowColor="white",ze.shadowBlur=2,ze.lineWidth=1.5,ze.strokeStyle="white",ze.textBaseline="top",ze.font="bold 36px Open Sans, sans-serif",ze.fillText(Le,5,5),ze.strokeText(Le,5,5),xe.debugOverlayTexture.update(he),xe.debugOverlayTexture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE)}(_,`${se} ${ie}kB`),P.draw(p,v.TRIANGLES,A,L,mn.alphaBlended,hr.disabled,X(x,u.Color.transparent,ue),null,F,_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments),P.draw(p,v.LINE_STRIP,A,L,O,hr.disabled,X(x,u.Color.red),B,F,_.debugBuffer,_.tileBorderIndexBuffer,_.debugSegments)}function bn(_,o,h){const p=_.context,v=p.gl,x=_.colorModeForRenderPass(),P=new cr(v.LEQUAL,cr.ReadWrite,_.depthRangeFor3D),A=_.useProgram("terrain"),L=o.getTerrainMesh();p.bindFramebuffer.set(null),p.viewport.set([0,0,_.width,_.height]);for(const O of h){const F=_.renderToTexture.getTexture(O),B=o.getTerrainData(O.tileID);p.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,F.texture);const Z={u_matrix:_.transform.calculatePosMatrix(O.tileID.toUnwrapped()),u_texture:0,u_ele_delta:o.getMeshFrameDelta(_.transform.zoom)};A.draw(p,v.TRIANGLES,P,wr.disabled,x,hr.backCCW,Z,B,"terrain",L.vertexBuffer,L.indexBuffer,L.segments)}}class Pn{constructor(o,h){this.context=new Il(o),this.transform=h,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.create(),renderTime:0},this.setup(),this.numSublayers=tn.maxUnderzooming+tn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Hr}resize(o,h,p){if(this.width=Math.floor(o*p),this.height=Math.floor(h*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style._order)this.style._layers[v].resize()}setup(){const o=this.context,h=new u.PosArray;h.emplaceBack(0,0),h.emplaceBack(u.EXTENT,0),h.emplaceBack(0,u.EXTENT),h.emplaceBack(u.EXTENT,u.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(h,Eo.members),this.tileExtentSegments=u.SegmentVector.simpleSegment(0,0,4,2);const p=new u.PosArray;p.emplaceBack(0,0),p.emplaceBack(u.EXTENT,0),p.emplaceBack(0,u.EXTENT),p.emplaceBack(u.EXTENT,u.EXTENT),this.debugBuffer=o.createVertexBuffer(p,Eo.members),this.debugSegments=u.SegmentVector.simpleSegment(0,0,4,5);const v=new u.RasterBoundsArray;v.emplaceBack(0,0,0,0),v.emplaceBack(u.EXTENT,0,u.EXTENT,0),v.emplaceBack(0,u.EXTENT,0,u.EXTENT),v.emplaceBack(u.EXTENT,u.EXTENT,u.EXTENT,u.EXTENT),this.rasterBoundsBuffer=o.createVertexBuffer(v,er.members),this.rasterBoundsSegments=u.SegmentVector.simpleSegment(0,0,4,2);const x=new u.PosArray;x.emplaceBack(0,0),x.emplaceBack(1,0),x.emplaceBack(0,1),x.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(x,Eo.members),this.viewportSegments=u.SegmentVector.simpleSegment(0,0,4,2);const P=new u.LineStripIndexArray;P.emplaceBack(0),P.emplaceBack(1),P.emplaceBack(3),P.emplaceBack(2),P.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(P);const A=new u.TriangleIndexArray;A.emplaceBack(0,1,2),A.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(A);const L=this.context.gl;this.stencilClearMode=new wr({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO)}clearStencil(){const o=this.context,h=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=u.create();u.ortho(p,0,this.width,this.height,0,0,1),u.scale(p,p,[h.drawingBufferWidth,h.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(o,h.TRIANGLES,cr.disabled,this.stencilClearMode,mn.disabled,hr.disabled,le(p),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,h){if(this.currentStencilSource===o.source||!o.isTileClipped()||!h||!h.length)return;this.currentStencilSource=o.source;const p=this.context,v=p.gl;this.nextStencilID+h.length>256&&this.clearStencil(),p.setColorMode(mn.disabled),p.setDepthMode(cr.disabled);const x=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const P of h){const A=this._tileClippingMaskIDs[P.key]=this.nextStencilID++,L=this.style.map.terrain&&this.style.map.terrain.getTerrainData(P);x.draw(p,v.TRIANGLES,cr.disabled,new wr({func:v.ALWAYS,mask:0},A,255,v.KEEP,v.KEEP,v.REPLACE),mn.disabled,hr.disabled,le(P.posMatrix),L,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,h=this.context.gl;return new wr({func:h.NOTEQUAL,mask:255},o,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(o){const h=this.context.gl;return new wr({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(o){const h=this.context.gl,p=o.sort((P,A)=>A.overscaledZ-P.overscaledZ),v=p[p.length-1].overscaledZ,x=p[0].overscaledZ-v+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const P={};for(let A=0;A<x;A++)P[A+v]=new wr({func:h.GEQUAL,mask:255},A+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=x,[P,p]}return[{[v]:wr.disabled},p]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new mn([o.CONSTANT_COLOR,o.ONE],new u.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?mn.unblended:mn.alphaBlended}depthModeForSublayer(o,h,p){if(!this.opaquePassEnabledForLayer())return cr.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new cr(p||this.context.gl.LEQUAL,h,[v,v])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,h){this.style=o,this.options=h,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(u.browser.now()),this.imageManager.beginFrame();const p=this.style._order,v=this.style.sourceCaches,x={},P={},A={};for(const L in v){const O=v[L];O.used&&O.prepare(this.context),x[L]=O.getVisibleCoordinates(),P[L]=x[L].slice().reverse(),A[L]=O.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let L=0;L<p.length;L++)if(this.style._layers[p[L]].is3D()){this.opaquePassCutoff=L;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const L=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!u.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||L.length)&&(u.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(O,F){const B=O.context,Z=B.gl,ie=mn.unblended,re=new cr(Z.LEQUAL,cr.ReadWrite,[0,1]),ue=F.getTerrainMesh(),se=F.sourceCache.getRenderableTiles(),xe=O.useProgram("terrainDepth");B.bindFramebuffer.set(F.getFramebuffer("depth").framebuffer),B.viewport.set([0,0,O.width/devicePixelRatio,O.height/devicePixelRatio]),B.clear({color:u.Color.transparent,depth:1});for(const Le of se){const he=F.getTerrainData(Le.tileID),Ae={u_matrix:O.transform.calculatePosMatrix(Le.tileID.toUnwrapped()),u_ele_delta:F.getMeshFrameDelta(O.transform.zoom)};xe.draw(B,Z.TRIANGLES,re,wr.disabled,ie,hr.backCCW,Ae,he,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments)}B.bindFramebuffer.set(null),B.viewport.set([0,0,O.width,O.height])}(this,this.style.map.terrain),function(O,F){const B=O.context,Z=B.gl,ie=mn.unblended,re=new cr(Z.LEQUAL,cr.ReadWrite,[0,1]),ue=F.getTerrainMesh(),se=F.getCoordsTexture(),xe=F.sourceCache.getRenderableTiles(),Le=O.useProgram("terrainCoords");B.bindFramebuffer.set(F.getFramebuffer("coords").framebuffer),B.viewport.set([0,0,O.width/devicePixelRatio,O.height/devicePixelRatio]),B.clear({color:u.Color.transparent,depth:1}),F.coordsIndex=[];for(const he of xe){const Ae=F.getTerrainData(he.tileID);B.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,se.texture);const ze={u_matrix:O.transform.calculatePosMatrix(he.tileID.toUnwrapped()),u_terrain_coords_id:(255-F.coordsIndex.length)/255,u_texture:0,u_ele_delta:F.getMeshFrameDelta(O.transform.zoom)};Le.draw(B,Z.TRIANGLES,re,wr.disabled,ie,hr.backCCW,ze,Ae,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments),F.coordsIndex.push(he.tileID.key)}B.bindFramebuffer.set(null),B.viewport.set([0,0,O.width,O.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const L of p){const O=this.style._layers[L];if(!O.hasOffscreenPass()||O.isHidden(this.transform.zoom))continue;const F=P[O.source];(O.type==="custom"||F.length)&&this.renderLayer(this,v[O.source],O,F)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:h.showOverdrawInspector?u.Color.black:u.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const L=this.style._layers[p[this.currentLayer]],O=v[L.source],F=x[L.source];this._renderTileClippingMasks(L,F),this.renderLayer(this,O,L,F)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const L=this.style._layers[p[this.currentLayer]],O=v[L.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(L))continue;const F=(L.type==="symbol"?A:P)[L.source];this._renderTileClippingMasks(L,x[L.source]),this.renderLayer(this,O,L,F)}if(this.options.showTileBoundaries){const L=function(O,F){let B=null;const Z=Object.values(O._layers).flatMap(se=>se.source&&!se.isHidden(F)?[O.sourceCaches[se.source]]:[]),ie=Z.filter(se=>se.getSource().type==="vector"),re=Z.filter(se=>se.getSource().type!=="vector"),ue=se=>{(!B||B.getSource().maxzoom<se.getSource().maxzoom)&&(B=se)};return ie.forEach(se=>ue(se)),B||re.forEach(se=>ue(se)),B}(this.style,this.transform.zoom);L&&function(O,F,B){for(let Z=0;Z<B.length;Z++)zi(O,F,B[Z])}(this,L,L.getVisibleCoordinates())}this.options.showPadding&&function(L){const O=L.transform.padding;dr(L,L.transform.height-(O.top||0),3,Ee),dr(L,O.bottom||0,3,Fe),Qr(L,O.left||0,3,ft),Qr(L,L.transform.width-(O.right||0),3,At);const F=L.transform.centerPoint;(function(B,Z,ie,re){nn(B,Z-1,ie-10,2,20,re),nn(B,Z-10,ie-1,20,2,re)})(L,F.x,L.transform.height-F.y,Fr)}(this),this.context.setDefault()}renderLayer(o,h,p,v){if(!p.isHidden(this.transform.zoom)&&(p.type==="background"||p.type==="custom"||(v||[]).length))switch(this.id=p.id,p.type){case"symbol":(function(x,P,A,L,O){if(x.renderPass!=="translucent")return;const F=wr.disabled,B=x.colorModeForRenderPass();A.layout.get("text-variable-anchor")&&function(Z,ie,re,ue,se,xe,Le){const he=ie.transform,Ae=se==="map",ze=xe==="map";for(const Ge of Z){const qe=ue.getTile(Ge),Je=qe.getBucket(re);if(!Je||!Je.text||!Je.text.segments.get().length)continue;const Ke=u.evaluateSizeForZoom(Je.textSizeData,he.zoom),gt=ve(qe,1,ie.transform.zoom),It=Nr(Ge.posMatrix,ze,Ae,ie.transform,gt),pr=re.layout.get("icon-text-fit")!=="none"&&Je.hasIconData();if(Ke){const ct=Math.pow(2,he.zoom-qe.tileID.overscaledZ);gs(Je,Ae,ze,Le,he,It,Ge.posMatrix,ct,Ke,pr,ie.style.map.terrain?(Ht,bt)=>ie.style.map.terrain.getElevation(Ge,Ht,bt):null)}}}(L,x,A,P,A.layout.get("text-rotation-alignment"),A.layout.get("text-pitch-alignment"),O),A.paint.get("icon-opacity").constantOr(1)!==0&&$s(x,P,A,L,!1,A.paint.get("icon-translate"),A.paint.get("icon-translate-anchor"),A.layout.get("icon-rotation-alignment"),A.layout.get("icon-pitch-alignment"),A.layout.get("icon-keep-upright"),F,B),A.paint.get("text-opacity").constantOr(1)!==0&&$s(x,P,A,L,!0,A.paint.get("text-translate"),A.paint.get("text-translate-anchor"),A.layout.get("text-rotation-alignment"),A.layout.get("text-pitch-alignment"),A.layout.get("text-keep-upright"),F,B),P.map.showCollisionBoxes&&(Ii(x,P,A,L,A.paint.get("text-translate"),A.paint.get("text-translate-anchor"),!0),Ii(x,P,A,L,A.paint.get("icon-translate"),A.paint.get("icon-translate-anchor"),!1))})(o,h,p,v,this.style.placement.variableOffsets);break;case"circle":(function(x,P,A,L){if(x.renderPass!=="translucent")return;const O=A.paint.get("circle-opacity"),F=A.paint.get("circle-stroke-width"),B=A.paint.get("circle-stroke-opacity"),Z=!A.layout.get("circle-sort-key").isConstant();if(O.constantOr(1)===0&&(F.constantOr(1)===0||B.constantOr(1)===0))return;const ie=x.context,re=ie.gl,ue=x.depthModeForSublayer(0,cr.ReadOnly),se=wr.disabled,xe=x.colorModeForRenderPass(),Le=[];for(let he=0;he<L.length;he++){const Ae=L[he],ze=P.getTile(Ae),Ge=ze.getBucket(A);if(!Ge)continue;const qe=Ge.programConfigurations.get(A.id),Je=x.useProgram("circle",qe),Ke=Ge.layoutVertexBuffer,gt=Ge.indexBuffer,It=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ae),pr={programConfiguration:qe,program:Je,layoutVertexBuffer:Ke,indexBuffer:gt,uniformValues:$(x,Ae,ze,A),terrainData:It};if(Z){const ct=Ge.segments.get();for(const Ht of ct)Le.push({segments:new u.SegmentVector([Ht]),sortKey:Ht.sortKey,state:pr})}else Le.push({segments:Ge.segments,sortKey:0,state:pr})}Z&&Le.sort((he,Ae)=>he.sortKey-Ae.sortKey);for(const he of Le){const{programConfiguration:Ae,program:ze,layoutVertexBuffer:Ge,indexBuffer:qe,uniformValues:Je,terrainData:Ke}=he.state;ze.draw(ie,re.TRIANGLES,ue,se,xe,hr.disabled,Je,Ke,A.id,Ge,qe,he.segments,A.paint,x.transform.zoom,Ae)}})(o,h,p,v);break;case"heatmap":(function(x,P,A,L){if(A.paint.get("heatmap-opacity")!==0)if(x.renderPass==="offscreen"){const O=x.context,F=O.gl,B=wr.disabled,Z=new mn([F.ONE,F.ONE],u.Color.transparent,[!0,!0,!0,!0]);(function(ie,re,ue){const se=ie.gl;ie.activeTexture.set(se.TEXTURE1),ie.viewport.set([0,0,re.width/4,re.height/4]);let xe=ue.heatmapFbo;if(xe)se.bindTexture(se.TEXTURE_2D,xe.colorAttachment.get()),ie.bindFramebuffer.set(xe.framebuffer);else{const Le=se.createTexture();se.bindTexture(se.TEXTURE_2D,Le),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_S,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_T,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MIN_FILTER,se.LINEAR),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MAG_FILTER,se.LINEAR),xe=ue.heatmapFbo=ie.createFramebuffer(re.width/4,re.height/4,!1,!1),function(he,Ae,ze,Ge){var qe,Je;const Ke=he.gl,gt=(qe=he.HALF_FLOAT)!==null&&qe!==void 0?qe:Ke.UNSIGNED_BYTE,It=(Je=he.RGBA16F)!==null&&Je!==void 0?Je:Ke.RGBA;Ke.texImage2D(Ke.TEXTURE_2D,0,It,Ae.width/4,Ae.height/4,0,Ke.RGBA,gt,null),Ge.colorAttachment.set(ze)}(ie,re,Le,xe)}})(O,x,A),O.clear({color:u.Color.transparent});for(let ie=0;ie<L.length;ie++){const re=L[ie];if(P.hasRenderableParent(re))continue;const ue=P.getTile(re),se=ue.getBucket(A);if(!se)continue;const xe=se.programConfigurations.get(A.id),Le=x.useProgram("heatmap",xe),{zoom:he}=x.transform;Le.draw(O,F.TRIANGLES,cr.disabled,B,Z,hr.disabled,we(re.posMatrix,ue,he,A.paint.get("heatmap-intensity")),null,A.id,se.layoutVertexBuffer,se.indexBuffer,se.segments,A.paint,x.transform.zoom,xe)}O.viewport.set([0,0,x.width,x.height])}else x.renderPass==="translucent"&&(x.context.setColorMode(x.colorModeForRenderPass()),function(O,F){const B=O.context,Z=B.gl,ie=F.heatmapFbo;if(!ie)return;B.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,ie.colorAttachment.get()),B.activeTexture.set(Z.TEXTURE1);let re=F.colorRampTexture;re||(re=F.colorRampTexture=new st(B,F.colorRamp,Z.RGBA)),re.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),O.useProgram("heatmapTexture").draw(B,Z.TRIANGLES,cr.disabled,wr.disabled,O.colorModeForRenderPass(),hr.disabled,((ue,se,xe,Le)=>{const he=u.create();u.ortho(he,0,ue.width,ue.height,0,0,1);const Ae=ue.context.gl;return{u_matrix:he,u_world:[Ae.drawingBufferWidth,Ae.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:se.paint.get("heatmap-opacity")}})(O,F),null,F.id,O.viewportBuffer,O.quadTriangleIndexBuffer,O.viewportSegments,F.paint,O.transform.zoom)}(x,A))})(o,h,p,v);break;case"line":(function(x,P,A,L){if(x.renderPass!=="translucent")return;const O=A.paint.get("line-opacity"),F=A.paint.get("line-width");if(O.constantOr(1)===0||F.constantOr(1)===0)return;const B=x.depthModeForSublayer(0,cr.ReadOnly),Z=x.colorModeForRenderPass(),ie=A.paint.get("line-dasharray"),re=A.paint.get("line-pattern"),ue=re.constantOr(1),se=A.paint.get("line-gradient"),xe=A.getCrossfadeParameters(),Le=ue?"linePattern":ie?"lineSDF":se?"lineGradient":"line",he=x.context,Ae=he.gl;let ze=!0;for(const Ge of L){const qe=P.getTile(Ge);if(ue&&!qe.patternsLoaded())continue;const Je=qe.getBucket(A);if(!Je)continue;const Ke=Je.programConfigurations.get(A.id),gt=x.context.program.get(),It=x.useProgram(Le,Ke),pr=ze||It.program!==gt,ct=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ge),Ht=re.constantOr(null);if(Ht&&qe.imageAtlas){const Or=qe.imageAtlas,Er=Or.patternPositions[Ht.to.toString()],nr=Or.patternPositions[Ht.from.toString()];Er&&nr&&Ke.setConstantPatternPositions(Er,nr)}const bt=ct?Ge:null,Vr=ue?$e(x,qe,A,xe,bt):ie?at(x,qe,A,ie,xe,bt):se?fe(x,qe,A,Je.lineClipsArray.length,bt):Re(x,qe,A,bt);if(ue)he.activeTexture.set(Ae.TEXTURE0),qe.imageAtlasTexture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE),Ke.updatePaintBuffers(xe);else if(ie&&(pr||x.lineAtlas.dirty))he.activeTexture.set(Ae.TEXTURE0),x.lineAtlas.bind(he);else if(se){const Or=Je.gradients[A.id];let Er=Or.texture;if(A.gradientVersion!==Or.version){let nr=256;if(A.stepInterpolant){const Rn=P.getSource().maxzoom,Fi=Ge.canonical.z===Rn?Math.ceil(1<<x.transform.maxZoom-Ge.canonical.z):1;nr=u.clamp(u.nextPowerOfTwo(Je.maxLineLength/u.EXTENT*1024*Fi),256,he.maxTextureSize)}Or.gradient=u.renderColorRamp({expression:A.gradientExpression(),evaluationKey:"lineProgress",resolution:nr,image:Or.gradient||void 0,clips:Je.lineClipsArray}),Or.texture?Or.texture.update(Or.gradient):Or.texture=new st(he,Or.gradient,Ae.RGBA),Or.version=A.gradientVersion,Er=Or.texture}he.activeTexture.set(Ae.TEXTURE0),Er.bind(A.stepInterpolant?Ae.NEAREST:Ae.LINEAR,Ae.CLAMP_TO_EDGE)}It.draw(he,Ae.TRIANGLES,B,x.stencilModeForClipping(Ge),Z,hr.disabled,Vr,ct,A.id,Je.layoutVertexBuffer,Je.indexBuffer,Je.segments,A.paint,x.transform.zoom,Ke,Je.layoutVertexBuffer2),ze=!1}})(o,h,p,v);break;case"fill":(function(x,P,A,L){const O=A.paint.get("fill-color"),F=A.paint.get("fill-opacity");if(F.constantOr(1)===0)return;const B=x.colorModeForRenderPass(),Z=A.paint.get("fill-pattern"),ie=x.opaquePassEnabledForLayer()&&!Z.constantOr(1)&&O.constantOr(u.Color.transparent).a===1&&F.constantOr(0)===1?"opaque":"translucent";if(x.renderPass===ie){const re=x.depthModeForSublayer(1,x.renderPass==="opaque"?cr.ReadWrite:cr.ReadOnly);ja(x,P,A,L,re,B,!1)}if(x.renderPass==="translucent"&&A.paint.get("fill-antialias")){const re=x.depthModeForSublayer(A.getPaintProperty("fill-outline-color")?2:0,cr.ReadOnly);ja(x,P,A,L,re,B,!0)}})(o,h,p,v);break;case"fill-extrusion":(function(x,P,A,L){const O=A.paint.get("fill-extrusion-opacity");if(O!==0&&x.renderPass==="translucent"){const F=new cr(x.context.gl.LEQUAL,cr.ReadWrite,x.depthRangeFor3D);if(O!==1||A.paint.get("fill-extrusion-pattern").constantOr(1))$a(x,P,A,L,F,wr.disabled,mn.disabled),$a(x,P,A,L,F,x.stencilModeFor3D(),x.colorModeForRenderPass());else{const B=x.colorModeForRenderPass();$a(x,P,A,L,F,wr.disabled,B)}}})(o,h,p,v);break;case"hillshade":(function(x,P,A,L){if(x.renderPass!=="offscreen"&&x.renderPass!=="translucent")return;const O=x.context,F=x.depthModeForSublayer(0,cr.ReadOnly),B=x.colorModeForRenderPass(),[Z,ie]=x.renderPass==="translucent"?x.stencilConfigForOverlap(L):[{},L];for(const re of ie){const ue=P.getTile(re);ue.needsHillshadePrepare!==void 0&&ue.needsHillshadePrepare&&x.renderPass==="offscreen"?un(x,ue,A,F,wr.disabled,B):x.renderPass==="translucent"&&Vs(x,re,ue,A,F,Z[re.overscaledZ],B)}O.viewport.set([0,0,x.width,x.height])})(o,h,p,v);break;case"raster":(function(x,P,A,L){if(x.renderPass!=="translucent"||A.paint.get("raster-opacity")===0||!L.length)return;const O=x.context,F=O.gl,B=P.getSource(),Z=x.useProgram("raster"),ie=x.colorModeForRenderPass(),[re,ue]=B instanceof so?[{},L]:x.stencilConfigForOverlap(L),se=ue[ue.length-1].overscaledZ,xe=!x.options.moving;for(const Le of ue){const he=x.depthModeForSublayer(Le.overscaledZ-se,A.paint.get("raster-opacity")===1?cr.ReadWrite:cr.ReadOnly,F.LESS),Ae=P.getTile(Le);Ae.registerFadeDuration(A.paint.get("raster-fade-duration"));const ze=P.findLoadedParent(Le,0),Ge=Zi(Ae,ze,P,A,x.transform,x.style.map.terrain);let qe,Je;const Ke=A.paint.get("raster-resampling")==="nearest"?F.NEAREST:F.LINEAR;O.activeTexture.set(F.TEXTURE0),Ae.texture.bind(Ke,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST),O.activeTexture.set(F.TEXTURE1),ze?(ze.texture.bind(Ke,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST),qe=Math.pow(2,ze.tileID.overscaledZ-Ae.tileID.overscaledZ),Je=[Ae.tileID.canonical.x*qe%1,Ae.tileID.canonical.y*qe%1]):Ae.texture.bind(Ke,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST);const gt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Le),It=gt?Le:null,pr=It?It.posMatrix:x.transform.calculatePosMatrix(Le.toUnwrapped(),xe),ct=Be(pr,Je||[0,0],qe||1,Ge,A);B instanceof so?Z.draw(O,F.TRIANGLES,he,wr.disabled,ie,hr.disabled,ct,gt,A.id,B.boundsBuffer,x.quadTriangleIndexBuffer,B.boundsSegments):Z.draw(O,F.TRIANGLES,he,re[Le.overscaledZ],ie,hr.disabled,ct,gt,A.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments)}})(o,h,p,v);break;case"background":(function(x,P,A,L){const O=A.paint.get("background-color"),F=A.paint.get("background-opacity");if(F===0)return;const B=x.context,Z=B.gl,ie=x.transform,re=ie.tileSize,ue=A.paint.get("background-pattern");if(x.isPatternMissing(ue))return;const se=!ue&&O.a===1&&F===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==se)return;const xe=wr.disabled,Le=x.depthModeForSublayer(0,se==="opaque"?cr.ReadWrite:cr.ReadOnly),he=x.colorModeForRenderPass(),Ae=x.useProgram(ue?"backgroundPattern":"background"),ze=L||ie.coveringTiles({tileSize:re,terrain:x.style.map.terrain});ue&&(B.activeTexture.set(Z.TEXTURE0),x.imageManager.bind(x.context));const Ge=A.getCrossfadeParameters();for(const qe of ze){const Je=L?qe.posMatrix:x.transform.calculatePosMatrix(qe.toUnwrapped()),Ke=ue?Ft(Je,F,x,ue,{tileID:qe,tileSize:re},Ge):vr(Je,F,O),gt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(qe);Ae.draw(B,Z.TRIANGLES,Le,xe,he,hr.disabled,Ke,gt,A.id,x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}})(o,0,p,v);break;case"custom":(function(x,P,A){const L=x.context,O=A.implementation;if(x.renderPass==="offscreen"){const F=O.prerender;F&&(x.setCustomLayerDefaults(),L.setColorMode(x.colorModeForRenderPass()),F.call(O,L.gl,x.transform.customLayerMatrix()),L.setDirty(),x.setBaseState())}else if(x.renderPass==="translucent"){x.setCustomLayerDefaults(),L.setColorMode(x.colorModeForRenderPass()),L.setStencilMode(wr.disabled);const F=O.renderingMode==="3d"?new cr(x.context.gl.LEQUAL,cr.ReadWrite,x.depthRangeFor3D):x.depthModeForSublayer(0,cr.ReadOnly);L.setDepthMode(F),O.render(L.gl,x.transform.customLayerMatrix()),L.setDirty(),x.setBaseState(),L.bindFramebuffer.set(null)}})(o,0,p)}}translatePosMatrix(o,h,p,v,x){if(!p[0]&&!p[1])return o;const P=x?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(P){const O=Math.sin(P),F=Math.cos(P);p=[p[0]*F-p[1]*O,p[0]*O+p[1]*F]}const A=[x?p[0]:ve(h,p[0],this.transform.zoom),x?p[1]:ve(h,p[1],this.transform.zoom),0],L=new Float32Array(16);return u.translate(L,o,A),L}saveTileTexture(o){const h=this._tileTextures[o.size[0]];h?h.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const h=this._tileTextures[o];return h&&h.length>0?h.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const h=this.imageManager.getPattern(o.from.toString()),p=this.imageManager.getPattern(o.to.toString());return!h||!p}useProgram(o,h){this.cache=this.cache||{};const p=o+(h?h.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[p]||(this.cache[p]=new ic(this.context,o,Vo[o],h,Pr[o],this._showOverdrawInspector,this.style.map.terrain)),this.cache[p]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new st(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:h}=this.context.gl;return this.width!==o||this.height!==h}}class ei{constructor(o,h){this.points=o,this.planes=h}static fromInvProjectionMatrix(o,h,p){const v=Math.pow(2,p),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(A=>{const L=1/(A=u.transformMat4([],A,o))[3]/h*v;return u.mul$1(A,A,[L,L,1/A[3],L])}),P=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(A=>{const L=function(Z,ie){var re=ie[0],ue=ie[1],se=ie[2],xe=re*re+ue*ue+se*se;return xe>0&&(xe=1/Math.sqrt(xe)),Z[0]=ie[0]*xe,Z[1]=ie[1]*xe,Z[2]=ie[2]*xe,Z}([],function(Z,ie,re){var ue=ie[0],se=ie[1],xe=ie[2],Le=re[0],he=re[1],Ae=re[2];return Z[0]=se*Ae-xe*he,Z[1]=xe*Le-ue*Ae,Z[2]=ue*he-se*Le,Z}([],je([],x[A[0]],x[A[1]]),je([],x[A[2]],x[A[1]]))),O=-((F=L)[0]*(B=x[A[1]])[0]+F[1]*B[1]+F[2]*B[2]);var F,B;return L.concat(O)});return new ei(x,P)}}class Fn{constructor(o,h){this.min=o,this.max=h,this.center=function(p,v,x){return p[0]=.5*v[0],p[1]=.5*v[1],p[2]=.5*v[2],p}([],function(p,v,x){return p[0]=v[0]+x[0],p[1]=v[1]+x[1],p[2]=v[2]+x[2],p}([],this.min,this.max))}quadrant(o){const h=[o%2==0,o<2],p=Me(this.min),v=Me(this.max);for(let x=0;x<h.length;x++)p[x]=h[x]?this.min[x]:this.center[x],v[x]=h[x]?this.center[x]:this.max[x];return v[2]=this.max[2],new Fn(p,v)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersects(o){const h=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let p=!0;for(let v=0;v<o.planes.length;v++){const x=o.planes[v];let P=0;for(let A=0;A<h.length;A++)u.dot(x,h[A])>=0&&P++;if(P===0)return 0;P!==h.length&&(p=!1)}if(p)return 2;for(let v=0;v<3;v++){let x=Number.MAX_VALUE,P=-Number.MAX_VALUE;for(let A=0;A<o.points.length;A++){const L=o.points[A][v]-this.min[v];x=Math.min(x,L),P=Math.max(P,L)}if(P<0||x>this.max[v]-this.min[v])return 0}return 1}}class $n{constructor(o=0,h=0,p=0,v=0){if(isNaN(o)||o<0||isNaN(h)||h<0||isNaN(p)||p<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=h,this.left=p,this.right=v}interpolate(o,h,p){return h.top!=null&&o.top!=null&&(this.top=u.interpolate.number(o.top,h.top,p)),h.bottom!=null&&o.bottom!=null&&(this.bottom=u.interpolate.number(o.bottom,h.bottom,p)),h.left!=null&&o.left!=null&&(this.left=u.interpolate.number(o.left,h.left,p)),h.right!=null&&o.right!=null&&(this.right=u.interpolate.number(o.right,h.right,p)),this}getCenter(o,h){const p=u.clamp((this.left+o-this.right)/2,0,o),v=u.clamp((this.top+h-this.bottom)/2,0,h);return new u.Point(p,v)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new $n(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Se{constructor(o,h,p,v,x){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=x===void 0||!!x,this._minZoom=o||0,this._maxZoom=h||22,this._minPitch=p??0,this._maxPitch=v??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new u.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new $n,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const o=new Se(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o.apply(this),o}apply(o){this.tileSize=o.tileSize,this.latRange=o.latRange,this.width=o.width,this.height=o.height,this._center=o._center,this._elevation=o._elevation,this.zoom=o.zoom,this.angle=o.angle,this._fov=o._fov,this._pitch=o._pitch,this._unmodified=o._unmodified,this._edgeInsets=o._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(o){const h=-u.wrap(o,-180,180)*Math.PI/180;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=function(){var p=new u.ARRAY_TYPE(4);return u.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p}(),function(p,v,x){var P=v[0],A=v[1],L=v[2],O=v[3],F=Math.sin(x),B=Math.cos(x);p[0]=P*B+L*F,p[1]=A*B+O*F,p[2]=P*-F+L*B,p[3]=A*-F+O*B}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const h=u.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(o){const h=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._zoom=h,this.tileZoom=Math.max(0,Math.floor(h)),this.scale=this.zoomScale(h),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(o){o!==this._elevation&&(this._elevation=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,h,p){this._unmodified=!1,this._edgeInsets.interpolate(o,h,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const h=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(o){const h=[new u.UnwrappedTileID(0,o)];if(this._renderWorldCopies){const p=this.pointCoordinate(new u.Point(0,0)),v=this.pointCoordinate(new u.Point(this.width,0)),x=this.pointCoordinate(new u.Point(this.width,this.height)),P=this.pointCoordinate(new u.Point(0,this.height)),A=Math.floor(Math.min(p.x,v.x,x.x,P.x)),L=Math.floor(Math.max(p.x,v.x,x.x,P.x)),O=1;for(let F=A-O;F<=L+O;F++)F!==0&&h.push(new u.UnwrappedTileID(F,o))}return h}coveringTiles(o){var h,p;let v=this.coveringZoomLevel(o);const x=v;if(o.minzoom!==void 0&&v<o.minzoom)return[];o.maxzoom!==void 0&&v>o.maxzoom&&(v=o.maxzoom);const P=this.pointCoordinate(this.getCameraPoint()),A=u.MercatorCoordinate.fromLngLat(this.center),L=Math.pow(2,v),O=[L*P.x,L*P.y,0],F=[L*A.x,L*A.y,0],B=ei.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,v);let Z=o.minzoom||0;!o.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(Z=v);const ie=o.terrain?2/Math.min(this.tileSize,o.tileSize)*this.tileSize:3,re=he=>({aabb:new Fn([he*L,0,0],[(he+1)*L,L,0]),zoom:0,x:0,y:0,wrap:he,fullyVisible:!1}),ue=[],se=[],xe=v,Le=o.reparseOverscaled?x:v;if(this._renderWorldCopies)for(let he=1;he<=3;he++)ue.push(re(-he)),ue.push(re(he));for(ue.push(re(0));ue.length>0;){const he=ue.pop(),Ae=he.x,ze=he.y;let Ge=he.fullyVisible;if(!Ge){const It=he.aabb.intersects(B);if(It===0)continue;Ge=It===2}const qe=o.terrain?O:F,Je=he.aabb.distanceX(qe),Ke=he.aabb.distanceY(qe),gt=Math.max(Math.abs(Je),Math.abs(Ke));if(he.zoom===xe||gt>ie+(1<<xe-he.zoom)-2&&he.zoom>=Z){const It=xe-he.zoom,pr=O[0]-.5-(Ae<<It),ct=O[1]-.5-(ze<<It);se.push({tileID:new u.OverscaledTileID(he.zoom===xe?Le:he.zoom,he.wrap,he.zoom,Ae,ze),distanceSq:Qe([F[0]-.5-Ae,F[1]-.5-ze]),tileDistanceToCamera:Math.sqrt(pr*pr+ct*ct)})}else for(let It=0;It<4;It++){const pr=(Ae<<1)+It%2,ct=(ze<<1)+(It>>1),Ht=he.zoom+1;let bt=he.aabb.quadrant(It);if(o.terrain){const Vr=new u.OverscaledTileID(Ht,he.wrap,Ht,pr,ct),Or=o.terrain.getMinMaxElevation(Vr),Er=(h=Or.minElevation)!==null&&h!==void 0?h:this.elevation,nr=(p=Or.maxElevation)!==null&&p!==void 0?p:this.elevation;bt=new Fn([bt.min[0],bt.min[1],Er],[bt.max[0],bt.max[1],nr])}ue.push({aabb:bt,zoom:Ht,x:pr,y:ct,wrap:he.wrap,fullyVisible:Ge})}}return se.sort((he,Ae)=>he.distanceSq-Ae.distanceSq).map(he=>he.tileID)}resize(o,h){this.width=o,this.height=h,this.pixelsToGLUnits=[2/o,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const h=u.clamp(o.lat,-this.maxValidLatitude,this.maxValidLatitude);return new u.Point(u.mercatorXfromLng(o.lng)*this.worldSize,u.mercatorYfromLat(h)*this.worldSize)}unproject(o){return new u.MercatorCoordinate(o.x/this.worldSize,o.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(o){this.freezeElevation||(this.elevation=o?this.getElevation(this._center,o):0)}getElevation(o,h){const p=u.MercatorCoordinate.fromLngLat(o.wrap()),v=(1<<this.tileZoom)*u.EXTENT,x=p.x*v,P=p.y*v,A=Math.floor(x/u.EXTENT),L=Math.floor(P/u.EXTENT),O=new u.OverscaledTileID(this.tileZoom,0,this.tileZoom,A,L);return h.getElevation(O,x%u.EXTENT,P%u.EXTENT,u.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(o){const h=this.pointLocation(this.centerPoint,o),p=this.getElevation(h,o);if(!(this.elevation-p))return;const v=this.getCameraPosition(),x=u.MercatorCoordinate.fromLngLat(v.lngLat,v.altitude),P=u.MercatorCoordinate.fromLngLat(h,p),A=x.x-P.x,L=x.y-P.y,O=x.z-P.z,F=Math.sqrt(A*A+L*L+O*O),B=this.scaleZoom(this.cameraToCenterDistance/F/this.tileSize);this._elevation=p,this._center=h,this.zoom=B}setLocationAtPoint(o,h){const p=this.pointCoordinate(h),v=this.pointCoordinate(this.centerPoint),x=this.locationCoordinate(o),P=new u.MercatorCoordinate(x.x-(p.x-v.x),x.y-(p.y-v.y));this.center=this.coordinateLocation(P),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(o,h){return h?this.coordinatePoint(this.locationCoordinate(o),this.getElevation(o,h),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(o))}pointLocation(o,h){return this.coordinateLocation(this.pointCoordinate(o,h))}locationCoordinate(o){return u.MercatorCoordinate.fromLngLat(o)}coordinateLocation(o){return o&&o.toLngLat()}pointCoordinate(o,h){if(h){const Z=h.pointCoordinate(o);if(Z!=null)return Z}const p=[o.x,o.y,0,1],v=[o.x,o.y,1,1];u.transformMat4(p,p,this.pixelMatrixInverse),u.transformMat4(v,v,this.pixelMatrixInverse);const x=p[3],P=v[3],A=p[1]/x,L=v[1]/P,O=p[2]/x,F=v[2]/P,B=O===F?0:(0-O)/(F-O);return new u.MercatorCoordinate(u.interpolate.number(p[0]/x,v[0]/P,B)/this.worldSize,u.interpolate.number(A,L,B)/this.worldSize)}coordinatePoint(o,h=0,p=this.pixelMatrix){const v=[o.x*this.worldSize,o.y*this.worldSize,h,1];return u.transformMat4(v,v,p),new u.Point(v[0]/v[3],v[1]/v[3])}getBounds(){const o=Math.max(0,this.height/2-this.getHorizon());return new yr().extend(this.pointLocation(new u.Point(0,o))).extend(this.pointLocation(new u.Point(this.width,o))).extend(this.pointLocation(new u.Point(this.width,this.height))).extend(this.pointLocation(new u.Point(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new yr([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(o){o?(this.lngRange=[o.getWest(),o.getEast()],this.latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(o,h=!1){const p=o.key,v=h?this._alignedPosMatrixCache:this._posMatrixCache;if(v[p])return v[p];const x=o.canonical,P=this.worldSize/this.zoomScale(x.z),A=x.x+Math.pow(2,x.z)*o.wrap,L=u.identity(new Float64Array(16));return u.translate(L,L,[A*P,x.y*P,0]),u.scale(L,L,[P/u.EXTENT,P/u.EXTENT,1]),u.multiply(L,h?this.alignedProjMatrix:this.projMatrix,L),v[p]=new Float32Array(L),v[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let o,h,p,v,x=-90,P=90,A=-180,L=180;const O=this.size,F=this._unmodified;if(this.latRange){const ie=this.latRange;x=u.mercatorYfromLat(ie[1])*this.worldSize,P=u.mercatorYfromLat(ie[0])*this.worldSize,o=P-x<O.y?O.y/(P-x):0}if(this.lngRange){const ie=this.lngRange;A=u.wrap(u.mercatorXfromLng(ie[0])*this.worldSize,0,this.worldSize),L=u.wrap(u.mercatorXfromLng(ie[1])*this.worldSize,0,this.worldSize),L<A&&(L+=this.worldSize),h=L-A<O.x?O.x/(L-A):0}const B=this.point,Z=Math.max(h||0,o||0);if(Z)return this.center=this.unproject(new u.Point(h?(L+A)/2:B.x,o?(P+x)/2:B.y)),this.zoom+=this.scaleZoom(Z),this._unmodified=F,void(this._constraining=!1);if(this.latRange){const ie=B.y,re=O.y/2;ie-re<x&&(v=x+re),ie+re>P&&(v=P-re)}if(this.lngRange){const ie=(A+L)/2,re=u.wrap(B.x,ie-this.worldSize/2,ie+this.worldSize/2),ue=O.x/2;re-ue<A&&(p=A+ue),re+ue>L&&(p=L-ue)}p===void 0&&v===void 0||(this.center=this.unproject(new u.Point(p!==void 0?p:B.x,v!==void 0?v:B.y)).wrap()),this._unmodified=F,this._constraining=!1}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,h=this.point.x,p=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=u.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let v=u.identity(new Float64Array(16));u.scale(v,v,[this.width/2,-this.height/2,1]),u.translate(v,v,[1,-1,0]),this.labelPlaneMatrix=v,v=u.identity(new Float64Array(16)),u.scale(v,v,[1,-1,1]),u.translate(v,v,[-1,-1,0]),u.scale(v,v,[2/this.width,2/this.height,1]),this.glCoordMatrix=v,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const x=this._elevation<0?this.cameraToCenterDistance:this.cameraToSeaLevelDistance,P=Math.PI/2+this._pitch,A=this._fov*(.5+o.y/this.height),L=Math.sin(A)*x/Math.sin(u.clamp(Math.PI-P-A,.01,Math.PI-.01)),O=this.getHorizon(),F=2*Math.atan(O/this.cameraToCenterDistance)*(.5+o.y/(2*O)),B=Math.sin(F)*x/Math.sin(u.clamp(Math.PI-P-F,.01,Math.PI-.01)),Z=Math.min(L,B),ie=1.01*(Math.cos(Math.PI/2-this._pitch)*Z+x),re=this.height/50;v=new Float64Array(16),u.perspective(v,this._fov,this.width/this.height,re,ie),v[8]=2*-o.x/this.width,v[9]=2*o.y/this.height,u.scale(v,v,[1,-1,1]),u.translate(v,v,[0,0,-this.cameraToCenterDistance]),u.rotateX(v,v,this._pitch),u.rotateZ(v,v,this.angle),u.translate(v,v,[-h,-p,0]),this.mercatorMatrix=u.scale([],v,[this.worldSize,this.worldSize,this.worldSize]),u.scale(v,v,[1,1,this._pixelPerMeter]),this.pixelMatrix=u.multiply(new Float64Array(16),this.labelPlaneMatrix,v),u.translate(v,v,[0,0,-this.elevation]),this.projMatrix=v,this.invProjMatrix=u.invert([],v),this.pixelMatrix3D=u.multiply(new Float64Array(16),this.labelPlaneMatrix,v);const ue=this.width%2/2,se=this.height%2/2,xe=Math.cos(this.angle),Le=Math.sin(this.angle),he=h-Math.round(h)+xe*ue+Le*se,Ae=p-Math.round(p)+xe*se+Le*ue,ze=new Float64Array(v);if(u.translate(ze,ze,[he>.5?he-1:he,Ae>.5?Ae-1:Ae,0]),this.alignedProjMatrix=ze,v=u.invert(new Float64Array(16),this.pixelMatrix),!v)throw new Error("failed to invert matrix");this.pixelMatrixInverse=v,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const o=this.pointCoordinate(new u.Point(0,0)),h=[o.x*this.worldSize,o.y*this.worldSize,0,1];return u.transformMat4(h,h,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.Point(0,o))}getCameraQueryGeometry(o){const h=this.getCameraPoint();if(o.length===1)return[o[0],h];{let p=h.x,v=h.y,x=h.x,P=h.y;for(const A of o)p=Math.min(p,A.x),v=Math.min(v,A.y),x=Math.max(x,A.x),P=Math.max(P,A.y);return[new u.Point(p,v),new u.Point(x,v),new u.Point(x,P),new u.Point(p,P),new u.Point(p,v)]}}}class Ne{constructor(o){this._getCurrentHash=()=>{const h=window.location.hash.replace("#","");if(this._hashName){let p;return h.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(p=v)}),(p&&p[1]||"").split("/")}return h.split("/")},this._onHashChange=()=>{const h=this._getCurrentHash();if(h.length>=3&&!h.some(p=>isNaN(p))){const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(h[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:p,pitch:+(h[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const h=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,h)}catch{}},this._updateHash=function(h,p){let v=!1,x=null;const P=()=>{x=null,v&&(h(),x=setTimeout(P,300),v=!1)};return()=>(v=!0,x||P(),x)}(this._updateHashUnthrottled),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(o){const h=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,v=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,v),P=Math.round(h.lng*x)/x,A=Math.round(h.lat*x)/x,L=this._map.getBearing(),O=this._map.getPitch();let F="";if(F+=o?`/${P}/${A}/${p}`:`${p}/${A}/${P}`,(L||O)&&(F+="/"+Math.round(10*L)/10),O&&(F+=`/${Math.round(O)}`),this._hashName){const B=this._hashName;let Z=!1;const ie=window.location.hash.slice(1).split("&").map(re=>{const ue=re.split("=")[0];return ue===B?(Z=!0,`${ue}=${F}`):re}).filter(re=>re);return Z||ie.push(`${B}=${F}`),`#${ie.join("&")}`}return`#${F}`}}const lt={linearity:.3,easing:u.bezier(0,0,.3,1)},kt=u.extend({deceleration:2500,maxSpeed:1400},lt),jr=u.extend({deceleration:20,maxSpeed:1400},lt),lr=u.extend({deceleration:1e3,maxSpeed:360},lt),gn=u.extend({deceleration:1e3,maxSpeed:90},lt);class Zr{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:u.browser.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,h=u.browser.now();for(;o.length>0&&h-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const h={zoom:0,bearing:0,pitch:0,pan:new u.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)h.zoom+=x.zoomDelta||0,h.bearing+=x.bearingDelta||0,h.pitch+=x.pitchDelta||0,x.panDelta&&h.pan._add(x.panDelta),x.around&&(h.around=x.around),x.pinchAround&&(h.pinchAround=x.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(h.pan.mag()){const x=Jt(h.pan.mag(),p,u.extend({},kt,o||{}));v.offset=h.pan.mult(x.amount/h.pan.mag()),v.center=this._map.transform.center,or(v,x)}if(h.zoom){const x=Jt(h.zoom,p,jr);v.zoom=this._map.transform.zoom+x.amount,or(v,x)}if(h.bearing){const x=Jt(h.bearing,p,lr);v.bearing=this._map.transform.bearing+u.clamp(x.amount,-179,179),or(v,x)}if(h.pitch){const x=Jt(h.pitch,p,gn);v.pitch=this._map.transform.pitch+x.amount,or(v,x)}if(v.zoom||v.bearing){const x=h.pinchAround===void 0?h.around:h.pinchAround;v.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),u.extend(v,{noMoveStart:!0})}}function or(_,o){(!_.duration||_.duration<o.duration)&&(_.duration=o.duration,_.easing=o.easing)}function Jt(_,o,h){const{maxSpeed:p,linearity:v,deceleration:x}=h,P=u.clamp(_*v/(o/1e3),-p,p),A=Math.abs(P)/(x*v);return{easing:h.easing,duration:1e3*A,amount:P*(A/2)}}class ur extends u.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,p,v={}){const x=m.mousePos(h.getCanvasContainer(),p),P=h.unproject(x);super(o,u.extend({point:x,lngLat:P,originalEvent:p},v)),this._defaultPrevented=!1,this.target=h}}class pn extends u.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,p){const v=o==="touchend"?p.changedTouches:p.touches,x=m.touchPos(h.getCanvasContainer(),v),P=x.map(L=>h.unproject(L)),A=x.reduce((L,O,F,B)=>L.add(O.div(B.length)),new u.Point(0,0));super(o,{points:x,point:A,lngLats:P,lngLat:h.unproject(A),originalEvent:p}),this._defaultPrevented=!1}}class co extends u.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,p){super(o,{originalEvent:p}),this._defaultPrevented=!1}}class on{constructor(o,h){this._map=o,this._clickTolerance=h.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new co(o.type,this._map,o))}mousedown(o,h){return this._mousedownPos=h,this._firePreventable(new ur(o.type,this._map,o))}mouseup(o){this._map.fire(new ur(o.type,this._map,o))}click(o,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||this._map.fire(new ur(o.type,this._map,o))}dblclick(o){return this._firePreventable(new ur(o.type,this._map,o))}mouseover(o){this._map.fire(new ur(o.type,this._map,o))}mouseout(o){this._map.fire(new ur(o.type,this._map,o))}touchstart(o){return this._firePreventable(new pn(o.type,this._map,o))}touchmove(o){this._map.fire(new pn(o.type,this._map,o))}touchend(o){this._map.fire(new pn(o.type,this._map,o))}touchcancel(o){this._map.fire(new pn(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ti{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new ur(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ur("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new ur(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Vn{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.pointLocation(u.Point.convert(o),this._map.terrain)}}class Wi{constructor(o,h){this._map=o,this._tr=new Vn(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,h){this.isEnabled()&&o.shiftKey&&o.button===0&&(m.disableDrag(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(o,h){if(!this._active)return;const p=h;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const v=this._startPos;this._lastPos=p,this._box||(this._box=m.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const x=Math.min(v.x,p.x),P=Math.max(v.x,p.x),A=Math.min(v.y,p.y),L=Math.max(v.y,p.y);m.setTransform(this._box,`translate(${x}px,${A}px)`),this._box.style.width=P-x+"px",this._box.style.height=L-A+"px"}mouseupWindow(o,h){if(!this._active||o.button!==0)return;const p=this._startPos,v=h;if(this.reset(),m.suppressClick(),p.x!==v.x||p.y!==v.y)return this._map.fire(new u.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:x=>x.fitScreenCoordinates(p,v,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(m.remove(this._box),this._box=null),m.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,h){return this._map.fire(new u.Event(o,{originalEvent:h}))}}function Gn(_,o){if(_.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${_.length}, points ${o.length}`);const h={};for(let p=0;p<_.length;p++)h[_[p].identifier]=o[p];return h}class yt{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,h,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),p.length===this.numTouches&&(this.centroid=function(v){const x=new u.Point(0,0);for(const P of v)x._add(P);return x.div(v.length)}(h),this.touches=Gn(p,h)))}touchmove(o,h,p){if(this.aborted||!this.centroid)return;const v=Gn(p,h);for(const x in this.touches){const P=v[x];(!P||P.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(o,h,p){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class Ki{constructor(o){this.singleTap=new yt(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,h,p){this.singleTap.touchstart(o,h,p)}touchmove(o,h,p){this.singleTap.touchmove(o,h,p)}touchend(o,h,p){const v=this.singleTap.touchend(o,h,p);if(v){const x=o.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(v)<30;if(x&&P||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class ma{constructor(o){this._tr=new Vn(o),this._zoomIn=new Ki({numTouches:1,numTaps:2}),this._zoomOut=new Ki({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,h,p){this._zoomIn.touchstart(o,h,p),this._zoomOut.touchstart(o,h,p)}touchmove(o,h,p){this._zoomIn.touchmove(o,h,p),this._zoomOut.touchmove(o,h,p)}touchend(o,h,p){const v=this._zoomIn.touchend(o,h,p),x=this._zoomOut.touchend(o,h,p),P=this._tr;return v?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:P.zoom+1,around:P.unproject(v)},{originalEvent:o})}):x?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:P.zoom-1,around:P.unproject(x)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xi{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const h=this._moveFunction(...o);if(h.bearingDelta||h.pitchDelta||h.around||h.panDelta)return this._active=!0,h}dragStart(o,h){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=h.length?h[0]:h,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,h){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const v=h.length?h[0]:h;return!this._moved&&v.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=v,this._move(p,v))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&m.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const $r={0:1,2:2};class Ye{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const h=m.mouseButton(o);this._eventButton=h}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(h,p){const v=$r[p];return h.buttons===void 0||(h.buttons&v)!==v}(o,this._eventButton)}isValidEndEvent(o){return m.mouseButton(o)===this._eventButton}}class Co{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return o.targetTouches.length===1}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}const ho=_=>{_.mousedown=_.dragStart,_.mousemoveWindow=_.dragMove,_.mouseup=_.dragEnd,_.contextmenu=function(o){o.preventDefault()}},Gs=({enable:_,clickTolerance:o,bearingDegreesPerPixelMoved:h=.8})=>{const p=new Ye({checkCorrectEvent:v=>m.mouseButton(v)===0&&v.ctrlKey||m.mouseButton(v)===2});return new Xi({clickTolerance:o,move:(v,x)=>({bearingDelta:(x.x-v.x)*h}),moveStateManager:p,enable:_,assignEvents:ho})},qn=({enable:_,clickTolerance:o,pitchDegreesPerPixelMoved:h=-.5})=>{const p=new Ye({checkCorrectEvent:v=>m.mouseButton(v)===0&&v.ctrlKey||m.mouseButton(v)===2});return new Xi({clickTolerance:o,move:(v,x)=>({pitchDelta:(x.y-v.y)*h}),moveStateManager:p,enable:_,assignEvents:ho})};class ys{constructor(o,h){this._minTouches=o.cooperativeGestures?2:1,this._clickTolerance=o.clickTolerance||1,this._map=h,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.Point(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(o,h,p){return this._calculateTransform(o,h,p)}touchmove(o,h,p){if(this._map._cooperativeGestures&&(this._minTouches===2&&p.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(o,!1,p.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(p.length<this._minTouches))return o.preventDefault(),this._calculateTransform(o,h,p)}touchend(o,h,p){this._calculateTransform(o,h,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,h,p){p.length>0&&(this._active=!0);const v=Gn(p,h),x=new u.Point(0,0),P=new u.Point(0,0);let A=0;for(const O in v){const F=v[O],B=this._touches[O];B&&(x._add(F),P._add(F.sub(B)),A++,v[O]=F)}if(this._touches=v,A<this._minTouches||!P.mag())return;const L=P.div(A);return this._sum._add(L),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(A),panDelta:L}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zo{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,h,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([h[0],h[1]]))}touchmove(o,h,p){if(!this._firstTwoTouches)return;o.preventDefault();const[v,x]=this._firstTwoTouches,P=ga(p,h,v),A=ga(p,h,x);if(!P||!A)return;const L=this._aroundCenter?null:P.add(A).div(2);return this._move([P,A],L,o)}touchend(o,h,p){if(!this._firstTwoTouches)return;const[v,x]=this._firstTwoTouches,P=ga(p,h,v),A=ga(p,h,x);P&&A||(this._active&&m.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ga(_,o,h){for(let p=0;p<_.length;p++)if(_[p].identifier===h)return o[p]}function Pl(_,o){return Math.log(_/o)/Math.LN2}class ya extends Zo{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,h){const p=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Pl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Pl(this._distance,p),pinchAround:h}}}function vs(_,o){return 180*_.angleWith(o)/Math.PI}class ou extends Zo{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,h){const p=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:vs(this._vector,p),pinchAround:h}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const h=25/(Math.PI*this._minDiameter)*360,p=vs(o,this._startVector);return Math.abs(p)<h}}function va(_){return Math.abs(_.y)>Math.abs(_.x)}class Pi extends Zo{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,h,p){super.touchstart(o,h,p),this._currentTouchCount=p.length}_start(o){this._lastPoints=o,va(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,h,p){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const v=o[0].sub(this._lastPoints[0]),x=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(v,x,p.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(v.y+x.y)/2*-.5}):void 0}gestureBeginsVertically(o,h,p){if(this._valid!==void 0)return this._valid;const v=o.mag()>=2,x=h.mag()>=2;if(!v&&!x)return;if(!v||!x)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const P=o.y>0==h.y>0;return va(o)&&va(h)&&P}}const Wo={panStep:100,bearingStep:15,pitchStep:10};class Al{constructor(o){this._tr=new Vn(o);const h=Wo;this._panStep=h.panStep,this._bearingStep=h.bearingStep,this._pitchStep=h.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let h=0,p=0,v=0,x=0,P=0;switch(o.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:o.shiftKey?p=-1:(o.preventDefault(),x=-1);break;case 39:o.shiftKey?p=1:(o.preventDefault(),x=1);break;case 38:o.shiftKey?v=1:(o.preventDefault(),P=-1);break;case 40:o.shiftKey?v=-1:(o.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(p=0,v=0),{cameraAnimation:A=>{const L=this._tr;A.easeTo({duration:300,easeId:"keyboardHandler",easing:su,zoom:h?Math.round(L.zoom)+h*(o.shiftKey?2:1):L.zoom,bearing:L.bearing+p*this._bearingStep,pitch:L.pitch+v*this._pitchStep,offset:[-x*this._panStep,-P*this._panStep],center:L.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function su(_){return _*(2-_)}const Va=4.000244140625;class dl{constructor(o,h){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=o,this._tr=new Vn(o),this._el=o.getCanvasContainer(),this._triggerRenderFrame=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!o[this._map._metaKey])return;o.preventDefault()}let h=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const p=u.browser.now(),v=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,h!==0&&h%Va==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(v*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),o.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=o,this._delta-=h,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=m.mousePos(this._el,o),p=this._tr;this._around=u.LngLat.convert(this._aroundCenter?p.center:p.unproject(h)),this._aroundPoint=p.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if(this._delta!==0){const A=this._type==="wheel"&&Math.abs(this._delta)>Va?this._wheelZoomRate:this._defaultZoomRate;let L=2/(1+Math.exp(-Math.abs(this._delta*A)));this._delta<0&&L!==0&&(L=1/L);const O=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(O*L))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const h=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,p=this._startZoom,v=this._easing;let x,P=!1;if(this._type==="wheel"&&p&&v){const A=Math.min((u.browser.now()-this._lastWheelEventTime)/200,1),L=v(A);x=u.interpolate.number(p,h,L),A<1?this._frameId||(this._frameId=!0):P=!0}else x=h,P=!0;return this._active=!0,P&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!P,zoomDelta:x-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let h=u.defaultEasing;if(this._prevEase){const p=this._prevEase,v=(u.browser.now()-p.start)/p.duration,x=p.easing(v+.01)-p.easing(v),P=.27/Math.sqrt(x*x+1e-4)*.01,A=Math.sqrt(.0729-P*P);h=u.bezier(P,A,.25,1)}return this._prevEase={start:u.browser.now(),duration:o,easing:h},h}reset(){this._active=!1}}class Vf{constructor(o,h){this._clickZoom=o,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class _s{constructor(o){this._tr=new Vn(o),this.reset()}reset(){this._active=!1}dblclick(o,h){return o.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(o.shiftKey?-1:1),around:this._tr.unproject(h)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class An{constructor(){this._tap=new Ki({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,h,p){if(!this._swipePoint)if(this._tapTime){const v=h[0],x=o.timeStamp-this._tapTime<500,P=this._tapPoint.dist(v)<30;x&&P?p.length>0&&(this._swipePoint=v,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(o,h,p)}touchmove(o,h,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const v=h[0],x=v.y-this._swipePoint.y;return this._swipePoint=v,o.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(o,h,p)}touchend(o,h,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{const v=this._tap.touchend(o,h,p);v&&(this._tapTime=o.timeStamp,this._tapPoint=v)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fc{constructor(o,h,p){this._el=o,this._mousePan=h,this._touchPan=p}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Jh{constructor(o,h,p){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=h,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Gf{constructor(o,h,p,v){this._el=o,this._touchZoom=h,this._touchRotate=p,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const oc=_=>_.zoom||_.drag||_.pitch||_.rotate;class qf extends u.Event{}function Yh(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class _a{constructor(o,h){this.handleWindowEvent=v=>{this.handleEvent(v,`${v.type}Window`)},this.handleEvent=(v,x)=>{if(v.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const P=v.type==="renderFrame"?void 0:v,A={needsRenderFrame:!1},L={},O={},F=v.touches,B=F?this._getMapTouches(F):void 0,Z=B?m.touchPos(this._el,B):m.mousePos(this._el,v);for(const{handlerName:ue,handler:se,allowed:xe}of this._handlers){if(!se.isEnabled())continue;let Le;this._blockedByActive(O,xe,ue)?se.reset():se[x||v.type]&&(Le=se[x||v.type](v,Z,B),this.mergeHandlerResult(A,L,Le,ue,P),Le&&Le.needsRenderFrame&&this._triggerRenderFrame()),(Le||se.isActive())&&(O[ue]=se)}const ie={};for(const ue in this._previousActiveHandlers)O[ue]||(ie[ue]=P);this._previousActiveHandlers=O,(Object.keys(ie).length||Yh(A))&&(this._changes.push([A,L,ie]),this._triggerRenderFrame()),(Object.keys(O).length||Yh(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:re}=A;re&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],re(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Zr(o),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(h);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,x,P]of this._listeners)m.addEventListener(v,x,v===document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[o,h,p]of this._listeners)m.removeEventListener(o,h,o===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(o){const h=this._map,p=h.getCanvasContainer();this._add("mapEvent",new on(h,o));const v=h.boxZoom=new Wi(h,o);this._add("boxZoom",v),o.interactive&&o.boxZoom&&v.enable();const x=new ma(h),P=new _s(h);h.doubleClickZoom=new Vf(P,x),this._add("tapZoom",x),this._add("clickZoom",P),o.interactive&&o.doubleClickZoom&&h.doubleClickZoom.enable();const A=new An;this._add("tapDragZoom",A);const L=h.touchPitch=new Pi(h);this._add("touchPitch",L),o.interactive&&o.touchPitch&&h.touchPitch.enable(o.touchPitch);const O=Gs(o),F=qn(o);h.dragRotate=new Jh(o,O,F),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]),o.interactive&&o.dragRotate&&h.dragRotate.enable();const B=(({enable:xe,clickTolerance:Le})=>{const he=new Ye({checkCorrectEvent:Ae=>m.mouseButton(Ae)===0&&!Ae.ctrlKey});return new Xi({clickTolerance:Le,move:(Ae,ze)=>({around:ze,panDelta:ze.sub(Ae)}),activateOnStart:!0,moveStateManager:he,enable:xe,assignEvents:ho})})(o),Z=new ys(o,h);h.dragPan=new Fc(p,B,Z),this._add("mousePan",B),this._add("touchPan",Z,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&h.dragPan.enable(o.dragPan);const ie=new ou,re=new ya;h.touchZoomRotate=new Gf(p,re,ie,A),this._add("touchRotate",ie,["touchPan","touchZoom"]),this._add("touchZoom",re,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&h.touchZoomRotate.enable(o.touchZoomRotate);const ue=h.scrollZoom=new dl(h,()=>this._triggerRenderFrame());this._add("scrollZoom",ue,["mousePan"]),o.interactive&&o.scrollZoom&&h.scrollZoom.enable(o.scrollZoom);const se=h.keyboard=new Al(h);this._add("keyboard",se),o.interactive&&o.keyboard&&h.keyboard.enable(),this._add("blockableMapEvent",new ti(h))}_add(o,h,p){this._handlers.push({handlerName:o,handler:h,allowed:p}),this._handlersById[o]=h}stop(o){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!oc(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,h,p){for(const v in o)if(v!==p&&(!h||h.indexOf(v)<0))return!0;return!1}_getMapTouches(o){const h=[];for(const p of o)this._el.contains(p.target)&&h.push(p);return h}mergeHandlerResult(o,h,p,v,x){if(!p)return;u.extend(o,p);const P={handlerName:v,originalEvent:p.originalEvent||x};p.zoomDelta!==void 0&&(h.zoom=P),p.panDelta!==void 0&&(h.drag=P),p.pitchDelta!==void 0&&(h.pitch=P),p.bearingDelta!==void 0&&(h.rotate=P)}_applyChanges(){const o={},h={},p={};for(const[v,x,P]of this._changes)v.panDelta&&(o.panDelta=(o.panDelta||new u.Point(0,0))._add(v.panDelta)),v.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+v.pitchDelta),v.around!==void 0&&(o.around=v.around),v.pinchAround!==void 0&&(o.pinchAround=v.pinchAround),v.noInertia&&(o.noInertia=v.noInertia),u.extend(h,x),u.extend(p,P);this._updateMapTransform(o,h,p),this._changes=[]}_updateMapTransform(o,h,p){const v=this._map,x=v._getTransformForUpdate(),P=v.terrain;if(!(Yh(o)||P&&this._terrainMovement))return this._fireEvents(h,p,!0);let{panDelta:A,zoomDelta:L,bearingDelta:O,pitchDelta:F,around:B,pinchAround:Z}=o;Z!==void 0&&(B=Z),v._stop(!0),B=B||v.transform.centerPoint;const ie=x.pointLocation(A?B.sub(A):B);O&&(x.bearing+=O),F&&(x.pitch+=F),L&&(x.zoom+=L),P?this._terrainMovement||!h.drag&&!h.zoom?h.drag&&this._terrainMovement?x.center=x.pointLocation(x.centerPoint.sub(A)):x.setLocationAtPoint(ie,B):(this._terrainMovement=!0,x.freezeElevation=!0,x.setLocationAtPoint(ie,B),this._map.once("moveend",()=>{x.freezeElevation=!1,this._terrainMovement=!1,x.recalculateZoom(v.terrain)})):x.setLocationAtPoint(ie,B),v._applyUpdatedTransform(x),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(h,p,!0)}_fireEvents(o,h,p){const v=oc(this._eventsInProgress),x=oc(o),P={};for(const F in o){const{originalEvent:B}=o[F];this._eventsInProgress[F]||(P[`${F}start`]=B),this._eventsInProgress[F]=o[F]}!v&&x&&this._fireEvent("movestart",x.originalEvent);for(const F in P)this._fireEvent(F,P[F]);x&&this._fireEvent("move",x.originalEvent);for(const F in o){const{originalEvent:B}=o[F];this._fireEvent(F,B)}const A={};let L;for(const F in this._eventsInProgress){const{handlerName:B,originalEvent:Z}=this._eventsInProgress[F];this._handlersById[B].isActive()||(delete this._eventsInProgress[F],L=h[B]||Z,A[`${F}end`]=L)}for(const F in A)this._fireEvent(F,A[F]);const O=oc(this._eventsInProgress);if(p&&(v||x)&&!O){this._updatingCamera=!0;const F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),B=Z=>Z!==0&&-this._bearingSnap<Z&&Z<this._bearingSnap;F?(B(F.bearing||this._map.getBearing())&&(F.bearing=0),F.freezeElevation=!0,this._map.easeTo(F,{originalEvent:L})):(this._map.fire(new u.Event("moveend",{originalEvent:L})),B(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,h){this._map.fire(new u.Event(o,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new qf("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Nc extends u.Evented{constructor(o,h){super(),this._renderFrameCallback=()=>{const p=Math.min((u.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=h.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new u.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,h){return this.jumpTo({center:o},h)}panBy(o,h,p){return o=u.Point.convert(o).mult(-1),this.panTo(this.transform.center,u.extend({offset:o},h),p)}panTo(o,h,p){return this.easeTo(u.extend({center:o},h),p)}getZoom(){return this.transform.zoom}setZoom(o,h){return this.jumpTo({zoom:o},h),this}zoomTo(o,h,p){return this.easeTo(u.extend({zoom:o},h),p)}zoomIn(o,h){return this.zoomTo(this.getZoom()+1,o,h),this}zoomOut(o,h){return this.zoomTo(this.getZoom()-1,o,h),this}getBearing(){return this.transform.bearing}setBearing(o,h){return this.jumpTo({bearing:o},h),this}getPadding(){return this.transform.padding}setPadding(o,h){return this.jumpTo({padding:o},h),this}rotateTo(o,h,p){return this.easeTo(u.extend({bearing:o},h),p)}resetNorth(o,h){return this.rotateTo(0,u.extend({duration:1e3},o),h),this}resetNorthPitch(o,h){return this.easeTo(u.extend({bearing:0,pitch:0,duration:1e3},o),h),this}snapToNorth(o,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,h):this}getPitch(){return this.transform.pitch}setPitch(o,h){return this.jumpTo({pitch:o},h),this}cameraForBounds(o,h){o=yr.convert(o);const p=h&&h.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),p,h)}_cameraForBoxAndBearing(o,h,p,v){const x={top:0,bottom:0,right:0,left:0};if(typeof(v=u.extend({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},v)).padding=="number"){const ze=v.padding;v.padding={top:ze,bottom:ze,right:ze,left:ze}}v.padding=u.extend(x,v.padding);const P=this.transform,A=P.padding,L=P.project(u.LngLat.convert(o)),O=P.project(u.LngLat.convert(h)),F=L.rotate(-p*Math.PI/180),B=O.rotate(-p*Math.PI/180),Z=new u.Point(Math.max(F.x,B.x),Math.max(F.y,B.y)),ie=new u.Point(Math.min(F.x,B.x),Math.min(F.y,B.y)),re=Z.sub(ie),ue=(P.width-(A.left+A.right+v.padding.left+v.padding.right))/re.x,se=(P.height-(A.top+A.bottom+v.padding.top+v.padding.bottom))/re.y;if(se<0||ue<0)return void u.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const xe=Math.min(P.scaleZoom(P.scale*Math.min(ue,se)),v.maxZoom),Le=u.Point.convert(v.offset),he=new u.Point((v.padding.left-v.padding.right)/2,(v.padding.top-v.padding.bottom)/2).rotate(p*Math.PI/180),Ae=Le.add(he).mult(P.scale/P.zoomScale(xe));return{center:P.unproject(L.add(O).div(2).sub(Ae)),zoom:xe,bearing:p}}fitBounds(o,h,p){return this._fitInternal(this.cameraForBounds(o,h),h,p)}fitScreenCoordinates(o,h,p,v,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(u.Point.convert(o)),this.transform.pointLocation(u.Point.convert(h)),p,v),v,x)}_fitInternal(o,h,p){return o?(delete(h=u.extend(o,h)).padding,h.linear?this.easeTo(h,p):this.flyTo(h,p)):this}jumpTo(o,h){this.stop();const p=this._getTransformForUpdate();let v=!1,x=!1,P=!1;return"zoom"in o&&p.zoom!==+o.zoom&&(v=!0,p.zoom=+o.zoom),o.center!==void 0&&(p.center=u.LngLat.convert(o.center)),"bearing"in o&&p.bearing!==+o.bearing&&(x=!0,p.bearing=+o.bearing),"pitch"in o&&p.pitch!==+o.pitch&&(P=!0,p.pitch=+o.pitch),o.padding==null||p.isPaddingEqual(o.padding)||(p.padding=o.padding),this._applyUpdatedTransform(p),this.fire(new u.Event("movestart",h)).fire(new u.Event("move",h)),v&&this.fire(new u.Event("zoomstart",h)).fire(new u.Event("zoom",h)).fire(new u.Event("zoomend",h)),x&&this.fire(new u.Event("rotatestart",h)).fire(new u.Event("rotate",h)).fire(new u.Event("rotateend",h)),P&&this.fire(new u.Event("pitchstart",h)).fire(new u.Event("pitch",h)).fire(new u.Event("pitchend",h)),this.fire(new u.Event("moveend",h))}calculateCameraOptionsFromTo(o,h,p,v=0){const x=u.MercatorCoordinate.fromLngLat(o,h),P=u.MercatorCoordinate.fromLngLat(p,v),A=P.x-x.x,L=P.y-x.y,O=P.z-x.z,F=Math.hypot(A,L,O);if(F===0)throw new Error("Can't calculate camera options with same From and To");const B=Math.hypot(A,L),Z=this.transform.scaleZoom(this.transform.cameraToCenterDistance/F/this.transform.tileSize),ie=180*Math.atan2(A,-L)/Math.PI;let re=180*Math.acos(B/F)/Math.PI;return re=O<0?90-re:90+re,{center:P.toLngLat(),zoom:Z,pitch:re,bearing:ie}}easeTo(o,h){this._stop(!1,o.easeId),((o=u.extend({offset:[0,0],duration:500,easing:u.defaultEasing},o)).animate===!1||!o.essential&&u.browser.prefersReducedMotion)&&(o.duration=0);const p=this._getTransformForUpdate(),v=this.getZoom(),x=this.getBearing(),P=this.getPitch(),A=this.getPadding(),L="zoom"in o?+o.zoom:v,O="bearing"in o?this._normalizeBearing(o.bearing,x):x,F="pitch"in o?+o.pitch:P,B="padding"in o?o.padding:p.padding,Z=u.Point.convert(o.offset);let ie=p.centerPoint.add(Z);const re=p.pointLocation(ie),ue=u.LngLat.convert(o.center||re);this._normalizeCenter(ue);const se=p.project(re),xe=p.project(ue).sub(se),Le=p.zoomScale(L-v);let he,Ae;o.around&&(he=u.LngLat.convert(o.around),Ae=p.locationPoint(he));const ze={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||L!==v,this._rotating=this._rotating||x!==O,this._pitching=this._pitching||F!==P,this._padding=!p.isPaddingEqual(B),this._easeId=o.easeId,this._prepareEase(h,o.noMoveStart,ze),this.terrain&&this._prepareElevation(ue),this._ease(Ge=>{if(this._zooming&&(p.zoom=u.interpolate.number(v,L,Ge)),this._rotating&&(p.bearing=u.interpolate.number(x,O,Ge)),this._pitching&&(p.pitch=u.interpolate.number(P,F,Ge)),this._padding&&(p.interpolatePadding(A,B,Ge),ie=p.centerPoint.add(Z)),this.terrain&&!o.freezeElevation&&this._updateElevation(Ge),he)p.setLocationAtPoint(he,Ae);else{const qe=p.zoomScale(p.zoom-v),Je=L>v?Math.min(2,Le):Math.max(.5,Le),Ke=Math.pow(Je,1-Ge),gt=p.unproject(se.add(xe.mult(Ge*Ke)).mult(qe));p.setLocationAtPoint(p.renderWorldCopies?gt.wrap():gt,ie)}this._applyUpdatedTransform(p),this._fireMoveEvents(h)},Ge=>{this.terrain&&this._finalizeElevation(),this._afterEase(h,Ge)},o),this}_prepareEase(o,h,p={}){this._moving=!0,h||p.moving||this.fire(new u.Event("movestart",o)),this._zooming&&!p.zooming&&this.fire(new u.Event("zoomstart",o)),this._rotating&&!p.rotating&&this.fire(new u.Event("rotatestart",o)),this._pitching&&!p.pitching&&this.fire(new u.Event("pitchstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.transform.getElevation(o,this.terrain),this.transform.freezeElevation=!0}_updateElevation(o){const h=this.transform.getElevation(this._elevationCenter,this.terrain);if(o<1&&h!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(p-(h-(p*o+this._elevationStart))/(1-o)),this._elevationTarget=h}this.transform.elevation=u.interpolate.number(this._elevationStart,this._elevationTarget,o)}_finalizeElevation(){this.transform.freezeElevation=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(o){if(!this.transformCameraUpdate)return;const h=o.clone(),{center:p,zoom:v,pitch:x,bearing:P,elevation:A}=this.transformCameraUpdate(h);p&&(h.center=p),v!==void 0&&(h.zoom=v),x!==void 0&&(h.pitch=x),P!==void 0&&(h.bearing=P),A!==void 0&&(h.elevation=A),this.transform.apply(h)}_fireMoveEvents(o){this.fire(new u.Event("move",o)),this._zooming&&this.fire(new u.Event("zoom",o)),this._rotating&&this.fire(new u.Event("rotate",o)),this._pitching&&this.fire(new u.Event("pitch",o))}_afterEase(o,h){if(this._easeId&&h&&this._easeId===h)return;delete this._easeId;const p=this._zooming,v=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new u.Event("zoomend",o)),v&&this.fire(new u.Event("rotateend",o)),x&&this.fire(new u.Event("pitchend",o)),this.fire(new u.Event("moveend",o))}flyTo(o,h){if(!o.essential&&u.browser.prefersReducedMotion){const bt=u.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(bt,h)}this.stop(),o=u.extend({offset:[0,0],speed:1.2,curve:1.42,easing:u.defaultEasing},o);const p=this._getTransformForUpdate(),v=this.getZoom(),x=this.getBearing(),P=this.getPitch(),A=this.getPadding(),L="zoom"in o?u.clamp(+o.zoom,p.minZoom,p.maxZoom):v,O="bearing"in o?this._normalizeBearing(o.bearing,x):x,F="pitch"in o?+o.pitch:P,B="padding"in o?o.padding:p.padding,Z=p.zoomScale(L-v),ie=u.Point.convert(o.offset);let re=p.centerPoint.add(ie);const ue=p.pointLocation(re),se=u.LngLat.convert(o.center||ue);this._normalizeCenter(se);const xe=p.project(ue),Le=p.project(se).sub(xe);let he=o.curve;const Ae=Math.max(p.width,p.height),ze=Ae/Z,Ge=Le.mag();if("minZoom"in o){const bt=u.clamp(Math.min(o.minZoom,v,L),p.minZoom,p.maxZoom),Vr=Ae/p.zoomScale(bt-v);he=Math.sqrt(Vr/Ge*2)}const qe=he*he;function Je(bt){const Vr=(ze*ze-Ae*Ae+(bt?-1:1)*qe*qe*Ge*Ge)/(2*(bt?ze:Ae)*qe*Ge);return Math.log(Math.sqrt(Vr*Vr+1)-Vr)}function Ke(bt){return(Math.exp(bt)-Math.exp(-bt))/2}function gt(bt){return(Math.exp(bt)+Math.exp(-bt))/2}const It=Je(!1);let pr=function(bt){return gt(It)/gt(It+he*bt)},ct=function(bt){return Ae*((gt(It)*(Ke(Vr=It+he*bt)/gt(Vr))-Ke(It))/qe)/Ge;var Vr},Ht=(Je(!0)-It)/he;if(Math.abs(Ge)<1e-6||!isFinite(Ht)){if(Math.abs(Ae-ze)<1e-6)return this.easeTo(o,h);const bt=ze<Ae?-1:1;Ht=Math.abs(Math.log(ze/Ae))/he,ct=function(){return 0},pr=function(Vr){return Math.exp(bt*he*Vr)}}return o.duration="duration"in o?+o.duration:1e3*Ht/("screenSpeed"in o?+o.screenSpeed/he:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=x!==O,this._pitching=F!==P,this._padding=!p.isPaddingEqual(B),this._prepareEase(h,!1),this.terrain&&this._prepareElevation(se),this._ease(bt=>{const Vr=bt*Ht,Or=1/pr(Vr);p.zoom=bt===1?L:v+p.scaleZoom(Or),this._rotating&&(p.bearing=u.interpolate.number(x,O,bt)),this._pitching&&(p.pitch=u.interpolate.number(P,F,bt)),this._padding&&(p.interpolatePadding(A,B,bt),re=p.centerPoint.add(ie)),this.terrain&&!o.freezeElevation&&this._updateElevation(bt);const Er=bt===1?se:p.unproject(xe.add(Le.mult(ct(Vr))).mult(Or));p.setLocationAtPoint(p.renderWorldCopies?Er.wrap():Er,re),this._applyUpdatedTransform(p),this._fireMoveEvents(h)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(h)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,h)}if(!o){const p=this.handlers;p&&p.stop(!1)}return this}_ease(o,h,p){p.animate===!1||p.duration===0?(o(1),h()):(this._easeStart=u.browser.now(),this._easeOptions=p,this._onEaseFrame=o,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,h){o=u.wrap(o,-180,180);const p=Math.abs(o-h);return Math.abs(o-360-h)<p&&(o-=360),Math.abs(o+360-h)<p&&(o+=360),o}_normalizeCenter(o){const h=this.transform;if(!h.renderWorldCopies||h.lngRange)return;const p=o.lng-h.center.lng;o.lng+=p>180?-360:p<-180?360:0}queryTerrainElevation(o){return this.terrain?this.transform.getElevation(u.LngLat.convert(o),this.terrain)-this.transform.elevation:null}}class Lt{constructor(o={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=h=>{!h||h.sourceDataType!=="metadata"&&h.sourceDataType!=="visibility"&&h.dataType!=="style"&&h.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options&&this.options.compact,this._container=m.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=m.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=m.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){m.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,h){const p=this._map._getUIString(`AttributionControl.${h}`);o.title=p,o.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(v=>typeof v!="string"?"":v)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const h=this._map.style.sourceCaches;for(const v in h){const x=h[v];if(x.used||x.usedForTerrain){const P=x.getSource();P.attribution&&o.indexOf(P.attribution)<0&&o.push(P.attribution)}}o=o.filter(v=>String(v).trim()),o.sort((v,x)=>v.length-x.length),o=o.filter((v,x)=>{for(let P=x+1;P<o.length;P++)if(o[P].indexOf(v)>=0)return!1;return!0});const p=o.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,o.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Wt{constructor(o={}){this._updateCompact=()=>{const h=this._container.children;if(h.length){const p=h[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=m.create("div","maplibregl-ctrl");const h=m.create("a","maplibregl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://maplibre.org/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){m.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Bc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const h=++this._id;return this._queue.push({callback:o,id:h,cancelled:!1}),h}remove(o){const h=this._currentlyRunning,p=h?this._queue.concat(h):this._queue;for(const v of p)if(v.id===o)return void(v.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const h=this._currentlyRunning=this._queue;this._queue=[];for(const p of h)if(!p.cancelled&&(p.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Qh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var ed=u.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class Io extends u.Evented{constructor(o){super(),this.sourceCache=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,o.usedForTerrain=!0,o.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(o,h){this.sourceCache.update(o,h),this._renderableTilesKeys=[];const p={};for(const v of o.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:h}))p[v.key]=!0,this._renderableTilesKeys.push(v.key),this._tiles[v.key]||(v.posMatrix=new Float64Array(16),u.ortho(v.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),this._tiles[v.key]=new ks(v,this.tileSize));for(const v in this._tiles)p[v]||delete this._tiles[v]}freeRtt(o){for(const h in this._tiles){const p=this._tiles[h];(!o||p.tileID.equals(o)||p.tileID.isChildOf(o)||o.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o){const h={};for(const p of this._renderableTilesKeys){const v=this._tiles[p].tileID;if(v.canonical.equals(o.canonical)){const x=o.clone();x.posMatrix=new Float64Array(16),u.ortho(x.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),h[p]=x}else if(v.canonical.isChildOf(o.canonical)){const x=o.clone();x.posMatrix=new Float64Array(16);const P=v.canonical.z-o.canonical.z,A=v.canonical.x-(v.canonical.x>>P<<P),L=v.canonical.y-(v.canonical.y>>P<<P),O=u.EXTENT>>P;u.ortho(x.posMatrix,0,O,0,O,0,1),u.translate(x.posMatrix,x.posMatrix,[-A*O,-L*O,0]),h[p]=x}else if(o.canonical.isChildOf(v.canonical)){const x=o.clone();x.posMatrix=new Float64Array(16);const P=o.canonical.z-v.canonical.z,A=o.canonical.x-(o.canonical.x>>P<<P),L=o.canonical.y-(o.canonical.y>>P<<P),O=u.EXTENT>>P;u.ortho(x.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),u.translate(x.posMatrix,x.posMatrix,[A*O,L*O,0]),u.scale(x.posMatrix,x.posMatrix,[1/2**P,1/2**P,0]),h[p]=x}}return h}getSourceTile(o,h){const p=this.sourceCache._source;let v=o.overscaledZ-this.deltaZoom;if(v>p.maxzoom&&(v=p.maxzoom),v<p.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(v).key);let x=this.sourceCache.getTileByID(this._sourceTileCache[o.key]);if((!x||!x.dem)&&h)for(;v>=p.minzoom&&(!x||!x.dem);)x=this.sourceCache.getTileByID(o.scaledTo(v--).key);return x}tilesAfterTime(o=Date.now()){return Object.values(this._tiles).filter(h=>h.timeAdded>=o)}}class Hf{constructor(o,h,p){this.painter=o,this.sourceCache=new Io(h),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,h,p,v=u.EXTENT){var x;if(!(h>=0&&h<v&&p>=0&&p<v))return 0;const P=this.getTerrainData(o),A=(x=P.tile)===null||x===void 0?void 0:x.dem;if(!A)return 0;const L=function(re,ue,se){var xe=ue[0],Le=ue[1];return re[0]=se[0]*xe+se[4]*Le+se[12],re[1]=se[1]*xe+se[5]*Le+se[13],re}([],[h/v*u.EXTENT,p/v*u.EXTENT],P.u_terrain_matrix),O=[L[0]*A.dim,L[1]*A.dim],F=Math.floor(O[0]),B=Math.floor(O[1]),Z=O[0]-F,ie=O[1]-B;return A.get(F,B)*(1-Z)*(1-ie)+A.get(F+1,B)*Z*(1-ie)+A.get(F,B+1)*(1-Z)*ie+A.get(F+1,B+1)*Z*ie}getElevation(o,h,p,v=u.EXTENT){return this.getDEMElevation(o,h,p,v)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const v=this.painter.context,x=new u.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new st(v,x,v.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new st(v,new u.RGBAImage({width:1,height:1}),v.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.identity([])}const h=this.sourceCache.getSourceTile(o,!0);if(h&&h.dem&&(!h.demTexture||h.needsTerrainPrepare)){const v=this.painter.context;h.demTexture=this.painter.getTileTexture(h.dem.stride),h.demTexture?h.demTexture.update(h.dem.getPixels(),{premultiply:!1}):h.demTexture=new st(v,h.dem.getPixels(),v.gl.RGBA,{premultiply:!1}),h.demTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),h.needsTerrainPrepare=!1}const p=h&&h+h.tileID.key+o.key;if(p&&!this._demMatrixCache[p]){const v=this.sourceCache.sourceCache._source.maxzoom;let x=o.canonical.z-h.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=v?x=o.canonical.z-v:u.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const P=o.canonical.x-(o.canonical.x>>x<<x),A=o.canonical.y-(o.canonical.y>>x<<x),L=u.fromScaling(new Float64Array(16),[1/(u.EXTENT<<x),1/(u.EXTENT<<x),0]);u.translate(L,L,[P*u.EXTENT,A*u.EXTENT,0]),this._demMatrixCache[o.key]={matrix:L,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:h&&h.dem&&h.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:h&&h.dem&&h.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(h&&h.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:h}}getFramebuffer(o){const h=this.painter,p=h.width/devicePixelRatio,v=h.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===v||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new st(h.context,{width:p,height:v,data:null},h.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(h.context.gl.NEAREST,h.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new st(h.context,{width:p,height:v,data:null},h.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(h.context.gl.NEAREST,h.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=h.context.createFramebuffer(p,v,!0,!1),this._fbo.depthAttachment.set(h.context.createRenderbuffer(h.context.gl.DEPTH_COMPONENT16,p,v))),this._fbo.colorAttachment.set(o==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const h=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let x=0,P=0;x<this._coordsTextureSize;x++)for(let A=0;A<this._coordsTextureSize;A++,P+=4)h[P+0]=255&A,h[P+1]=255&x,h[P+2]=A>>8<<4|x>>8,h[P+3]=0;const p=new u.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(h.buffer)),v=new st(o,p,o.gl.RGBA,{premultiply:!1});return v.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=v,v}pointCoordinate(o){const h=new Uint8Array(4),p=this.painter.context,v=p.gl;p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),v.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,v.RGBA,v.UNSIGNED_BYTE,h),p.bindFramebuffer.set(null);const x=h[0]+(h[2]>>4<<8),P=h[1]+((15&h[2])<<8),A=this.coordsIndex[255-h[3]],L=A&&this.sourceCache.getTileByID(A);if(!L)return null;const O=this._coordsTextureSize,F=(1<<L.tileID.canonical.z)*O;return new u.MercatorCoordinate((L.tileID.canonical.x*O+x)/F,(L.tileID.canonical.y*O+P)/F,this.getElevation(L.tileID,x,P,O))}getTerrainMesh(){if(this._mesh)return this._mesh;const o=this.painter.context,h=new u.Pos3dArray,p=new u.TriangleIndexArray,v=this.meshSize,x=u.EXTENT/v,P=v*v;for(let B=0;B<=v;B++)for(let Z=0;Z<=v;Z++)h.emplaceBack(Z*x,B*x,0);for(let B=0;B<P;B+=v+1)for(let Z=0;Z<v;Z++)p.emplaceBack(Z+B,v+Z+B+1,v+Z+B+2),p.emplaceBack(Z+B,v+Z+B+2,Z+B+1);const A=h.length,L=A+2*(v+1);for(const B of[0,1])for(let Z=0;Z<=v;Z++)for(const ie of[0,1])h.emplaceBack(Z*x,B*u.EXTENT,ie);for(let B=0;B<2*v;B+=2)p.emplaceBack(L+B,L+B+1,L+B+3),p.emplaceBack(L+B,L+B+3,L+B+2),p.emplaceBack(A+B,A+B+3,A+B+1),p.emplaceBack(A+B,A+B+2,A+B+3);const O=h.length,F=O+2*(v+1);for(const B of[0,1])for(let Z=0;Z<=v;Z++)for(const ie of[0,1])h.emplaceBack(B*u.EXTENT,Z*x,ie);for(let B=0;B<2*v;B+=2)p.emplaceBack(O+B,O+B+1,O+B+3),p.emplaceBack(O+B,O+B+3,O+B+2),p.emplaceBack(F+B,F+B+3,F+B+1),p.emplaceBack(F+B,F+B+2,F+B+3);return this._mesh={indexBuffer:o.createIndexBuffer(p),vertexBuffer:o.createVertexBuffer(h,ed.members),segments:u.SegmentVector.simpleSegment(0,0,h.length,p.length)},this._mesh}getMeshFrameDelta(o){return 2*Math.PI*u.earthRadius/Math.pow(2,o)/5}getMinMaxElevation(o){const h=this.getTerrainData(o).tile,p={minElevation:null,maxElevation:null};return h&&h.dem&&(p.minElevation=h.dem.min*this.exaggeration,p.maxElevation=h.dem.max*this.exaggeration),p}}class xa{constructor(o,h,p){this._context=o,this._size=h,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const h=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new st(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),h.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),h.colorAttachment.set(p.texture),{id:o,fbo:h,texture:p,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(h=>o.id!==h),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const h of this._recentlyUsed)if(!this._objects[h].inUse)return this._objects[h];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(o=>!o.inUse)===!1}}const au={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Uc{constructor(o,h){this.painter=o,this.terrain=h,this.pool=new xa(o.context,30,h.sourceCache.tileSize*h.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,h){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=o._order.filter(p=>!o._layers[p].isHidden(h)),this._coordsDescendingInv={};for(const p in o.sourceCaches){this._coordsDescendingInv[p]={};const v=o.sourceCaches[p].getVisibleCoordinates();for(const x of v){const P=this.terrain.sourceCache.getTerrainCoords(x);for(const A in P)this._coordsDescendingInv[p][A]||(this._coordsDescendingInv[p][A]=[]),this._coordsDescendingInv[p][A].push(P[A])}}this._coordsDescendingInvStr={};for(const p of o._order){const v=o._layers[p],x=v.source;if(au[v.type]&&!this._coordsDescendingInvStr[x]){this._coordsDescendingInvStr[x]={};for(const P in this._coordsDescendingInv[x])this._coordsDescendingInvStr[x][P]=this._coordsDescendingInv[x][P].map(A=>A.key).sort().join()}}for(const p of this._renderableTiles)for(const v in this._coordsDescendingInvStr){const x=this._coordsDescendingInvStr[v][p.tileID.key];x&&x!==p.rttCoords[v]&&(p.rtt=[])}}renderLayer(o){if(o.isHidden(this.painter.transform.zoom))return!1;const h=o.type,p=this.painter,v=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if(au[h]&&(this._prevType&&au[this._prevType]||this._stacks.push([]),this._prevType=h,this._stacks[this._stacks.length-1].push(o.id),!v))return!0;if(au[this._prevType]||au[h]&&v){this._prevType=h;const x=this._stacks.length-1,P=this._stacks[x]||[];for(const A of this._renderableTiles){if(this.pool.isFull()&&(bn(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(A),A.rtt[x]){const O=this.pool.getObjectForId(A.rtt[x].id);if(O.stamp===A.rtt[x].stamp){this.pool.useObject(O);continue}}const L=this.pool.getOrCreateFreeObject();this.pool.useObject(L),this.pool.stampObject(L),A.rtt[x]={id:L.id,stamp:L.stamp},p.context.bindFramebuffer.set(L.fbo.framebuffer),p.context.clear({color:u.Color.transparent,stencil:0}),p.currentStencilSource=void 0;for(let O=0;O<P.length;O++){const F=p.style._layers[P[O]],B=F.source?this._coordsDescendingInv[F.source][A.tileID.key]:[A.tileID];p.context.viewport.set([0,0,L.fbo.width,L.fbo.height]),p._renderTileClippingMasks(F,B),p.renderLayer(p,p.style.sourceCaches[F.source],F,B),F.source&&(A.rttCoords[F.source]=this._coordsDescendingInvStr[F.source][A.tileID.key])}}return bn(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),au[h]}return!1}}const Hn=E,ai={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:u.config.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},td=_=>{_.touchstart=_.dragStart,_.touchmoveWindow=_.dragMove,_.touchend=_.dragEnd},sc={showCompass:!0,showZoom:!0,visualizePitch:!1};class jc{constructor(o,h,p=!1){this.mousedown=P=>{this.startMouse(u.extend({},P,{ctrlKey:!0,preventDefault:()=>P.preventDefault()}),m.mousePos(this.element,P)),m.addEventListener(window,"mousemove",this.mousemove),m.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=P=>{this.moveMouse(P,m.mousePos(this.element,P))},this.mouseup=P=>{this.mouseRotate.dragEnd(P),this.mousePitch&&this.mousePitch.dragEnd(P),this.offTemp()},this.touchstart=P=>{P.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=m.touchPos(this.element,P.targetTouches)[0],this.startTouch(P,this._startPos),m.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),m.addEventListener(window,"touchend",this.touchend))},this.touchmove=P=>{P.targetTouches.length!==1?this.reset():(this._lastPos=m.touchPos(this.element,P.targetTouches)[0],this.moveTouch(P,this._lastPos))},this.touchend=P=>{P.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const v=o.dragRotate._mouseRotate.getClickTolerance(),x=o.dragRotate._mousePitch.getClickTolerance();this.element=h,this.mouseRotate=Gs({clickTolerance:v,enable:!0}),this.touchRotate=(({enable:P,clickTolerance:A,bearingDegreesPerPixelMoved:L=.8})=>{const O=new Co;return new Xi({clickTolerance:A,move:(F,B)=>({bearingDelta:(B.x-F.x)*L}),moveStateManager:O,enable:P,assignEvents:td})})({clickTolerance:v,enable:!0}),this.map=o,p&&(this.mousePitch=qn({clickTolerance:x,enable:!0}),this.touchPitch=(({enable:P,clickTolerance:A,pitchDegreesPerPixelMoved:L=-.5})=>{const O=new Co;return new Xi({clickTolerance:A,move:(F,B)=>({pitchDelta:(B.y-F.y)*L}),moveStateManager:O,enable:P,assignEvents:td})})({clickTolerance:x,enable:!0})),m.addEventListener(h,"mousedown",this.mousedown),m.addEventListener(h,"touchstart",this.touchstart,{passive:!1}),m.addEventListener(h,"touchcancel",this.reset)}startMouse(o,h){this.mouseRotate.dragStart(o,h),this.mousePitch&&this.mousePitch.dragStart(o,h),m.disableDrag()}startTouch(o,h){this.touchRotate.dragStart(o,h),this.touchPitch&&this.touchPitch.dragStart(o,h),m.disableDrag()}moveMouse(o,h){const p=this.map,{bearingDelta:v}=this.mouseRotate.dragMove(o,h)||{};if(v&&p.setBearing(p.getBearing()+v),this.mousePitch){const{pitchDelta:x}=this.mousePitch.dragMove(o,h)||{};x&&p.setPitch(p.getPitch()+x)}}moveTouch(o,h){const p=this.map,{bearingDelta:v}=this.touchRotate.dragMove(o,h)||{};if(v&&p.setBearing(p.getBearing()+v),this.touchPitch){const{pitchDelta:x}=this.touchPitch.dragMove(o,h)||{};x&&p.setPitch(p.getPitch()+x)}}off(){const o=this.element;m.removeEventListener(o,"mousedown",this.mousedown),m.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),m.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),m.removeEventListener(window,"touchend",this.touchend),m.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){m.enableDrag(),m.removeEventListener(window,"mousemove",this.mousemove),m.removeEventListener(window,"mouseup",this.mouseup),m.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),m.removeEventListener(window,"touchend",this.touchend)}}let ba;function $c(_,o,h){if(_=new u.LngLat(_.lng,_.lat),o){const p=new u.LngLat(_.lng-360,_.lat),v=new u.LngLat(_.lng+360,_.lat),x=h.locationPoint(_).distSqr(o);h.locationPoint(p).distSqr(o)<x?_=p:h.locationPoint(v).distSqr(o)<x&&(_=v)}for(;Math.abs(_.lng-h.center.lng)>180;){const p=h.locationPoint(_);if(p.x>=0&&p.y>=0&&p.x<=h.width&&p.y<=h.height)break;_.lng>h.center.lng?_.lng-=360:_.lng+=360}return _}const ac={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function lu(_,o,h){const p=_.classList;for(const v in ac)p.remove(`maplibregl-${h}-anchor-${v}`);p.add(`maplibregl-${h}-anchor-${o}`)}class lc extends u.Evented{constructor(o){if(super(),this._onKeyPress=h=>{const p=h.code,v=h.charCode||h.keyCode;p!=="Space"&&p!=="Enter"&&v!==32&&v!==13||this.togglePopup()},this._onMapClick=h=>{const p=h.originalEvent.target,v=this._element;this._popup&&(p===v||v.contains(p))&&this.togglePopup()},this._update=h=>{if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=$c(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let p="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?p=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(p=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let v="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?v="rotateX(0deg)":this._pitchAlignment==="map"&&(v=`rotateX(${this._map.getPitch()}deg)`),h&&h.type!=="moveend"||(this._pos=this._pos.round()),m.setTransform(this._element,`${ac[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${v} ${p}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const x=this._map.unproject(this._pos),P=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=x.distanceTo(this._lngLat)>20*P?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=h=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=h.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=h.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.Event("dragstart"))),this.fire(new u.Event("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.Event("dragend")),this._state="inactive"},this._addDragHandler=h=>{this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(this._pos).add(this._offset),this._pointerdownPos=h.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=u.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=m.create("div"),this._element.setAttribute("aria-label","Map marker");const h=m.createNS("http://www.w3.org/2000/svg","svg"),p=41,v=27;h.setAttributeNS(null,"display","block"),h.setAttributeNS(null,"height",`${p}px`),h.setAttributeNS(null,"width",`${v}px`),h.setAttributeNS(null,"viewBox",`0 0 ${v} ${p}`);const x=m.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const P=m.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"fill-rule","nonzero");const A=m.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"transform","translate(3.0, 29.0)"),A.setAttributeNS(null,"fill","#000000");const L=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const xe of L){const Le=m.createNS("http://www.w3.org/2000/svg","ellipse");Le.setAttributeNS(null,"opacity","0.04"),Le.setAttributeNS(null,"cx","10.5"),Le.setAttributeNS(null,"cy","5.80029008"),Le.setAttributeNS(null,"rx",xe.rx),Le.setAttributeNS(null,"ry",xe.ry),A.appendChild(Le)}const O=m.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill",this._color);const F=m.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),O.appendChild(F);const B=m.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"opacity","0.25"),B.setAttributeNS(null,"fill","#000000");const Z=m.createNS("http://www.w3.org/2000/svg","path");Z.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),B.appendChild(Z);const ie=m.createNS("http://www.w3.org/2000/svg","g");ie.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ie.setAttributeNS(null,"fill","#FFFFFF");const re=m.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ue=m.createNS("http://www.w3.org/2000/svg","circle");ue.setAttributeNS(null,"fill","#000000"),ue.setAttributeNS(null,"opacity","0.25"),ue.setAttributeNS(null,"cx","5.5"),ue.setAttributeNS(null,"cy","5.5"),ue.setAttributeNS(null,"r","5.4999962");const se=m.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#FFFFFF"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962"),re.appendChild(ue),re.appendChild(se),P.appendChild(A),P.appendChild(O),P.appendChild(B),P.appendChild(ie),P.appendChild(re),h.appendChild(P),h.setAttributeNS(null,"height",p*this._scale+"px"),h.setAttributeNS(null,"width",v*this._scale+"px"),this._element.appendChild(h),this._offset=u.Point.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",h=>{h.preventDefault()}),this._element.addEventListener("mousedown",h=>{h.preventDefault()}),lu(this._element,this._anchor,"marker"),o&&o.className)for(const h of o.className.split(" "))this._element.classList.add(h);this._popup=null}addTo(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),m.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=u.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const v=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(o){return this._offset=u.Point.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const rd={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let uu=0,Ml=!1;const nd={maxWidth:100,unit:"metric"};function Vc(_,o,h){const p=h&&h.maxWidth||100,v=_._container.clientHeight/2,x=_.unproject([0,v]),P=_.unproject([p,v]),A=x.distanceTo(P);if(h&&h.unit==="imperial"){const L=3.2808*A;L>5280?kl(o,p,L/5280,_._getUIString("ScaleControl.Miles")):kl(o,p,L,_._getUIString("ScaleControl.Feet"))}else h&&h.unit==="nautical"?kl(o,p,A/1852,_._getUIString("ScaleControl.NauticalMiles")):A>=1e3?kl(o,p,A/1e3,_._getUIString("ScaleControl.Kilometers")):kl(o,p,A,_._getUIString("ScaleControl.Meters"))}function kl(_,o,h,p){const v=function(x){const P=Math.pow(10,`${Math.floor(x)}`.length-1);let A=x/P;return A=A>=10?10:A>=5?5:A>=3?3:A>=2?2:A>=1?1:function(L){const O=Math.pow(10,Math.ceil(-Math.log(L)/Math.LN10));return Math.round(L*O)/O}(A),P*A}(h);_.style.width=o*(v/h)+"px",_.innerHTML=`${v}&nbsp;${p}`}const id={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Gc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function qc(_){if(_){if(typeof _=="number"){const o=Math.round(Math.sqrt(.5*Math.pow(_,2)));return{center:new u.Point(0,0),top:new u.Point(0,_),"top-left":new u.Point(o,o),"top-right":new u.Point(-o,o),bottom:new u.Point(0,-_),"bottom-left":new u.Point(o,-o),"bottom-right":new u.Point(-o,-o),left:new u.Point(_,0),right:new u.Point(-_,0)}}if(_ instanceof u.Point||Array.isArray(_)){const o=u.Point.convert(_);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:u.Point.convert(_.center||[0,0]),top:u.Point.convert(_.top||[0,0]),"top-left":u.Point.convert(_["top-left"]||[0,0]),"top-right":u.Point.convert(_["top-right"]||[0,0]),bottom:u.Point.convert(_.bottom||[0,0]),"bottom-left":u.Point.convert(_["bottom-left"]||[0,0]),"bottom-right":u.Point.convert(_["bottom-right"]||[0,0]),left:u.Point.convert(_.left||[0,0]),right:u.Point.convert(_.right||[0,0])}}return qc(new u.Point(0,0))}const od={extend:(_,...o)=>u.extend(_,...o),run(_){_()},logToElement(_,o=!1,h="log"){const p=window.document.getElementById(h);p&&(o&&(p.innerHTML=""),p.innerHTML+=`<br>${_}`)}},Hc=E;class Wr{static get version(){return Hc}static get workerCount(){return _n.workerCount}static set workerCount(o){_n.workerCount=o}static get maxParallelImageRequests(){return u.config.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(o){u.config.MAX_PARALLEL_IMAGE_REQUESTS=o}static get workerUrl(){return u.config.WORKER_URL}static set workerUrl(o){u.config.WORKER_URL=o}static addProtocol(o,h){u.config.REGISTERED_PROTOCOLS[o]=h}static removeProtocol(o){delete u.config.REGISTERED_PROTOCOLS[o]}}return Wr.Map=class extends Nc{constructor(_){if(u.PerformanceUtils.mark(u.PerformanceMarkers.create),(_=u.extend({},ai,_)).minZoom!=null&&_.maxZoom!=null&&_.minZoom>_.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(_.minPitch!=null&&_.maxPitch!=null&&_.minPitch>_.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(_.minPitch!=null&&_.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(_.maxPitch!=null&&_.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Se(_.minZoom,_.maxZoom,_.minPitch,_.maxPitch,_.renderWorldCopies),{bearingSnap:_.bearingSnap}),this._cooperativeGesturesOnWheel=o=>{this._onCooperativeGesture(o,o[this._metaKey],1)},this._contextLost=o=>{o.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new u.Event("webglcontextlost",{originalEvent:o}))},this._contextRestored=o=>{this._setupPainter(),this.resize(),this._update(),this.fire(new u.Event("webglcontextrestored",{originalEvent:o}))},this._onMapScroll=o=>{if(o.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=_.interactive,this._cooperativeGestures=_.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=_.maxTileCacheSize,this._maxTileCacheZoomLevels=_.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=_.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=_.preserveDrawingBuffer,this._antialias=_.antialias,this._trackResize=_.trackResize,this._bearingSnap=_.bearingSnap,this._refreshExpiredTiles=_.refreshExpiredTiles,this._fadeDuration=_.fadeDuration,this._crossSourceCollisions=_.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=_.collectResourceTiming,this._renderTaskQueue=new Bc,this._controls=[],this._mapId=u.uniqueId(),this._locale=u.extend({},Qh,_.locale),this._clickTolerance=_.clickTolerance,this._overridePixelRatio=_.pixelRatio,this._maxCanvasSize=_.maxCanvasSize,this.transformCameraUpdate=_.transformCameraUpdate,this._imageQueueHandle=ye.addThrottleControl(()=>this.isMoving()),this._requestManager=new te(_.transformRequest),typeof _.container=="string"){if(this._container=document.getElementById(_.container),!this._container)throw new Error(`Container '${_.container}' not found.`)}else{if(!(_.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=_.container}if(_.maxBounds&&this.setMaxBounds(_.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let o=!1;this._resizeObserver=new ResizeObserver(h=>{o?this._trackResize&&this.resize(h)._update():o=!0}),this._resizeObserver.observe(this._container)}this.handlers=new _a(this,_),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=_.hash&&new Ne(typeof _.hash=="string"&&_.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),_.bounds&&(this.resize(),this.fitBounds(_.bounds,u.extend({},_.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=_.localIdeographFontFamily,this._validateStyle=_.validateStyle,_.style&&this.setStyle(_.style,{localIdeographFontFamily:_.localIdeographFontFamily}),_.attributionControl&&this.addControl(new Lt({customAttribution:_.customAttribution})),_.maplibreLogo&&this.addControl(new Wt,_.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new u.Event(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new u.Event(`${o.dataType}dataloading`,o))}),this.on("dataabort",o=>{this.fire(new u.Event("sourcedataabort",o))})}_getMapId(){return this._mapId}addControl(_,o){if(o===void 0&&(o=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=_.onAdd(this);this._controls.push(_);const p=this._controlPositions[o];return o.indexOf("bottom")!==-1?p.insertBefore(h,p.firstChild):p.appendChild(h),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(_);return o>-1&&this._controls.splice(o,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}calculateCameraOptionsFromTo(_,o,h,p){return p==null&&this.terrain&&(p=this.transform.getElevation(h,this.terrain)),super.calculateCameraOptionsFromTo(_,o,h,p)}resize(_){var o;const h=this._containerDimensions(),p=h[0],v=h[1],x=this._getClampedPixelRatio(p,v);if(this._resizeCanvas(p,v,x),this.painter.resize(p,v,x),this.painter.overLimit()){const A=this.painter.context.gl;this._maxCanvasSize=[A.drawingBufferWidth,A.drawingBufferHeight];const L=this._getClampedPixelRatio(p,v);this._resizeCanvas(p,v,L),this.painter.resize(p,v,L)}this.transform.resize(p,v),(o=this._requestedCameraState)===null||o===void 0||o.resize(p,v);const P=!this._moving;return P&&(this.stop(),this.fire(new u.Event("movestart",_)).fire(new u.Event("move",_))),this.fire(new u.Event("resize",_)),P&&this.fire(new u.Event("moveend",_)),this}_getClampedPixelRatio(_,o){const{0:h,1:p}=this._maxCanvasSize,v=this.getPixelRatio(),x=_*v,P=o*v;return Math.min(x>h?h/x:1,P>p?p/P:1)*v}getPixelRatio(){var _;return(_=this._overridePixelRatio)!==null&&_!==void 0?_:devicePixelRatio}setPixelRatio(_){this._overridePixelRatio=_,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(_){return this.transform.setMaxBounds(yr.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_&&this.setZoom(_),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_&&this.setZoom(_),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_&&this.setPitch(_),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_&&this.setPitch(_),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(_){return this._cooperativeGestures=_,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(_){return this.transform.locationPoint(u.LngLat.convert(_),this.style&&this.terrain)}unproject(_){return this.transform.pointLocation(u.Point.convert(_),this.terrain)}isMoving(){var _;return this._moving||((_=this.handlers)===null||_===void 0?void 0:_.isMoving())}isZooming(){var _;return this._zooming||((_=this.handlers)===null||_===void 0?void 0:_.isZooming())}isRotating(){var _;return this._rotating||((_=this.handlers)===null||_===void 0?void 0:_.isRotating())}_createDelegatedListener(_,o,h){if(_==="mouseenter"||_==="mouseover"){let p=!1;return{layer:o,listener:h,delegates:{mousemove:x=>{const P=this.getLayer(o)?this.queryRenderedFeatures(x.point,{layers:[o]}):[];P.length?p||(p=!0,h.call(this,new ur(_,this,x.originalEvent,{features:P}))):p=!1},mouseout:()=>{p=!1}}}}if(_==="mouseleave"||_==="mouseout"){let p=!1;return{layer:o,listener:h,delegates:{mousemove:P=>{(this.getLayer(o)?this.queryRenderedFeatures(P.point,{layers:[o]}):[]).length?p=!0:p&&(p=!1,h.call(this,new ur(_,this,P.originalEvent)))},mouseout:P=>{p&&(p=!1,h.call(this,new ur(_,this,P.originalEvent)))}}}}{const p=v=>{const x=this.getLayer(o)?this.queryRenderedFeatures(v.point,{layers:[o]}):[];x.length&&(v.features=x,h.call(this,v),delete v.features)};return{layer:o,listener:h,delegates:{[_]:p}}}}on(_,o,h){if(h===void 0)return super.on(_,o);const p=this._createDelegatedListener(_,o,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(p);for(const v in p.delegates)this.on(v,p.delegates[v]);return this}once(_,o,h){if(h===void 0)return super.once(_,o);const p=this._createDelegatedListener(_,o,h);for(const v in p.delegates)this.once(v,p.delegates[v]);return this}off(_,o,h){return h===void 0?super.off(_,o):(this._delegatedListeners&&this._delegatedListeners[_]&&(p=>{const v=this._delegatedListeners[_];for(let x=0;x<v.length;x++){const P=v[x];if(P.layer===o&&P.listener===h){for(const A in P.delegates)this.off(A,P.delegates[A]);return v.splice(x,1),this}}})(),this)}queryRenderedFeatures(_,o){if(!this.style)return[];let h;const p=_ instanceof u.Point||Array.isArray(_),v=p?_:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(p?{}:_)||{},v instanceof u.Point||typeof v[0]=="number")h=[u.Point.convert(v)];else{const x=u.Point.convert(v[0]),P=u.Point.convert(v[1]);h=[x,new u.Point(P.x,x.y),P,new u.Point(x.x,P.y),x]}return this.style.queryRenderedFeatures(h,o,this.transform)}querySourceFeatures(_,o){return this.style.querySourceFeatures(_,o)}setStyle(_,o){return(o=u.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&_?(this._diffStyle(_,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(_,o))}setTransformRequest(_){return this._requestManager.setTransformRequest(_),this}_getUIString(_){const o=this._locale[_];if(o==null)throw new Error(`Missing UI string '${_}'`);return o}_updateStyle(_,o){if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(_,o));const h=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!_)),_?(this.style=new Vi(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_,o,h):this.style.loadJSON(_,o,h),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Vi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,o){if(typeof _=="string"){const h=this._requestManager.transformRequest(_,Q.Style);u.getJSON(h,(p,v)=>{p?this.fire(new u.ErrorEvent(p)):v&&this._updateDiff(v,o)})}else typeof _=="object"&&this._updateDiff(_,o)}_updateDiff(_,o){try{this.style.setState(_,o)&&this._update(!0)}catch(h){u.warnOnce(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(_,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.warnOnce("There is no style added to the map.")}addSource(_,o){return this._lazyInitEmptyStyle(),this.style.addSource(_,o),this._update(!0)}isSourceLoaded(_){const o=this.style&&this.style.sourceCaches[_];if(o!==void 0)return o.loaded();this.fire(new u.ErrorEvent(new Error(`There is no source with ID '${_}'`)))}setTerrain(_){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),_){const o=this.style.sourceCaches[_.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${_.source}`);for(const h in this.style._layers){const p=this.style._layers[h];p.type==="hillshade"&&p.source===_.source&&u.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Hf(this.painter,o,_),this.painter.renderToTexture=new Uc(this.painter,this.terrain),this.transform.updateElevation(this.terrain),this._terrainDataCallback=h=>{h.dataType==="style"?this.terrain.sourceCache.freeRtt():h.dataType==="source"&&h.tile&&(h.sourceId===_.source&&this.transform.updateElevation(this.terrain),this.terrain.sourceCache.freeRtt(h.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.updateElevation(this.terrain);return this.fire(new u.Event("terrain",{terrain:_})),this}getTerrain(){return this.terrain&&this.terrain.options}areTilesLoaded(){const _=this.style&&this.style.sourceCaches;for(const o in _){const h=_[o]._tiles;for(const p in h){const v=h[p];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}addSourceType(_,o,h){return this._lazyInitEmptyStyle(),this.style.addSourceType(_,o,h)}removeSource(_){return this.style.removeSource(_),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,o,h={}){const{pixelRatio:p=1,sdf:v=!1,stretchX:x,stretchY:P,content:A}=h;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||u.isImageBitmap(o))){if(o.width===void 0||o.height===void 0)return this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:L,height:O,data:F}=o,B=o;return this.style.addImage(_,{data:new u.RGBAImage({width:L,height:O},new Uint8Array(F)),pixelRatio:p,stretchX:x,stretchY:P,content:A,sdf:v,version:0,userImage:B}),B.onAdd&&B.onAdd(this,_),this}}{const{width:L,height:O,data:F}=u.browser.getImageData(o);this.style.addImage(_,{data:new u.RGBAImage({width:L,height:O},F),pixelRatio:p,stretchX:x,stretchY:P,content:A,sdf:v,version:0})}}updateImage(_,o){const h=this.style.getImage(_);if(!h)return this.fire(new u.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=o instanceof HTMLImageElement||u.isImageBitmap(o)?u.browser.getImageData(o):o,{width:v,height:x,data:P}=p;if(v===void 0||x===void 0)return this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==h.data.width||x!==h.data.height)return this.fire(new u.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const A=!(o instanceof HTMLImageElement||u.isImageBitmap(o));return h.data.replace(P,A),this.style.updateImage(_,h),this}getImage(_){return this.style.getImage(_)}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new u.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_,o){ye.getImage(this._requestManager.transformRequest(_,Q.Image),o)}listImages(){return this.style.listImages()}addLayer(_,o){return this._lazyInitEmptyStyle(),this.style.addLayer(_,o),this._update(!0)}moveLayer(_,o){return this.style.moveLayer(_,o),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}setLayerZoomRange(_,o,h){return this.style.setLayerZoomRange(_,o,h),this._update(!0)}setFilter(_,o,h={}){return this.style.setFilter(_,o,h),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,o,h,p={}){return this.style.setPaintProperty(_,o,h,p),this._update(!0)}getPaintProperty(_,o){return this.style.getPaintProperty(_,o)}setLayoutProperty(_,o,h,p={}){return this.style.setLayoutProperty(_,o,h,p),this._update(!0)}getLayoutProperty(_,o){return this.style.getLayoutProperty(_,o)}setGlyphs(_,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(_,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(_,o,h={}){return this._lazyInitEmptyStyle(),this.style.addSprite(_,o,h,p=>{p||this._update(!0)}),this}removeSprite(_){return this._lazyInitEmptyStyle(),this.style.removeSprite(_),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(_,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite(_,o,h=>{h||this._update(!0)}),this}setLight(_,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,o),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(_,o){return this.style.setFeatureState(_,o),this._update()}removeFeatureState(_,o){return this.style.removeFeatureState(_,o),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let _=0,o=0;return this._container&&(_=this._container.clientWidth||400,o=this._container.clientHeight||300),[_,o]}_setupContainer(){const _=this._container;_.classList.add("maplibregl-map");const o=this._canvasContainer=m.create("div","maplibregl-canvas-container",_);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=m.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const h=this._containerDimensions(),p=this._getClampedPixelRatio(h[0],h[1]);this._resizeCanvas(h[0],h[1],p);const v=this._controlContainer=m.create("div","maplibregl-control-container",_),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(P=>{x[P]=m.create("div",`maplibregl-ctrl-${P} `,v)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=m.create("div","maplibregl-cooperative-gesture-screen",this._container);let _=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(_=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${_}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){m.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(_,o,h){this._canvas.width=Math.floor(h*_),this._canvas.height=Math.floor(h*o),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const _={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let o=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{o={requestedAttributes:_},p&&(o.statusMessage=p.statusMessage,o.type=p.type)},{once:!0});const h=this._canvas.getContext("webgl2",_)||this._canvas.getContext("webgl",_);if(!h){const p="Failed to initialize WebGL";throw o?(o.message=p,new Error(JSON.stringify(o))):new Error(p)}this.painter=new Pn(h,this.transform),S.testSupport(h)}_onCooperativeGesture(_,o,h){return!o&&h<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_render(_){const o=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(_),this._removed)return;let h=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const v=this.transform.zoom,x=u.browser.now();this.style.zoomHistory.update(v,x);const P=new u.EvaluationParameters(v,{now:x,fadeDuration:o,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),A=P.crossFadingFactor();A===1&&A===this._crossFadingFactor||(h=!0,this._crossFadingFactor=A),this.style.update(P)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain&&this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.updateElevation(this.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,o,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:o,showPadding:this.showPadding}),this.fire(new u.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.PerformanceUtils.mark(u.PerformanceMarkers.load),this.fire(new u.Event("load"))),this.style&&(this.style.hasTransitions()||h)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const p=this._sourcesDirty||this._styleDirty||this._placementDirty;return p||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.Event("idle")),!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,u.PerformanceUtils.mark(u.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var _;this._hash&&this._hash.remove();for(const h of this._controls)h.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ye.removeThrottleControl(this._imageQueueHandle),(_=this._resizeObserver)===null||_===void 0||_.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),m.remove(this._canvasContainer),m.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),u.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new u.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=u.browser.frame(_=>{u.PerformanceUtils.frame(_),this._frame=null,this._render(_)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get version(){return Hn}getCameraTargetElevation(){return this.transform.elevation}},Wr.NavigationControl=class{constructor(_){this._updateZoomButtons=()=>{const o=this._map.getZoom(),h=o===this._map.getMaxZoom(),p=o===this._map.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=o},this._setButtonTitle=(o,h)=>{const p=this._map._getUIString(`NavigationControl.${h}`);o.title=p,o.setAttribute("aria-label",p)},this.options=u.extend({},sc,_),this._container=m.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),m.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),m.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=m.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new jc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){m.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(_,o){const h=m.create("button",_,this._container);return h.type="button",h.addEventListener("click",o),h}},Wr.GeolocateControl=class extends u.Evented{constructor(_){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new u.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new u.Event("geolocate",o)),this._finish()}},this._updateCamera=o=>{const h=new u.LngLat(o.coords.longitude,o.coords.latitude),p=o.coords.accuracy,v=this._map.getBearing(),x=u.extend({bearing:v},this.options.fitBoundsOptions),P=yr.fromLngLat(h,p);this._map.fitBounds(P,x,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const h=new u.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=o=>{if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&Ml)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new u.Event("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=o=>{if(this._map){if(this._container.addEventListener("contextmenu",h=>h.preventDefault()),this._geolocateButton=m.create("button","maplibregl-ctrl-geolocate",this._container),m.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",o===!1){u.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h)}else{const h=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=m.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new lc({element:this._dotElement}),this._circleElement=m.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new lc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",h=>{h.geolocateSource||this._watchState!=="ACTIVE_LOCK"||h.originalEvent&&h.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new u.Event("trackuserlocationend")))})}},this.options=u.extend({},rd,_)}onAdd(_){return this._map=_,this._container=m.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(o,h=!1){ba===void 0||h?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(p=>{ba=p.state!=="denied",o(ba)}).catch(()=>{ba=!!window.navigator.geolocation,o(ba)}):(ba=!!window.navigator.geolocation,o(ba)):o(ba)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),m.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,uu=0,Ml=!1}_isOutOfMapMaxBounds(_){const o=this._map.getMaxBounds(),h=_.coords;return o&&(h.longitude<o.getWest()||h.longitude>o.getEast()||h.latitude<o.getSouth()||h.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const _=this._map.getBounds(),o=_.getSouthEast(),h=_.getNorthEast(),p=o.distanceTo(h),v=Math.ceil(this._accuracy/(p/this._map._container.clientHeight)*2);this._circleElement.style.width=`${v}px`,this._circleElement.style.height=`${v}px`}trigger(){if(!this._setup)return u.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":uu--,Ml=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new u.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),uu++,uu>1?(_={maximumAge:6e5,timeout:0},Ml=!0):(_=this.options.positionOptions,Ml=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,_)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},Wr.AttributionControl=Lt,Wr.LogoControl=Wt,Wr.ScaleControl=class{constructor(_){this._onMove=()=>{Vc(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,Vc(this._map,this._container,this.options)},this.options=u.extend({},nd,_)}getDefaultPosition(){return"bottom-left"}onAdd(_){return this._map=_,this._container=m.create("div","maplibregl-ctrl maplibregl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){m.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},Wr.FullscreenControl=class extends u.Evented{constructor(_={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,_&&_.container&&(_.container instanceof HTMLElement?this._container=_.container:u.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=m.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){m.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const _=this._fullscreenButton=m.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);m.create("span","maplibregl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.title=_}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new u.Event("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new u.Event("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},Wr.TerrainControl=class{constructor(_){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=_}onAdd(_){return this._map=_,this._container=m.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=m.create("button","maplibregl-ctrl-terrain",this._container),m.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){m.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},Wr.Popup=class extends u.Evented{constructor(_){super(),this.remove=()=>(this._content&&m.remove(this._content),this._container&&(m.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new u.Event("close")),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=m.create("div","maplibregl-popup",this._map.getContainer()),this._tip=m.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const P of this.options.className.split(" "))this._container.classList.add(P);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=$c(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!o)return;const h=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);let p=this.options.anchor;const v=qc(this.options.offset);if(!p){const P=this._container.offsetWidth,A=this._container.offsetHeight;let L;L=h.y+v.bottom.y<A?["top"]:h.y>this._map.transform.height-A?["bottom"]:[],h.x<P/2?L.push("left"):h.x>this._map.transform.width-P/2&&L.push("right"),p=L.length===0?"bottom":L.join("-")}const x=h.add(v[p]).round();m.setTransform(this._container,`${ac[p]} translate(${x.x}px,${x.y}px)`),lu(this._container,p,"popup")},this._onClose=()=>{this.remove()},this.options=u.extend(Object.create(id),_)}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new u.Event("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(_){return this._lngLat=u.LngLat.convert(_),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(document.createTextNode(_))}setHTML(_){const o=document.createDocumentFragment(),h=document.createElement("body");let p;for(h.innerHTML=_;p=h.firstChild,p;)o.appendChild(p);return this.setDOMContent(o)}getMaxWidth(){var _;return(_=this._container)===null||_===void 0?void 0:_.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=m.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(_),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(_){this._container&&this._container.classList.add(_)}removeClassName(_){this._container&&this._container.classList.remove(_)}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){if(this._container)return this._container.classList.toggle(_)}_createCloseButton(){this.options.closeButton&&(this._closeButton=m.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(Gc);_&&_.focus()}},Wr.Marker=lc,Wr.Style=Vi,Wr.LngLat=u.LngLat,Wr.LngLatBounds=yr,Wr.Point=u.Point,Wr.MercatorCoordinate=u.MercatorCoordinate,Wr.Evented=u.Evented,Wr.AJAXError=u.AJAXError,Wr.config=u.config,Wr.CanvasSource=Ue,Wr.GeoJSONSource=vn,Wr.ImageSource=so,Wr.RasterDEMTileSource=jo,Wr.RasterTileSource=ji,Wr.VectorTileSource=dn,Wr.VideoSource=wi,Wr.setRTLTextPlugin=u.setRTLTextPlugin,Wr.getRTLTextPluginStatus=u.getRTLTextPluginStatus,Wr.prewarm=function(){$i().acquire(ut)},Wr.clearPrewarmedResources=function(){const _=Si;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(ut),Si=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},od.extend(Wr,{isSafari:u.isSafari,getPerformanceMetrics:u.PerformanceUtils.getPerformanceMetrics}),Wr});var f=a;return f})})(RC);var Ix=RC.exports;const IB=Lf(Ix);function DC(e){return Array.isArray(e)&&typeof e[0]=="number"&&typeof e[1]=="number"}function PB(e){return DC(e[0])}function AB(e){return e&&Array.isArray(e.coordinates)&&typeof e.coordinates[0]=="number"&&typeof e.coordinates[1]=="number"}function MB(e){return AB(e[0])}function kB(e){return e.type==="geojson"}const Ov=e=>typeof e=="string"&&e.length>0,IE=e=>{let t;return PB(e)?t=e.map(r=>({type:"Feature",geometry:{type:"Point",coordinates:r},properties:{place_name:`Coordinates,${r}`}})):MB(e)?t=e.map(r=>({type:"Feature",geometry:{type:"Point",coordinates:r.coordinates},properties:{title:r.title,address:r.address}})):t=e,t},LB=e=>e.replace(/\./g,"%2E");var Xm=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})},RB=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class e0{constructor(t,r){this.refreshCredentials=()=>Xm(this,void 0,void 0,function*(){try{this.credentials=yield Cf.get()}catch(n){throw console.error(`Failed to refresh credentials: ${n}`),n}}),this.refreshCredentialsWithRetry=()=>Xm(this,void 0,void 0,function*(){try{if(yield bT(this.refreshCredentials,[],3e5),this.activeTimeout&&clearTimeout(this.activeTimeout),this.credentials.expiration.getTime()>new Date().getTime()){const l=new Date(this.credentials.expiration).getTime()-new Date().getTime()-1e4;this.activeTimeout=window.setTimeout(this.refreshCredentialsWithRetry,Math.min(l,36e5))}}catch(n){console.error(`Failed to refresh credentials: ${n}`)}}),this.transformRequest=(n,a)=>{let l=n;if(a==="Style"&&!n.includes("://")){if(this.region==null)throw new Error("AWS region for map is undefined. Please verify that the region is set in aws-exports.js or that you are providing an AWS region parameter to createMap");l=`https://maps.geo.${this.region}.amazonaws.com/maps/v0/maps/${n}/style-descriptor`}const f=new URL(l);if(f.hostname.endsWith(".amazonaws.com"))return f.searchParams.append("x-amz-user-agent",encodeURIComponent(LB(DB()))),{url:LR.signUrl(f.href,{access_key:this.credentials.accessKeyId,secret_key:this.credentials.secretAccessKey,session_token:this.credentials.sessionToken})}},this.credentials=t,this.region=r,this.activeTimeout=null,this.refreshCredentialsWithRetry(),vT.listen("auth",n=>{switch(n.payload.event){case"signIn":case"signOut":case"tokenRefresh":this.refreshCredentialsWithRetry();break}})}}e0.createMapLibreMap=e=>Xm(void 0,void 0,void 0,function*(){const{region:t,mapConstructor:r=Ix.Map}=e,n=RB(e,["region","mapConstructor"]),a=Tc.getDefaultMap(),f=new e0(yield Cf.get(),t||a.region).transformRequest;return new r(Object.assign(Object.assign({},n),{style:e.style||a.mapName,transformRequest:f}))});const OB=e=>Xm(void 0,void 0,void 0,function*(){return e0.createMapLibreMap(e)});function DB(){const e=rx();return e&&typeof e=="object"?e.map(([t,r])=>`${t}/${r}`).join(" "):e}const $h="#fff",zB="#000",Px="#5d8aff",FB="#ff9900",NB="#0000001f",zC="M24.8133 38.533C18.76 31.493 13 28.8264 13 20.8264C13.4827 14.9864 16.552 9.67169 21.368 6.33302C33.768 -2.26165 50.824 5.78902 52.0667 20.8264C52.0667 28.613 46.5733 31.6797 40.6533 38.373C32.4933 47.5464 35.4 63.093 32.4933 63.093C29.72 63.093 32.4933 47.5464 24.8133 38.533ZM32.4933 8.23969C26.5573 8.23969 21.7467 13.0504 21.7467 18.9864C21.7467 24.9224 26.5573 29.733 32.4933 29.733C38.4293 29.733 43.24 24.9224 43.24 18.9864C43.24 13.0504 38.4293 8.23969 32.4933 8.23969Z";var bu;(function(e){e.ESRI_TOPOGRAPHIC="VectorEsriTopographic",e.ESRI_STREETS="VectorEsriStreets",e.ESRI_LIGHT_GRAY="VectorEsriLightGrayCanvas",e.ESRI_DARK_GRAY="VectorEsriDarkGrayCanvas",e.ESRI_NAVIGATION="VectorEsriNavigation",e.HERE_BERLIN="VectorHereBerlin"})(bu||(bu={}));const BB={[bu.ESRI_TOPOGRAPHIC]:"Noto Sans Regular",[bu.ESRI_STREETS]:"Arial Regular",[bu.ESRI_LIGHT_GRAY]:"Ubuntu Regular",[bu.ESRI_DARK_GRAY]:"Ubuntu Regular",[bu.ESRI_NAVIGATION]:"Arial Regular",[bu.HERE_BERLIN]:"Fira GO Regular"};function UB(e,t,{fillColor:r=Px,smCircleSize:n=60,smThreshold:a=50,mdCircleSize:l=100,mdThreshold:f=100,lgCircleSize:u=140,lgThreshold:E=500,xlCircleSize:m=180,borderWidth:S=4,borderColor:M=$h,clusterPaint:z,onClick:H,showCount:q,clusterCountLayout:Y,fontColor:ye=$h},Q){const te=`${e}-layer-clusters`,ne=`${e}-layer-cluster-count`,Me=Object.assign({"circle-color":["step",["get","point_count"],r,a,r,f,r,E,r],"circle-radius":["step",["get","point_count"],n,a,l,f,u,E,m],"circle-stroke-width":S,"circle-stroke-color":M},z),Ve={id:te,type:"circle",source:e,filter:["has","point_count"],paint:Me};if(t.addLayer(Object.assign({},Ve)),t.on("click",te,function(je){typeof H=="function"&&H(je);const Qe=t.queryRenderedFeatures(je.point,{layers:[te]}),ot=Qe[0].properties.cluster_id,Ut=t.getSource(e);kB(Ut)&&Ut.getClusterExpansionZoom(ot,function(st,Qt){st||t.easeTo({center:Qe[0].geometry.coordinates,zoom:Qt})})}),q){const je={"text-field":"{point_count_abbreviated}","text-size":24},Qe=Q||Tc.getDefaultMap().style;Qe&&(je["text-font"]=[BB[Qe]]);const ot=Object.assign(Object.assign({},je),Y),st={id:ne,type:"symbol",source:e,filter:["has","point_count"],layout:ot,paint:{"text-color":ye}};t.addLayer(Object.assign({},st))}return{clusterLayerId:te,clusterSymbolLayerId:ne}}function PE(e){const t=e!=null&&e.fillColor?e.fillColor:Px,r=e!=null&&e.strokeColor?e.strokeColor:$h,n=e!=null&&e.lineWidth?e.lineWidth:4;return{width:64,height:64,data:new Uint8Array(64*64*4),onAdd:function(){const a=document.createElement("canvas");a.width=this.width,a.height=this.height,this.context=a.getContext("2d")},render:function(){const a=this.context,l=new Path2D(zC);return a.stroke(l),a.fillStyle=t,a.strokeStyle=r,a.lineWidth=n,a.fill(l),this.data=a.getImageData(0,0,this.width,this.height).data,!0}}}function jB(e,{popupBackgroundColor:t=$h,popupBorderColor:r=NB,popupBorderWidth:n=2,popupFontColor:a=zB,popupPadding:l=20,popupBorderRadius:f=4,popupTitleFontWeight:u="bold"}){return E=>{let m,S;if(Ov(E.properties.place_name)){const Y=E.properties.place_name.split(",");m=Y[0],S=Y.splice(1,Y.length).join(",")}else Ov(E.properties.title)||Ov(E.properties.address)?(m=E.properties.title,S=E.properties.address):(m="Coordinates",S=E.geometry.coordinates);const M=`<div class="${e}-popup-title" style="font-weight: ${u};">${m}</div>`,z=`<div class="${e}-popup-address">${S}</div>`,H=`background: ${t}; border: ${n}px solid ${r}; color: ${a}; border-radius: ${f}px; padding: ${l}px; word-wrap: break-word; margin: -10px -10px -15px;`;let q=`<div class="${e}-popup" style="${H}">`;return m&&(q+=M),S&&(q+=z),q+="</div>",q}}var $B=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const AE="amplify-tip";function VB(e,t,r){var{showMarkerPopup:n=!1}=r,a=$B(r,["showMarkerPopup"]);const l=`${e}-layer-unclustered-point`;let f=null;function u(){f!==null&&(t.setLayoutProperty(l,"icon-image","inactive-marker"),f=null)}const E=a.popupRender?a.popupRender:jB(l,a);GB(t,a);const m={id:l,type:"symbol",source:e,filter:["!",["has","point_count"]],layout:{"icon-image":"inactive-marker"}};if(t.addLayer(Object.assign({},m)),n&&!document.getElementById(AE)){const M=document.createElement("style");M.setAttribute("id",AE),document.head.append(M),M.textContent=".mapboxgl-popup-tip { display: none; }"}return t.on("click",function(){u()}),t.on("click",l,function(S){if(typeof a.onClick=="function"&&a.onClick(S),f=S.features[0].id,t.setLayoutProperty(l,"icon-image",["match",["id"],f,"active-marker","inactive-marker"]),n){const M=S.features[0],z=M.geometry.coordinates;DC(z)&&new Ix.Popup().setLngLat(z).setHTML(E(M)).setOffset(15).addTo(t).on("close",function(){f===M.id&&u()})}}),t.on("mouseover",l,function(){t.getCanvas().style.cursor="pointer"}),t.on("mouseleave",l,()=>{t.getCanvas().style.cursor=""}),{unclusteredLayerId:l}}function GB(e,{selectedColor:t=FB,selectedBorderColor:r=$h,selectedBorderWidth:n=4,defaultBorderColor:a=$h,defaultBorderWidth:l=4,defaultColor:f=Px,markerImageElement:u,activeMarkerImageElement:E}){const m=u||PE({fillColor:f,strokeColor:a,lineWidth:l}),S=E||u||PE({fillColor:t,strokeColor:r,lineWidth:n});e.addImage("inactive-marker",m,{pixelRatio:2}),e.addImage("active-marker",S,{pixelRatio:2})}function qB(e,t,r,{showCluster:n=!0,clusterOptions:a={},unclusteredOptions:l={},autoFit:f=!0}={},u){var E,m;if(!r||typeof r.addSource!="function"||typeof r.addLayer!="function")throw new Error("Please use a maplibre map");const S=IE(t),M=e;r.addSource(M,{type:"geojson",data:{type:"FeatureCollection",features:S},cluster:n,clusterMaxZoom:(E=a.clusterMaxZoom)!==null&&E!==void 0?E:14,clusterRadius:(m=a.smCircleSize)!==null&&m!==void 0?m:60,generateId:!0});let z,H;n&&({clusterLayerId:z,clusterSymbolLayerId:H}=UB(M,r,a,u));const{unclusteredLayerId:q}=VB(M,r,l||{});if(f){const te=r.getBounds();S.forEach(function(ne){te.extend(ne.geometry.coordinates)}),r.fitBounds(te)}return{sourceId:M,unclusteredLayerId:q,clusterLayerId:z,clusterSymbolLayerId:H,setData:te=>{const ne=IE(te);r.getSource(M).setData({type:"FeatureCollection",features:ne})},show:()=>{r.setLayoutProperty(q,"visibility","visible"),z&&r.setLayoutProperty(z,"visibility","visible"),H&&r.setLayoutProperty(H,"visibility","visible")},hide:()=>{r.setLayoutProperty(q,"visibility","none"),z&&r.setLayoutProperty(z,"visibility","none"),H&&r.setLayoutProperty(H,"visibility","none")}}}var FC=ZB,HB=Object.prototype.hasOwnProperty;function ZB(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var n in r)HB.call(r,n)&&(e[n]=r[n])}return e}var NC={exports:{}};(function(e,t){(function(){var r={};e.exports=r,r.simpleFilter=function(n,a){return a.filter(function(l){return r.test(n,l)})},r.test=function(n,a){return r.match(n,a)!==null},r.match=function(n,a,l){l=l||{};var f=0,u=[],E=a.length,m=0,S=0,M=l.pre||"",z=l.post||"",H=l.caseSensitive&&a||a.toLowerCase(),q;n=l.caseSensitive&&n||n.toLowerCase();for(var Y=0;Y<E;Y++)q=a[Y],H[Y]===n[f]?(q=M+q+z,f+=1,S+=1+S):S=0,m+=S,u[u.length]=q;return f===n.length?(m=H===n?1/0:m,{rendered:u.join(""),score:m}):null},r.filter=function(n,a,l){return!a||a.length===0?[]:typeof n!="string"?a:(l=l||{},a.reduce(function(f,u,E,m){var S=u;l.extract&&(S=l.extract(u));var M=r.match(n,S,l);return M!=null&&(f[f.length]={string:M.rendered,score:M.score,index:E,original:u}),f},[]).sort(function(f,u){var E=u.score-f.score;return E||f.index-u.index}))}})()})(NC);var WB=NC.exports,Ms=function(e){return this.component=e,this.items=[],this.active=e.options.noInitialSelection?-1:0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,e.el.parentNode.insertBefore(this.wrapper,e.el.nextSibling),this};Ms.prototype.show=function(){this.element.style.display="block"};Ms.prototype.hide=function(){this.element.style.display="none"};Ms.prototype.add=function(e){this.items.push(e)};Ms.prototype.clear=function(){this.items=[],this.active=this.component.options.noInitialSelection?-1:0};Ms.prototype.isEmpty=function(){return!this.items.length};Ms.prototype.isVisible=function(){return this.element.style.display==="block"};Ms.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var e=0;e<this.items.length;e++)this.drawItem(this.items[e],this.active===e);this.show()};Ms.prototype.drawItem=function(e,t){var r=document.createElement("li"),n=document.createElement("a");t&&(r.className+=" active"),n.innerHTML=e.string,r.appendChild(n),this.element.appendChild(r),r.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),r.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,e)}).bind(this))};Ms.prototype.handleMouseUp=function(e){this.selectingListItem=!1,this.component.value(e.original),this.clear(),this.draw()};Ms.prototype.move=function(e){this.active=e,this.draw()};Ms.prototype.previous=function(){this.move(this.active<=0?this.items.length-1:this.active-1)};Ms.prototype.next=function(){this.move(this.active>=this.items.length-1?0:this.active+1)};Ms.prototype.drawError=function(e){var t=document.createElement("li");t.innerHTML=e,this.element.appendChild(t),this.show()};var KB=Ms,XB=FC,JB=WB,YB=KB,Uo=function(e,t,r){return r=r||{},this.options=XB({minLength:2,limit:5,filter:!0,hideOnBlur:!0,noInitialSelection:!0},r),this.el=e,this.data=t||[],this.list=new YB(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(n){this.handleKeyUp(n.keyCode,n)}).bind(this),!1),this.el.addEventListener("keydown",(function(n){this.handleKeyDown(n)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(n){this.handlePaste(n)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};Uo.prototype.handleKeyUp=function(e,t){if(!(e===40||e===38||e===27||e===9)){if(e===13){this.list.items[this.list.active]&&(this.list.handleMouseUp(this.list.items[this.list.active]),t.stopPropagation());return}this.handleInputChange(this.el.value)}};Uo.prototype.handleKeyDown=function(e){switch(e.keyCode){case 13:this.list.active>=0&&(this.list.selectingListItem=!0);break;case 9:this.list.isEmpty()||(this.list.isVisible()&&e.preventDefault(),this.value(this.list.active>=0?this.list.items[this.list.active].original:null),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}};Uo.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()};Uo.prototype.handlePaste=function(e){if(e.clipboardData)this.handleInputChange(e.clipboardData.getData("Text"));else{var t=this;setTimeout(function(){t.handleInputChange(e.target.value)},100)}};Uo.prototype.handleInputChange=function(e){if(this.query=this.normalize(e),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(t){for(var r=0;r<t.length&&(this.list.add(t[r]),r!==this.options.limit-1);r++);this.list.draw()}).bind(this))};Uo.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1};Uo.prototype.update=function(e){this.data=e,this.handleKeyUp()};Uo.prototype.clear=function(){this.data=[],this.list.clear()};Uo.prototype.normalize=function(e){return e=e.toLowerCase(),e};Uo.prototype.match=function(e,t){return e.indexOf(t)>-1};Uo.prototype.value=function(e){if(this.selected=e,this.el.value=this.getItemValue(e||{place_name:this.query}),document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this.el.dispatchEvent(t)}else this.el.fireEvent("onchange")};Uo.prototype.getCandidates=function(e){var t={pre:"<strong>",post:"</strong>",extract:(function(n){return this.getItemValue(n)}).bind(this)},r;this.options.filter?(r=JB.filter(this.query,this.data,t),r=r.map((function(n){return{original:n.original,string:this.render(n.original,n.string)}}).bind(this))):r=this.data.map((function(n){var a=this.render(n);return{original:n,string:a}}).bind(this)),e(r)};Uo.prototype.getItemValue=function(e){return e};Uo.prototype.render=function(e,t){if(t)return t;for(var r=e.original?this.getItemValue(e.original):this.getItemValue(e),n=this.normalize(r),a=n.lastIndexOf(this.query);a>-1;){var l=a+this.query.length;r=r.slice(0,a)+"<strong>"+r.slice(a,l)+"</strong>"+r.slice(l),a=n.slice(0,a).lastIndexOf(this.query)}return r};Uo.prototype.renderError=function(e){this.list.drawError(e)};var QB=Uo,BC=QB,e6=BC;typeof window<"u"&&(window.Suggestions=BC);var t6="Expected a function",ME=0/0,r6="[object Symbol]",n6=/^\s+|\s+$/g,i6=/^[-+]0x[0-9a-f]+$/i,o6=/^0b[01]+$/i,s6=/^0o[0-7]+$/i,a6=parseInt,l6=typeof{}=="object"&&{}&&{}.Object===Object&&{},u6=typeof self=="object"&&self&&self.Object===Object&&self,c6=l6||u6||Function("return this")(),h6=Object.prototype,d6=h6.toString,f6=Math.max,p6=Math.min,Dv=function(){return c6.Date.now()};function m6(e,t,r){var n,a,l,f,u,E,m=0,S=!1,M=!1,z=!0;if(typeof e!="function")throw new TypeError(t6);t=kE(t)||0,t0(r)&&(S=!!r.leading,M="maxWait"in r,l=M?f6(kE(r.maxWait)||0,t):l,z="trailing"in r?!!r.trailing:z);function H(je){var Qe=n,ot=a;return n=a=void 0,m=je,f=e.apply(ot,Qe),f}function q(je){return m=je,u=setTimeout(Q,t),S?H(je):f}function Y(je){var Qe=je-E,ot=je-m,Ut=t-Qe;return M?p6(Ut,l-ot):Ut}function ye(je){var Qe=je-E,ot=je-m;return E===void 0||Qe>=t||Qe<0||M&&ot>=l}function Q(){var je=Dv();if(ye(je))return te(je);u=setTimeout(Q,Y(je))}function te(je){return u=void 0,z&&n?H(je):(n=a=void 0,f)}function ne(){u!==void 0&&clearTimeout(u),m=0,n=E=a=u=void 0}function Me(){return u===void 0?f:te(Dv())}function Ve(){var je=Dv(),Qe=ye(je);if(n=arguments,a=this,E=je,Qe){if(u===void 0)return q(E);if(M)return u=setTimeout(Q,t),H(E)}return u===void 0&&(u=setTimeout(Q,t)),f}return Ve.cancel=ne,Ve.flush=Me,Ve}function t0(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function g6(e){return!!e&&typeof e=="object"}function y6(e){return typeof e=="symbol"||g6(e)&&d6.call(e)==r6}function kE(e){if(typeof e=="number")return e;if(y6(e))return ME;if(t0(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=t0(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(n6,"");var r=o6.test(e);return r||s6.test(e)?a6(e.slice(2),r?2:8):i6.test(e)?ME:+e}var v6=m6,Ax={exports:{}},Ah=typeof Reflect=="object"?Reflect:null,LE=Ah&&typeof Ah.apply=="function"?Ah.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},sm;Ah&&typeof Ah.ownKeys=="function"?sm=Ah.ownKeys:Object.getOwnPropertySymbols?sm=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:sm=function(t){return Object.getOwnPropertyNames(t)};function _6(e){console&&console.warn&&console.warn(e)}var UC=Number.isNaN||function(t){return t!==t};function Sn(){Sn.init.call(this)}Ax.exports=Sn;Ax.exports.once=E6;Sn.EventEmitter=Sn;Sn.prototype._events=void 0;Sn.prototype._eventsCount=0;Sn.prototype._maxListeners=void 0;var RE=10;function Vg(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(Sn,"defaultMaxListeners",{enumerable:!0,get:function(){return RE},set:function(e){if(typeof e!="number"||e<0||UC(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");RE=e}});Sn.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Sn.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||UC(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function jC(e){return e._maxListeners===void 0?Sn.defaultMaxListeners:e._maxListeners}Sn.prototype.getMaxListeners=function(){return jC(this)};Sn.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var a=t==="error",l=this._events;if(l!==void 0)a=a&&l.error===void 0;else if(!a)return!1;if(a){var f;if(r.length>0&&(f=r[0]),f instanceof Error)throw f;var u=new Error("Unhandled error."+(f?" ("+f.message+")":""));throw u.context=f,u}var E=l[t];if(E===void 0)return!1;if(typeof E=="function")LE(E,this,r);else for(var m=E.length,S=HC(E,m),n=0;n<m;++n)LE(S[n],this,r);return!0};function $C(e,t,r,n){var a,l,f;if(Vg(r),l=e._events,l===void 0?(l=e._events=Object.create(null),e._eventsCount=0):(l.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),l=e._events),f=l[t]),f===void 0)f=l[t]=r,++e._eventsCount;else if(typeof f=="function"?f=l[t]=n?[r,f]:[f,r]:n?f.unshift(r):f.push(r),a=jC(e),a>0&&f.length>a&&!f.warned){f.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=f.length,_6(u)}return e}Sn.prototype.addListener=function(t,r){return $C(this,t,r,!1)};Sn.prototype.on=Sn.prototype.addListener;Sn.prototype.prependListener=function(t,r){return $C(this,t,r,!0)};function x6(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function VC(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},a=x6.bind(n);return a.listener=r,n.wrapFn=a,a}Sn.prototype.once=function(t,r){return Vg(r),this.on(t,VC(this,t,r)),this};Sn.prototype.prependOnceListener=function(t,r){return Vg(r),this.prependListener(t,VC(this,t,r)),this};Sn.prototype.removeListener=function(t,r){var n,a,l,f,u;if(Vg(r),a=this._events,a===void 0)return this;if(n=a[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete a[t],a.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(l=-1,f=n.length-1;f>=0;f--)if(n[f]===r||n[f].listener===r){u=n[f].listener,l=f;break}if(l<0)return this;l===0?n.shift():b6(n,l),n.length===1&&(a[t]=n[0]),a.removeListener!==void 0&&this.emit("removeListener",t,u||r)}return this};Sn.prototype.off=Sn.prototype.removeListener;Sn.prototype.removeAllListeners=function(t){var r,n,a;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var l=Object.keys(n),f;for(a=0;a<l.length;++a)f=l[a],f!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(a=r.length-1;a>=0;a--)this.removeListener(t,r[a]);return this};function GC(e,t,r){var n=e._events;if(n===void 0)return[];var a=n[t];return a===void 0?[]:typeof a=="function"?r?[a.listener||a]:[a]:r?w6(a):HC(a,a.length)}Sn.prototype.listeners=function(t){return GC(this,t,!0)};Sn.prototype.rawListeners=function(t){return GC(this,t,!1)};Sn.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):qC.call(e,t)};Sn.prototype.listenerCount=qC;function qC(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Sn.prototype.eventNames=function(){return this._eventsCount>0?sm(this._events):[]};function HC(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function b6(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function w6(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function E6(e,t){return new Promise(function(r,n){function a(f){e.removeListener(t,l),n(f)}function l(){typeof e.removeListener=="function"&&e.removeListener("error",a),r([].slice.call(arguments))}ZC(e,t,l,{once:!0}),t!=="error"&&S6(e,a,{once:!0})})}function S6(e,t,r){typeof e.on=="function"&&ZC(e,"error",t,r)}function ZC(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function a(l){n.once&&e.removeEventListener(t,a),r(l)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var T6=Ax.exports,C6={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}},I6={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"לחפש",ja:"サーチ",lv:"Meklēt",pt:"Procurar",sr:"Претрага",zh:"搜索",cs:"Vyhledávání",hu:"Keresés",ka:"ძიება",nb:"Søke",sk:"Vyhľadávanie",th:"ค้นหา",fi:"Hae",is:"Leita",ko:"수색",pl:"Szukaj",sl:"Iskanje",fa:"جستجو",ru:"Поиск"},P6={placeholder:I6},WC={exports:{}};(function(e){(function(t,r,n){e.exports?e.exports=n():t[r]=n()})(ig,"subtag",function(){var t="",r=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function n(E){return E.match(r)||[]}function a(E){return n(E).filter(function(m,S){return m&&S})}function l(E){return E=n(E),{language:E[1]||t,extlang:E[2]||t,script:E[3]||t,region:E[4]||t}}function f(E,m,S){Object.defineProperty(E,m,{value:S,enumerable:!0})}function u(E,m,S){function M(z){return n(z)[E]||t}f(M,"pattern",m),f(l,S,M)}return u(1,/^[a-zA-Z]{2,3}$/,"language"),u(2,/^[a-zA-Z]{3}$/,"extlang"),u(3,/^[a-zA-Z]{4}$/,"script"),u(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),f(l,"split",a),l})})(WC);var A6=WC.exports,M6=e6,k6=v6,Js=FC,L6=T6.EventEmitter,OE=C6,R6=P6,O6=A6;function KC(e,t){this._eventEmitter=new L6,this.options=Js({},this.options,t),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geocoderApi=e}KC.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,showResultsWhileTyping:!1,minLength:2,reverseGeocode:!1,limit:5,enableEventLogging:!0,marker:!0,popup:!1,maplibregl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,getItemValue:function(e){return e.text!==void 0?e.text:e.place_name},render:function(e){if(e.geometry){var u=e.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--result maplibregl-ctrl-geocoder--result"><svg class="mapboxgl-ctrl-geocoder--result-icon maplibre-ctrl-geocoder--result-icon" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36571 0 0 5.38676 0 12.0471C0 21.0824 12 32 12 32C12 32 24 21.0824 24 12.0471C24 5.38676 18.6343 0 12 0ZM12 16.3496C9.63428 16.3496 7.71429 14.4221 7.71429 12.0471C7.71429 9.67207 9.63428 7.74454 12 7.74454C14.3657 7.74454 16.2857 9.67207 16.2857 12.0471C16.2857 14.4221 14.3657 16.3496 12 16.3496Z" fill="#687078"/></svg><div><div class="mapboxgl-ctrl-geocoder--result-title maplibregl-ctrl-geocoder--result-title">'+u[0]+'</div><div class="mapboxgl-ctrl-geocoder--result-address maplibregl-ctrl-geocoder--result-address">'+u.splice(1,u.length).join(",")+"</div></div></div>"}else{var t=e.text,r=t.toLowerCase().indexOf(this.query.toLowerCase()),n=this.query.length,a=t.substring(0,r),l=t.substring(r,r+n),f=t.substring(r+n);return'<div class="mapboxgl-ctrl-geocoder--suggestion maplibregl-ctrl-geocoder--suggestion"><svg class="mapboxgl-ctrl-geocoder--suggestion-icon maplibre-ctrl-geocoder--suggestion-icon" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22.8702 20.1258H21.4248L20.9125 19.6318C22.7055 17.546 23.785 14.8382 23.785 11.8925C23.785 5.32419 18.4608 0 11.8925 0C5.32419 0 0 5.32419 0 11.8925C0 18.4608 5.32419 23.785 11.8925 23.785C14.8382 23.785 17.546 22.7055 19.6318 20.9125L20.1258 21.4248V22.8702L29.2739 32L32 29.2739L22.8702 20.1258ZM11.8925 20.1258C7.33676 20.1258 3.65923 16.4483 3.65923 11.8925C3.65923 7.33676 7.33676 3.65923 11.8925 3.65923C16.4483 3.65923 20.1258 7.33676 20.1258 11.8925C20.1258 16.4483 16.4483 20.1258 11.8925 20.1258Z" fill="#687078"/></svg><div class="mapboxgl-ctrl-geocoder--suggestion-info maplibregl-ctrl-geocoder--suggestion-info"><div class="mapboxgl-ctrl-geocoder--suggestion-title maplibregl-ctrl-geocoder--suggestion-title">'+a+'<span class="mapboxgl-ctrl-geocoder--suggestion-match maplibregl-ctrl-geocoder--suggestion-match">'+l+"</span>"+f+"</div></div></div>"}},popupRender:function(e){var t=e.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion maplibre-ctrl-geocoder--suggestion popup-suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title maplibre-ctrl-geocoder--suggestion-title popup-suggestion-title">'+t[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address maplibre-ctrl-geocoder--suggestion-address popup-suggestion-address">'+t.splice(1,t.length).join(",")+"</div></div>"},showResultMarkers:!0,debounceSearch:200},addTo:function(e){function t(n,a){if(!document.body.contains(a))throw new Error("Element provided to #addTo() exists, but is not in the DOM");var l=n.onAdd();a.appendChild(l)}if(e._controlContainer)e.addControl(this);else if(e instanceof HTMLElement)t(this,e);else if(typeof e=="string"){var r=document.querySelectorAll(e);if(r.length===0)throw new Error("Element ",e,"not found.");if(r.length>1)throw new Error("Geocoder can only be added to a single html element");t(this,r[0])}else throw new Error("Error: addTo must be a maplibre-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(e){if(e&&typeof e!="string"&&(this._map=e),this.setLanguage(),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this);var t=this.container=document.createElement("div");t.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl";var r=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input maplibregl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",k6(this._onKeyDown,this.options.debounceSearch)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton);var n=document.createElement("div");n.classList.add("mapboxgl-ctrl-geocoder--pin-right","maplibregl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button maplibregl-ctrl-geocoder--button";var a=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');return this._clearEl.appendChild(a),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),n.appendChild(this._clearEl),n.appendChild(this._loadingEl),t.appendChild(r),t.appendChild(this._inputEl),t.appendChild(n),this._typeahead=new M6(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit,noInitialSelection:!0}),this.setRenderFunction(this.options.render),this._typeahead.getItemValue=this.options.getItemValue,this.mapMarker=null,this.resultMarkers=[],this._handleMarker=this._handleMarker.bind(this),this._handleResultMarkers=this._handleResultMarkers.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._maplibregl=this.options.maplibregl,!this._maplibregl&&this.options.marker&&(console.error("No maplibregl detected in options. Map markers are disabled. Please set options.maplibregl."),this.options.marker=!1)),t},createIcon:function(e,t){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");if(r.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+e+" maplibregl-ctrl-geocoder--icon maplibregl-ctrl-geocoder--icon-"+e),r.setAttribute("viewBox","0 0 18 18"),r.setAttribute("xml:space","preserve"),r.setAttribute("width",18),r.setAttribute("height",18),"innerHTML"in r)r.innerHTML=t;else{var n=document.createElement("div");n.innerHTML="<svg>"+t.valueOf().toString()+"</svg>";var a=n.firstChild,l=a.firstChild;r.appendChild(l)}return r},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_onPaste:function(e){var t=(e.clipboardData||window.clipboardData).getData("text");t.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(t)},_onKeyDown:function(e){var t=27,r=9;if(e.keyCode===t&&this.options.clearAndBlurOnEsc)return this._clear(e),this._inputEl.blur();var n=e.target&&e.target.shadowRoot?e.target.shadowRoot.activeElement:e.target,a=n?n.value:"";if(!a)return this.fresh=!0,e.keyCode!==r&&this.clear(e),this._clearEl.style.display="none";if(!(e.metaKey||[r,t,37,39,38,40].indexOf(e.keyCode)!==-1)){if(e.keyCode===13)if(!this.options.showResultsWhileTyping)this._typeahead.selected||this._geocode(n.value);else{this._typeahead.selected==null&&this.geocoderApi.getSuggestions?this._geocode(n.value,!0):this._typeahead.selected==null&&this.options.showResultMarkers&&this._fitBoundsForMarkers();return}n.value.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(n.value)}},_showButton:function(){this._inputEl.value.length>0&&(this._clearEl.style.display="block")},_hideButton:function(){this._typeahead.selected&&(this._clearEl.style.display="none")},_onBlur:function(e){this.options.clearOnBlur&&this._clearOnBlur(e),this.options.collapsed&&this._collapse()},_onChange:function(){var e=this._typeahead.selected;if(e&&!e.geometry)e.placeId?this._geocode(e.placeId,!0,!0):this._geocode(e.text,!0);else if(e&&JSON.stringify(e)!==this.lastSelected){if(this._clearEl.style.display="none",this.options.flyTo){var t;if(this._removeResultMarkers(),e.properties&&OE[e.properties.short_code])t=Js({},this.options.flyTo),this._map&&this._map.fitBounds(OE[e.properties.short_code].bbox,t);else if(e.bbox){var r=e.bbox;t=Js({},this.options.flyTo),this._map&&this._map.fitBounds([[r[0],r[1]],[r[2],r[3]]],t)}else{var n={zoom:this.options.zoom};t=Js({},n,this.options.flyTo),e.center?t.center=e.center:e.geometry&&e.geometry.type&&e.geometry.type==="Point"&&e.geometry.coordinates&&(t.center=e.geometry.coordinates),this._map&&this._map.flyTo(t)}}this.options.marker&&this._maplibregl&&this._handleMarker(e),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(e),this._typeahead.selected=null,this._eventEmitter.emit("result",{result:e})}},_getConfigForRequest:function(){var e=["bbox","limit","proximity","countries","types","language","reverseMode"],t=this,r=e.reduce(function(n,a){return t.options[a]&&(["countries","types","language"].indexOf(a)>-1?n[a]=t.options[a].split(/[\s,]+/):n[a]=t.options[a],a==="proximity"&&t.options[a]&&typeof t.options[a].longitude=="number"&&typeof t.options[a].latitude=="number"&&(n[a]=[t.options[a].longitude,t.options[a].latitude])),n},{});return r},_geocode:function(e,t,r){this._loadingEl.style.display="block",this._eventEmitter.emit("loading",{query:e}),this.inputString=e;var n=null,a=this._getConfigForRequest(),l;if(this.options.localGeocoderOnly)l=Promise.resolve();else if(this.options.reverseGeocode&&/(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/.test(e)){var f=e.split(/[\s(,)?]+/).map(function(m){return parseFloat(m,10)}).reverse();a.types&&a.types[0],a=Js(a,{query:f,limit:1}),"proximity"in a&&delete a.proximity,l=this.geocoderApi.reverseGeocode(a)}else a=Js(a,{query:e}),this.geocoderApi.getSuggestions?t?this.geocoderApi.searchByPlaceId&&r?l=this.geocoderApi.searchByPlaceId(a):l=this.geocoderApi.forwardGeocode(a):l=this.geocoderApi.getSuggestions(a):l=this.geocoderApi.forwardGeocode(a);var u=[];this.options.localGeocoder&&(u=this.options.localGeocoder(e),u||(u=[]));var E=[];return l.catch((function(m){n=m}).bind(this)).then((function(m){this._loadingEl.style.display="none";var S={};return m?S=m:S={type:"FeatureCollection",features:[]},S.config=a,this.fresh&&(this.fresh=!1),S.features=S.features?u.concat(S.features):u,this.options.externalGeocoder?(E=this.options.externalGeocoder(e,S.features,a)||[],E.then(function(M){return S.features=S.features?M.concat(S.features):M,S},function(){return S})):S}).bind(this)).then((function(m){if(n)throw n;this.options.filter&&m.features.length&&(m.features=m.features.filter(this.options.filter));var S=[];m.suggestions?S=m.suggestions:m.place?S=[m.place]:S=m.features,S.length?(this._clearEl.style.display="block",this._typeahead.update(S),(!this.options.showResultsWhileTyping||t)&&this.options.showResultMarkers&&(m.features.length>0||m.place)&&this._fitBoundsForMarkers(),this._eventEmitter.emit("results",m)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",m))}).bind(this)).catch((function(m){this._loadingEl.style.display="none",u.length&&this.options.localGeocoder||E.length&&this.options.externalGeocoder?(this._clearEl.style.display="block",this._typeahead.update(u)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:u}),this._eventEmitter.emit("error",{error:m})}).bind(this)),l},_clear:function(e){e&&e.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._clearEl.style.display="none",this._removeMarker(),this._removeResultMarkers(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(e){this._clear(e),this._inputEl.focus()},_clearOnBlur:function(e){var t=this;e.relatedTarget&&t._clear(e)},_onQueryResult:function(e){var t=e;if(t.features.length){var r=t.features[0];this._typeahead.selected=r,this._inputEl.value=r.place_name,this._onChange()}},_updateProximity:function(){if(this._map)if(this._map.getZoom()>9){var e=this._map.getCenter().wrap();this.setProximity({longitude:e.lng,latitude:e.lat})}else this.setProximity(null)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed","maplibregl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed","maplibregl-ctrl-geocoder--collapsed")},query:function(e){return this._geocode(e).then(this._onQueryResult),this},_renderError:function(){var e="<div class='mapbox-gl-geocoder--error maplibre-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(e)},_renderNoResults:function(){var e="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results maplibre-gl-geocoder--error maplibre-gl-geocoder--no-results'>No results found</div>";this._renderMessage(e)},_renderMessage:function(e){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(e)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var e=this.options.language.split(",")[0],t=O6.language(e),r=R6.placeholder[t];if(r)return r}return"Search"},_fitBoundsForMarkers:function(){if(!(this._typeahead.data.length<1)){var e=this._typeahead.data.filter(function(a){return typeof a!="string"}).slice(0,this.options.limit);if(this._clearEl.style.display="none",this.options.flyTo&&this._maplibregl&&this._map){var t={padding:100},r=Js({},t,this.options.flyTo),n=new this._maplibregl.LngLatBounds;e.forEach(function(a){n.extend(a.geometry.coordinates)}),this._map.fitBounds(n.toArray(),r)}return e.length>0&&this._maplibregl&&this._handleResultMarkers(e),this}},setInput:function(e){return this._inputEl.value=e,this._typeahead.selected=null,this._typeahead.clear(),e.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(e),this},setProximity:function(e){return this.options.proximity=e,this},getProximity:function(){return this.options.proximity},setRenderFunction:function(e){return e&&typeof e=="function"&&(this._typeahead.render=e),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(e){var t=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=e||this.options.language||t,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(e){return this.options.zoom=e,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(e){return this.options.flyTo=e,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(e){return this.placeholder=e||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(e){return this.options.bbox=e,this},getCountries:function(){return this.options.countries},setCountries:function(e){return this.options.countries=e,this},getTypes:function(){return this.options.types},setTypes:function(e){return this.options.types=e,this},getMinLength:function(){return this.options.minLength},setMinLength:function(e){return this.options.minLength=e,this._typeahead&&(this._typeahead.options.minLength=e),this},getLimit:function(){return this.options.limit},setLimit:function(e){return this.options.limit=e,this._typeahead&&(this._typeahead.options.limit=e),this},getFilter:function(){return this.options.filter},setFilter:function(e){return this.options.filter=e,this},setGeocoderApi:function(e){return this.geocoderApi=e,this},getGeocoderApi:function(){return this.geocoderApi},_handleMarker:function(e){if(this._map){this._removeMarker();var t={color:"#4668F2"},r=Js({},t,this.options.marker);this.mapMarker=new this._maplibregl.Marker(r);var n;if(this.options.popup){var a={},l=Js({},a,this.options.popup);n=new this._maplibregl.Popup(l).setHTML(this.options.popupRender(e))}return e.center?(this.mapMarker.setLngLat(e.center).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(n)):e.geometry&&e.geometry.type&&e.geometry.type==="Point"&&e.geometry.coordinates&&(this.mapMarker.setLngLat(e.geometry.coordinates).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(n)),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},_handleResultMarkers:function(e){if(this._map){this._removeResultMarkers();var t={color:"#4668F2"},r=Js({},t,this.options.showResultMarkers);return e.forEach((function(n){if(this.options.showResultMarkers&&this.options.showResultMarkers.element){var a=this.options.showResultMarkers.element.cloneNode(!0);r=Js(r,{element:a})}var l=new this._maplibregl.Marker(Js({},r,{element:a})),f;if(this.options.popup){var u={},E=Js({},u,this.options.popup);f=new this._maplibregl.Popup(E).setHTML(this.options.popupRender(n))}n.center?(l.setLngLat(n.center).addTo(this._map),this.options.popup&&l.setPopup(f)):n.geometry&&n.geometry.type&&n.geometry.type==="Point"&&n.geometry.coordinates&&(l.setLngLat(n.geometry.coordinates).addTo(this._map),this.options.popup&&l.setPopup(f)),this.resultMarkers.push(l)}).bind(this)),this}},_removeResultMarkers:function(){this.resultMarkers&&this.resultMarkers.length>0&&(this.resultMarkers.forEach(function(e){e.remove()}),this.resultMarkers=[])},on:function(e,t){return this._eventEmitter.on(e,t),this},off:function(e,t){return this._eventEmitter.removeListener(e,t),this}};var D6=KC;const z6=Lf(D6);function DE(){const e=document.createElementNS("http://www.w3.org/2000/svg","svg"),t=document.createElementNS("http://www.w3.org/2000/svg","path"),r=document.createElement("circle");return e.setAttribute("viewBox","0 0 64 64"),e.setAttribute("width","32"),e.setAttribute("height","32"),t.setAttribute("d",zC),t.setAttribute("fill","#5d8aff"),r.setAttribute("fill","white"),r.setAttribute("cx","50%"),r.setAttribute("cy","50%"),r.setAttribute("r","5"),e.appendChild(r),e.appendChild(t),e}var Gp=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function u(S){try{m(n.next(S))}catch(M){f(M)}}function E(S){try{m(n.throw(S))}catch(M){f(M)}}function m(S){S.done?l(S.value):a(S.value).then(u,E)}m((n=n.apply(e,t||[])).next())})},zv=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const F6={forwardGeocode:e=>Gp(void 0,void 0,void 0,function*(){const t=[];try{const r=yield Tc.searchByText(e.query,{biasPosition:e.bbox?void 0:e.proximity,searchAreaConstraints:e.bbox,countries:e.countries,maxResults:e.limit});r&&r.forEach(n=>{const{geometry:a}=n,l=zv(n,["geometry"]);t.push({type:"Feature",geometry:{type:"Point",coordinates:a.point},properties:Object.assign({},l),place_name:l.label,text:l.label,center:a.point})})}catch(r){console.error(`Failed to forwardGeocode with error: ${r}`)}return{features:t}}),reverseGeocode:e=>Gp(void 0,void 0,void 0,function*(){const t=[];try{const r=yield Tc.searchByCoordinates(e.query,{maxResults:e.limit});if(r&&r.geometry){const{geometry:n}=r,a=zv(r,["geometry"]);t.push({type:"Feature",geometry:{type:"Point",coordinates:n.point},properties:Object.assign({},a),place_name:a.label,text:a.label,center:n.point})}}catch(r){console.error(`Failed to reverseGeocode with error: ${r}`)}return{features:t}}),getSuggestions:e=>Gp(void 0,void 0,void 0,function*(){const t=[];try{const r=yield Tc.searchForSuggestions(e.query,{biasPosition:e.proximity,searchAreaConstraints:e.bbox,countries:e.countries,maxResults:e.limit});t.push(...r)}catch(r){console.error(`Failed to get suggestions with error: ${r}`)}return{suggestions:t}}),searchByPlaceId:e=>Gp(void 0,void 0,void 0,function*(){let t;try{const r=yield Tc.searchByPlaceId(e.query);if(r){const{geometry:n}=r,a=zv(r,["geometry"]);t={type:"Feature",geometry:{type:"Point",coordinates:n.point},properties:Object.assign({},a),place_name:a.label,text:a.label,center:n.point}}}catch(r){console.error(`Failed to get place with error: ${r}`)}return{place:t}})};function N6(e){return new z6(F6,Object.assign({maplibregl:IB,showResultMarkers:{element:DE()},marker:{element:DE()},showResultsWhileTyping:e==null?void 0:e.autocomplete},e))}function B6(e,t,r,n){n===void 0&&(n={});var a=Y_(e),l=Pu(a[0]),f=Pu(a[1]),u=Pu(r),E=$g(t,n.units),m=Math.asin(Math.sin(f)*Math.cos(E)+Math.cos(f)*Math.sin(E)*Math.cos(u)),S=l+Math.atan2(Math.sin(u)*Math.sin(E)*Math.cos(f),Math.cos(E)-Math.sin(f)*Math.sin(m)),M=Wm(S),z=Wm(m);return Bg([M,z],n.properties)}function U6(e,t,r){r===void 0&&(r={});var n=Y_(e),a=Y_(t),l=Pu(a[1]-n[1]),f=Pu(a[0]-n[0]),u=Pu(n[1]),E=Pu(a[1]),m=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(f/2),2)*Math.cos(u)*Math.cos(E);return Cx(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),r.units)}const j6=Object.freeze(Object.defineProperty({__proto__:null,default:U6},Symbol.toStringTag,{value:"Module"}));function $6(e,t,r){r===void 0&&(r={});for(var n=r.steps||64,a=r.properties?r.properties:!Array.isArray(e)&&e.type==="Feature"&&e.properties?e.properties:{},l=[],f=0;f<n;f++)l.push(B6(e,t,f*-360/n,r).geometry.coordinates);return l.push(l[0]),Ug([l],a)}const V6=Object.freeze(Object.defineProperty({__proto__:null,default:$6},Symbol.toStringTag,{value:"Module"}));function zE(e,t,r){var n,a,l,f,u;t==null&&(t=100);function E(){var S=Date.now()-f;S<t&&S>=0?n=setTimeout(E,t-S):(n=null,r||(u=e.apply(l,a),l=a=null))}var m=function(){l=this,a=arguments,f=Date.now();var S=r&&!n;return n||(n=setTimeout(E,t)),S&&(u=e.apply(l,a),l=a=null),u};return m.clear=function(){n&&(clearTimeout(n),n=null)},m.flush=function(){n&&(u=e.apply(l,a),l=a=null,clearTimeout(n),n=null)},m}zE.debounce=zE;globalThis&&globalThis.__awaiter;var G6={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(ig,function(){var r=function(C,y){var T={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},R={on:function(K,X,le){if(T[K]===void 0)throw new Error("Invalid event type: "+K);T[K].push({selector:X,fn:le})},render:function(K){y.store.featureChanged(K)}},$=function(K,X){for(var le=T[K],we=le.length;we--;){var Ce=le[we];if(Ce.selector(X)){Ce.fn.call(R,X)||y.store.render(),y.ui.updateMapClasses();break}}};return C.start.call(R),{render:C.render,stop:function(){C.stop&&C.stop()},trash:function(){C.trash&&(C.trash(),y.store.render())},combineFeatures:function(){C.combineFeatures&&C.combineFeatures()},uncombineFeatures:function(){C.uncombineFeatures&&C.uncombineFeatures()},drag:function(K){$("drag",K)},click:function(K){$("click",K)},mousemove:function(K){$("mousemove",K)},mousedown:function(K){$("mousedown",K)},mouseup:function(K){$("mouseup",K)},mouseout:function(K){$("mouseout",K)},keydown:function(K){$("keydown",K)},keyup:function(K){$("keyup",K)},touchstart:function(K){$("touchstart",K)},touchmove:function(K){$("touchmove",K)},touchend:function(K){$("touchend",K)},tap:function(K){$("tap",K)}}};function n(C){return C&&C.__esModule&&Object.prototype.hasOwnProperty.call(C,"default")?C.default:C}function a(C){if(C.__esModule)return C;var y=C.default;if(typeof y=="function"){var T=function R(){if(this instanceof R){var $=[null];$.push.apply($,arguments);var K=Function.bind.apply(y,$);return new K}return y.apply(this,arguments)};T.prototype=y.prototype}else T={};return Object.defineProperty(T,"__esModule",{value:!0}),Object.keys(C).forEach(function(R){var $=Object.getOwnPropertyDescriptor(C,R);Object.defineProperty(T,R,$.get?$:{enumerable:!0,get:function(){return C[R]}})}),T}var l={},f={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:63567523142e-4},u=f;function E(C){var y=0;if(C&&C.length>0){y+=Math.abs(m(C[0]));for(var T=1;T<C.length;T++)y-=Math.abs(m(C[T]))}return y}function m(C){var y,T,R,$,K,X,le=0,we=C.length;if(we>2){for(X=0;X<we;X++)X===we-2?(R=we-2,$=we-1,K=0):X===we-1?(R=we-1,$=0,K=1):(R=X,$=X+1,K=X+2),y=C[R],T=C[$],le+=(S(C[K][0])-S(y[0]))*Math.sin(S(T[1]));le=le*u.RADIUS*u.RADIUS/2}return le}function S(C){return C*Math.PI/180}l.geometry=function C(y){var T,R=0;switch(y.type){case"Polygon":return E(y.coordinates);case"MultiPolygon":for(T=0;T<y.coordinates.length;T++)R+=E(y.coordinates[T]);return R;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(T=0;T<y.geometries.length;T++)R+=C(y.geometries[T]);return R}},l.ring=m;var M={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},z={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},H={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},q={POLYGON:"polygon",LINE:"line_string",POINT:"point"},Y={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},ye={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},Q={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},te={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},ne={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},Me={ACTIVE:"true",INACTIVE:"false"},Ve=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],je=-85,Qe=Object.freeze({__proto__:null,classes:M,sources:z,cursors:H,types:q,geojsonTypes:Y,modes:ye,events:Q,updateActions:te,meta:ne,activeStates:Me,interactions:Ve,LAT_MIN:-90,LAT_RENDERED_MIN:je,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),ot={Point:0,LineString:1,MultiLineString:1,Polygon:2};function Ut(C,y){var T=ot[C.geometry.type]-ot[y.geometry.type];return T===0&&C.geometry.type===Y.POLYGON?C.area-y.area:T}function st(C){return C.map(function(y){return y.geometry.type===Y.POLYGON&&(y.area=l.geometry({type:Y.FEATURE,property:{},geometry:y.geometry})),y}).sort(Ut).map(function(y){return delete y.area,y})}function Qt(C,y){return y===void 0&&(y=0),[[C.point.x-y,C.point.y-y],[C.point.x+y,C.point.y+y]]}function ar(C){if(this._items={},this._nums={},this._length=C?C.length:0,C)for(var y=0,T=C.length;y<T;y++)this.add(C[y]),C[y]!==void 0&&(typeof C[y]=="string"?this._items[C[y]]=y:this._nums[C[y]]=y)}ar.prototype.add=function(C){return this.has(C)||(this._length++,typeof C=="string"?this._items[C]=this._length:this._nums[C]=this._length),this},ar.prototype.delete=function(C){return this.has(C)===!1||(this._length--,delete this._items[C],delete this._nums[C]),this},ar.prototype.has=function(C){return(typeof C=="string"||typeof C=="number")&&(this._items[C]!==void 0||this._nums[C]!==void 0)},ar.prototype.values=function(){var C=this,y=[];return Object.keys(this._items).forEach(function(T){y.push({k:T,v:C._items[T]})}),Object.keys(this._nums).forEach(function(T){y.push({k:JSON.parse(T),v:C._nums[T]})}),y.sort(function(T,R){return T.v-R.v}).map(function(T){return T.k})},ar.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var Xr=[ne.FEATURE,ne.MIDPOINT,ne.VERTEX],Tr={click:function(C,y,T){return sn(C,y,T,T.options.clickBuffer)},touch:function(C,y,T){return sn(C,y,T,T.options.touchBuffer)}};function sn(C,y,T,R){if(T.map===null)return[];var $=C?Qt(C,R):y,K={};T.options.styles&&(K.layers=T.options.styles.map(function(Ce){return Ce.id}));var X=T.map.queryRenderedFeatures($,K).filter(function(Ce){return Xr.indexOf(Ce.properties.meta)!==-1}),le=new ar,we=[];return X.forEach(function(Ce){var Re=Ce.properties.id;le.has(Re)||(le.add(Re),we.push(Ce))}),st(we)}function qr(C,y){var T=Tr.click(C,null,y),R={mouse:H.NONE};return T[0]&&(R.mouse=T[0].properties.active===Me.ACTIVE?H.MOVE:H.POINTER,R.feature=T[0].properties.meta),y.events.currentModeName().indexOf("draw")!==-1&&(R.mouse=H.ADD),y.ui.queueMapClasses(R),y.ui.updateMapClasses(),T[0]}function Un(C,y){var T=C.x-y.x,R=C.y-y.y;return Math.sqrt(T*T+R*R)}function pt(C,y,T){T===void 0&&(T={});var R=T.fineTolerance!=null?T.fineTolerance:4,$=T.grossTolerance!=null?T.grossTolerance:12,K=T.interval!=null?T.interval:500;C.point=C.point||y.point,C.time=C.time||y.time;var X=Un(C.point,y.point);return X<R||X<$&&y.time-C.time<K}function Nt(C,y,T){T===void 0&&(T={});var R=T.tolerance!=null?T.tolerance:25,$=T.interval!=null?T.interval:250;return C.point=C.point||y.point,C.time=C.time||y.time,Un(C.point,y.point)<R&&y.time-C.time<$}var mt={exports:{}},gr=mt.exports=function(C,y){if(y||(y=16),C===void 0&&(C=128),C<=0)return"0";for(var T=Math.log(Math.pow(2,C))/Math.log(y),R=2;T===1/0;R*=2)T=Math.log(Math.pow(2,C/R))/Math.log(y)*R;var $=T-Math.floor(T),K="";for(R=0;R<Math.floor(T);R++)K=Math.floor(Math.random()*y).toString(y)+K;if($){var X=Math.pow(y,$);K=Math.floor(Math.random()*X).toString(y)+K}var le=parseInt(K,y);return le!==1/0&&le>=Math.pow(2,C)?gr(C,y):K};gr.rack=function(C,y,T){var R=function(K){var X=0;do{if(X++>10){if(!T)throw new Error("too many ID collisions, use more bits");C+=T}var le=gr(C,y)}while(Object.hasOwnProperty.call($,le));return $[le]=K,le},$=R.hats={};return R.get=function(K){return R.hats[K]},R.set=function(K,X){return R.hats[K]=X,R},R.bits=C||128,R.base=y||16,R};var Ar=n(mt.exports),Lr=function(C,y){this.ctx=C,this.properties=y.properties||{},this.coordinates=y.geometry.coordinates,this.id=y.id||Ar(),this.type=y.geometry.type};Lr.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},Lr.prototype.incomingCoords=function(C){this.setCoordinates(C)},Lr.prototype.setCoordinates=function(C){this.coordinates=C,this.changed()},Lr.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},Lr.prototype.setProperty=function(C,y){this.properties[C]=y},Lr.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:Y.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},Lr.prototype.internal=function(C){var y={id:this.id,meta:ne.FEATURE,"meta:type":this.type,active:Me.INACTIVE,mode:C};if(this.ctx.options.userProperties)for(var T in this.properties)y["user_"+T]=this.properties[T];return{type:Y.FEATURE,properties:y,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var yr=function(C,y){Lr.call(this,C,y)};(yr.prototype=Object.create(Lr.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},yr.prototype.updateCoordinate=function(C,y,T){this.coordinates=arguments.length===3?[y,T]:[C,y],this.changed()},yr.prototype.getCoordinate=function(){return this.getCoordinates()};var Dn=function(C,y){Lr.call(this,C,y)};(Dn.prototype=Object.create(Lr.prototype)).isValid=function(){return this.coordinates.length>1},Dn.prototype.addCoordinate=function(C,y,T){this.changed();var R=parseInt(C,10);this.coordinates.splice(R,0,[y,T])},Dn.prototype.getCoordinate=function(C){var y=parseInt(C,10);return JSON.parse(JSON.stringify(this.coordinates[y]))},Dn.prototype.removeCoordinate=function(C){this.changed(),this.coordinates.splice(parseInt(C,10),1)},Dn.prototype.updateCoordinate=function(C,y,T){var R=parseInt(C,10);this.coordinates[R]=[y,T],this.changed()};var dn=function(C,y){Lr.call(this,C,y),this.coordinates=this.coordinates.map(function(T){return T.slice(0,-1)})};(dn.prototype=Object.create(Lr.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(C){return C.length>2})},dn.prototype.incomingCoords=function(C){this.coordinates=C.map(function(y){return y.slice(0,-1)}),this.changed()},dn.prototype.setCoordinates=function(C){this.coordinates=C,this.changed()},dn.prototype.addCoordinate=function(C,y,T){this.changed();var R=C.split(".").map(function($){return parseInt($,10)});this.coordinates[R[0]].splice(R[1],0,[y,T])},dn.prototype.removeCoordinate=function(C){this.changed();var y=C.split(".").map(function(R){return parseInt(R,10)}),T=this.coordinates[y[0]];T&&(T.splice(y[1],1),T.length<3&&this.coordinates.splice(y[0],1))},dn.prototype.getCoordinate=function(C){var y=C.split(".").map(function(R){return parseInt(R,10)}),T=this.coordinates[y[0]];return JSON.parse(JSON.stringify(T[y[1]]))},dn.prototype.getCoordinates=function(){return this.coordinates.map(function(C){return C.concat([C[0]])})},dn.prototype.updateCoordinate=function(C,y,T){this.changed();var R=C.split("."),$=parseInt(R[0],10),K=parseInt(R[1],10);this.coordinates[$]===void 0&&(this.coordinates[$]=[]),this.coordinates[$][K]=[y,T]};var ji={MultiPoint:yr,MultiLineString:Dn,MultiPolygon:dn},jo=function(C,y,T,R,$){var K=T.split("."),X=parseInt(K[0],10),le=K[1]?K.slice(1).join("."):null;return C[X][y](le,R,$)},vn=function(C,y){if(Lr.call(this,C,y),delete this.coordinates,this.model=ji[y.geometry.type],this.model===void 0)throw new TypeError(y.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(y.geometry.coordinates)};function er(C){this.map=C.map,this.drawConfig=JSON.parse(JSON.stringify(C.options||{})),this._ctx=C}(vn.prototype=Object.create(Lr.prototype))._coordinatesToFeatures=function(C){var y=this,T=this.model.bind(this);return C.map(function(R){return new T(y.ctx,{id:Ar(),type:Y.FEATURE,properties:{},geometry:{coordinates:R,type:y.type.replace("Multi","")}})})},vn.prototype.isValid=function(){return this.features.every(function(C){return C.isValid()})},vn.prototype.setCoordinates=function(C){this.features=this._coordinatesToFeatures(C),this.changed()},vn.prototype.getCoordinate=function(C){return jo(this.features,"getCoordinate",C)},vn.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(C){return C.type===Y.POLYGON?C.getCoordinates():C.coordinates})))},vn.prototype.updateCoordinate=function(C,y,T){jo(this.features,"updateCoordinate",C,y,T),this.changed()},vn.prototype.addCoordinate=function(C,y,T){jo(this.features,"addCoordinate",C,y,T),this.changed()},vn.prototype.removeCoordinate=function(C){jo(this.features,"removeCoordinate",C),this.changed()},vn.prototype.getFeatures=function(){return this.features},er.prototype.setSelected=function(C){return this._ctx.store.setSelected(C)},er.prototype.setSelectedCoordinates=function(C){var y=this;this._ctx.store.setSelectedCoordinates(C),C.reduce(function(T,R){return T[R.feature_id]===void 0&&(T[R.feature_id]=!0,y._ctx.store.get(R.feature_id).changed()),T},{})},er.prototype.getSelected=function(){return this._ctx.store.getSelected()},er.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},er.prototype.isSelected=function(C){return this._ctx.store.isSelected(C)},er.prototype.getFeature=function(C){return this._ctx.store.get(C)},er.prototype.select=function(C){return this._ctx.store.select(C)},er.prototype.deselect=function(C){return this._ctx.store.deselect(C)},er.prototype.deleteFeature=function(C,y){return y===void 0&&(y={}),this._ctx.store.delete(C,y)},er.prototype.addFeature=function(C){return this._ctx.store.add(C)},er.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},er.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},er.prototype.setActionableState=function(C){C===void 0&&(C={});var y={trash:C.trash||!1,combineFeatures:C.combineFeatures||!1,uncombineFeatures:C.uncombineFeatures||!1};return this._ctx.events.actionable(y)},er.prototype.changeMode=function(C,y,T){return y===void 0&&(y={}),T===void 0&&(T={}),this._ctx.events.changeMode(C,y,T)},er.prototype.updateUIClasses=function(C){return this._ctx.ui.queueMapClasses(C)},er.prototype.activateUIButton=function(C){return this._ctx.ui.setActiveButton(C)},er.prototype.featuresAt=function(C,y,T){if(T===void 0&&(T="click"),T!=="click"&&T!=="touch")throw new Error("invalid buffer type");return Tr[T](C,y,this._ctx)},er.prototype.newFeature=function(C){var y=C.geometry.type;return y===Y.POINT?new yr(this._ctx,C):y===Y.LINE_STRING?new Dn(this._ctx,C):y===Y.POLYGON?new dn(this._ctx,C):new vn(this._ctx,C)},er.prototype.isInstanceOf=function(C,y){if(C===Y.POINT)return y instanceof yr;if(C===Y.LINE_STRING)return y instanceof Dn;if(C===Y.POLYGON)return y instanceof dn;if(C==="MultiFeature")return y instanceof vn;throw new Error("Unknown feature class: "+C)},er.prototype.doRender=function(C){return this._ctx.store.featureChanged(C)},er.prototype.onSetup=function(){},er.prototype.onDrag=function(){},er.prototype.onClick=function(){},er.prototype.onMouseMove=function(){},er.prototype.onMouseDown=function(){},er.prototype.onMouseUp=function(){},er.prototype.onMouseOut=function(){},er.prototype.onKeyUp=function(){},er.prototype.onKeyDown=function(){},er.prototype.onTouchStart=function(){},er.prototype.onTouchMove=function(){},er.prototype.onTouchEnd=function(){},er.prototype.onTap=function(){},er.prototype.onStop=function(){},er.prototype.onTrash=function(){},er.prototype.onCombineFeature=function(){},er.prototype.onUncombineFeature=function(){},er.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var so={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},wi=Object.keys(so);function Ue(C){var y=Object.keys(C);return function(T,R){R===void 0&&(R={});var $={},K=y.reduce(function(X,le){return X[le]=C[le],X},new er(T));return{start:function(){var X=this;$=K.onSetup(R),wi.forEach(function(le){var we,Ce=so[le],Re=function(){return!1};C[Ce]&&(Re=function(){return!0}),X.on(le,Re,(we=Ce,function(fe){return K[we]($,fe)}))})},stop:function(){K.onStop($)},trash:function(){K.onTrash($)},combineFeatures:function(){K.onCombineFeatures($)},uncombineFeatures:function(){K.onUncombineFeatures($)},render:function(X,le){K.toDisplayFeatures($,X,le)}}}}function Xn(C){return[].concat(C).filter(function(y){return y!==void 0})}function Ei(){var C=this;if(!(C.ctx.map&&C.ctx.map.getSource(z.HOT)!==void 0))return we();var y=C.ctx.events.currentModeName();C.ctx.ui.queueMapClasses({mode:y});var T=[],R=[];C.isDirty?R=C.getAllIds():(T=C.getChangedIds().filter(function(Ce){return C.get(Ce)!==void 0}),R=C.sources.hot.filter(function(Ce){return Ce.properties.id&&T.indexOf(Ce.properties.id)===-1&&C.get(Ce.properties.id)!==void 0}).map(function(Ce){return Ce.properties.id})),C.sources.hot=[];var $=C.sources.cold.length;C.sources.cold=C.isDirty?[]:C.sources.cold.filter(function(Ce){var Re=Ce.properties.id||Ce.properties.parent;return T.indexOf(Re)===-1});var K=$!==C.sources.cold.length||R.length>0;function X(Ce,Re){var fe=C.get(Ce).internal(y);C.ctx.events.currentModeRender(fe,function($e){C.sources[Re].push($e)})}if(T.forEach(function(Ce){return X(Ce,"hot")}),R.forEach(function(Ce){return X(Ce,"cold")}),K&&C.ctx.map.getSource(z.COLD).setData({type:Y.FEATURE_COLLECTION,features:C.sources.cold}),C.ctx.map.getSource(z.HOT).setData({type:Y.FEATURE_COLLECTION,features:C.sources.hot}),C._emitSelectionChange&&(C.ctx.map.fire(Q.SELECTION_CHANGE,{features:C.getSelected().map(function(Ce){return Ce.toGeoJSON()}),points:C.getSelectedCoordinates().map(function(Ce){return{type:Y.FEATURE,properties:{},geometry:{type:Y.POINT,coordinates:Ce.coordinates}}})}),C._emitSelectionChange=!1),C._deletedFeaturesToEmit.length){var le=C._deletedFeaturesToEmit.map(function(Ce){return Ce.toGeoJSON()});C._deletedFeaturesToEmit=[],C.ctx.map.fire(Q.DELETE,{features:le})}function we(){C.isDirty=!1,C.clearChangedIds()}we(),C.ctx.map.fire(Q.RENDER,{})}function Dt(C){var y,T=this;this._features={},this._featureIds=new ar,this._selectedFeatureIds=new ar,this._selectedCoordinates=[],this._changedFeatureIds=new ar,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=C,this.sources={hot:[],cold:[]},this.render=function(){y||(y=requestAnimationFrame(function(){y=null,Ei.call(T)}))},this.isDirty=!1}function Mr(C,y){var T=C._selectedCoordinates.filter(function(R){return C._selectedFeatureIds.has(R.feature_id)});C._selectedCoordinates.length===T.length||y.silent||(C._emitSelectionChange=!0),C._selectedCoordinates=T}Dt.prototype.createRenderBatch=function(){var C=this,y=this.render,T=0;return this.render=function(){T++},function(){C.render=y,T>0&&C.render()}},Dt.prototype.setDirty=function(){return this.isDirty=!0,this},Dt.prototype.featureChanged=function(C){return this._changedFeatureIds.add(C),this},Dt.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},Dt.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},Dt.prototype.getAllIds=function(){return this._featureIds.values()},Dt.prototype.add=function(C){return this.featureChanged(C.id),this._features[C.id]=C,this._featureIds.add(C.id),this},Dt.prototype.delete=function(C,y){var T=this;return y===void 0&&(y={}),Xn(C).forEach(function(R){T._featureIds.has(R)&&(T._featureIds.delete(R),T._selectedFeatureIds.delete(R),y.silent||T._deletedFeaturesToEmit.indexOf(T._features[R])===-1&&T._deletedFeaturesToEmit.push(T._features[R]),delete T._features[R],T.isDirty=!0)}),Mr(this,y),this},Dt.prototype.get=function(C){return this._features[C]},Dt.prototype.getAll=function(){var C=this;return Object.keys(this._features).map(function(y){return C._features[y]})},Dt.prototype.select=function(C,y){var T=this;return y===void 0&&(y={}),Xn(C).forEach(function(R){T._selectedFeatureIds.has(R)||(T._selectedFeatureIds.add(R),T._changedFeatureIds.add(R),y.silent||(T._emitSelectionChange=!0))}),this},Dt.prototype.deselect=function(C,y){var T=this;return y===void 0&&(y={}),Xn(C).forEach(function(R){T._selectedFeatureIds.has(R)&&(T._selectedFeatureIds.delete(R),T._changedFeatureIds.add(R),y.silent||(T._emitSelectionChange=!0))}),Mr(this,y),this},Dt.prototype.clearSelected=function(C){return C===void 0&&(C={}),this.deselect(this._selectedFeatureIds.values(),{silent:C.silent}),this},Dt.prototype.setSelected=function(C,y){var T=this;return y===void 0&&(y={}),C=Xn(C),this.deselect(this._selectedFeatureIds.values().filter(function(R){return C.indexOf(R)===-1}),{silent:y.silent}),this.select(C.filter(function(R){return!T._selectedFeatureIds.has(R)}),{silent:y.silent}),this},Dt.prototype.setSelectedCoordinates=function(C){return this._selectedCoordinates=C,this._emitSelectionChange=!0,this},Dt.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},Dt.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},Dt.prototype.getSelected=function(){var C=this;return this._selectedFeatureIds.values().map(function(y){return C.get(y)})},Dt.prototype.getSelectedCoordinates=function(){var C=this;return this._selectedCoordinates.map(function(y){return{coordinates:C.get(y.feature_id).getCoordinate(y.coord_path)}})},Dt.prototype.isSelected=function(C){return this._selectedFeatureIds.has(C)},Dt.prototype.setFeatureProperty=function(C,y,T){this.get(C).setProperty(y,T),this.featureChanged(C)},Dt.prototype.storeMapConfig=function(){var C=this;Ve.forEach(function(y){C.ctx.map[y]&&(C._mapInitialConfig[y]=C.ctx.map[y].isEnabled())})},Dt.prototype.restoreMapConfig=function(){var C=this;Object.keys(this._mapInitialConfig).forEach(function(y){C._mapInitialConfig[y]?C.ctx.map[y].enable():C.ctx.map[y].disable()})},Dt.prototype.getInitialConfigValue=function(C){return this._mapInitialConfig[C]===void 0||this._mapInitialConfig[C]};var hs=function(){for(var C=arguments,y={},T=0;T<arguments.length;T++){var R=C[T];for(var $ in R)ks.call(R,$)&&(y[$]=R[$])}return y},ks=Object.prototype.hasOwnProperty,Tn=n(hs),ol=["mode","feature","mouse"];function tn(C){var y=null,T=null,R={onRemove:function(){return C.map.off("load",R.connect),clearInterval(T),R.removeLayers(),C.store.restoreMapConfig(),C.ui.removeButtons(),C.events.removeEventListeners(),C.ui.clearMapClasses(),C.boxZoomInitial&&C.map.boxZoom.enable(),C.map=null,C.container=null,C.store=null,y&&y.parentNode&&y.parentNode.removeChild(y),y=null,this},connect:function(){C.map.off("load",R.connect),clearInterval(T),R.addLayers(),C.store.storeMapConfig(),C.events.addEventListeners()},onAdd:function($){var K=$.fire;return $.fire=function(X,le){var we=arguments;return K.length===1&&arguments.length!==1&&(we=[Tn({},{type:X},le)]),K.apply($,we)},C.map=$,C.events=function(X){var le=Object.keys(X.options.modes).reduce(function(Be,Pe){return Be[Pe]=Ue(X.options.modes[Pe]),Be},{}),we={},Ce={},Re={},fe=null,$e=null;Re.drag=function(Be,Pe){Pe({point:Be.point,time:new Date().getTime()})?(X.ui.queueMapClasses({mouse:H.DRAG}),$e.drag(Be)):Be.originalEvent.stopPropagation()},Re.mousedrag=function(Be){Re.drag(Be,function(Pe){return!pt(we,Pe)})},Re.touchdrag=function(Be){Re.drag(Be,function(Pe){return!Nt(Ce,Pe)})},Re.mousemove=function(Be){if((Be.originalEvent.buttons!==void 0?Be.originalEvent.buttons:Be.originalEvent.which)===1)return Re.mousedrag(Be);var Pe=qr(Be,X);Be.featureTarget=Pe,$e.mousemove(Be)},Re.mousedown=function(Be){we={time:new Date().getTime(),point:Be.point};var Pe=qr(Be,X);Be.featureTarget=Pe,$e.mousedown(Be)},Re.mouseup=function(Be){var Pe=qr(Be,X);Be.featureTarget=Pe,pt(we,{point:Be.point,time:new Date().getTime()})?$e.click(Be):$e.mouseup(Be)},Re.mouseout=function(Be){$e.mouseout(Be)},Re.touchstart=function(Be){if(Be.originalEvent.preventDefault(),X.options.touchEnabled){Ce={time:new Date().getTime(),point:Be.point};var Pe=Tr.touch(Be,null,X)[0];Be.featureTarget=Pe,$e.touchstart(Be)}},Re.touchmove=function(Be){if(Be.originalEvent.preventDefault(),X.options.touchEnabled)return $e.touchmove(Be),Re.touchdrag(Be)},Re.touchend=function(Be){if(Be.originalEvent.preventDefault(),X.options.touchEnabled){var Pe=Tr.touch(Be,null,X)[0];Be.featureTarget=Pe,Nt(Ce,{time:new Date().getTime(),point:Be.point})?$e.tap(Be):$e.touchend(Be)}};var at=function(Be){return!(Be===8||Be===46||Be>=48&&Be<=57)};function tt(Be,Pe,rt){rt===void 0&&(rt={}),$e.stop();var rr=le[Be];if(rr===void 0)throw new Error(Be+" is not valid");fe=Be;var Ot=rr(X,Pe);$e=r(Ot,X),rt.silent||X.map.fire(Q.MODE_CHANGE,{mode:Be}),X.store.setDirty(),X.store.render()}Re.keydown=function(Be){(Be.srcElement||Be.target).classList.contains("mapboxgl-canvas")&&(Be.keyCode!==8&&Be.keyCode!==46||!X.options.controls.trash?at(Be.keyCode)?$e.keydown(Be):Be.keyCode===49&&X.options.controls.point?tt(ye.DRAW_POINT):Be.keyCode===50&&X.options.controls.line_string?tt(ye.DRAW_LINE_STRING):Be.keyCode===51&&X.options.controls.polygon&&tt(ye.DRAW_POLYGON):(Be.preventDefault(),$e.trash()))},Re.keyup=function(Be){at(Be.keyCode)&&$e.keyup(Be)},Re.zoomend=function(){X.store.changeZoom()},Re.data=function(Be){if(Be.dataType==="style"){var Pe=X.setup,rt=X.map,rr=X.options,Ot=X.store;rr.styles.some(function(vr){return rt.getLayer(vr.id)})||(Pe.addLayers(),Ot.setDirty(),Ot.render())}};var Tt={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){fe=X.options.defaultMode,$e=r(le[fe](X),X)},changeMode:tt,actionable:function(Be){var Pe=!1;Object.keys(Be).forEach(function(rt){if(Tt[rt]===void 0)throw new Error("Invalid action type");Tt[rt]!==Be[rt]&&(Pe=!0),Tt[rt]=Be[rt]}),Pe&&X.map.fire(Q.ACTIONABLE,{actions:Tt})},currentModeName:function(){return fe},currentModeRender:function(Be,Pe){return $e.render(Be,Pe)},fire:function(Be,Pe){Re[Be]&&Re[Be](Pe)},addEventListeners:function(){X.map.on("mousemove",Re.mousemove),X.map.on("mousedown",Re.mousedown),X.map.on("mouseup",Re.mouseup),X.map.on("data",Re.data),X.map.on("touchmove",Re.touchmove),X.map.on("touchstart",Re.touchstart),X.map.on("touchend",Re.touchend),X.container.addEventListener("mouseout",Re.mouseout),X.options.keybindings&&(X.container.addEventListener("keydown",Re.keydown),X.container.addEventListener("keyup",Re.keyup))},removeEventListeners:function(){X.map.off("mousemove",Re.mousemove),X.map.off("mousedown",Re.mousedown),X.map.off("mouseup",Re.mouseup),X.map.off("data",Re.data),X.map.off("touchmove",Re.touchmove),X.map.off("touchstart",Re.touchstart),X.map.off("touchend",Re.touchend),X.container.removeEventListener("mouseout",Re.mouseout),X.options.keybindings&&(X.container.removeEventListener("keydown",Re.keydown),X.container.removeEventListener("keyup",Re.keyup))},trash:function(Be){$e.trash(Be)},combineFeatures:function(){$e.combineFeatures()},uncombineFeatures:function(){$e.uncombineFeatures()},getMode:function(){return fe}}}(C),C.ui=function(X){var le={},we=null,Ce={mode:null,feature:null,mouse:null},Re={mode:null,feature:null,mouse:null};function fe(Be){Re=Tn(Re,Be)}function $e(){var Be,Pe;if(X.container){var rt=[],rr=[];ol.forEach(function(Ot){Re[Ot]!==Ce[Ot]&&(rt.push(Ot+"-"+Ce[Ot]),Re[Ot]!==null&&rr.push(Ot+"-"+Re[Ot]))}),rt.length>0&&(Be=X.container.classList).remove.apply(Be,rt),rr.length>0&&(Pe=X.container.classList).add.apply(Pe,rr),Ce=Tn(Ce,Re)}}function at(Be,Pe){Pe===void 0&&(Pe={});var rt=document.createElement("button");return rt.className=M.CONTROL_BUTTON+" "+Pe.className,rt.setAttribute("title",Pe.title),Pe.container.appendChild(rt),rt.addEventListener("click",function(rr){if(rr.preventDefault(),rr.stopPropagation(),rr.target===we)return tt(),void Pe.onDeactivate();Tt(Be),Pe.onActivate()},!0),rt}function tt(){we&&(we.classList.remove(M.ACTIVE_BUTTON),we=null)}function Tt(Be){tt();var Pe=le[Be];Pe&&Pe&&Be!=="trash"&&(Pe.classList.add(M.ACTIVE_BUTTON),we=Pe)}return{setActiveButton:Tt,queueMapClasses:fe,updateMapClasses:$e,clearMapClasses:function(){fe({mode:null,feature:null,mouse:null}),$e()},addButtons:function(){var Be=X.options.controls,Pe=document.createElement("div");return Pe.className=M.CONTROL_GROUP+" "+M.CONTROL_BASE,Be&&(Be[q.LINE]&&(le[q.LINE]=at(q.LINE,{container:Pe,className:M.CONTROL_BUTTON_LINE,title:"LineString tool "+(X.options.keybindings?"(l)":""),onActivate:function(){return X.events.changeMode(ye.DRAW_LINE_STRING)},onDeactivate:function(){return X.events.trash()}})),Be[q.POLYGON]&&(le[q.POLYGON]=at(q.POLYGON,{container:Pe,className:M.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(X.options.keybindings?"(p)":""),onActivate:function(){return X.events.changeMode(ye.DRAW_POLYGON)},onDeactivate:function(){return X.events.trash()}})),Be[q.POINT]&&(le[q.POINT]=at(q.POINT,{container:Pe,className:M.CONTROL_BUTTON_POINT,title:"Marker tool "+(X.options.keybindings?"(m)":""),onActivate:function(){return X.events.changeMode(ye.DRAW_POINT)},onDeactivate:function(){return X.events.trash()}})),Be.trash&&(le.trash=at("trash",{container:Pe,className:M.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){X.events.trash()}})),Be.combine_features&&(le.combine_features=at("combineFeatures",{container:Pe,className:M.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){X.events.combineFeatures()}})),Be.uncombine_features&&(le.uncombine_features=at("uncombineFeatures",{container:Pe,className:M.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){X.events.uncombineFeatures()}}))),Pe},removeButtons:function(){Object.keys(le).forEach(function(Be){var Pe=le[Be];Pe.parentNode&&Pe.parentNode.removeChild(Pe),delete le[Be]})}}}(C),C.container=$.getContainer(),C.store=new Dt(C),y=C.ui.addButtons(),C.options.boxSelect&&(C.boxZoomInitial=$.boxZoom.isEnabled(),$.boxZoom.disable(),$.dragPan.disable(),$.dragPan.enable()),$.loaded()?R.connect():($.on("load",R.connect),T=setInterval(function(){$.loaded()&&R.connect()},16)),C.events.start(),y},addLayers:function(){C.map.addSource(z.COLD,{data:{type:Y.FEATURE_COLLECTION,features:[]},type:"geojson"}),C.map.addSource(z.HOT,{data:{type:Y.FEATURE_COLLECTION,features:[]},type:"geojson"}),C.options.styles.forEach(function($){C.map.addLayer($)}),C.store.setDirty(!0),C.store.render()},removeLayers:function(){C.options.styles.forEach(function($){C.map.getLayer($.id)&&C.map.removeLayer($.id)}),C.map.getSource(z.COLD)&&C.map.removeSource(z.COLD),C.map.getSource(z.HOT)&&C.map.removeSource(z.HOT)}};return C.setup=R,R}var Ls=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function ao(C){return function(y){var T=y.featureTarget;return!!T&&!!T.properties&&T.properties.meta===C}}function ut(C){return!!C.originalEvent&&!!C.originalEvent.shiftKey&&C.originalEvent.button===0}function _n(C){return!!C.featureTarget&&!!C.featureTarget.properties&&C.featureTarget.properties.active===Me.ACTIVE&&C.featureTarget.properties.meta===ne.FEATURE}function Jn(C){return!!C.featureTarget&&!!C.featureTarget.properties&&C.featureTarget.properties.active===Me.INACTIVE&&C.featureTarget.properties.meta===ne.FEATURE}function Si(C){return C.featureTarget===void 0}function $i(C){return!!C.featureTarget&&!!C.featureTarget.properties&&C.featureTarget.properties.meta===ne.FEATURE}function et(C){var y=C.featureTarget;return!!y&&!!y.properties&&y.properties.meta===ne.VERTEX}function Gt(C){return!!C.originalEvent&&C.originalEvent.shiftKey===!0}function jt(C){return C.keyCode===27}function Nr(C){return C.keyCode===13}var $o=Object.freeze({__proto__:null,isOfMetaType:ao,isShiftMousedown:ut,isActiveFeature:_n,isInactiveFeature:Jn,noTarget:Si,isFeature:$i,isVertex:et,isShiftDown:Gt,isEscapeKey:jt,isEnterKey:Nr,isTrue:function(){return!0}}),Bt=Jr;function Jr(C,y){this.x=C,this.y=y}Jr.prototype={clone:function(){return new Jr(this.x,this.y)},add:function(C){return this.clone()._add(C)},sub:function(C){return this.clone()._sub(C)},multByPoint:function(C){return this.clone()._multByPoint(C)},divByPoint:function(C){return this.clone()._divByPoint(C)},mult:function(C){return this.clone()._mult(C)},div:function(C){return this.clone()._div(C)},rotate:function(C){return this.clone()._rotate(C)},rotateAround:function(C,y){return this.clone()._rotateAround(C,y)},matMult:function(C){return this.clone()._matMult(C)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(C){return this.x===C.x&&this.y===C.y},dist:function(C){return Math.sqrt(this.distSqr(C))},distSqr:function(C){var y=C.x-this.x,T=C.y-this.y;return y*y+T*T},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(C){return Math.atan2(this.y-C.y,this.x-C.x)},angleWith:function(C){return this.angleWithSep(C.x,C.y)},angleWithSep:function(C,y){return Math.atan2(this.x*y-this.y*C,this.x*C+this.y*y)},_matMult:function(C){var y=C[0]*this.x+C[1]*this.y,T=C[2]*this.x+C[3]*this.y;return this.x=y,this.y=T,this},_add:function(C){return this.x+=C.x,this.y+=C.y,this},_sub:function(C){return this.x-=C.x,this.y-=C.y,this},_mult:function(C){return this.x*=C,this.y*=C,this},_div:function(C){return this.x/=C,this.y/=C,this},_multByPoint:function(C){return this.x*=C.x,this.y*=C.y,this},_divByPoint:function(C){return this.x/=C.x,this.y/=C.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var C=this.y;return this.y=this.x,this.x=-C,this},_rotate:function(C){var y=Math.cos(C),T=Math.sin(C),R=y*this.x-T*this.y,$=T*this.x+y*this.y;return this.x=R,this.y=$,this},_rotateAround:function(C,y){var T=Math.cos(C),R=Math.sin(C),$=y.x+T*(this.x-y.x)-R*(this.y-y.y),K=y.y+R*(this.x-y.x)+T*(this.y-y.y);return this.x=$,this.y=K,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Jr.convert=function(C){return C instanceof Jr?C:Array.isArray(C)?new Jr(C[0],C[1]):C};var ir=n(Bt);function lo(C,y){var T=y.getBoundingClientRect();return new ir(C.clientX-T.left-(y.clientLeft||0),C.clientY-T.top-(y.clientTop||0))}function Yn(C,y,T,R){return{type:Y.FEATURE,properties:{meta:ne.VERTEX,parent:C,coord_path:T,active:R?Me.ACTIVE:Me.INACTIVE},geometry:{type:Y.POINT,coordinates:y}}}function jn(C,y,T){var R=y.geometry.coordinates,$=T.geometry.coordinates;if(R[1]>85||R[1]<je||$[1]>85||$[1]<je)return null;var K={lng:(R[0]+$[0])/2,lat:(R[1]+$[1])/2};return{type:Y.FEATURE,properties:{meta:ne.MIDPOINT,parent:C,lng:K.lng,lat:K.lat,coord_path:T.properties.coord_path},geometry:{type:Y.POINT,coordinates:[K.lng,K.lat]}}}function Ir(C,y,T){y===void 0&&(y={}),T===void 0&&(T=null);var R,$=C.geometry,K=$.type,X=$.coordinates,le=C.properties&&C.properties.id,we=[];function Ce(fe,$e){var at="",tt=null;fe.forEach(function(Tt,Be){var Pe=$e!=null?$e+"."+Be:String(Be),rt=Yn(le,Tt,Pe,Re(Pe));if(y.midpoints&&tt){var rr=jn(le,tt,rt);rr&&we.push(rr)}tt=rt;var Ot=JSON.stringify(Tt);at!==Ot&&we.push(rt),Be===0&&(at=Ot)})}function Re(fe){return!!y.selectedPaths&&y.selectedPaths.indexOf(fe)!==-1}return K===Y.POINT?we.push(Yn(le,X,T,Re(T))):K===Y.POLYGON?X.forEach(function(fe,$e){Ce(fe,T!==null?T+"."+$e:String($e))}):K===Y.LINE_STRING?Ce(X,T):K.indexOf(Y.MULTI_PREFIX)===0&&(R=K.replace(Y.MULTI_PREFIX,""),X.forEach(function(fe,$e){var at={type:Y.FEATURE,properties:C.properties,geometry:{type:R,coordinates:fe}};we=we.concat(Ir(at,y,$e))})),we}var Ti={enable:function(C){setTimeout(function(){C.map&&C.map.doubleClickZoom&&C._ctx&&C._ctx.store&&C._ctx.store.getInitialConfigValue&&C._ctx.store.getInitialConfigValue("doubleClickZoom")&&C.map.doubleClickZoom.enable()},0)},disable:function(C){setTimeout(function(){C.map&&C.map.doubleClickZoom&&C.map.doubleClickZoom.disable()},0)}},xr={exports:{}},bo=function(C){if(!C||!C.type)return null;var y=oe[C.type];if(!y)return null;if(y==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:C}]};if(y==="feature")return{type:"FeatureCollection",features:[C]};if(y==="featurecollection")return C},oe={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},j=n(bo),G=Object.freeze({__proto__:null,default:function C(y){switch(y&&y.type||null){case"FeatureCollection":return y.features=y.features.reduce(function(T,R){return T.concat(C(R))},[]),y;case"Feature":return y.geometry?C(y.geometry).map(function(T){var R={type:"Feature",properties:JSON.parse(JSON.stringify(y.properties)),geometry:T};return y.id!==void 0&&(R.id=y.id),R}):[y];case"MultiPoint":return y.coordinates.map(function(T){return{type:"Point",coordinates:T}});case"MultiPolygon":return y.coordinates.map(function(T){return{type:"Polygon",coordinates:T}});case"MultiLineString":return y.coordinates.map(function(T){return{type:"LineString",coordinates:T}});case"GeometryCollection":return y.geometries.map(C).reduce(function(T,R){return T.concat(R)},[]);case"Point":case"Polygon":case"LineString":return[y]}}}),ee=bo,ce=a(G),me=function(C){return function y(T){return Array.isArray(T)&&T.length&&typeof T[0]=="number"?[T]:T.reduce(function(R,$){return Array.isArray($)&&Array.isArray($[0])?R.concat(y($)):(R.push($),R)},[])}(C)};ce instanceof Function||(ce=ce.default);var be={exports:{}},ve=be.exports=function(C){return new pe(C)};function pe(C){this.value=C}function Te(C,y,T){var R=[],$=[],K=!0;return function X(le){var we=T?He(le):le,Ce={},Re=!0,fe={node:we,node_:le,path:[].concat(R),parent:$[$.length-1],parents:$,key:R.slice(-1)[0],isRoot:R.length===0,level:R.length,circular:null,update:function(tt,Tt){fe.isRoot||(fe.parent.node[fe.key]=tt),fe.node=tt,Tt&&(Re=!1)},delete:function(tt){delete fe.parent.node[fe.key],tt&&(Re=!1)},remove:function(tt){Pt(fe.parent.node)?fe.parent.node.splice(fe.key,1):delete fe.parent.node[fe.key],tt&&(Re=!1)},keys:null,before:function(tt){Ce.before=tt},after:function(tt){Ce.after=tt},pre:function(tt){Ce.pre=tt},post:function(tt){Ce.post=tt},stop:function(){K=!1},block:function(){Re=!1}};if(!K)return fe;function $e(){if(typeof fe.node=="object"&&fe.node!==null){fe.keys&&fe.node_===fe.node||(fe.keys=We(fe.node)),fe.isLeaf=fe.keys.length==0;for(var tt=0;tt<$.length;tt++)if($[tt].node_===le){fe.circular=$[tt];break}}else fe.isLeaf=!0,fe.keys=null;fe.notLeaf=!fe.isLeaf,fe.notRoot=!fe.isRoot}$e();var at=y.call(fe,fe.node);return at!==void 0&&fe.update&&fe.update(at),Ce.before&&Ce.before.call(fe,fe.node),Re&&(typeof fe.node!="object"||fe.node===null||fe.circular||($.push(fe),$e(),Zt(fe.keys,function(tt,Tt){R.push(tt),Ce.pre&&Ce.pre.call(fe,fe.node[tt],tt);var Be=X(fe.node[tt]);T&&xt.call(fe.node,tt)&&(fe.node[tt]=Be.node),Be.isLast=Tt==fe.keys.length-1,Be.isFirst=Tt==0,Ce.post&&Ce.post.call(fe,Be),R.pop()}),$.pop()),Ce.after&&Ce.after.call(fe,fe.node)),fe}(C).node}function He(C){if(typeof C=="object"&&C!==null){var y;if(Pt(C))y=[];else if(Ze(C)==="[object Date]")y=new Date(C.getTime?C.getTime():C);else if(function($){return Ze($)==="[object RegExp]"}(C))y=new RegExp(C);else if(function($){return Ze($)==="[object Error]"}(C))y={message:C.message};else if(function($){return Ze($)==="[object Boolean]"}(C))y=new Boolean(C);else if(function($){return Ze($)==="[object Number]"}(C))y=new Number(C);else if(function($){return Ze($)==="[object String]"}(C))y=new String(C);else if(Object.create&&Object.getPrototypeOf)y=Object.create(Object.getPrototypeOf(C));else if(C.constructor===Object)y={};else{var T=C.constructor&&C.constructor.prototype||C.__proto__||{},R=function(){};R.prototype=T,y=new R}return Zt(We(C),function($){y[$]=C[$]}),y}return C}pe.prototype.get=function(C){for(var y=this.value,T=0;T<C.length;T++){var R=C[T];if(!y||!xt.call(y,R)){y=void 0;break}y=y[R]}return y},pe.prototype.has=function(C){for(var y=this.value,T=0;T<C.length;T++){var R=C[T];if(!y||!xt.call(y,R))return!1;y=y[R]}return!0},pe.prototype.set=function(C,y){for(var T=this.value,R=0;R<C.length-1;R++){var $=C[R];xt.call(T,$)||(T[$]={}),T=T[$]}return T[C[R]]=y,y},pe.prototype.map=function(C){return Te(this.value,C,!0)},pe.prototype.forEach=function(C){return this.value=Te(this.value,C,!1),this.value},pe.prototype.reduce=function(C,y){var T=arguments.length===1,R=T?this.value:y;return this.forEach(function($){this.isRoot&&T||(R=C.call(this,R,$))}),R},pe.prototype.paths=function(){var C=[];return this.forEach(function(y){C.push(this.path)}),C},pe.prototype.nodes=function(){var C=[];return this.forEach(function(y){C.push(this.node)}),C},pe.prototype.clone=function(){var C=[],y=[];return function T(R){for(var $=0;$<C.length;$++)if(C[$]===R)return y[$];if(typeof R=="object"&&R!==null){var K=He(R);return C.push(R),y.push(K),Zt(We(R),function(X){K[X]=T(R[X])}),C.pop(),y.pop(),K}return R}(this.value)};var We=Object.keys||function(C){var y=[];for(var T in C)y.push(T);return y};function Ze(C){return Object.prototype.toString.call(C)}var Pt=Array.isArray||function(C){return Object.prototype.toString.call(C)==="[object Array]"},Zt=function(C,y){if(C.forEach)return C.forEach(y);for(var T=0;T<C.length;T++)y(C[T],T,C)};Zt(We(pe.prototype),function(C){ve[C]=function(y){var T=[].slice.call(arguments,1),R=new pe(y);return R[C].apply(R,T)}});var xt=Object.hasOwnProperty||function(C,y){return y in C},Mt=be.exports,$t=Kt;function Kt(C){if(!(this instanceof Kt))return new Kt(C);this._bbox=C||[1/0,1/0,-1/0,-1/0],this._valid=!!C}Kt.prototype.include=function(C){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],C[0]),this._bbox[1]=Math.min(this._bbox[1],C[1]),this._bbox[2]=Math.max(this._bbox[2],C[0]),this._bbox[3]=Math.max(this._bbox[3],C[1]),this},Kt.prototype.equals=function(C){var y;return y=C instanceof Kt?C.bbox():C,this._bbox[0]==y[0]&&this._bbox[1]==y[1]&&this._bbox[2]==y[2]&&this._bbox[3]==y[3]},Kt.prototype.center=function(C){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},Kt.prototype.union=function(C){var y;return this._valid=!0,y=C instanceof Kt?C.bbox():C,this._bbox[0]=Math.min(this._bbox[0],y[0]),this._bbox[1]=Math.min(this._bbox[1],y[1]),this._bbox[2]=Math.max(this._bbox[2],y[2]),this._bbox[3]=Math.max(this._bbox[3],y[3]),this},Kt.prototype.bbox=function(){return this._valid?this._bbox:null},Kt.prototype.contains=function(C){if(!C)return this._fastContains();if(!this._valid)return null;var y=C[0],T=C[1];return this._bbox[0]<=y&&this._bbox[1]<=T&&this._bbox[2]>=y&&this._bbox[3]>=T},Kt.prototype.intersect=function(C){return this._valid?(y=C instanceof Kt?C.bbox():C,!(this._bbox[0]>y[2]||this._bbox[2]<y[0]||this._bbox[3]<y[1]||this._bbox[1]>y[3])):null;var y},Kt.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var C="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",C)},Kt.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var sr=function(C){if(!C)return[];var y=ce(ee(C)),T=[];return y.features.forEach(function(R){R.geometry&&(T=T.concat(me(R.geometry.coordinates)))}),T},Br=Mt,Ur=$t,tr={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},an=Object.keys(tr);function ln(C){for(var y=Ur(),T=sr(C),R=0;R<T.length;R++)y.include(T[R]);return y}xr.exports=function(C){return ln(C).bbox()},xr.exports.polygon=function(C){return ln(C).polygon()},xr.exports.bboxify=function(C){return Br(C).map(function(y){y&&an.some(function(T){return!!y[T]&&tr[T].indexOf(y.type)!==-1})&&(y.bbox=ln(y).bbox(),this.update(y))})};var Rr=n(xr.exports),Cn=-90;function Ci(C,y){var T=Cn,R=90,$=Cn,K=90,X=270,le=-270;C.forEach(function(Ce){var Re=Rr(Ce),fe=Re[1],$e=Re[3],at=Re[0],tt=Re[2];fe>T&&(T=fe),$e<R&&(R=$e),$e>$&&($=$e),fe<K&&(K=fe),at<X&&(X=at),tt>le&&(le=tt)});var we=y;return T+we.lat>85&&(we.lat=85-T),$+we.lat>90&&(we.lat=90-$),R+we.lat<-85&&(we.lat=-85-R),K+we.lat<Cn&&(we.lat=Cn-K),X+we.lng<=-270&&(we.lng+=360*Math.ceil(Math.abs(we.lng)/360)),le+we.lng>=270&&(we.lng-=360*Math.ceil(Math.abs(we.lng)/360)),we}function aa(C,y){var T=Ci(C.map(function(R){return R.toGeoJSON()}),y);C.forEach(function(R){var $,K=R.getCoordinates(),X=function(we){var Ce={lng:we[0]+T.lng,lat:we[1]+T.lat};return[Ce.lng,Ce.lat]},le=function(we){return we.map(function(Ce){return X(Ce)})};R.type===Y.POINT?$=X(K):R.type===Y.LINE_STRING||R.type===Y.MULTI_POINT?$=K.map(X):R.type===Y.POLYGON||R.type===Y.MULTI_LINE_STRING?$=K.map(le):R.type===Y.MULTI_POLYGON&&($=K.map(function(we){return we.map(function(Ce){return le(Ce)})})),R.incomingCoords($)})}var Yr={onSetup:function(C){var y=this,T={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:C.featureIds||[]};return this.setSelected(T.initiallySelectedFeatureIds.filter(function(R){return y.getFeature(R)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),T},fireUpdate:function(){this.map.fire(Q.UPDATE,{action:te.MOVE,features:this.getSelected().map(function(C){return C.toGeoJSON()})})},fireActionable:function(){var C=this,y=this.getSelected(),T=y.filter(function(le){return C.isInstanceOf("MultiFeature",le)}),R=!1;if(y.length>1){R=!0;var $=y[0].type.replace("Multi","");y.forEach(function(le){le.type.replace("Multi","")!==$&&(R=!1)})}var K=T.length>0,X=y.length>0;this.setActionableState({combineFeatures:R,uncombineFeatures:K,trash:X})},getUniqueIds:function(C){return C.length?C.map(function(y){return y.properties.id}).filter(function(y){return y!==void 0}).reduce(function(y,T){return y.add(T),y},new ar).values():[]},stopExtendedInteractions:function(C){C.boxSelectElement&&(C.boxSelectElement.parentNode&&C.boxSelectElement.parentNode.removeChild(C.boxSelectElement),C.boxSelectElement=null),this.map.dragPan.enable(),C.boxSelecting=!1,C.canBoxSelect=!1,C.dragMoving=!1,C.canDragMove=!1},onStop:function(){Ti.enable(this)},onMouseMove:function(C,y){return $i(y)&&C.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(C),!0},onMouseOut:function(C){return!C.dragMoving||this.fireUpdate()}};Yr.onTap=Yr.onClick=function(C,y){return Si(y)?this.clickAnywhere(C,y):ao(ne.VERTEX)(y)?this.clickOnVertex(C,y):$i(y)?this.clickOnFeature(C,y):void 0},Yr.clickAnywhere=function(C){var y=this,T=this.getSelectedIds();T.length&&(this.clearSelectedFeatures(),T.forEach(function(R){return y.doRender(R)})),Ti.enable(this),this.stopExtendedInteractions(C)},Yr.clickOnVertex=function(C,y){this.changeMode(ye.DIRECT_SELECT,{featureId:y.featureTarget.properties.parent,coordPath:y.featureTarget.properties.coord_path,startPos:y.lngLat}),this.updateUIClasses({mouse:H.MOVE})},Yr.startOnActiveFeature=function(C,y){this.stopExtendedInteractions(C),this.map.dragPan.disable(),this.doRender(y.featureTarget.properties.id),C.canDragMove=!0,C.dragMoveLocation=y.lngLat},Yr.clickOnFeature=function(C,y){var T=this;Ti.disable(this),this.stopExtendedInteractions(C);var R=Gt(y),$=this.getSelectedIds(),K=y.featureTarget.properties.id,X=this.isSelected(K);if(!R&&X&&this.getFeature(K).type!==Y.POINT)return this.changeMode(ye.DIRECT_SELECT,{featureId:K});X&&R?(this.deselect(K),this.updateUIClasses({mouse:H.POINTER}),$.length===1&&Ti.enable(this)):!X&&R?(this.select(K),this.updateUIClasses({mouse:H.MOVE})):X||R||($.forEach(function(le){return T.doRender(le)}),this.setSelected(K),this.updateUIClasses({mouse:H.MOVE})),this.doRender(K)},Yr.onMouseDown=function(C,y){return _n(y)?this.startOnActiveFeature(C,y):this.drawConfig.boxSelect&&ut(y)?this.startBoxSelect(C,y):void 0},Yr.startBoxSelect=function(C,y){this.stopExtendedInteractions(C),this.map.dragPan.disable(),C.boxSelectStartLocation=lo(y.originalEvent,this.map.getContainer()),C.canBoxSelect=!0},Yr.onTouchStart=function(C,y){if(_n(y))return this.startOnActiveFeature(C,y)},Yr.onDrag=function(C,y){return C.canDragMove?this.dragMove(C,y):this.drawConfig.boxSelect&&C.canBoxSelect?this.whileBoxSelect(C,y):void 0},Yr.whileBoxSelect=function(C,y){C.boxSelecting=!0,this.updateUIClasses({mouse:H.ADD}),C.boxSelectElement||(C.boxSelectElement=document.createElement("div"),C.boxSelectElement.classList.add(M.BOX_SELECT),this.map.getContainer().appendChild(C.boxSelectElement));var T=lo(y.originalEvent,this.map.getContainer()),R=Math.min(C.boxSelectStartLocation.x,T.x),$=Math.max(C.boxSelectStartLocation.x,T.x),K=Math.min(C.boxSelectStartLocation.y,T.y),X=Math.max(C.boxSelectStartLocation.y,T.y),le="translate("+R+"px, "+K+"px)";C.boxSelectElement.style.transform=le,C.boxSelectElement.style.WebkitTransform=le,C.boxSelectElement.style.width=$-R+"px",C.boxSelectElement.style.height=X-K+"px"},Yr.dragMove=function(C,y){C.dragMoving=!0,y.originalEvent.stopPropagation();var T={lng:y.lngLat.lng-C.dragMoveLocation.lng,lat:y.lngLat.lat-C.dragMoveLocation.lat};aa(this.getSelected(),T),C.dragMoveLocation=y.lngLat},Yr.onTouchEnd=Yr.onMouseUp=function(C,y){var T=this;if(C.dragMoving)this.fireUpdate();else if(C.boxSelecting){var R=[C.boxSelectStartLocation,lo(y.originalEvent,this.map.getContainer())],$=this.featuresAt(null,R,"click"),K=this.getUniqueIds($).filter(function(X){return!T.isSelected(X)});K.length&&(this.select(K),K.forEach(function(X){return T.doRender(X)}),this.updateUIClasses({mouse:H.MOVE}))}this.stopExtendedInteractions(C)},Yr.toDisplayFeatures=function(C,y,T){y.properties.active=this.isSelected(y.properties.id)?Me.ACTIVE:Me.INACTIVE,T(y),this.fireActionable(),y.properties.active===Me.ACTIVE&&y.geometry.type!==Y.POINT&&Ir(y).forEach(T)},Yr.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},Yr.onCombineFeatures=function(){var C=this.getSelected();if(!(C.length===0||C.length<2)){for(var y=[],T=[],R=C[0].type.replace("Multi",""),$=0;$<C.length;$++){var K=C[$];if(K.type.replace("Multi","")!==R)return;K.type.includes("Multi")?K.getCoordinates().forEach(function(le){y.push(le)}):y.push(K.getCoordinates()),T.push(K.toGeoJSON())}if(T.length>1){var X=this.newFeature({type:Y.FEATURE,properties:T[0].properties,geometry:{type:"Multi"+R,coordinates:y}});this.addFeature(X),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([X.id]),this.map.fire(Q.COMBINE_FEATURES,{createdFeatures:[X.toGeoJSON()],deletedFeatures:T})}this.fireActionable()}},Yr.onUncombineFeatures=function(){var C=this,y=this.getSelected();if(y.length!==0){for(var T=[],R=[],$=function(X){var le=y[X];C.isInstanceOf("MultiFeature",le)&&(le.getFeatures().forEach(function(we){C.addFeature(we),we.properties=le.properties,T.push(we.toGeoJSON()),C.select([we.id])}),C.deleteFeature(le.id,{silent:!0}),R.push(le.toGeoJSON()))},K=0;K<y.length;K++)$(K);T.length>1&&this.map.fire(Q.UNCOMBINE_FEATURES,{createdFeatures:T,deletedFeatures:R}),this.fireActionable()}};var xn=ao(ne.VERTEX),Rs=ao(ne.MIDPOINT),zr={fireUpdate:function(){this.map.fire(Q.UPDATE,{action:te.CHANGE_COORDINATES,features:this.getSelected().map(function(C){return C.toGeoJSON()})})},fireActionable:function(C){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:C.selectedCoordPaths.length>0})},startDragging:function(C,y){this.map.dragPan.disable(),C.canDragMove=!0,C.dragMoveLocation=y.lngLat},stopDragging:function(C){this.map.dragPan.enable(),C.dragMoving=!1,C.canDragMove=!1,C.dragMoveLocation=null},onVertex:function(C,y){this.startDragging(C,y);var T=y.featureTarget.properties,R=C.selectedCoordPaths.indexOf(T.coord_path);Gt(y)||R!==-1?Gt(y)&&R===-1&&C.selectedCoordPaths.push(T.coord_path):C.selectedCoordPaths=[T.coord_path];var $=this.pathsToCoordinates(C.featureId,C.selectedCoordPaths);this.setSelectedCoordinates($)},onMidpoint:function(C,y){this.startDragging(C,y);var T=y.featureTarget.properties;C.feature.addCoordinate(T.coord_path,T.lng,T.lat),this.fireUpdate(),C.selectedCoordPaths=[T.coord_path]},pathsToCoordinates:function(C,y){return y.map(function(T){return{feature_id:C,coord_path:T}})},onFeature:function(C,y){C.selectedCoordPaths.length===0?this.startDragging(C,y):this.stopDragging(C)},dragFeature:function(C,y,T){aa(this.getSelected(),T),C.dragMoveLocation=y.lngLat},dragVertex:function(C,y,T){for(var R=C.selectedCoordPaths.map(function(le){return C.feature.getCoordinate(le)}),$=Ci(R.map(function(le){return{type:Y.FEATURE,properties:{},geometry:{type:Y.POINT,coordinates:le}}}),T),K=0;K<R.length;K++){var X=R[K];C.feature.updateCoordinate(C.selectedCoordPaths[K],X[0]+$.lng,X[1]+$.lat)}},clickNoTarget:function(){this.changeMode(ye.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(ye.SIMPLE_SELECT)},clickActiveFeature:function(C){C.selectedCoordPaths=[],this.clearSelectedCoordinates(),C.feature.changed()},onSetup:function(C){var y=C.featureId,T=this.getFeature(y);if(!T)throw new Error("You must provide a featureId to enter direct_select mode");if(T.type===Y.POINT)throw new TypeError("direct_select mode doesn't handle point features");var R={featureId:y,feature:T,dragMoveLocation:C.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:C.coordPath?[C.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(y,R.selectedCoordPaths)),this.setSelected(y),Ti.disable(this),this.setActionableState({trash:!0}),R},onStop:function(){Ti.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(C,y,T){C.featureId===y.properties.id?(y.properties.active=Me.ACTIVE,T(y),Ir(y,{map:this.map,midpoints:!0,selectedPaths:C.selectedCoordPaths}).forEach(T)):(y.properties.active=Me.INACTIVE,T(y)),this.fireActionable(C)},onTrash:function(C){C.selectedCoordPaths.sort(function(y,T){return T.localeCompare(y,"en",{numeric:!0})}).forEach(function(y){return C.feature.removeCoordinate(y)}),this.fireUpdate(),C.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(C),C.feature.isValid()===!1&&(this.deleteFeature([C.featureId]),this.changeMode(ye.SIMPLE_SELECT,{}))},onMouseMove:function(C,y){var T=_n(y),R=xn(y),$=Rs(y),K=C.selectedCoordPaths.length===0;return T&&K||R&&!K?this.updateUIClasses({mouse:H.MOVE}):this.updateUIClasses({mouse:H.NONE}),(R||T||$)&&C.dragMoving&&this.fireUpdate(),this.stopDragging(C),!0},onMouseOut:function(C){return C.dragMoving&&this.fireUpdate(),!0}};zr.onTouchStart=zr.onMouseDown=function(C,y){return xn(y)?this.onVertex(C,y):_n(y)?this.onFeature(C,y):Rs(y)?this.onMidpoint(C,y):void 0},zr.onDrag=function(C,y){if(C.canDragMove===!0){C.dragMoving=!0,y.originalEvent.stopPropagation();var T={lng:y.lngLat.lng-C.dragMoveLocation.lng,lat:y.lngLat.lat-C.dragMoveLocation.lat};C.selectedCoordPaths.length>0?this.dragVertex(C,y,T):this.dragFeature(C,y,T),C.dragMoveLocation=y.lngLat}},zr.onClick=function(C,y){return Si(y)?this.clickNoTarget(C,y):_n(y)?this.clickActiveFeature(C,y):Jn(y)?this.clickInactive(C,y):void this.stopDragging(C)},zr.onTap=function(C,y){return Si(y)?this.clickNoTarget(C,y):_n(y)?this.clickActiveFeature(C,y):Jn(y)?this.clickInactive(C,y):void 0},zr.onTouchEnd=zr.onMouseUp=function(C){C.dragMoving&&this.fireUpdate(),this.stopDragging(C)};var Hr={};function wo(C,y){return!!C.lngLat&&C.lngLat.lng===y[0]&&C.lngLat.lat===y[1]}Hr.onSetup=function(){var C=this.newFeature({type:Y.FEATURE,properties:{},geometry:{type:Y.POINT,coordinates:[]}});return this.addFeature(C),this.clearSelectedFeatures(),this.updateUIClasses({mouse:H.ADD}),this.activateUIButton(q.POINT),this.setActionableState({trash:!0}),{point:C}},Hr.stopDrawingAndRemove=function(C){this.deleteFeature([C.point.id],{silent:!0}),this.changeMode(ye.SIMPLE_SELECT)},Hr.onTap=Hr.onClick=function(C,y){this.updateUIClasses({mouse:H.MOVE}),C.point.updateCoordinate("",y.lngLat.lng,y.lngLat.lat),this.map.fire(Q.CREATE,{features:[C.point.toGeoJSON()]}),this.changeMode(ye.SIMPLE_SELECT,{featureIds:[C.point.id]})},Hr.onStop=function(C){this.activateUIButton(),C.point.getCoordinate().length||this.deleteFeature([C.point.id],{silent:!0})},Hr.toDisplayFeatures=function(C,y,T){var R=y.properties.id===C.point.id;if(y.properties.active=R?Me.ACTIVE:Me.INACTIVE,!R)return T(y)},Hr.onTrash=Hr.stopDrawingAndRemove,Hr.onKeyUp=function(C,y){if(jt(y)||Nr(y))return this.stopDrawingAndRemove(C,y)};var fn={onSetup:function(){var C=this.newFeature({type:Y.FEATURE,properties:{},geometry:{type:Y.POLYGON,coordinates:[[]]}});return this.addFeature(C),this.clearSelectedFeatures(),Ti.disable(this),this.updateUIClasses({mouse:H.ADD}),this.activateUIButton(q.POLYGON),this.setActionableState({trash:!0}),{polygon:C,currentVertexPosition:0}},clickAnywhere:function(C,y){if(C.currentVertexPosition>0&&wo(y,C.polygon.coordinates[0][C.currentVertexPosition-1]))return this.changeMode(ye.SIMPLE_SELECT,{featureIds:[C.polygon.id]});this.updateUIClasses({mouse:H.ADD}),C.polygon.updateCoordinate("0."+C.currentVertexPosition,y.lngLat.lng,y.lngLat.lat),C.currentVertexPosition++,C.polygon.updateCoordinate("0."+C.currentVertexPosition,y.lngLat.lng,y.lngLat.lat)},clickOnVertex:function(C){return this.changeMode(ye.SIMPLE_SELECT,{featureIds:[C.polygon.id]})},onMouseMove:function(C,y){C.polygon.updateCoordinate("0."+C.currentVertexPosition,y.lngLat.lng,y.lngLat.lat),et(y)&&this.updateUIClasses({mouse:H.POINTER})}};fn.onTap=fn.onClick=function(C,y){return et(y)?this.clickOnVertex(C,y):this.clickAnywhere(C,y)},fn.onKeyUp=function(C,y){jt(y)?(this.deleteFeature([C.polygon.id],{silent:!0}),this.changeMode(ye.SIMPLE_SELECT)):Nr(y)&&this.changeMode(ye.SIMPLE_SELECT,{featureIds:[C.polygon.id]})},fn.onStop=function(C){this.updateUIClasses({mouse:H.NONE}),Ti.enable(this),this.activateUIButton(),this.getFeature(C.polygon.id)!==void 0&&(C.polygon.removeCoordinate("0."+C.currentVertexPosition),C.polygon.isValid()?this.map.fire(Q.CREATE,{features:[C.polygon.toGeoJSON()]}):(this.deleteFeature([C.polygon.id],{silent:!0}),this.changeMode(ye.SIMPLE_SELECT,{},{silent:!0})))},fn.toDisplayFeatures=function(C,y,T){var R=y.properties.id===C.polygon.id;if(y.properties.active=R?Me.ACTIVE:Me.INACTIVE,!R)return T(y);if(y.geometry.coordinates.length!==0){var $=y.geometry.coordinates[0].length;if(!($<3)){if(y.properties.meta=ne.FEATURE,T(Yn(C.polygon.id,y.geometry.coordinates[0][0],"0.0",!1)),$>3){var K=y.geometry.coordinates[0].length-3;T(Yn(C.polygon.id,y.geometry.coordinates[0][K],"0."+K,!1))}if($<=4){var X=[[y.geometry.coordinates[0][0][0],y.geometry.coordinates[0][0][1]],[y.geometry.coordinates[0][1][0],y.geometry.coordinates[0][1][1]]];if(T({type:Y.FEATURE,properties:y.properties,geometry:{coordinates:X,type:Y.LINE_STRING}}),$===3)return}return T(y)}}},fn.onTrash=function(C){this.deleteFeature([C.polygon.id],{silent:!0}),this.changeMode(ye.SIMPLE_SELECT)};var Qn={onSetup:function(C){var y,T,R=(C=C||{}).featureId,$="forward";if(R){if(!(y=this.getFeature(R)))throw new Error("Could not find a feature with the provided featureId");var K=C.from;if(K&&K.type==="Feature"&&K.geometry&&K.geometry.type==="Point"&&(K=K.geometry),K&&K.type==="Point"&&K.coordinates&&K.coordinates.length===2&&(K=K.coordinates),!K||!Array.isArray(K))throw new Error("Please use the `from` property to indicate which point to continue the line from");var X=y.coordinates.length-1;if(y.coordinates[X][0]===K[0]&&y.coordinates[X][1]===K[1])T=X+1,y.addCoordinate.apply(y,[T].concat(y.coordinates[X]));else{if(y.coordinates[0][0]!==K[0]||y.coordinates[0][1]!==K[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");$="backwards",T=0,y.addCoordinate.apply(y,[T].concat(y.coordinates[0]))}}else y=this.newFeature({type:Y.FEATURE,properties:{},geometry:{type:Y.LINE_STRING,coordinates:[]}}),T=0,this.addFeature(y);return this.clearSelectedFeatures(),Ti.disable(this),this.updateUIClasses({mouse:H.ADD}),this.activateUIButton(q.LINE),this.setActionableState({trash:!0}),{line:y,currentVertexPosition:T,direction:$}},clickAnywhere:function(C,y){if(C.currentVertexPosition>0&&wo(y,C.line.coordinates[C.currentVertexPosition-1])||C.direction==="backwards"&&wo(y,C.line.coordinates[C.currentVertexPosition+1]))return this.changeMode(ye.SIMPLE_SELECT,{featureIds:[C.line.id]});this.updateUIClasses({mouse:H.ADD}),C.line.updateCoordinate(C.currentVertexPosition,y.lngLat.lng,y.lngLat.lat),C.direction==="forward"?(C.currentVertexPosition++,C.line.updateCoordinate(C.currentVertexPosition,y.lngLat.lng,y.lngLat.lat)):C.line.addCoordinate(0,y.lngLat.lng,y.lngLat.lat)},clickOnVertex:function(C){return this.changeMode(ye.SIMPLE_SELECT,{featureIds:[C.line.id]})},onMouseMove:function(C,y){C.line.updateCoordinate(C.currentVertexPosition,y.lngLat.lng,y.lngLat.lat),et(y)&&this.updateUIClasses({mouse:H.POINTER})}};Qn.onTap=Qn.onClick=function(C,y){if(et(y))return this.clickOnVertex(C,y);this.clickAnywhere(C,y)},Qn.onKeyUp=function(C,y){Nr(y)?this.changeMode(ye.SIMPLE_SELECT,{featureIds:[C.line.id]}):jt(y)&&(this.deleteFeature([C.line.id],{silent:!0}),this.changeMode(ye.SIMPLE_SELECT))},Qn.onStop=function(C){Ti.enable(this),this.activateUIButton(),this.getFeature(C.line.id)!==void 0&&(C.line.removeCoordinate(""+C.currentVertexPosition),C.line.isValid()?this.map.fire(Q.CREATE,{features:[C.line.toGeoJSON()]}):(this.deleteFeature([C.line.id],{silent:!0}),this.changeMode(ye.SIMPLE_SELECT,{},{silent:!0})))},Qn.onTrash=function(C){this.deleteFeature([C.line.id],{silent:!0}),this.changeMode(ye.SIMPLE_SELECT)},Qn.toDisplayFeatures=function(C,y,T){var R=y.properties.id===C.line.id;if(y.properties.active=R?Me.ACTIVE:Me.INACTIVE,!R)return T(y);y.geometry.coordinates.length<2||(y.properties.meta=ne.FEATURE,T(Yn(C.line.id,y.geometry.coordinates[C.direction==="forward"?y.geometry.coordinates.length-2:1],""+(C.direction==="forward"?y.geometry.coordinates.length-2:1),!1)),T(y))};var uo={simple_select:Yr,direct_select:zr,draw_point:Hr,draw_polygon:fn,draw_line_string:Qn},Vi={defaultMode:ye.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:Ls,modes:uo,controls:{},userProperties:!1},Eo={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},Os={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function Vo(C,y){return C.map(function(T){return T.source?T:Tn(T,{id:T.id+"."+y,source:y==="hot"?z.HOT:z.COLD})})}var fr={exports:{}};(function(C,y){var T="__lodash_hash_undefined__",R=9007199254740991,$="[object Arguments]",K="[object Array]",X="[object Boolean]",le="[object Date]",we="[object Error]",Ce="[object Function]",Re="[object Map]",fe="[object Number]",$e="[object Object]",at="[object Promise]",tt="[object RegExp]",Tt="[object Set]",Be="[object String]",Pe="[object Symbol]",rt="[object WeakMap]",rr="[object ArrayBuffer]",Ot="[object DataView]",vr=/^\[object .+?Constructor\]$/,Ft=/^(?:0|[1-9]\d*)$/,Pr={};Pr["[object Float32Array]"]=Pr["[object Float64Array]"]=Pr["[object Int8Array]"]=Pr["[object Int16Array]"]=Pr["[object Int32Array]"]=Pr["[object Uint8Array]"]=Pr["[object Uint8ClampedArray]"]=Pr["[object Uint16Array]"]=Pr["[object Uint32Array]"]=!0,Pr[$]=Pr[K]=Pr[rr]=Pr[X]=Pr[Ot]=Pr[le]=Pr[we]=Pr[Ce]=Pr[Re]=Pr[fe]=Pr[$e]=Pr[tt]=Pr[Tt]=Pr[Be]=Pr[rt]=!1;var Gi=typeof{}=="object"&&{}&&{}.Object===Object&&{},Cr=typeof self=="object"&&self&&self.Object===Object&&self,In=Gi||Cr||Function("return this")(),Ln=y&&!y.nodeType&&y,Go=Ln&&C&&!C.nodeType&&C,br=Go&&Go.exports===Ln,pi=br&&Gi.process,ll=function(){try{return pi&&pi.binding&&pi.binding("util")}catch{}}(),ul=ll&&ll.isTypedArray;function la(Se,Ne){for(var lt=-1,kt=Se==null?0:Se.length;++lt<kt;)if(Ne(Se[lt],lt,Se))return!0;return!1}function ru(Se){var Ne=-1,lt=Array(Se.size);return Se.forEach(function(kt,jr){lt[++Ne]=[jr,kt]}),lt}function cl(Se){var Ne=-1,lt=Array(Se.size);return Se.forEach(function(kt){lt[++Ne]=kt}),lt}var Tl,Cl,nu,Ds=Array.prototype,hl=Function.prototype,zs=Object.prototype,Oa=In["__core-js_shared__"],ua=hl.toString,zn=zs.hasOwnProperty,Da=(Tl=/[^.]+$/.exec(Oa&&Oa.keys&&Oa.keys.IE_PROTO||""))?"Symbol(src)_1."+Tl:"",za=zs.toString,Fa=RegExp("^"+ua.call(zn).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qi=br?In.Buffer:void 0,Na=In.Symbol,Fs=In.Uint8Array,Ns=zs.propertyIsEnumerable,iu=Ds.splice,qo=Na?Na.toStringTag:void 0,kr=Object.getOwnPropertySymbols,ca=qi?qi.isBuffer:void 0,Bs=(Cl=Object.keys,nu=Object,function(Se){return Cl(nu(Se))}),Hi=Zi(In,"DataView"),mi=Zi(In,"Map"),ha=Zi(In,"Promise"),So=Zi(In,"Set"),da=Zi(In,"WeakMap"),fs=Zi(Object,"create"),Us=At(Hi),Ba=At(mi),Ua=At(ha),mn=At(So),Il=At(da),cr=Na?Na.prototype:void 0,Ho=cr?cr.valueOf:void 0;function wr(Se){var Ne=-1,lt=Se==null?0:Se.length;for(this.clear();++Ne<lt;){var kt=Se[Ne];this.set(kt[0],kt[1])}}function hr(Se){var Ne=-1,lt=Se==null?0:Se.length;for(this.clear();++Ne<lt;){var kt=Se[Ne];this.set(kt[0],kt[1])}}function To(Se){var Ne=-1,lt=Se==null?0:Se.length;for(this.clear();++Ne<lt;){var kt=Se[Ne];this.set(kt[0],kt[1])}}function Ii(Se){var Ne=-1,lt=Se==null?0:Se.length;for(this.__data__=new To;++Ne<lt;)this.add(Se[Ne])}function ps(Se){var Ne=this.__data__=new hr(Se);this.size=Ne.size}function ms(Se,Ne){var lt=Qr(Se),kt=!lt&&dr(Se),jr=!lt&&!kt&&nn(Se),lr=!lt&&!kt&&!jr&&Fn(Se),gn=lt||kt||jr||lr,Zr=gn?function(ur,pn){for(var co=-1,on=Array(ur);++co<ur;)on[co]=pn(co);return on}(Se.length,String):[],or=Zr.length;for(var Jt in Se)!Ne&&!zn.call(Se,Jt)||gn&&(Jt=="length"||jr&&(Jt=="offset"||Jt=="parent")||lr&&(Jt=="buffer"||Jt=="byteLength"||Jt=="byteOffset")||ft(Jt,or))||Zr.push(Jt);return Zr}function gs(Se,Ne){for(var lt=Se.length;lt--;)if(Fr(Se[lt][0],Ne))return lt;return-1}function js(Se){return Se==null?Se===void 0?"[object Undefined]":"[object Null]":qo&&qo in Object(Se)?function(Ne){var lt=zn.call(Ne,qo),kt=Ne[qo];try{Ne[qo]=void 0;var jr=!0}catch{}var lr=za.call(Ne);return jr&&(lt?Ne[qo]=kt:delete Ne[qo]),lr}(Se):function(Ne){return za.call(Ne)}(Se)}function $s(Se){return ei(Se)&&js(Se)==$}function fa(Se,Ne,lt,kt,jr){return Se===Ne||(Se==null||Ne==null||!ei(Se)&&!ei(Ne)?Se!=Se&&Ne!=Ne:function(lr,gn,Zr,or,Jt,ur){var pn=Qr(lr),co=Qr(gn),on=pn?K:Fe(lr),ti=co?K:Fe(gn),Vn=(on=on==$?$e:on)==$e,Wi=(ti=ti==$?$e:ti)==$e,Gn=on==ti;if(Gn&&nn(lr)){if(!nn(gn))return!1;pn=!0,Vn=!1}if(Gn&&!Vn)return ur||(ur=new ps),pn||Fn(lr)?$a(lr,gn,Zr,or,Jt,ur):function($r,Ye,Co,ho,Gs,qn,ys){switch(Co){case Ot:if($r.byteLength!=Ye.byteLength||$r.byteOffset!=Ye.byteOffset)return!1;$r=$r.buffer,Ye=Ye.buffer;case rr:return!($r.byteLength!=Ye.byteLength||!qn(new Fs($r),new Fs(Ye)));case X:case le:case fe:return Fr(+$r,+Ye);case we:return $r.name==Ye.name&&$r.message==Ye.message;case tt:case Be:return $r==Ye+"";case Re:var Zo=ru;case Tt:var ga=1&ho;if(Zo||(Zo=cl),$r.size!=Ye.size&&!ga)return!1;var Pl=ys.get($r);if(Pl)return Pl==Ye;ho|=2,ys.set($r,Ye);var ya=$a(Zo($r),Zo(Ye),ho,Gs,qn,ys);return ys.delete($r),ya;case Pe:if(Ho)return Ho.call($r)==Ho.call(Ye)}return!1}(lr,gn,on,Zr,or,Jt,ur);if(!(1&Zr)){var yt=Vn&&zn.call(lr,"__wrapped__"),Ki=Wi&&zn.call(gn,"__wrapped__");if(yt||Ki){var ma=yt?lr.value():lr,Xi=Ki?gn.value():gn;return ur||(ur=new ps),Jt(ma,Xi,Zr,or,ur)}}return Gn?(ur||(ur=new ps),function($r,Ye,Co,ho,Gs,qn){var ys=1&Co,Zo=Vs($r),ga=Zo.length,Pl=Vs(Ye).length;if(ga!=Pl&&!ys)return!1;for(var ya=ga;ya--;){var vs=Zo[ya];if(!(ys?vs in Ye:zn.call(Ye,vs)))return!1}var ou=qn.get($r);if(ou&&qn.get(Ye))return ou==Ye;var va=!0;qn.set($r,Ye),qn.set(Ye,$r);for(var Pi=ys;++ya<ga;){var Wo=$r[vs=Zo[ya]],Al=Ye[vs];if(ho)var su=ys?ho(Al,Wo,vs,Ye,$r,qn):ho(Wo,Al,vs,$r,Ye,qn);if(!(su===void 0?Wo===Al||Gs(Wo,Al,Co,ho,qn):su)){va=!1;break}Pi||(Pi=vs=="constructor")}if(va&&!Pi){var Va=$r.constructor,dl=Ye.constructor;Va==dl||!("constructor"in $r)||!("constructor"in Ye)||typeof Va=="function"&&Va instanceof Va&&typeof dl=="function"&&dl instanceof dl||(va=!1)}return qn.delete($r),qn.delete(Ye),va}(lr,gn,Zr,or,Jt,ur)):!1}(Se,Ne,lt,kt,fa,jr))}function pa(Se){return!(!Pn(Se)||function(Ne){return!!Da&&Da in Ne}(Se))&&(zi(Se)?Fa:vr).test(At(Se))}function ja(Se){if(lt=(Ne=Se)&&Ne.constructor,kt=typeof lt=="function"&&lt.prototype||zs,Ne!==kt)return Bs(Se);var Ne,lt,kt,jr=[];for(var lr in Object(Se))zn.call(Se,lr)&&lr!="constructor"&&jr.push(lr);return jr}function $a(Se,Ne,lt,kt,jr,lr){var gn=1&lt,Zr=Se.length,or=Ne.length;if(Zr!=or&&!(gn&&or>Zr))return!1;var Jt=lr.get(Se);if(Jt&&lr.get(Ne))return Jt==Ne;var ur=-1,pn=!0,co=2&lt?new Ii:void 0;for(lr.set(Se,Ne),lr.set(Ne,Se);++ur<Zr;){var on=Se[ur],ti=Ne[ur];if(kt)var Vn=gn?kt(ti,on,ur,Ne,Se,lr):kt(on,ti,ur,Se,Ne,lr);if(Vn!==void 0){if(Vn)continue;pn=!1;break}if(co){if(!la(Ne,function(Wi,Gn){if(yt=Gn,!co.has(yt)&&(on===Wi||jr(on,Wi,lt,kt,lr)))return co.push(Gn);var yt})){pn=!1;break}}else if(on!==ti&&!jr(on,ti,lt,kt,lr)){pn=!1;break}}return lr.delete(Se),lr.delete(Ne),pn}function Vs(Se){return function(Ne,lt,kt){var jr=lt(Ne);return Qr(Ne)?jr:function(lr,gn){for(var Zr=-1,or=gn.length,Jt=lr.length;++Zr<or;)lr[Jt+Zr]=gn[Zr];return lr}(jr,kt(Ne))}(Se,$n,Ee)}function un(Se,Ne){var lt,kt,jr=Se.__data__;return((kt=typeof(lt=Ne))=="string"||kt=="number"||kt=="symbol"||kt=="boolean"?lt!=="__proto__":lt===null)?jr[typeof Ne=="string"?"string":"hash"]:jr.map}function Zi(Se,Ne){var lt=function(kt,jr){return kt==null?void 0:kt[jr]}(Se,Ne);return pa(lt)?lt:void 0}wr.prototype.clear=function(){this.__data__=fs?fs(null):{},this.size=0},wr.prototype.delete=function(Se){var Ne=this.has(Se)&&delete this.__data__[Se];return this.size-=Ne?1:0,Ne},wr.prototype.get=function(Se){var Ne=this.__data__;if(fs){var lt=Ne[Se];return lt===T?void 0:lt}return zn.call(Ne,Se)?Ne[Se]:void 0},wr.prototype.has=function(Se){var Ne=this.__data__;return fs?Ne[Se]!==void 0:zn.call(Ne,Se)},wr.prototype.set=function(Se,Ne){var lt=this.__data__;return this.size+=this.has(Se)?0:1,lt[Se]=fs&&Ne===void 0?T:Ne,this},hr.prototype.clear=function(){this.__data__=[],this.size=0},hr.prototype.delete=function(Se){var Ne=this.__data__,lt=gs(Ne,Se);return!(lt<0)&&(lt==Ne.length-1?Ne.pop():iu.call(Ne,lt,1),--this.size,!0)},hr.prototype.get=function(Se){var Ne=this.__data__,lt=gs(Ne,Se);return lt<0?void 0:Ne[lt][1]},hr.prototype.has=function(Se){return gs(this.__data__,Se)>-1},hr.prototype.set=function(Se,Ne){var lt=this.__data__,kt=gs(lt,Se);return kt<0?(++this.size,lt.push([Se,Ne])):lt[kt][1]=Ne,this},To.prototype.clear=function(){this.size=0,this.__data__={hash:new wr,map:new(mi||hr),string:new wr}},To.prototype.delete=function(Se){var Ne=un(this,Se).delete(Se);return this.size-=Ne?1:0,Ne},To.prototype.get=function(Se){return un(this,Se).get(Se)},To.prototype.has=function(Se){return un(this,Se).has(Se)},To.prototype.set=function(Se,Ne){var lt=un(this,Se),kt=lt.size;return lt.set(Se,Ne),this.size+=lt.size==kt?0:1,this},Ii.prototype.add=Ii.prototype.push=function(Se){return this.__data__.set(Se,T),this},Ii.prototype.has=function(Se){return this.__data__.has(Se)},ps.prototype.clear=function(){this.__data__=new hr,this.size=0},ps.prototype.delete=function(Se){var Ne=this.__data__,lt=Ne.delete(Se);return this.size=Ne.size,lt},ps.prototype.get=function(Se){return this.__data__.get(Se)},ps.prototype.has=function(Se){return this.__data__.has(Se)},ps.prototype.set=function(Se,Ne){var lt=this.__data__;if(lt instanceof hr){var kt=lt.__data__;if(!mi||kt.length<199)return kt.push([Se,Ne]),this.size=++lt.size,this;lt=this.__data__=new To(kt)}return lt.set(Se,Ne),this.size=lt.size,this};var Ee=kr?function(Se){return Se==null?[]:(Se=Object(Se),function(Ne,lt){for(var kt=-1,jr=Ne==null?0:Ne.length,lr=0,gn=[];++kt<jr;){var Zr=Ne[kt];lt(Zr,kt,Ne)&&(gn[lr++]=Zr)}return gn}(kr(Se),function(Ne){return Ns.call(Se,Ne)}))}:function(){return[]},Fe=js;function ft(Se,Ne){return!!(Ne=Ne??R)&&(typeof Se=="number"||Ft.test(Se))&&Se>-1&&Se%1==0&&Se<Ne}function At(Se){if(Se!=null){try{return ua.call(Se)}catch{}try{return Se+""}catch{}}return""}function Fr(Se,Ne){return Se===Ne||Se!=Se&&Ne!=Ne}(Hi&&Fe(new Hi(new ArrayBuffer(1)))!=Ot||mi&&Fe(new mi)!=Re||ha&&Fe(ha.resolve())!=at||So&&Fe(new So)!=Tt||da&&Fe(new da)!=rt)&&(Fe=function(Se){var Ne=js(Se),lt=Ne==$e?Se.constructor:void 0,kt=lt?At(lt):"";if(kt)switch(kt){case Us:return Ot;case Ba:return Re;case Ua:return at;case mn:return Tt;case Il:return rt}return Ne});var dr=$s(function(){return arguments}())?$s:function(Se){return ei(Se)&&zn.call(Se,"callee")&&!Ns.call(Se,"callee")},Qr=Array.isArray,nn=ca||function(){return!1};function zi(Se){if(!Pn(Se))return!1;var Ne=js(Se);return Ne==Ce||Ne=="[object GeneratorFunction]"||Ne=="[object AsyncFunction]"||Ne=="[object Proxy]"}function bn(Se){return typeof Se=="number"&&Se>-1&&Se%1==0&&Se<=R}function Pn(Se){var Ne=typeof Se;return Se!=null&&(Ne=="object"||Ne=="function")}function ei(Se){return Se!=null&&typeof Se=="object"}var Fn=ul?function(Se){return function(Ne){return Se(Ne)}}(ul):function(Se){return ei(Se)&&bn(Se.length)&&!!Pr[js(Se)]};function $n(Se){return(Ne=Se)!=null&&bn(Ne.length)&&!zi(Ne)?ms(Se):ja(Se);var Ne}C.exports=function(Se,Ne){return fa(Se,Ne)}})(fr,fr.exports);var Sl=n(fr.exports);function ds(C,y){return C.length===y.length&&JSON.stringify(C.map(function(T){return T}).sort())===JSON.stringify(y.map(function(T){return T}).sort())}var ic={Polygon:dn,LineString:Dn,Point:yr,MultiPolygon:vn,MultiLineString:vn,MultiPoint:vn},tu=Object.freeze({__proto__:null,CommonSelectors:$o,constrainFeatureMovement:Ci,createMidPoint:jn,createSupplementaryPoints:Ir,createVertex:Yn,doubleClickZoom:Ti,euclideanDistance:Un,featuresAt:Tr,getFeatureAtAndSetCursors:qr,isClick:pt,isEventAtCoordinates:wo,isTap:Nt,mapEventToBoundingBox:Qt,ModeHandler:r,moveFeatures:aa,sortFeatures:st,stringSetsAreEqual:ds,StringSet:ar,theme:Ls,toDenseArray:Xn}),sl=function(C,y){var T={options:C=function($){$===void 0&&($={});var K=Tn($);return $.controls||(K.controls={}),$.displayControlsDefault===!1?K.controls=Tn(Os,$.controls):K.controls=Tn(Eo,$.controls),(K=Tn(Vi,K)).styles=Vo(K.styles,"cold").concat(Vo(K.styles,"hot")),K}(C)};y=function($,K){return K.modes=ye,K.getFeatureIdsAt=function(X){return Tr.click({point:X},null,$).map(function(le){return le.properties.id})},K.getSelectedIds=function(){return $.store.getSelectedIds()},K.getSelected=function(){return{type:Y.FEATURE_COLLECTION,features:$.store.getSelectedIds().map(function(X){return $.store.get(X)}).map(function(X){return X.toGeoJSON()})}},K.getSelectedPoints=function(){return{type:Y.FEATURE_COLLECTION,features:$.store.getSelectedCoordinates().map(function(X){return{type:Y.FEATURE,properties:{},geometry:{type:Y.POINT,coordinates:X.coordinates}}})}},K.set=function(X){if(X.type===void 0||X.type!==Y.FEATURE_COLLECTION||!Array.isArray(X.features))throw new Error("Invalid FeatureCollection");var le=$.store.createRenderBatch(),we=$.store.getAllIds().slice(),Ce=K.add(X),Re=new ar(Ce);return(we=we.filter(function(fe){return!Re.has(fe)})).length&&K.delete(we),le(),Ce},K.add=function(X){var le=JSON.parse(JSON.stringify(j(X))).features.map(function(we){if(we.id=we.id||Ar(),we.geometry===null)throw new Error("Invalid geometry: null");if($.store.get(we.id)===void 0||$.store.get(we.id).type!==we.geometry.type){var Ce=ic[we.geometry.type];if(Ce===void 0)throw new Error("Invalid geometry type: "+we.geometry.type+".");var Re=new Ce($,we);$.store.add(Re)}else{var fe=$.store.get(we.id);fe.properties=we.properties,Sl(fe.getCoordinates(),we.geometry.coordinates)||fe.incomingCoords(we.geometry.coordinates)}return we.id});return $.store.render(),le},K.get=function(X){var le=$.store.get(X);if(le)return le.toGeoJSON()},K.getAll=function(){return{type:Y.FEATURE_COLLECTION,features:$.store.getAll().map(function(X){return X.toGeoJSON()})}},K.delete=function(X){return $.store.delete(X,{silent:!0}),K.getMode()!==ye.DIRECT_SELECT||$.store.getSelectedIds().length?$.store.render():$.events.changeMode(ye.SIMPLE_SELECT,void 0,{silent:!0}),K},K.deleteAll=function(){return $.store.delete($.store.getAllIds(),{silent:!0}),K.getMode()===ye.DIRECT_SELECT?$.events.changeMode(ye.SIMPLE_SELECT,void 0,{silent:!0}):$.store.render(),K},K.changeMode=function(X,le){return le===void 0&&(le={}),X===ye.SIMPLE_SELECT&&K.getMode()===ye.SIMPLE_SELECT?(ds(le.featureIds||[],$.store.getSelectedIds())||($.store.setSelected(le.featureIds,{silent:!0}),$.store.render()),K):(X===ye.DIRECT_SELECT&&K.getMode()===ye.DIRECT_SELECT&&le.featureId===$.store.getSelectedIds()[0]||$.events.changeMode(X,le,{silent:!0}),K)},K.getMode=function(){return $.events.getMode()},K.trash=function(){return $.events.trash({silent:!0}),K},K.combineFeatures=function(){return $.events.combineFeatures({silent:!0}),K},K.uncombineFeatures=function(){return $.events.uncombineFeatures({silent:!0}),K},K.setFeatureProperty=function(X,le,we){return $.store.setFeatureProperty(X,le,we),K},K}(T,y),T.api=y;var R=tn(T);return y.onAdd=R.onAdd,y.onRemove=R.onRemove,y.types=q,y.options=C,y};function al(C){sl(C,this)}return al.modes=uo,al.constants=Qe,al.lib=tu,al})})(G6);var XC={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(ig,function(){var r=function(y,T){var R={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},$={on:function(X,le,we){if(R[X]===void 0)throw new Error("Invalid event type: "+X);R[X].push({selector:le,fn:we})},render:function(X){T.store.featureChanged(X)}},K=function(X,le){for(var we=R[X],Ce=we.length;Ce--;){var Re=we[Ce];if(Re.selector(le)){Re.fn.call($,le)||T.store.render(),T.ui.updateMapClasses();break}}};return y.start.call($),{render:y.render,stop:function(){y.stop&&y.stop()},trash:function(){y.trash&&(y.trash(),T.store.render())},combineFeatures:function(){y.combineFeatures&&y.combineFeatures()},uncombineFeatures:function(){y.uncombineFeatures&&y.uncombineFeatures()},drag:function(X){K("drag",X)},click:function(X){K("click",X)},mousemove:function(X){K("mousemove",X)},mousedown:function(X){K("mousedown",X)},mouseup:function(X){K("mouseup",X)},mouseout:function(X){K("mouseout",X)},keydown:function(X){K("keydown",X)},keyup:function(X){K("keyup",X)},touchstart:function(X){K("touchstart",X)},touchmove:function(X){K("touchmove",X)},touchend:function(X){K("touchend",X)},tap:function(X){K("tap",X)}}},n=6378137;function a(y){var T=0;if(y&&y.length>0){T+=Math.abs(l(y[0]));for(var R=1;R<y.length;R++)T-=Math.abs(l(y[R]))}return T}function l(y){var T,R,$,K,X,le,we=0,Ce=y.length;if(Ce>2){for(le=0;le<Ce;le++)le===Ce-2?($=Ce-2,K=Ce-1,X=0):le===Ce-1?($=Ce-1,K=0,X=1):($=le,K=le+1,X=le+2),T=y[$],R=y[K],we+=(f(y[X][0])-f(T[0]))*Math.sin(f(R[1]));we=we*n*n/2}return we}function f(y){return y*Math.PI/180}var u={geometry:function y(T){var R,$=0;switch(T.type){case"Polygon":return a(T.coordinates);case"MultiPolygon":for(R=0;R<T.coordinates.length;R++)$+=a(T.coordinates[R]);return $;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(R=0;R<T.geometries.length;R++)$+=y(T.geometries[R]);return $}},ring:l},E="mapboxgl-ctrl",m="mapbox-gl-draw_ctrl-draw-btn",S="mapbox-gl-draw_line",M="mapbox-gl-draw_polygon",z="mapbox-gl-draw_point",H="mapbox-gl-draw_trash",q="mapbox-gl-draw_combine",Y="mapbox-gl-draw_uncombine",ye="mapboxgl-ctrl-group",Q="active",te="mapbox-gl-draw_boxselect",ne="mapbox-gl-draw-hot",Me="mapbox-gl-draw-cold",Ve="add",je="move",Qe="drag",ot="pointer",Ut="none",st={POLYGON:"polygon",LINE:"line_string",POINT:"point"},Qt="Feature",ar="Polygon",Xr="LineString",Tr="Point",sn="FeatureCollection",qr="Multi",Un="MultiPoint",pt="MultiLineString",Nt="MultiPolygon",mt={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},gr="draw.create",Ar="draw.delete",Lr="draw.update",yr="draw.selectionchange",Dn="draw.modechange",dn="draw.actionable",ji="draw.render",jo="draw.combine",vn="draw.uncombine",er="move",so="change_coordinates",wi="feature",Ue="midpoint",Xn="vertex",Ei="true",Dt="false",Mr=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],hs={Point:0,LineString:1,Polygon:2};function ks(y,T){var R=hs[y.geometry.type]-hs[T.geometry.type];return R===0&&y.geometry.type===ar?y.area-T.area:R}function Tn(y){if(this._items={},this._nums={},this._length=y?y.length:0,y)for(var T=0,R=y.length;T<R;T++)this.add(y[T]),y[T]!==void 0&&(typeof y[T]=="string"?this._items[y[T]]=T:this._nums[y[T]]=T)}Tn.prototype.add=function(y){return this.has(y)||(this._length++,typeof y=="string"?this._items[y]=this._length:this._nums[y]=this._length),this},Tn.prototype.delete=function(y){return this.has(y)===!1||(this._length--,delete this._items[y],delete this._nums[y]),this},Tn.prototype.has=function(y){return(typeof y=="string"||typeof y=="number")&&(this._items[y]!==void 0||this._nums[y]!==void 0)},Tn.prototype.values=function(){var y=this,T=[];return Object.keys(this._items).forEach(function(R){T.push({k:R,v:y._items[R]})}),Object.keys(this._nums).forEach(function(R){T.push({k:JSON.parse(R),v:y._nums[R]})}),T.sort(function(R,$){return R.v-$.v}).map(function(R){return R.k})},Tn.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var ol=[wi,Ue,Xn],tn={click:function(y,T,R){return Ls(y,T,R,R.options.clickBuffer)},touch:function(y,T,R){return Ls(y,T,R,R.options.touchBuffer)}};function Ls(y,T,R,$){if(R.map===null)return[];var K=y?function(Re,fe){return fe===void 0&&(fe=0),[[Re.point.x-fe,Re.point.y-fe],[Re.point.x+fe,Re.point.y+fe]]}(y,$):T,X={};R.options.styles&&(X.layers=R.options.styles.map(function(Re){return Re.id}));var le=R.map.queryRenderedFeatures(K,X).filter(function(Re){return ol.indexOf(Re.properties.meta)!==-1}),we=new Tn,Ce=[];return le.forEach(function(Re){var fe=Re.properties.id;we.has(fe)||(we.add(fe),Ce.push(Re))}),function(Re){return Re.map(function(fe){return fe.geometry.type===ar&&(fe.area=u.geometry({type:Qt,property:{},geometry:fe.geometry})),fe}).sort(ks).map(function(fe){return delete fe.area,fe})}(Ce)}function ao(y,T){var R=tn.click(y,null,T),$={mouse:Ut};return R[0]&&($.mouse=R[0].properties.active===Ei?je:ot,$.feature=R[0].properties.meta),T.events.currentModeName().indexOf("draw")!==-1&&($.mouse=Ve),T.ui.queueMapClasses($),T.ui.updateMapClasses(),R[0]}function ut(y,T){var R=y.x-T.x,$=y.y-T.y;return Math.sqrt(R*R+$*$)}function _n(y,T,R){R===void 0&&(R={});var $=R.fineTolerance!=null?R.fineTolerance:4,K=R.grossTolerance!=null?R.grossTolerance:12,X=R.interval!=null?R.interval:500;y.point=y.point||T.point,y.time=y.time||T.time;var le=ut(y.point,T.point);return le<$||le<K&&T.time-y.time<X}function Jn(y,T,R){R===void 0&&(R={});var $=R.tolerance!=null?R.tolerance:25,K=R.interval!=null?R.interval:250;return y.point=y.point||T.point,y.time=y.time||T.time,ut(y.point,T.point)<$&&T.time-y.time<K}function Si(y,T){return y(T={exports:{}},T.exports),T.exports}var $i=Si(function(y){var T=y.exports=function(R,$){if($||($=16),R===void 0&&(R=128),R<=0)return"0";for(var K=Math.log(Math.pow(2,R))/Math.log($),X=2;K===1/0;X*=2)K=Math.log(Math.pow(2,R/X))/Math.log($)*X;var le=K-Math.floor(K),we="";for(X=0;X<Math.floor(K);X++)we=Math.floor(Math.random()*$).toString($)+we;if(le){var Ce=Math.pow($,le);we=Math.floor(Math.random()*Ce).toString($)+we}var Re=parseInt(we,$);return Re!==1/0&&Re>=Math.pow(2,R)?T(R,$):we};T.rack=function(R,$,K){var X=function(we){var Ce=0;do{if(Ce++>10){if(!K)throw new Error("too many ID collisions, use more bits");R+=K}var Re=T(R,$)}while(Object.hasOwnProperty.call(le,Re));return le[Re]=we,Re},le=X.hats={};return X.get=function(we){return X.hats[we]},X.set=function(we,Ce){return X.hats[we]=Ce,X},X.bits=R||128,X.base=$||16,X}}),et=function(y,T){this.ctx=y,this.properties=T.properties||{},this.coordinates=T.geometry.coordinates,this.id=T.id||$i(),this.type=T.geometry.type};et.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},et.prototype.incomingCoords=function(y){this.setCoordinates(y)},et.prototype.setCoordinates=function(y){this.coordinates=y,this.changed()},et.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},et.prototype.setProperty=function(y,T){this.properties[y]=T},et.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:Qt,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},et.prototype.internal=function(y){var T={id:this.id,meta:wi,"meta:type":this.type,active:Dt,mode:y};if(this.ctx.options.userProperties)for(var R in this.properties)T["user_"+R]=this.properties[R];return{type:Qt,properties:T,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var Gt=function(y,T){et.call(this,y,T)};(Gt.prototype=Object.create(et.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},Gt.prototype.updateCoordinate=function(y,T,R){this.coordinates=arguments.length===3?[T,R]:[y,T],this.changed()},Gt.prototype.getCoordinate=function(){return this.getCoordinates()};var jt=function(y,T){et.call(this,y,T)};(jt.prototype=Object.create(et.prototype)).isValid=function(){return this.coordinates.length>1},jt.prototype.addCoordinate=function(y,T,R){this.changed();var $=parseInt(y,10);this.coordinates.splice($,0,[T,R])},jt.prototype.getCoordinate=function(y){var T=parseInt(y,10);return JSON.parse(JSON.stringify(this.coordinates[T]))},jt.prototype.removeCoordinate=function(y){this.changed(),this.coordinates.splice(parseInt(y,10),1)},jt.prototype.updateCoordinate=function(y,T,R){var $=parseInt(y,10);this.coordinates[$]=[T,R],this.changed()};var Nr=function(y,T){et.call(this,y,T),this.coordinates=this.coordinates.map(function(R){return R.slice(0,-1)})};(Nr.prototype=Object.create(et.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(y){return y.length>2})},Nr.prototype.incomingCoords=function(y){this.coordinates=y.map(function(T){return T.slice(0,-1)}),this.changed()},Nr.prototype.setCoordinates=function(y){this.coordinates=y,this.changed()},Nr.prototype.addCoordinate=function(y,T,R){this.changed();var $=y.split(".").map(function(K){return parseInt(K,10)});this.coordinates[$[0]].splice($[1],0,[T,R])},Nr.prototype.removeCoordinate=function(y){this.changed();var T=y.split(".").map(function($){return parseInt($,10)}),R=this.coordinates[T[0]];R&&(R.splice(T[1],1),R.length<3&&this.coordinates.splice(T[0],1))},Nr.prototype.getCoordinate=function(y){var T=y.split(".").map(function($){return parseInt($,10)}),R=this.coordinates[T[0]];return JSON.parse(JSON.stringify(R[T[1]]))},Nr.prototype.getCoordinates=function(){return this.coordinates.map(function(y){return y.concat([y[0]])})},Nr.prototype.updateCoordinate=function(y,T,R){this.changed();var $=y.split("."),K=parseInt($[0],10),X=parseInt($[1],10);this.coordinates[K]===void 0&&(this.coordinates[K]=[]),this.coordinates[K][X]=[T,R]};var $o={MultiPoint:Gt,MultiLineString:jt,MultiPolygon:Nr},Bt=function(y,T,R,$,K){var X=R.split("."),le=parseInt(X[0],10),we=X[1]?X.slice(1).join("."):null;return y[le][T](we,$,K)},Jr=function(y,T){if(et.call(this,y,T),delete this.coordinates,this.model=$o[T.geometry.type],this.model===void 0)throw new TypeError(T.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(T.geometry.coordinates)};function ir(y){this.map=y.map,this.drawConfig=JSON.parse(JSON.stringify(y.options||{})),this._ctx=y}(Jr.prototype=Object.create(et.prototype))._coordinatesToFeatures=function(y){var T=this,R=this.model.bind(this);return y.map(function($){return new R(T.ctx,{id:$i(),type:Qt,properties:{},geometry:{coordinates:$,type:T.type.replace("Multi","")}})})},Jr.prototype.isValid=function(){return this.features.every(function(y){return y.isValid()})},Jr.prototype.setCoordinates=function(y){this.features=this._coordinatesToFeatures(y),this.changed()},Jr.prototype.getCoordinate=function(y){return Bt(this.features,"getCoordinate",y)},Jr.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(y){return y.type===ar?y.getCoordinates():y.coordinates})))},Jr.prototype.updateCoordinate=function(y,T,R){Bt(this.features,"updateCoordinate",y,T,R),this.changed()},Jr.prototype.addCoordinate=function(y,T,R){Bt(this.features,"addCoordinate",y,T,R),this.changed()},Jr.prototype.removeCoordinate=function(y){Bt(this.features,"removeCoordinate",y),this.changed()},Jr.prototype.getFeatures=function(){return this.features},ir.prototype.setSelected=function(y){return this._ctx.store.setSelected(y)},ir.prototype.setSelectedCoordinates=function(y){var T=this;this._ctx.store.setSelectedCoordinates(y),y.reduce(function(R,$){return R[$.feature_id]===void 0&&(R[$.feature_id]=!0,T._ctx.store.get($.feature_id).changed()),R},{})},ir.prototype.getSelected=function(){return this._ctx.store.getSelected()},ir.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},ir.prototype.isSelected=function(y){return this._ctx.store.isSelected(y)},ir.prototype.getFeature=function(y){return this._ctx.store.get(y)},ir.prototype.select=function(y){return this._ctx.store.select(y)},ir.prototype.deselect=function(y){return this._ctx.store.deselect(y)},ir.prototype.deleteFeature=function(y,T){return T===void 0&&(T={}),this._ctx.store.delete(y,T)},ir.prototype.addFeature=function(y){return this._ctx.store.add(y)},ir.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},ir.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},ir.prototype.setActionableState=function(y){y===void 0&&(y={});var T={trash:y.trash||!1,combineFeatures:y.combineFeatures||!1,uncombineFeatures:y.uncombineFeatures||!1};return this._ctx.events.actionable(T)},ir.prototype.changeMode=function(y,T,R){return T===void 0&&(T={}),R===void 0&&(R={}),this._ctx.events.changeMode(y,T,R)},ir.prototype.updateUIClasses=function(y){return this._ctx.ui.queueMapClasses(y)},ir.prototype.activateUIButton=function(y){return this._ctx.ui.setActiveButton(y)},ir.prototype.featuresAt=function(y,T,R){if(R===void 0&&(R="click"),R!=="click"&&R!=="touch")throw new Error("invalid buffer type");return tn[R](y,T,this._ctx)},ir.prototype.newFeature=function(y){var T=y.geometry.type;return T===Tr?new Gt(this._ctx,y):T===Xr?new jt(this._ctx,y):T===ar?new Nr(this._ctx,y):new Jr(this._ctx,y)},ir.prototype.isInstanceOf=function(y,T){if(y===Tr)return T instanceof Gt;if(y===Xr)return T instanceof jt;if(y===ar)return T instanceof Nr;if(y==="MultiFeature")return T instanceof Jr;throw new Error("Unknown feature class: "+y)},ir.prototype.doRender=function(y){return this._ctx.store.featureChanged(y)},ir.prototype.onSetup=function(){},ir.prototype.onDrag=function(){},ir.prototype.onClick=function(){},ir.prototype.onMouseMove=function(){},ir.prototype.onMouseDown=function(){},ir.prototype.onMouseUp=function(){},ir.prototype.onMouseOut=function(){},ir.prototype.onKeyUp=function(){},ir.prototype.onKeyDown=function(){},ir.prototype.onTouchStart=function(){},ir.prototype.onTouchMove=function(){},ir.prototype.onTouchEnd=function(){},ir.prototype.onTap=function(){},ir.prototype.onStop=function(){},ir.prototype.onTrash=function(){},ir.prototype.onCombineFeature=function(){},ir.prototype.onUncombineFeature=function(){},ir.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var lo={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},Yn=Object.keys(lo);function jn(y){var T=Object.keys(y);return function(R,$){$===void 0&&($={});var K={},X=T.reduce(function(le,we){return le[we]=y[we],le},new ir(R));return{start:function(){var le=this;K=X.onSetup($),Yn.forEach(function(we){var Ce,Re=lo[we],fe=function(){return!1};y[Re]&&(fe=function(){return!0}),le.on(we,fe,(Ce=Re,function($e){return X[Ce](K,$e)}))})},stop:function(){X.onStop(K)},trash:function(){X.onTrash(K)},combineFeatures:function(){X.onCombineFeatures(K)},uncombineFeatures:function(){X.onUncombineFeatures(K)},render:function(le,we){X.toDisplayFeatures(K,le,we)}}}}function Ir(y){return[].concat(y).filter(function(T){return T!==void 0})}function Ti(){var y=this;if(!(y.ctx.map&&y.ctx.map.getSource(ne)!==void 0))return Ce();var T=y.ctx.events.currentModeName();y.ctx.ui.queueMapClasses({mode:T});var R=[],$=[];y.isDirty?$=y.getAllIds():(R=y.getChangedIds().filter(function(Re){return y.get(Re)!==void 0}),$=y.sources.hot.filter(function(Re){return Re.properties.id&&R.indexOf(Re.properties.id)===-1&&y.get(Re.properties.id)!==void 0}).map(function(Re){return Re.properties.id})),y.sources.hot=[];var K=y.sources.cold.length;y.sources.cold=y.isDirty?[]:y.sources.cold.filter(function(Re){var fe=Re.properties.id||Re.properties.parent;return R.indexOf(fe)===-1});var X=K!==y.sources.cold.length||$.length>0;function le(Re,fe){var $e=y.get(Re).internal(T);y.ctx.events.currentModeRender($e,function(at){y.sources[fe].push(at)})}if(R.forEach(function(Re){return le(Re,"hot")}),$.forEach(function(Re){return le(Re,"cold")}),X&&y.ctx.map.getSource(Me).setData({type:sn,features:y.sources.cold}),y.ctx.map.getSource(ne).setData({type:sn,features:y.sources.hot}),y._emitSelectionChange&&(y.ctx.map.fire(yr,{features:y.getSelected().map(function(Re){return Re.toGeoJSON()}),points:y.getSelectedCoordinates().map(function(Re){return{type:Qt,properties:{},geometry:{type:Tr,coordinates:Re.coordinates}}})}),y._emitSelectionChange=!1),y._deletedFeaturesToEmit.length){var we=y._deletedFeaturesToEmit.map(function(Re){return Re.toGeoJSON()});y._deletedFeaturesToEmit=[],y.ctx.map.fire(Ar,{features:we})}function Ce(){y.isDirty=!1,y.clearChangedIds()}Ce(),y.ctx.map.fire(ji,{})}function xr(y){var T,R=this;this._features={},this._featureIds=new Tn,this._selectedFeatureIds=new Tn,this._selectedCoordinates=[],this._changedFeatureIds=new Tn,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=y,this.sources={hot:[],cold:[]},this.render=function(){T||(T=requestAnimationFrame(function(){T=null,Ti.call(R)}))},this.isDirty=!1}function bo(y,T){var R=y._selectedCoordinates.filter(function($){return y._selectedFeatureIds.has($.feature_id)});y._selectedCoordinates.length===R.length||T.silent||(y._emitSelectionChange=!0),y._selectedCoordinates=R}xr.prototype.createRenderBatch=function(){var y=this,T=this.render,R=0;return this.render=function(){R++},function(){y.render=T,R>0&&y.render()}},xr.prototype.setDirty=function(){return this.isDirty=!0,this},xr.prototype.featureChanged=function(y){return this._changedFeatureIds.add(y),this},xr.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},xr.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},xr.prototype.getAllIds=function(){return this._featureIds.values()},xr.prototype.add=function(y){return this.featureChanged(y.id),this._features[y.id]=y,this._featureIds.add(y.id),this},xr.prototype.delete=function(y,T){var R=this;return T===void 0&&(T={}),Ir(y).forEach(function($){R._featureIds.has($)&&(R._featureIds.delete($),R._selectedFeatureIds.delete($),T.silent||R._deletedFeaturesToEmit.indexOf(R._features[$])===-1&&R._deletedFeaturesToEmit.push(R._features[$]),delete R._features[$],R.isDirty=!0)}),bo(this,T),this},xr.prototype.get=function(y){return this._features[y]},xr.prototype.getAll=function(){var y=this;return Object.keys(this._features).map(function(T){return y._features[T]})},xr.prototype.select=function(y,T){var R=this;return T===void 0&&(T={}),Ir(y).forEach(function($){R._selectedFeatureIds.has($)||(R._selectedFeatureIds.add($),R._changedFeatureIds.add($),T.silent||(R._emitSelectionChange=!0))}),this},xr.prototype.deselect=function(y,T){var R=this;return T===void 0&&(T={}),Ir(y).forEach(function($){R._selectedFeatureIds.has($)&&(R._selectedFeatureIds.delete($),R._changedFeatureIds.add($),T.silent||(R._emitSelectionChange=!0))}),bo(this,T),this},xr.prototype.clearSelected=function(y){return y===void 0&&(y={}),this.deselect(this._selectedFeatureIds.values(),{silent:y.silent}),this},xr.prototype.setSelected=function(y,T){var R=this;return T===void 0&&(T={}),y=Ir(y),this.deselect(this._selectedFeatureIds.values().filter(function($){return y.indexOf($)===-1}),{silent:T.silent}),this.select(y.filter(function($){return!R._selectedFeatureIds.has($)}),{silent:T.silent}),this},xr.prototype.setSelectedCoordinates=function(y){return this._selectedCoordinates=y,this._emitSelectionChange=!0,this},xr.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},xr.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},xr.prototype.getSelected=function(){var y=this;return this._selectedFeatureIds.values().map(function(T){return y.get(T)})},xr.prototype.getSelectedCoordinates=function(){var y=this;return this._selectedCoordinates.map(function(T){return{coordinates:y.get(T.feature_id).getCoordinate(T.coord_path)}})},xr.prototype.isSelected=function(y){return this._selectedFeatureIds.has(y)},xr.prototype.setFeatureProperty=function(y,T,R){this.get(y).setProperty(T,R),this.featureChanged(y)},xr.prototype.storeMapConfig=function(){var y=this;Mr.forEach(function(T){y.ctx.map[T]&&(y._mapInitialConfig[T]=y.ctx.map[T].isEnabled())})},xr.prototype.restoreMapConfig=function(){var y=this;Object.keys(this._mapInitialConfig).forEach(function(T){y._mapInitialConfig[T]?y.ctx.map[T].enable():y.ctx.map[T].disable()})},xr.prototype.getInitialConfigValue=function(y){return this._mapInitialConfig[y]===void 0||this._mapInitialConfig[y]};var oe=function(){for(var y=arguments,T={},R=0;R<arguments.length;R++){var $=y[R];for(var K in $)j.call($,K)&&(T[K]=$[K])}return T},j=Object.prototype.hasOwnProperty,G=["mode","feature","mouse"];function ee(y){var T=null,R=null,$={onRemove:function(){return y.map.off("load",$.connect),clearInterval(R),$.removeLayers(),y.store.restoreMapConfig(),y.ui.removeButtons(),y.events.removeEventListeners(),y.ui.clearMapClasses(),y.map=null,y.container=null,y.store=null,T&&T.parentNode&&T.parentNode.removeChild(T),T=null,this},connect:function(){y.map.off("load",$.connect),clearInterval(R),$.addLayers(),y.store.storeMapConfig(),y.events.addEventListeners()},onAdd:function(K){var X=K.fire;return K.fire=function(le,we){var Ce=arguments;return X.length===1&&arguments.length!==1&&(Ce=[oe({},{type:le},we)]),X.apply(K,Ce)},y.map=K,y.events=function(le){var we=Object.keys(le.options.modes).reduce(function(Pe,rt){return Pe[rt]=jn(le.options.modes[rt]),Pe},{}),Ce={},Re={},fe={},$e=null,at=null;fe.drag=function(Pe,rt){rt({point:Pe.point,time:new Date().getTime()})?(le.ui.queueMapClasses({mouse:Qe}),at.drag(Pe)):Pe.originalEvent.stopPropagation()},fe.mousedrag=function(Pe){fe.drag(Pe,function(rt){return!_n(Ce,rt)})},fe.touchdrag=function(Pe){fe.drag(Pe,function(rt){return!Jn(Re,rt)})},fe.mousemove=function(Pe){if((Pe.originalEvent.buttons!==void 0?Pe.originalEvent.buttons:Pe.originalEvent.which)===1)return fe.mousedrag(Pe);var rt=ao(Pe,le);Pe.featureTarget=rt,at.mousemove(Pe)},fe.mousedown=function(Pe){Ce={time:new Date().getTime(),point:Pe.point};var rt=ao(Pe,le);Pe.featureTarget=rt,at.mousedown(Pe)},fe.mouseup=function(Pe){var rt=ao(Pe,le);Pe.featureTarget=rt,_n(Ce,{point:Pe.point,time:new Date().getTime()})?at.click(Pe):at.mouseup(Pe)},fe.mouseout=function(Pe){at.mouseout(Pe)},fe.touchstart=function(Pe){if(Pe.originalEvent.preventDefault(),le.options.touchEnabled){Re={time:new Date().getTime(),point:Pe.point};var rt=tn.touch(Pe,null,le)[0];Pe.featureTarget=rt,at.touchstart(Pe)}},fe.touchmove=function(Pe){if(Pe.originalEvent.preventDefault(),le.options.touchEnabled)return at.touchmove(Pe),fe.touchdrag(Pe)},fe.touchend=function(Pe){if(Pe.originalEvent.preventDefault(),le.options.touchEnabled){var rt=tn.touch(Pe,null,le)[0];Pe.featureTarget=rt,Jn(Re,{time:new Date().getTime(),point:Pe.point})?at.tap(Pe):at.touchend(Pe)}};var tt=function(Pe){return!(Pe===8||Pe===46||Pe>=48&&Pe<=57)};function Tt(Pe,rt,rr){rr===void 0&&(rr={}),at.stop();var Ot=we[Pe];if(Ot===void 0)throw new Error(Pe+" is not valid");$e=Pe;var vr=Ot(le,rt);at=r(vr,le),rr.silent||le.map.fire(Dn,{mode:Pe}),le.store.setDirty(),le.store.render()}fe.keydown=function(Pe){(Pe.srcElement||Pe.target).classList[0]==="mapboxgl-canvas"&&(Pe.keyCode!==8&&Pe.keyCode!==46||!le.options.controls.trash?tt(Pe.keyCode)?at.keydown(Pe):Pe.keyCode===49&&le.options.controls.point?Tt(mt.DRAW_POINT):Pe.keyCode===50&&le.options.controls.line_string?Tt(mt.DRAW_LINE_STRING):Pe.keyCode===51&&le.options.controls.polygon&&Tt(mt.DRAW_POLYGON):(Pe.preventDefault(),at.trash()))},fe.keyup=function(Pe){tt(Pe.keyCode)&&at.keyup(Pe)},fe.zoomend=function(){le.store.changeZoom()},fe.data=function(Pe){if(Pe.dataType==="style"){var rt=le.setup,rr=le.map,Ot=le.options,vr=le.store;Ot.styles.some(function(Ft){return rr.getLayer(Ft.id)})||(rt.addLayers(),vr.setDirty(),vr.render())}};var Be={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){$e=le.options.defaultMode,at=r(we[$e](le),le)},changeMode:Tt,actionable:function(Pe){var rt=!1;Object.keys(Pe).forEach(function(rr){if(Be[rr]===void 0)throw new Error("Invalid action type");Be[rr]!==Pe[rr]&&(rt=!0),Be[rr]=Pe[rr]}),rt&&le.map.fire(dn,{actions:Be})},currentModeName:function(){return $e},currentModeRender:function(Pe,rt){return at.render(Pe,rt)},fire:function(Pe,rt){fe[Pe]&&fe[Pe](rt)},addEventListeners:function(){le.map.on("mousemove",fe.mousemove),le.map.on("mousedown",fe.mousedown),le.map.on("mouseup",fe.mouseup),le.map.on("data",fe.data),le.map.on("touchmove",fe.touchmove),le.map.on("touchstart",fe.touchstart),le.map.on("touchend",fe.touchend),le.container.addEventListener("mouseout",fe.mouseout),le.options.keybindings&&(le.container.addEventListener("keydown",fe.keydown),le.container.addEventListener("keyup",fe.keyup))},removeEventListeners:function(){le.map.off("mousemove",fe.mousemove),le.map.off("mousedown",fe.mousedown),le.map.off("mouseup",fe.mouseup),le.map.off("data",fe.data),le.map.off("touchmove",fe.touchmove),le.map.off("touchstart",fe.touchstart),le.map.off("touchend",fe.touchend),le.container.removeEventListener("mouseout",fe.mouseout),le.options.keybindings&&(le.container.removeEventListener("keydown",fe.keydown),le.container.removeEventListener("keyup",fe.keyup))},trash:function(Pe){at.trash(Pe)},combineFeatures:function(){at.combineFeatures()},uncombineFeatures:function(){at.uncombineFeatures()},getMode:function(){return $e}}}(y),y.ui=function(le){var we={},Ce=null,Re={mode:null,feature:null,mouse:null},fe={mode:null,feature:null,mouse:null};function $e(Pe){fe=oe(fe,Pe)}function at(){var Pe,rt;if(le.container){var rr=[],Ot=[];G.forEach(function(vr){fe[vr]!==Re[vr]&&(rr.push(vr+"-"+Re[vr]),fe[vr]!==null&&Ot.push(vr+"-"+fe[vr]))}),rr.length>0&&(Pe=le.container.classList).remove.apply(Pe,rr),Ot.length>0&&(rt=le.container.classList).add.apply(rt,Ot),Re=oe(Re,fe)}}function tt(Pe,rt){rt===void 0&&(rt={});var rr=document.createElement("button");return rr.className=m+" "+rt.className,rr.setAttribute("title",rt.title),rt.container.appendChild(rr),rr.addEventListener("click",function(Ot){if(Ot.preventDefault(),Ot.stopPropagation(),Ot.target===Ce)return Tt(),void rt.onDeactivate();Be(Pe),rt.onActivate()},!0),rr}function Tt(){Ce&&(Ce.classList.remove(Q),Ce=null)}function Be(Pe){Tt();var rt=we[Pe];rt&&rt&&Pe!=="trash"&&(rt.classList.add(Q),Ce=rt)}return{setActiveButton:Be,queueMapClasses:$e,updateMapClasses:at,clearMapClasses:function(){$e({mode:null,feature:null,mouse:null}),at()},addButtons:function(){var Pe=le.options.controls,rt=document.createElement("div");return rt.className=ye+" "+E,Pe&&(Pe[st.LINE]&&(we[st.LINE]=tt(st.LINE,{container:rt,className:S,title:"LineString tool "+(le.options.keybindings?"(l)":""),onActivate:function(){return le.events.changeMode(mt.DRAW_LINE_STRING)},onDeactivate:function(){return le.events.trash()}})),Pe[st.POLYGON]&&(we[st.POLYGON]=tt(st.POLYGON,{container:rt,className:M,title:"Polygon tool "+(le.options.keybindings?"(p)":""),onActivate:function(){return le.events.changeMode(mt.DRAW_POLYGON)},onDeactivate:function(){return le.events.trash()}})),Pe[st.POINT]&&(we[st.POINT]=tt(st.POINT,{container:rt,className:z,title:"Marker tool "+(le.options.keybindings?"(m)":""),onActivate:function(){return le.events.changeMode(mt.DRAW_POINT)},onDeactivate:function(){return le.events.trash()}})),Pe.trash&&(we.trash=tt("trash",{container:rt,className:H,title:"Delete",onActivate:function(){le.events.trash()}})),Pe.combine_features&&(we.combine_features=tt("combineFeatures",{container:rt,className:q,title:"Combine",onActivate:function(){le.events.combineFeatures()}})),Pe.uncombine_features&&(we.uncombine_features=tt("uncombineFeatures",{container:rt,className:Y,title:"Uncombine",onActivate:function(){le.events.uncombineFeatures()}}))),rt},removeButtons:function(){Object.keys(we).forEach(function(Pe){var rt=we[Pe];rt.parentNode&&rt.parentNode.removeChild(rt),delete we[Pe]})}}}(y),y.container=K.getContainer(),y.store=new xr(y),T=y.ui.addButtons(),y.options.boxSelect&&(K.boxZoom.disable(),K.dragPan.disable(),K.dragPan.enable()),K.loaded()?$.connect():(K.on("load",$.connect),R=setInterval(function(){K.loaded()&&$.connect()},16)),y.events.start(),T},addLayers:function(){y.map.addSource(Me,{data:{type:sn,features:[]},type:"geojson"}),y.map.addSource(ne,{data:{type:sn,features:[]},type:"geojson"}),y.options.styles.forEach(function(K){y.map.addLayer(K)}),y.store.setDirty(!0),y.store.render()},removeLayers:function(){y.options.styles.forEach(function(K){y.map.getLayer(K.id)&&y.map.removeLayer(K.id)}),y.map.getSource(Me)&&y.map.removeSource(Me),y.map.getSource(ne)&&y.map.removeSource(ne)}};return y.setup=$,$}function ce(y){return function(T){var R=T.featureTarget;return!!R&&!!R.properties&&R.properties.meta===y}}function me(y){return!!y.featureTarget&&!!y.featureTarget.properties&&y.featureTarget.properties.active===Ei&&y.featureTarget.properties.meta===wi}function be(y){return!!y.featureTarget&&!!y.featureTarget.properties&&y.featureTarget.properties.active===Dt&&y.featureTarget.properties.meta===wi}function ve(y){return y.featureTarget===void 0}function pe(y){var T=y.featureTarget;return!!T&&!!T.properties&&T.properties.meta===Xn}function Te(y){return!!y.originalEvent&&y.originalEvent.shiftKey===!0}function He(y){return y.keyCode===27}function We(y){return y.keyCode===13}var Ze=Pt;function Pt(y,T){this.x=y,this.y=T}function Zt(y,T){var R=T.getBoundingClientRect();return new Ze(y.clientX-R.left-(T.clientLeft||0),y.clientY-R.top-(T.clientTop||0))}function xt(y,T,R,$){return{type:Qt,properties:{meta:Xn,parent:y,coord_path:R,active:$?Ei:Dt},geometry:{type:Tr,coordinates:T}}}function Mt(y,T,R){T===void 0&&(T={}),R===void 0&&(R=null);var $,K=y.geometry,X=K.type,le=K.coordinates,we=y.properties&&y.properties.id,Ce=[];function Re($e,at){var tt="",Tt=null;$e.forEach(function(Be,Pe){var rt=at!=null?at+"."+Pe:String(Pe),rr=xt(we,Be,rt,fe(rt));if(T.midpoints&&Tt){var Ot=function(Ft,Pr,Gi){var Cr=Pr.geometry.coordinates,In=Gi.geometry.coordinates;if(Cr[1]>85||Cr[1]<-85||In[1]>85||In[1]<-85)return null;var Ln={lng:(Cr[0]+In[0])/2,lat:(Cr[1]+In[1])/2};return{type:Qt,properties:{meta:Ue,parent:Ft,lng:Ln.lng,lat:Ln.lat,coord_path:Gi.properties.coord_path},geometry:{type:Tr,coordinates:[Ln.lng,Ln.lat]}}}(we,Tt,rr);Ot&&Ce.push(Ot)}Tt=rr;var vr=JSON.stringify(Be);tt!==vr&&Ce.push(rr),Pe===0&&(tt=vr)})}function fe($e){return!!T.selectedPaths&&T.selectedPaths.indexOf($e)!==-1}return X===Tr?Ce.push(xt(we,le,R,fe(R))):X===ar?le.forEach(function($e,at){Re($e,R!==null?R+"."+at:String(at))}):X===Xr?Re(le,R):X.indexOf(qr)===0&&($=X.replace(qr,""),le.forEach(function($e,at){var tt={type:Qt,properties:y.properties,geometry:{type:$,coordinates:$e}};Ce=Ce.concat(Mt(tt,T,at))})),Ce}Pt.prototype={clone:function(){return new Pt(this.x,this.y)},add:function(y){return this.clone()._add(y)},sub:function(y){return this.clone()._sub(y)},multByPoint:function(y){return this.clone()._multByPoint(y)},divByPoint:function(y){return this.clone()._divByPoint(y)},mult:function(y){return this.clone()._mult(y)},div:function(y){return this.clone()._div(y)},rotate:function(y){return this.clone()._rotate(y)},rotateAround:function(y,T){return this.clone()._rotateAround(y,T)},matMult:function(y){return this.clone()._matMult(y)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(y){return this.x===y.x&&this.y===y.y},dist:function(y){return Math.sqrt(this.distSqr(y))},distSqr:function(y){var T=y.x-this.x,R=y.y-this.y;return T*T+R*R},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(y){return Math.atan2(this.y-y.y,this.x-y.x)},angleWith:function(y){return this.angleWithSep(y.x,y.y)},angleWithSep:function(y,T){return Math.atan2(this.x*T-this.y*y,this.x*y+this.y*T)},_matMult:function(y){var T=y[0]*this.x+y[1]*this.y,R=y[2]*this.x+y[3]*this.y;return this.x=T,this.y=R,this},_add:function(y){return this.x+=y.x,this.y+=y.y,this},_sub:function(y){return this.x-=y.x,this.y-=y.y,this},_mult:function(y){return this.x*=y,this.y*=y,this},_div:function(y){return this.x/=y,this.y/=y,this},_multByPoint:function(y){return this.x*=y.x,this.y*=y.y,this},_divByPoint:function(y){return this.x/=y.x,this.y/=y.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var y=this.y;return this.y=this.x,this.x=-y,this},_rotate:function(y){var T=Math.cos(y),R=Math.sin(y),$=T*this.x-R*this.y,K=R*this.x+T*this.y;return this.x=$,this.y=K,this},_rotateAround:function(y,T){var R=Math.cos(y),$=Math.sin(y),K=T.x+R*(this.x-T.x)-$*(this.y-T.y),X=T.y+$*(this.x-T.x)+R*(this.y-T.y);return this.x=K,this.y=X,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Pt.convert=function(y){return y instanceof Pt?y:Array.isArray(y)?new Pt(y[0],y[1]):y};var $t=function(y){setTimeout(function(){y.map&&y.map.doubleClickZoom&&y._ctx&&y._ctx.store&&y._ctx.store.getInitialConfigValue&&y._ctx.store.getInitialConfigValue("doubleClickZoom")&&y.map.doubleClickZoom.enable()},0)},Kt=function(y){setTimeout(function(){y.map&&y.map.doubleClickZoom&&y.map.doubleClickZoom.disable()},0)},sr=function(y){if(!y||!y.type)return null;var T=Br[y.type];if(!T)return null;if(T==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:y}]};if(T==="feature")return{type:"FeatureCollection",features:[y]};if(T==="featurecollection")return y},Br={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function Ur(y){switch(y&&y.type||null){case"FeatureCollection":return y.features=y.features.reduce(function(T,R){return T.concat(Ur(R))},[]),y;case"Feature":return y.geometry?Ur(y.geometry).map(function(T){var R={type:"Feature",properties:JSON.parse(JSON.stringify(y.properties)),geometry:T};return y.id!==void 0&&(R.id=y.id),R}):[y];case"MultiPoint":return y.coordinates.map(function(T){return{type:"Point",coordinates:T}});case"MultiPolygon":return y.coordinates.map(function(T){return{type:"Polygon",coordinates:T}});case"MultiLineString":return y.coordinates.map(function(T){return{type:"LineString",coordinates:T}});case"GeometryCollection":return y.geometries.map(Ur).reduce(function(T,R){return T.concat(R)},[]);case"Point":case"Polygon":case"LineString":return[y]}}var tr=function(y){if(!y)return[];var T=Ur(sr(y)),R=[];return T.features.forEach(function($){$.geometry&&(R=R.concat(function K(X){return Array.isArray(X)&&X.length&&typeof X[0]=="number"?[X]:X.reduce(function(le,we){return Array.isArray(we)&&Array.isArray(we[0])?le.concat(K(we)):(le.push(we),le)},[])}($.geometry.coordinates)))}),R},an=Si(function(y){var T=y.exports=function(fe){return new R(fe)};function R(fe){this.value=fe}function $(fe,$e,at){var tt=[],Tt=[],Be=!0;return function Pe(rt){var rr=at?K(rt):rt,Ot={},vr=!0,Ft={node:rr,node_:rt,path:[].concat(tt),parent:Tt[Tt.length-1],parents:Tt,key:tt.slice(-1)[0],isRoot:tt.length===0,level:tt.length,circular:null,update:function(Cr,In){Ft.isRoot||(Ft.parent.node[Ft.key]=Cr),Ft.node=Cr,In&&(vr=!1)},delete:function(Cr){delete Ft.parent.node[Ft.key],Cr&&(vr=!1)},remove:function(Cr){we(Ft.parent.node)?Ft.parent.node.splice(Ft.key,1):delete Ft.parent.node[Ft.key],Cr&&(vr=!1)},keys:null,before:function(Cr){Ot.before=Cr},after:function(Cr){Ot.after=Cr},pre:function(Cr){Ot.pre=Cr},post:function(Cr){Ot.post=Cr},stop:function(){Be=!1},block:function(){vr=!1}};if(!Be)return Ft;function Pr(){if(typeof Ft.node=="object"&&Ft.node!==null){Ft.keys&&Ft.node_===Ft.node||(Ft.keys=X(Ft.node)),Ft.isLeaf=Ft.keys.length==0;for(var Cr=0;Cr<Tt.length;Cr++)if(Tt[Cr].node_===rt){Ft.circular=Tt[Cr];break}}else Ft.isLeaf=!0,Ft.keys=null;Ft.notLeaf=!Ft.isLeaf,Ft.notRoot=!Ft.isRoot}Pr();var Gi=$e.call(Ft,Ft.node);return Gi!==void 0&&Ft.update&&Ft.update(Gi),Ot.before&&Ot.before.call(Ft,Ft.node),vr&&(typeof Ft.node!="object"||Ft.node===null||Ft.circular||(Tt.push(Ft),Pr(),Ce(Ft.keys,function(Cr,In){tt.push(Cr),Ot.pre&&Ot.pre.call(Ft,Ft.node[Cr],Cr);var Ln=Pe(Ft.node[Cr]);at&&Re.call(Ft.node,Cr)&&(Ft.node[Cr]=Ln.node),Ln.isLast=In==Ft.keys.length-1,Ln.isFirst=In==0,Ot.post&&Ot.post.call(Ft,Ln),tt.pop()}),Tt.pop()),Ot.after&&Ot.after.call(Ft,Ft.node)),Ft}(fe).node}function K(fe){if(typeof fe=="object"&&fe!==null){var $e;if(we(fe))$e=[];else if(le(fe)==="[object Date]")$e=new Date(fe.getTime?fe.getTime():fe);else if(function(Tt){return le(Tt)==="[object RegExp]"}(fe))$e=new RegExp(fe);else if(function(Tt){return le(Tt)==="[object Error]"}(fe))$e={message:fe.message};else if(function(Tt){return le(Tt)==="[object Boolean]"}(fe))$e=new Boolean(fe);else if(function(Tt){return le(Tt)==="[object Number]"}(fe))$e=new Number(fe);else if(function(Tt){return le(Tt)==="[object String]"}(fe))$e=new String(fe);else if(Object.create&&Object.getPrototypeOf)$e=Object.create(Object.getPrototypeOf(fe));else if(fe.constructor===Object)$e={};else{var at=fe.constructor&&fe.constructor.prototype||fe.__proto__||{},tt=function(){};tt.prototype=at,$e=new tt}return Ce(X(fe),function(Tt){$e[Tt]=fe[Tt]}),$e}return fe}R.prototype.get=function(fe){for(var $e=this.value,at=0;at<fe.length;at++){var tt=fe[at];if(!$e||!Re.call($e,tt)){$e=void 0;break}$e=$e[tt]}return $e},R.prototype.has=function(fe){for(var $e=this.value,at=0;at<fe.length;at++){var tt=fe[at];if(!$e||!Re.call($e,tt))return!1;$e=$e[tt]}return!0},R.prototype.set=function(fe,$e){for(var at=this.value,tt=0;tt<fe.length-1;tt++){var Tt=fe[tt];Re.call(at,Tt)||(at[Tt]={}),at=at[Tt]}return at[fe[tt]]=$e,$e},R.prototype.map=function(fe){return $(this.value,fe,!0)},R.prototype.forEach=function(fe){return this.value=$(this.value,fe,!1),this.value},R.prototype.reduce=function(fe,$e){var at=arguments.length===1,tt=at?this.value:$e;return this.forEach(function(Tt){this.isRoot&&at||(tt=fe.call(this,tt,Tt))}),tt},R.prototype.paths=function(){var fe=[];return this.forEach(function($e){fe.push(this.path)}),fe},R.prototype.nodes=function(){var fe=[];return this.forEach(function($e){fe.push(this.node)}),fe},R.prototype.clone=function(){var fe=[],$e=[];return function at(tt){for(var Tt=0;Tt<fe.length;Tt++)if(fe[Tt]===tt)return $e[Tt];if(typeof tt=="object"&&tt!==null){var Be=K(tt);return fe.push(tt),$e.push(Be),Ce(X(tt),function(Pe){Be[Pe]=at(tt[Pe])}),fe.pop(),$e.pop(),Be}return tt}(this.value)};var X=Object.keys||function(fe){var $e=[];for(var at in fe)$e.push(at);return $e};function le(fe){return Object.prototype.toString.call(fe)}var we=Array.isArray||function(fe){return Object.prototype.toString.call(fe)==="[object Array]"},Ce=function(fe,$e){if(fe.forEach)return fe.forEach($e);for(var at=0;at<fe.length;at++)$e(fe[at],at,fe)};Ce(X(R.prototype),function(fe){T[fe]=function($e){var at=[].slice.call(arguments,1),tt=new R($e);return tt[fe].apply(tt,at)}});var Re=Object.hasOwnProperty||function(fe,$e){return $e in fe}}),ln=Rr;function Rr(y){if(!(this instanceof Rr))return new Rr(y);this._bbox=y||[1/0,1/0,-1/0,-1/0],this._valid=!!y}Rr.prototype.include=function(y){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],y[0]),this._bbox[1]=Math.min(this._bbox[1],y[1]),this._bbox[2]=Math.max(this._bbox[2],y[0]),this._bbox[3]=Math.max(this._bbox[3],y[1]),this},Rr.prototype.equals=function(y){var T;return T=y instanceof Rr?y.bbox():y,this._bbox[0]==T[0]&&this._bbox[1]==T[1]&&this._bbox[2]==T[2]&&this._bbox[3]==T[3]},Rr.prototype.center=function(y){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},Rr.prototype.union=function(y){var T;return this._valid=!0,T=y instanceof Rr?y.bbox():y,this._bbox[0]=Math.min(this._bbox[0],T[0]),this._bbox[1]=Math.min(this._bbox[1],T[1]),this._bbox[2]=Math.max(this._bbox[2],T[2]),this._bbox[3]=Math.max(this._bbox[3],T[3]),this},Rr.prototype.bbox=function(){return this._valid?this._bbox:null},Rr.prototype.contains=function(y){if(!y)return this._fastContains();if(!this._valid)return null;var T=y[0],R=y[1];return this._bbox[0]<=T&&this._bbox[1]<=R&&this._bbox[2]>=T&&this._bbox[3]>=R},Rr.prototype.intersect=function(y){return this._valid?(T=y instanceof Rr?y.bbox():y,!(this._bbox[0]>T[2]||this._bbox[2]<T[0]||this._bbox[3]<T[1]||this._bbox[1]>T[3])):null;var T},Rr.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var y="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",y)},Rr.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var Cn={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},Ci=Object.keys(Cn),aa=function(y){return Yr(y).bbox()};function Yr(y){for(var T=ln(),R=tr(y),$=0;$<R.length;$++)T.include(R[$]);return T}aa.polygon=function(y){return Yr(y).polygon()},aa.bboxify=function(y){return an(y).map(function(T){T&&Ci.some(function(R){return!!T[R]&&Cn[R].indexOf(T.type)!==-1})&&(T.bbox=Yr(T).bbox(),this.update(T))})};function xn(y,T){var R=-90,$=90,K=-90,X=90,le=270,we=-270;y.forEach(function(Re){var fe=aa(Re),$e=fe[1],at=fe[3],tt=fe[0],Tt=fe[2];$e>R&&(R=$e),at<$&&($=at),at>K&&(K=at),$e<X&&(X=$e),tt<le&&(le=tt),Tt>we&&(we=Tt)});var Ce=T;return R+Ce.lat>85&&(Ce.lat=85-R),K+Ce.lat>90&&(Ce.lat=90-K),$+Ce.lat<-85&&(Ce.lat=-85-$),X+Ce.lat<-90&&(Ce.lat=-90-X),le+Ce.lng<=-270&&(Ce.lng+=360*Math.ceil(Math.abs(Ce.lng)/360)),we+Ce.lng>=270&&(Ce.lng-=360*Math.ceil(Math.abs(Ce.lng)/360)),Ce}function Rs(y,T){var R=xn(y.map(function($){return $.toGeoJSON()}),T);y.forEach(function($){var K,X=$.getCoordinates(),le=function(Ce){var Re={lng:Ce[0]+R.lng,lat:Ce[1]+R.lat};return[Re.lng,Re.lat]},we=function(Ce){return Ce.map(function(Re){return le(Re)})};$.type===Tr?K=le(X):$.type===Xr||$.type===Un?K=X.map(le):$.type===ar||$.type===pt?K=X.map(we):$.type===Nt&&(K=X.map(function(Ce){return Ce.map(function(Re){return we(Re)})})),$.incomingCoords(K)})}var zr={onSetup:function(y){var T=this,R={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:y.featureIds||[]};return this.setSelected(R.initiallySelectedFeatureIds.filter(function($){return T.getFeature($)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),R},fireUpdate:function(){this.map.fire(Lr,{action:er,features:this.getSelected().map(function(y){return y.toGeoJSON()})})},fireActionable:function(){var y=this,T=this.getSelected(),R=T.filter(function(we){return y.isInstanceOf("MultiFeature",we)}),$=!1;if(T.length>1){$=!0;var K=T[0].type.replace("Multi","");T.forEach(function(we){we.type.replace("Multi","")!==K&&($=!1)})}var X=R.length>0,le=T.length>0;this.setActionableState({combineFeatures:$,uncombineFeatures:X,trash:le})},getUniqueIds:function(y){return y.length?y.map(function(T){return T.properties.id}).filter(function(T){return T!==void 0}).reduce(function(T,R){return T.add(R),T},new Tn).values():[]},stopExtendedInteractions:function(y){y.boxSelectElement&&(y.boxSelectElement.parentNode&&y.boxSelectElement.parentNode.removeChild(y.boxSelectElement),y.boxSelectElement=null),this.map.dragPan.enable(),y.boxSelecting=!1,y.canBoxSelect=!1,y.dragMoving=!1,y.canDragMove=!1},onStop:function(){$t(this)},onMouseMove:function(y){return this.stopExtendedInteractions(y),!0},onMouseOut:function(y){return!y.dragMoving||this.fireUpdate()}};zr.onTap=zr.onClick=function(y,T){return ve(T)?this.clickAnywhere(y,T):ce(Xn)(T)?this.clickOnVertex(y,T):function(R){return!!R.featureTarget&&!!R.featureTarget.properties&&R.featureTarget.properties.meta===wi}(T)?this.clickOnFeature(y,T):void 0},zr.clickAnywhere=function(y){var T=this,R=this.getSelectedIds();R.length&&(this.clearSelectedFeatures(),R.forEach(function($){return T.doRender($)})),$t(this),this.stopExtendedInteractions(y)},zr.clickOnVertex=function(y,T){this.changeMode(mt.DIRECT_SELECT,{featureId:T.featureTarget.properties.parent,coordPath:T.featureTarget.properties.coord_path,startPos:T.lngLat}),this.updateUIClasses({mouse:je})},zr.startOnActiveFeature=function(y,T){this.stopExtendedInteractions(y),this.map.dragPan.disable(),this.doRender(T.featureTarget.properties.id),y.canDragMove=!0,y.dragMoveLocation=T.lngLat},zr.clickOnFeature=function(y,T){var R=this;Kt(this),this.stopExtendedInteractions(y);var $=Te(T),K=this.getSelectedIds(),X=T.featureTarget.properties.id,le=this.isSelected(X);if(!$&&le&&this.getFeature(X).type!==Tr)return this.changeMode(mt.DIRECT_SELECT,{featureId:X});le&&$?(this.deselect(X),this.updateUIClasses({mouse:ot}),K.length===1&&$t(this)):!le&&$?(this.select(X),this.updateUIClasses({mouse:je})):le||$||(K.forEach(function(we){return R.doRender(we)}),this.setSelected(X),this.updateUIClasses({mouse:je})),this.doRender(X)},zr.onMouseDown=function(y,T){return me(T)?this.startOnActiveFeature(y,T):this.drawConfig.boxSelect&&function(R){return!!R.originalEvent&&!!R.originalEvent.shiftKey&&R.originalEvent.button===0}(T)?this.startBoxSelect(y,T):void 0},zr.startBoxSelect=function(y,T){this.stopExtendedInteractions(y),this.map.dragPan.disable(),y.boxSelectStartLocation=Zt(T.originalEvent,this.map.getContainer()),y.canBoxSelect=!0},zr.onTouchStart=function(y,T){if(me(T))return this.startOnActiveFeature(y,T)},zr.onDrag=function(y,T){return y.canDragMove?this.dragMove(y,T):this.drawConfig.boxSelect&&y.canBoxSelect?this.whileBoxSelect(y,T):void 0},zr.whileBoxSelect=function(y,T){y.boxSelecting=!0,this.updateUIClasses({mouse:Ve}),y.boxSelectElement||(y.boxSelectElement=document.createElement("div"),y.boxSelectElement.classList.add(te),this.map.getContainer().appendChild(y.boxSelectElement));var R=Zt(T.originalEvent,this.map.getContainer()),$=Math.min(y.boxSelectStartLocation.x,R.x),K=Math.max(y.boxSelectStartLocation.x,R.x),X=Math.min(y.boxSelectStartLocation.y,R.y),le=Math.max(y.boxSelectStartLocation.y,R.y),we="translate("+$+"px, "+X+"px)";y.boxSelectElement.style.transform=we,y.boxSelectElement.style.WebkitTransform=we,y.boxSelectElement.style.width=K-$+"px",y.boxSelectElement.style.height=le-X+"px"},zr.dragMove=function(y,T){y.dragMoving=!0,T.originalEvent.stopPropagation();var R={lng:T.lngLat.lng-y.dragMoveLocation.lng,lat:T.lngLat.lat-y.dragMoveLocation.lat};Rs(this.getSelected(),R),y.dragMoveLocation=T.lngLat},zr.onMouseUp=function(y,T){var R=this;if(y.dragMoving)this.fireUpdate();else if(y.boxSelecting){var $=[y.boxSelectStartLocation,Zt(T.originalEvent,this.map.getContainer())],K=this.featuresAt(null,$,"click"),X=this.getUniqueIds(K).filter(function(le){return!R.isSelected(le)});X.length&&(this.select(X),X.forEach(function(le){return R.doRender(le)}),this.updateUIClasses({mouse:je}))}this.stopExtendedInteractions(y)},zr.toDisplayFeatures=function(y,T,R){T.properties.active=this.isSelected(T.properties.id)?Ei:Dt,R(T),this.fireActionable(),T.properties.active===Ei&&T.geometry.type!==Tr&&Mt(T).forEach(R)},zr.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},zr.onCombineFeatures=function(){var y=this.getSelected();if(!(y.length===0||y.length<2)){for(var T=[],R=[],$=y[0].type.replace("Multi",""),K=0;K<y.length;K++){var X=y[K];if(X.type.replace("Multi","")!==$)return;X.type.includes("Multi")?X.getCoordinates().forEach(function(we){T.push(we)}):T.push(X.getCoordinates()),R.push(X.toGeoJSON())}if(R.length>1){var le=this.newFeature({type:Qt,properties:R[0].properties,geometry:{type:"Multi"+$,coordinates:T}});this.addFeature(le),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([le.id]),this.map.fire(jo,{createdFeatures:[le.toGeoJSON()],deletedFeatures:R})}this.fireActionable()}},zr.onUncombineFeatures=function(){var y=this,T=this.getSelected();if(T.length!==0){for(var R=[],$=[],K=function(le){var we=T[le];y.isInstanceOf("MultiFeature",we)&&(we.getFeatures().forEach(function(Ce){y.addFeature(Ce),Ce.properties=we.properties,R.push(Ce.toGeoJSON()),y.select([Ce.id])}),y.deleteFeature(we.id,{silent:!0}),$.push(we.toGeoJSON()))},X=0;X<T.length;X++)K(X);R.length>1&&this.map.fire(vn,{createdFeatures:R,deletedFeatures:$}),this.fireActionable()}};var Hr=ce(Xn),wo=ce(Ue),fn={fireUpdate:function(){this.map.fire(Lr,{action:so,features:this.getSelected().map(function(y){return y.toGeoJSON()})})},fireActionable:function(y){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:y.selectedCoordPaths.length>0})},startDragging:function(y,T){this.map.dragPan.disable(),y.canDragMove=!0,y.dragMoveLocation=T.lngLat},stopDragging:function(y){this.map.dragPan.enable(),y.dragMoving=!1,y.canDragMove=!1,y.dragMoveLocation=null},onVertex:function(y,T){this.startDragging(y,T);var R=T.featureTarget.properties,$=y.selectedCoordPaths.indexOf(R.coord_path);Te(T)||$!==-1?Te(T)&&$===-1&&y.selectedCoordPaths.push(R.coord_path):y.selectedCoordPaths=[R.coord_path];var K=this.pathsToCoordinates(y.featureId,y.selectedCoordPaths);this.setSelectedCoordinates(K)},onMidpoint:function(y,T){this.startDragging(y,T);var R=T.featureTarget.properties;y.feature.addCoordinate(R.coord_path,R.lng,R.lat),this.fireUpdate(),y.selectedCoordPaths=[R.coord_path]},pathsToCoordinates:function(y,T){return T.map(function(R){return{feature_id:y,coord_path:R}})},onFeature:function(y,T){y.selectedCoordPaths.length===0?this.startDragging(y,T):this.stopDragging(y)},dragFeature:function(y,T,R){Rs(this.getSelected(),R),y.dragMoveLocation=T.lngLat},dragVertex:function(y,T,R){for(var $=y.selectedCoordPaths.map(function(we){return y.feature.getCoordinate(we)}),K=xn($.map(function(we){return{type:Qt,properties:{},geometry:{type:Tr,coordinates:we}}}),R),X=0;X<$.length;X++){var le=$[X];y.feature.updateCoordinate(y.selectedCoordPaths[X],le[0]+K.lng,le[1]+K.lat)}},clickNoTarget:function(){this.changeMode(mt.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(mt.SIMPLE_SELECT)},clickActiveFeature:function(y){y.selectedCoordPaths=[],this.clearSelectedCoordinates(),y.feature.changed()},onSetup:function(y){var T=y.featureId,R=this.getFeature(T);if(!R)throw new Error("You must provide a featureId to enter direct_select mode");if(R.type===Tr)throw new TypeError("direct_select mode doesn't handle point features");var $={featureId:T,feature:R,dragMoveLocation:y.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:y.coordPath?[y.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(T,$.selectedCoordPaths)),this.setSelected(T),Kt(this),this.setActionableState({trash:!0}),$},onStop:function(){$t(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(y,T,R){y.featureId===T.properties.id?(T.properties.active=Ei,R(T),Mt(T,{map:this.map,midpoints:!0,selectedPaths:y.selectedCoordPaths}).forEach(R)):(T.properties.active=Dt,R(T)),this.fireActionable(y)},onTrash:function(y){y.selectedCoordPaths.sort(function(T,R){return R.localeCompare(T,"en",{numeric:!0})}).forEach(function(T){return y.feature.removeCoordinate(T)}),this.fireUpdate(),y.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(y),y.feature.isValid()===!1&&(this.deleteFeature([y.featureId]),this.changeMode(mt.SIMPLE_SELECT,{}))},onMouseMove:function(y,T){var R=me(T),$=Hr(T),K=y.selectedCoordPaths.length===0;return R&&K||$&&!K?this.updateUIClasses({mouse:je}):this.updateUIClasses({mouse:Ut}),this.stopDragging(y),!0},onMouseOut:function(y){return y.dragMoving&&this.fireUpdate(),!0}};fn.onTouchStart=fn.onMouseDown=function(y,T){return Hr(T)?this.onVertex(y,T):me(T)?this.onFeature(y,T):wo(T)?this.onMidpoint(y,T):void 0},fn.onDrag=function(y,T){if(y.canDragMove===!0){y.dragMoving=!0,T.originalEvent.stopPropagation();var R={lng:T.lngLat.lng-y.dragMoveLocation.lng,lat:T.lngLat.lat-y.dragMoveLocation.lat};y.selectedCoordPaths.length>0?this.dragVertex(y,T,R):this.dragFeature(y,T,R),y.dragMoveLocation=T.lngLat}},fn.onClick=function(y,T){return ve(T)?this.clickNoTarget(y,T):me(T)?this.clickActiveFeature(y,T):be(T)?this.clickInactive(y,T):void this.stopDragging(y)},fn.onTap=function(y,T){return ve(T)?this.clickNoTarget(y,T):me(T)?this.clickActiveFeature(y,T):be(T)?this.clickInactive(y,T):void 0},fn.onTouchEnd=fn.onMouseUp=function(y){y.dragMoving&&this.fireUpdate(),this.stopDragging(y)};var Qn={};function uo(y,T){return!!y.lngLat&&y.lngLat.lng===T[0]&&y.lngLat.lat===T[1]}Qn.onSetup=function(){var y=this.newFeature({type:Qt,properties:{},geometry:{type:Tr,coordinates:[]}});return this.addFeature(y),this.clearSelectedFeatures(),this.updateUIClasses({mouse:Ve}),this.activateUIButton(st.POINT),this.setActionableState({trash:!0}),{point:y}},Qn.stopDrawingAndRemove=function(y){this.deleteFeature([y.point.id],{silent:!0}),this.changeMode(mt.SIMPLE_SELECT)},Qn.onTap=Qn.onClick=function(y,T){this.updateUIClasses({mouse:je}),y.point.updateCoordinate("",T.lngLat.lng,T.lngLat.lat),this.map.fire(gr,{features:[y.point.toGeoJSON()]}),this.changeMode(mt.SIMPLE_SELECT,{featureIds:[y.point.id]})},Qn.onStop=function(y){this.activateUIButton(),y.point.getCoordinate().length||this.deleteFeature([y.point.id],{silent:!0})},Qn.toDisplayFeatures=function(y,T,R){var $=T.properties.id===y.point.id;if(T.properties.active=$?Ei:Dt,!$)return R(T)},Qn.onTrash=Qn.stopDrawingAndRemove,Qn.onKeyUp=function(y,T){if(He(T)||We(T))return this.stopDrawingAndRemove(y,T)};var Vi={onSetup:function(){var y=this.newFeature({type:Qt,properties:{},geometry:{type:ar,coordinates:[[]]}});return this.addFeature(y),this.clearSelectedFeatures(),Kt(this),this.updateUIClasses({mouse:Ve}),this.activateUIButton(st.POLYGON),this.setActionableState({trash:!0}),{polygon:y,currentVertexPosition:0}},clickAnywhere:function(y,T){if(y.currentVertexPosition>0&&uo(T,y.polygon.coordinates[0][y.currentVertexPosition-1]))return this.changeMode(mt.SIMPLE_SELECT,{featureIds:[y.polygon.id]});this.updateUIClasses({mouse:Ve}),y.polygon.updateCoordinate("0."+y.currentVertexPosition,T.lngLat.lng,T.lngLat.lat),y.currentVertexPosition++,y.polygon.updateCoordinate("0."+y.currentVertexPosition,T.lngLat.lng,T.lngLat.lat)},clickOnVertex:function(y){return this.changeMode(mt.SIMPLE_SELECT,{featureIds:[y.polygon.id]})},onMouseMove:function(y,T){y.polygon.updateCoordinate("0."+y.currentVertexPosition,T.lngLat.lng,T.lngLat.lat),pe(T)&&this.updateUIClasses({mouse:ot})}};Vi.onTap=Vi.onClick=function(y,T){return pe(T)?this.clickOnVertex(y,T):this.clickAnywhere(y,T)},Vi.onKeyUp=function(y,T){He(T)?(this.deleteFeature([y.polygon.id],{silent:!0}),this.changeMode(mt.SIMPLE_SELECT)):We(T)&&this.changeMode(mt.SIMPLE_SELECT,{featureIds:[y.polygon.id]})},Vi.onStop=function(y){this.updateUIClasses({mouse:Ut}),$t(this),this.activateUIButton(),this.getFeature(y.polygon.id)!==void 0&&(y.polygon.removeCoordinate("0."+y.currentVertexPosition),y.polygon.isValid()?this.map.fire(gr,{features:[y.polygon.toGeoJSON()]}):(this.deleteFeature([y.polygon.id],{silent:!0}),this.changeMode(mt.SIMPLE_SELECT,{},{silent:!0})))},Vi.toDisplayFeatures=function(y,T,R){var $=T.properties.id===y.polygon.id;if(T.properties.active=$?Ei:Dt,!$)return R(T);if(T.geometry.coordinates.length!==0){var K=T.geometry.coordinates[0].length;if(!(K<3)){if(T.properties.meta=wi,R(xt(y.polygon.id,T.geometry.coordinates[0][0],"0.0",!1)),K>3){var X=T.geometry.coordinates[0].length-3;R(xt(y.polygon.id,T.geometry.coordinates[0][X],"0."+X,!1))}if(K<=4){var le=[[T.geometry.coordinates[0][0][0],T.geometry.coordinates[0][0][1]],[T.geometry.coordinates[0][1][0],T.geometry.coordinates[0][1][1]]];if(R({type:Qt,properties:T.properties,geometry:{coordinates:le,type:Xr}}),K===3)return}return R(T)}}},Vi.onTrash=function(y){this.deleteFeature([y.polygon.id],{silent:!0}),this.changeMode(mt.SIMPLE_SELECT)};var Eo={onSetup:function(y){var T,R,$=(y=y||{}).featureId,K="forward";if($){if(!(T=this.getFeature($)))throw new Error("Could not find a feature with the provided featureId");var X=y.from;if(X&&X.type==="Feature"&&X.geometry&&X.geometry.type==="Point"&&(X=X.geometry),X&&X.type==="Point"&&X.coordinates&&X.coordinates.length===2&&(X=X.coordinates),!X||!Array.isArray(X))throw new Error("Please use the `from` property to indicate which point to continue the line from");var le=T.coordinates.length-1;if(T.coordinates[le][0]===X[0]&&T.coordinates[le][1]===X[1])R=le+1,T.addCoordinate.apply(T,[R].concat(T.coordinates[le]));else{if(T.coordinates[0][0]!==X[0]||T.coordinates[0][1]!==X[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");K="backwards",R=0,T.addCoordinate.apply(T,[R].concat(T.coordinates[0]))}}else T=this.newFeature({type:Qt,properties:{},geometry:{type:Xr,coordinates:[]}}),R=0,this.addFeature(T);return this.clearSelectedFeatures(),Kt(this),this.updateUIClasses({mouse:Ve}),this.activateUIButton(st.LINE),this.setActionableState({trash:!0}),{line:T,currentVertexPosition:R,direction:K}},clickAnywhere:function(y,T){if(y.currentVertexPosition>0&&uo(T,y.line.coordinates[y.currentVertexPosition-1])||y.direction==="backwards"&&uo(T,y.line.coordinates[y.currentVertexPosition+1]))return this.changeMode(mt.SIMPLE_SELECT,{featureIds:[y.line.id]});this.updateUIClasses({mouse:Ve}),y.line.updateCoordinate(y.currentVertexPosition,T.lngLat.lng,T.lngLat.lat),y.direction==="forward"?(y.currentVertexPosition++,y.line.updateCoordinate(y.currentVertexPosition,T.lngLat.lng,T.lngLat.lat)):y.line.addCoordinate(0,T.lngLat.lng,T.lngLat.lat)},clickOnVertex:function(y){return this.changeMode(mt.SIMPLE_SELECT,{featureIds:[y.line.id]})},onMouseMove:function(y,T){y.line.updateCoordinate(y.currentVertexPosition,T.lngLat.lng,T.lngLat.lat),pe(T)&&this.updateUIClasses({mouse:ot})}};Eo.onTap=Eo.onClick=function(y,T){if(pe(T))return this.clickOnVertex(y,T);this.clickAnywhere(y,T)},Eo.onKeyUp=function(y,T){We(T)?this.changeMode(mt.SIMPLE_SELECT,{featureIds:[y.line.id]}):He(T)&&(this.deleteFeature([y.line.id],{silent:!0}),this.changeMode(mt.SIMPLE_SELECT))},Eo.onStop=function(y){$t(this),this.activateUIButton(),this.getFeature(y.line.id)!==void 0&&(y.line.removeCoordinate(""+y.currentVertexPosition),y.line.isValid()?this.map.fire(gr,{features:[y.line.toGeoJSON()]}):(this.deleteFeature([y.line.id],{silent:!0}),this.changeMode(mt.SIMPLE_SELECT,{},{silent:!0})))},Eo.onTrash=function(y){this.deleteFeature([y.line.id],{silent:!0}),this.changeMode(mt.SIMPLE_SELECT)},Eo.toDisplayFeatures=function(y,T,R){var $=T.properties.id===y.line.id;if(T.properties.active=$?Ei:Dt,!$)return R(T);T.geometry.coordinates.length<2||(T.properties.meta=wi,R(xt(y.line.id,T.geometry.coordinates[y.direction==="forward"?T.geometry.coordinates.length-2:1],""+(y.direction==="forward"?T.geometry.coordinates.length-2:1),!1)),R(T))};var Os={simple_select:zr,direct_select:fn,draw_point:Qn,draw_polygon:Vi,draw_line_string:Eo},Vo={defaultMode:mt.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}],modes:Os,controls:{},userProperties:!1},fr={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},Sl={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function ds(y,T){return y.map(function(R){return R.source?R:oe(R,{id:R.id+"."+T,source:T==="hot"?ne:Me})})}var ic=Si(function(y,T){var R="[object Arguments]",$="[object Map]",K="[object Object]",X="[object Set]",le=/^\[object .+?Constructor\]$/,we=/^(?:0|[1-9]\d*)$/,Ce={};Ce["[object Float32Array]"]=Ce["[object Float64Array]"]=Ce["[object Int8Array]"]=Ce["[object Int16Array]"]=Ce["[object Int32Array]"]=Ce["[object Uint8Array]"]=Ce["[object Uint8ClampedArray]"]=Ce["[object Uint16Array]"]=Ce["[object Uint32Array]"]=!0,Ce[R]=Ce["[object Array]"]=Ce["[object ArrayBuffer]"]=Ce["[object Boolean]"]=Ce["[object DataView]"]=Ce["[object Date]"]=Ce["[object Error]"]=Ce["[object Function]"]=Ce[$]=Ce["[object Number]"]=Ce[K]=Ce["[object RegExp]"]=Ce[X]=Ce["[object String]"]=Ce["[object WeakMap]"]=!1;var Re=typeof{}=="object"&&{}&&{}.Object===Object&&{},fe=typeof self=="object"&&self&&self.Object===Object&&self,$e=Re||fe||Function("return this")(),at=T&&!T.nodeType&&T,tt=at&&y&&!y.nodeType&&y,Tt=tt&&tt.exports===at,Be=Tt&&Re.process,Pe=function(){try{return Be&&Be.binding&&Be.binding("util")}catch{}}(),rt=Pe&&Pe.isTypedArray;function rr(Ee,Fe){for(var ft=-1,At=Ee==null?0:Ee.length;++ft<At;)if(Fe(Ee[ft],ft,Ee))return!0;return!1}function Ot(Ee){var Fe=-1,ft=Array(Ee.size);return Ee.forEach(function(At,Fr){ft[++Fe]=[Fr,At]}),ft}function vr(Ee){var Fe=-1,ft=Array(Ee.size);return Ee.forEach(function(At){ft[++Fe]=At}),ft}var Ft,Pr,Gi,Cr=Array.prototype,In=Function.prototype,Ln=Object.prototype,Go=$e["__core-js_shared__"],br=In.toString,pi=Ln.hasOwnProperty,ll=(Ft=/[^.]+$/.exec(Go&&Go.keys&&Go.keys.IE_PROTO||""))?"Symbol(src)_1."+Ft:"",ul=Ln.toString,la=RegExp("^"+br.call(pi).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ru=Tt?$e.Buffer:void 0,cl=$e.Symbol,Tl=$e.Uint8Array,Cl=Ln.propertyIsEnumerable,nu=Cr.splice,Ds=cl?cl.toStringTag:void 0,hl=Object.getOwnPropertySymbols,zs=ru?ru.isBuffer:void 0,Oa=(Pr=Object.keys,Gi=Object,function(Ee){return Pr(Gi(Ee))}),ua=hr($e,"DataView"),zn=hr($e,"Map"),Da=hr($e,"Promise"),za=hr($e,"Set"),Fa=hr($e,"WeakMap"),qi=hr(Object,"create"),Na=ms(ua),Fs=ms(zn),Ns=ms(Da),iu=ms(za),qo=ms(Fa),kr=cl?cl.prototype:void 0,ca=kr?kr.valueOf:void 0;function Bs(Ee){var Fe=-1,ft=Ee==null?0:Ee.length;for(this.clear();++Fe<ft;){var At=Ee[Fe];this.set(At[0],At[1])}}function Hi(Ee){var Fe=-1,ft=Ee==null?0:Ee.length;for(this.clear();++Fe<ft;){var At=Ee[Fe];this.set(At[0],At[1])}}function mi(Ee){var Fe=-1,ft=Ee==null?0:Ee.length;for(this.clear();++Fe<ft;){var At=Ee[Fe];this.set(At[0],At[1])}}function ha(Ee){var Fe=-1,ft=Ee==null?0:Ee.length;for(this.__data__=new mi;++Fe<ft;)this.add(Ee[Fe])}function So(Ee){var Fe=this.__data__=new Hi(Ee);this.size=Fe.size}function da(Ee,Fe){var ft=$s(Ee),At=!ft&&js(Ee),Fr=!ft&&!At&&fa(Ee),dr=!ft&&!At&&!Fr&&un(Ee),Qr=ft||At||Fr||dr,nn=Qr?function(Pn,ei){for(var Fn=-1,$n=Array(Pn);++Fn<Pn;)$n[Fn]=ei(Fn);return $n}(Ee.length,String):[],zi=nn.length;for(var bn in Ee)!Fe&&!pi.call(Ee,bn)||Qr&&(bn=="length"||Fr&&(bn=="offset"||bn=="parent")||dr&&(bn=="buffer"||bn=="byteLength"||bn=="byteOffset")||ps(bn,zi))||nn.push(bn);return nn}function fs(Ee,Fe){for(var ft=Ee.length;ft--;)if(gs(Ee[ft][0],Fe))return ft;return-1}function Us(Ee){return Ee==null?Ee===void 0?"[object Undefined]":"[object Null]":Ds&&Ds in Object(Ee)?function(Fe){var ft=pi.call(Fe,Ds),At=Fe[Ds];try{Fe[Ds]=void 0;var Fr=!0}catch{}var dr=ul.call(Fe);return Fr&&(ft?Fe[Ds]=At:delete Fe[Ds]),dr}(Ee):function(Fe){return ul.call(Fe)}(Ee)}function Ba(Ee){return Vs(Ee)&&Us(Ee)==R}function Ua(Ee,Fe,ft,At,Fr){return Ee===Fe||(Ee==null||Fe==null||!Vs(Ee)&&!Vs(Fe)?Ee!=Ee&&Fe!=Fe:function(dr,Qr,nn,zi,bn,Pn){var ei=$s(dr),Fn=$s(Qr),$n=ei?"[object Array]":Ii(dr),Se=Fn?"[object Array]":Ii(Qr),Ne=($n=$n==R?K:$n)==K,lt=(Se=Se==R?K:Se)==K,kt=$n==Se;if(kt&&fa(dr)){if(!fa(Qr))return!1;ei=!0,Ne=!1}if(kt&&!Ne)return Pn||(Pn=new So),ei||un(dr)?cr(dr,Qr,nn,zi,bn,Pn):function(or,Jt,ur,pn,co,on,ti){switch(ur){case"[object DataView]":if(or.byteLength!=Jt.byteLength||or.byteOffset!=Jt.byteOffset)return!1;or=or.buffer,Jt=Jt.buffer;case"[object ArrayBuffer]":return!(or.byteLength!=Jt.byteLength||!on(new Tl(or),new Tl(Jt)));case"[object Boolean]":case"[object Date]":case"[object Number]":return gs(+or,+Jt);case"[object Error]":return or.name==Jt.name&&or.message==Jt.message;case"[object RegExp]":case"[object String]":return or==Jt+"";case $:var Vn=Ot;case X:var Wi=1&pn;if(Vn||(Vn=vr),or.size!=Jt.size&&!Wi)return!1;var Gn=ti.get(or);if(Gn)return Gn==Jt;pn|=2,ti.set(or,Jt);var yt=cr(Vn(or),Vn(Jt),pn,co,on,ti);return ti.delete(or),yt;case"[object Symbol]":if(ca)return ca.call(or)==ca.call(Jt)}return!1}(dr,Qr,$n,nn,zi,bn,Pn);if(!(1&nn)){var jr=Ne&&pi.call(dr,"__wrapped__"),lr=lt&&pi.call(Qr,"__wrapped__");if(jr||lr){var gn=jr?dr.value():dr,Zr=lr?Qr.value():Qr;return Pn||(Pn=new So),bn(gn,Zr,nn,zi,Pn)}}return kt?(Pn||(Pn=new So),function(or,Jt,ur,pn,co,on){var ti=1&ur,Vn=Ho(or),Wi=Vn.length,Gn=Ho(Jt).length;if(Wi!=Gn&&!ti)return!1;for(var yt=Wi;yt--;){var Ki=Vn[yt];if(!(ti?Ki in Jt:pi.call(Jt,Ki)))return!1}var ma=on.get(or);if(ma&&on.get(Jt))return ma==Jt;var Xi=!0;on.set(or,Jt),on.set(Jt,or);for(var $r=ti;++yt<Wi;){Ki=Vn[yt];var Ye=or[Ki],Co=Jt[Ki];if(pn)var ho=ti?pn(Co,Ye,Ki,Jt,or,on):pn(Ye,Co,Ki,or,Jt,on);if(!(ho===void 0?Ye===Co||co(Ye,Co,ur,pn,on):ho)){Xi=!1;break}$r||($r=Ki=="constructor")}if(Xi&&!$r){var Gs=or.constructor,qn=Jt.constructor;Gs==qn||!("constructor"in or)||!("constructor"in Jt)||typeof Gs=="function"&&Gs instanceof Gs&&typeof qn=="function"&&qn instanceof qn||(Xi=!1)}return on.delete(or),on.delete(Jt),Xi}(dr,Qr,nn,zi,bn,Pn)):!1}(Ee,Fe,ft,At,Ua,Fr))}function mn(Ee){return!(!$a(Ee)||function(Fe){return!!ll&&ll in Fe}(Ee))&&(pa(Ee)?la:le).test(ms(Ee))}function Il(Ee){if(ft=(Fe=Ee)&&Fe.constructor,At=typeof ft=="function"&&ft.prototype||Ln,Fe!==At)return Oa(Ee);var Fe,ft,At,Fr=[];for(var dr in Object(Ee))pi.call(Ee,dr)&&dr!="constructor"&&Fr.push(dr);return Fr}function cr(Ee,Fe,ft,At,Fr,dr){var Qr=1&ft,nn=Ee.length,zi=Fe.length;if(nn!=zi&&!(Qr&&zi>nn))return!1;var bn=dr.get(Ee);if(bn&&dr.get(Fe))return bn==Fe;var Pn=-1,ei=!0,Fn=2&ft?new ha:void 0;for(dr.set(Ee,Fe),dr.set(Fe,Ee);++Pn<nn;){var $n=Ee[Pn],Se=Fe[Pn];if(At)var Ne=Qr?At(Se,$n,Pn,Fe,Ee,dr):At($n,Se,Pn,Ee,Fe,dr);if(Ne!==void 0){if(Ne)continue;ei=!1;break}if(Fn){if(!rr(Fe,function(lt,kt){if(jr=kt,!Fn.has(jr)&&($n===lt||Fr($n,lt,ft,At,dr)))return Fn.push(kt);var jr})){ei=!1;break}}else if($n!==Se&&!Fr($n,Se,ft,At,dr)){ei=!1;break}}return dr.delete(Ee),dr.delete(Fe),ei}function Ho(Ee){return function(Fe,ft,At){var Fr=ft(Fe);return $s(Fe)?Fr:function(dr,Qr){for(var nn=-1,zi=Qr.length,bn=dr.length;++nn<zi;)dr[bn+nn]=Qr[nn];return dr}(Fr,At(Fe))}(Ee,Zi,To)}function wr(Ee,Fe){var ft,At,Fr=Ee.__data__;return((At=typeof(ft=Fe))=="string"||At=="number"||At=="symbol"||At=="boolean"?ft!=="__proto__":ft===null)?Fr[typeof Fe=="string"?"string":"hash"]:Fr.map}function hr(Ee,Fe){var ft=function(At,Fr){return At==null?void 0:At[Fr]}(Ee,Fe);return mn(ft)?ft:void 0}Bs.prototype.clear=function(){this.__data__=qi?qi(null):{},this.size=0},Bs.prototype.delete=function(Ee){var Fe=this.has(Ee)&&delete this.__data__[Ee];return this.size-=Fe?1:0,Fe},Bs.prototype.get=function(Ee){var Fe=this.__data__;if(qi){var ft=Fe[Ee];return ft==="__lodash_hash_undefined__"?void 0:ft}return pi.call(Fe,Ee)?Fe[Ee]:void 0},Bs.prototype.has=function(Ee){var Fe=this.__data__;return qi?Fe[Ee]!==void 0:pi.call(Fe,Ee)},Bs.prototype.set=function(Ee,Fe){var ft=this.__data__;return this.size+=this.has(Ee)?0:1,ft[Ee]=qi&&Fe===void 0?"__lodash_hash_undefined__":Fe,this},Hi.prototype.clear=function(){this.__data__=[],this.size=0},Hi.prototype.delete=function(Ee){var Fe=this.__data__,ft=fs(Fe,Ee);return!(ft<0)&&(ft==Fe.length-1?Fe.pop():nu.call(Fe,ft,1),--this.size,!0)},Hi.prototype.get=function(Ee){var Fe=this.__data__,ft=fs(Fe,Ee);return ft<0?void 0:Fe[ft][1]},Hi.prototype.has=function(Ee){return fs(this.__data__,Ee)>-1},Hi.prototype.set=function(Ee,Fe){var ft=this.__data__,At=fs(ft,Ee);return At<0?(++this.size,ft.push([Ee,Fe])):ft[At][1]=Fe,this},mi.prototype.clear=function(){this.size=0,this.__data__={hash:new Bs,map:new(zn||Hi),string:new Bs}},mi.prototype.delete=function(Ee){var Fe=wr(this,Ee).delete(Ee);return this.size-=Fe?1:0,Fe},mi.prototype.get=function(Ee){return wr(this,Ee).get(Ee)},mi.prototype.has=function(Ee){return wr(this,Ee).has(Ee)},mi.prototype.set=function(Ee,Fe){var ft=wr(this,Ee),At=ft.size;return ft.set(Ee,Fe),this.size+=ft.size==At?0:1,this},ha.prototype.add=ha.prototype.push=function(Ee){return this.__data__.set(Ee,"__lodash_hash_undefined__"),this},ha.prototype.has=function(Ee){return this.__data__.has(Ee)},So.prototype.clear=function(){this.__data__=new Hi,this.size=0},So.prototype.delete=function(Ee){var Fe=this.__data__,ft=Fe.delete(Ee);return this.size=Fe.size,ft},So.prototype.get=function(Ee){return this.__data__.get(Ee)},So.prototype.has=function(Ee){return this.__data__.has(Ee)},So.prototype.set=function(Ee,Fe){var ft=this.__data__;if(ft instanceof Hi){var At=ft.__data__;if(!zn||At.length<199)return At.push([Ee,Fe]),this.size=++ft.size,this;ft=this.__data__=new mi(At)}return ft.set(Ee,Fe),this.size=ft.size,this};var To=hl?function(Ee){return Ee==null?[]:(Ee=Object(Ee),function(Fe,ft){for(var At=-1,Fr=Fe==null?0:Fe.length,dr=0,Qr=[];++At<Fr;){var nn=Fe[At];ft(nn,At,Fe)&&(Qr[dr++]=nn)}return Qr}(hl(Ee),function(Fe){return Cl.call(Ee,Fe)}))}:function(){return[]},Ii=Us;function ps(Ee,Fe){return!!(Fe=Fe??9007199254740991)&&(typeof Ee=="number"||we.test(Ee))&&Ee>-1&&Ee%1==0&&Ee<Fe}function ms(Ee){if(Ee!=null){try{return br.call(Ee)}catch{}try{return Ee+""}catch{}}return""}function gs(Ee,Fe){return Ee===Fe||Ee!=Ee&&Fe!=Fe}(ua&&Ii(new ua(new ArrayBuffer(1)))!="[object DataView]"||zn&&Ii(new zn)!=$||Da&&Ii(Da.resolve())!="[object Promise]"||za&&Ii(new za)!=X||Fa&&Ii(new Fa)!="[object WeakMap]")&&(Ii=function(Ee){var Fe=Us(Ee),ft=Fe==K?Ee.constructor:void 0,At=ft?ms(ft):"";if(At)switch(At){case Na:return"[object DataView]";case Fs:return $;case Ns:return"[object Promise]";case iu:return X;case qo:return"[object WeakMap]"}return Fe});var js=Ba(function(){return arguments}())?Ba:function(Ee){return Vs(Ee)&&pi.call(Ee,"callee")&&!Cl.call(Ee,"callee")},$s=Array.isArray,fa=zs||function(){return!1};function pa(Ee){if(!$a(Ee))return!1;var Fe=Us(Ee);return Fe=="[object Function]"||Fe=="[object GeneratorFunction]"||Fe=="[object AsyncFunction]"||Fe=="[object Proxy]"}function ja(Ee){return typeof Ee=="number"&&Ee>-1&&Ee%1==0&&Ee<=9007199254740991}function $a(Ee){var Fe=typeof Ee;return Ee!=null&&(Fe=="object"||Fe=="function")}function Vs(Ee){return Ee!=null&&typeof Ee=="object"}var un=rt?function(Ee){return function(Fe){return Ee(Fe)}}(rt):function(Ee){return Vs(Ee)&&ja(Ee.length)&&!!Ce[Us(Ee)]};function Zi(Ee){return(Fe=Ee)!=null&&ja(Fe.length)&&!pa(Fe)?da(Ee):Il(Ee);var Fe}y.exports=function(Ee,Fe){return Ua(Ee,Fe)}}),tu={Polygon:Nr,LineString:jt,Point:Gt,MultiPolygon:Jr,MultiLineString:Jr,MultiPoint:Jr};function sl(y,T){return T.modes=mt,T.getFeatureIdsAt=function(R){return tn.click({point:R},null,y).map(function($){return $.properties.id})},T.getSelectedIds=function(){return y.store.getSelectedIds()},T.getSelected=function(){return{type:sn,features:y.store.getSelectedIds().map(function(R){return y.store.get(R)}).map(function(R){return R.toGeoJSON()})}},T.getSelectedPoints=function(){return{type:sn,features:y.store.getSelectedCoordinates().map(function(R){return{type:Qt,properties:{},geometry:{type:Tr,coordinates:R.coordinates}}})}},T.set=function(R){if(R.type===void 0||R.type!==sn||!Array.isArray(R.features))throw new Error("Invalid FeatureCollection");var $=y.store.createRenderBatch(),K=y.store.getAllIds().slice(),X=T.add(R),le=new Tn(X);return(K=K.filter(function(we){return!le.has(we)})).length&&T.delete(K),$(),X},T.add=function(R){var $=JSON.parse(JSON.stringify(sr(R))).features.map(function(K){if(K.id=K.id||$i(),K.geometry===null)throw new Error("Invalid geometry: null");if(y.store.get(K.id)===void 0||y.store.get(K.id).type!==K.geometry.type){var X=tu[K.geometry.type];if(X===void 0)throw new Error("Invalid geometry type: "+K.geometry.type+".");var le=new X(y,K);y.store.add(le)}else{var we=y.store.get(K.id);we.properties=K.properties,ic(we.getCoordinates(),K.geometry.coordinates)||we.incomingCoords(K.geometry.coordinates)}return K.id});return y.store.render(),$},T.get=function(R){var $=y.store.get(R);if($)return $.toGeoJSON()},T.getAll=function(){return{type:sn,features:y.store.getAll().map(function(R){return R.toGeoJSON()})}},T.delete=function(R){return y.store.delete(R,{silent:!0}),T.getMode()!==mt.DIRECT_SELECT||y.store.getSelectedIds().length?y.store.render():y.events.changeMode(mt.SIMPLE_SELECT,void 0,{silent:!0}),T},T.deleteAll=function(){return y.store.delete(y.store.getAllIds(),{silent:!0}),T.getMode()===mt.DIRECT_SELECT?y.events.changeMode(mt.SIMPLE_SELECT,void 0,{silent:!0}):y.store.render(),T},T.changeMode=function(R,$){return $===void 0&&($={}),R===mt.SIMPLE_SELECT&&T.getMode()===mt.SIMPLE_SELECT?(K=$.featureIds||[],X=y.store.getSelectedIds(),K.length===X.length&&JSON.stringify(K.map(function(le){return le}).sort())===JSON.stringify(X.map(function(le){return le}).sort())||(y.store.setSelected($.featureIds,{silent:!0}),y.store.render()),T):(R===mt.DIRECT_SELECT&&T.getMode()===mt.DIRECT_SELECT&&$.featureId===y.store.getSelectedIds()[0]||y.events.changeMode(R,$,{silent:!0}),T);var K,X},T.getMode=function(){return y.events.getMode()},T.trash=function(){return y.events.trash({silent:!0}),T},T.combineFeatures=function(){return y.events.combineFeatures({silent:!0}),T},T.uncombineFeatures=function(){return y.events.uncombineFeatures({silent:!0}),T},T.setFeatureProperty=function(R,$,K){return y.store.setFeatureProperty(R,$,K),T},T}var al=function(y,T){var R={options:y=function(K){K===void 0&&(K={});var X=oe(K);return K.controls||(X.controls={}),K.displayControlsDefault===!1?X.controls=oe(Sl,K.controls):X.controls=oe(fr,K.controls),(X=oe(Vo,X)).styles=ds(X.styles,"cold").concat(ds(X.styles,"hot")),X}(y)};T=sl(R,T),R.api=T;var $=ee(R);return T.onAdd=$.onAdd,T.onRemove=$.onRemove,T.types=st,T.options=y,T};function C(y){al(y,this)}return C.modes=Os,C})})(XC);var Gg=XC.exports,eu={classes:{CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},sources:{HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},cursors:{ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},types:{POLYGON:"polygon",LINE:"line_string",POINT:"point"},geojsonTypes:{FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},modes:{DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},events:{CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},updateActions:{MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},meta:{FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},activeStates:{ACTIVE:"true",INACTIVE:"false"},interactions:["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],LAT_MIN:-90,LAT_RENDERED_MIN:-85,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270},JC={enable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.doubleClickZoom.disable()},0)}};const Mx=na(V6),q6=Gg,Vd=eu,H6=JC,Z6=Mx.default,YC={...q6.modes.draw_polygon},W6=2;YC.onSetup=function(e){const t=this.newFeature({type:Vd.geojsonTypes.FEATURE,properties:{isCircle:!0,center:[]},geometry:{type:Vd.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),H6.disable(this),this.updateUIClasses({mouse:Vd.cursors.ADD}),this.activateUIButton(Vd.types.POLYGON),this.setActionableState({trash:!0}),{initialRadiusInKm:e.initialRadiusInKm||W6,polygon:t,currentVertexPosition:0}};YC.clickAnywhere=function(e,t){if(e.currentVertexPosition===0){e.currentVertexPosition++;const r=[t.lngLat.lng,t.lngLat.lat],n=Z6(r,e.initialRadiusInKm);e.polygon.incomingCoords(n.geometry.coordinates),e.polygon.properties.center=r,e.polygon.properties.radiusInKm=e.initialRadiusInKm}return this.changeMode(Vd.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};var K6={enable(e){setTimeout(()=>{!e.map||!e.map.dragPan||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("dragPan")&&e.map.dragPan.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.dragPan.disable()},0)}};const QC=na(j6),eI=na(xB),X6=Gg,Cc=eu,J6=JC,tI=K6,Y6=Mx.default,Q6=QC.default,FE=eI,wl={...X6.modes.draw_polygon};wl.onSetup=function(e){const t=this.newFeature({type:Cc.geojsonTypes.FEATURE,properties:{isCircle:!0,center:[]},geometry:{type:Cc.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),J6.disable(this),tI.disable(this),this.updateUIClasses({mouse:Cc.cursors.ADD}),this.activateUIButton(Cc.types.POLYGON),this.setActionableState({trash:!0}),{polygon:t,currentVertexPosition:0}};wl.onMouseDown=wl.onTouchStart=function(e,t){e.polygon.properties.center.length===0&&(e.polygon.properties.center=[t.lngLat.lng,t.lngLat.lat])};wl.onDrag=wl.onMouseMove=function(e,t){const r=e.polygon.properties.center;if(r.length>0){const n=Q6(FE.point(r),FE.point([t.lngLat.lng,t.lngLat.lat]),{units:"kilometers"}),a=Y6(r,n);e.polygon.incomingCoords(a.geometry.coordinates),e.polygon.properties.radiusInKm=n}};wl.onMouseUp=wl.onTouchEnd=function(e,t){return tI.enable(this),this.changeMode(Cc.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};wl.onClick=wl.onTap=function(e,t){e.polygon.properties.center=[]};wl.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.polygon.id;return t.properties.active=n?Cc.activeStates.ACTIVE:Cc.activeStates.INACTIVE,r(t)};const Fd=eu;var rI=function(e,t,r,n){return{type:Fd.geojsonTypes.FEATURE,properties:{meta:Fd.meta.VERTEX,parent:e,coord_path:r,active:n?Fd.activeStates.ACTIVE:Fd.activeStates.INACTIVE},geometry:{type:Fd.geojsonTypes.POINT,coordinates:t}}};const mc=eu;var eU=function(e,t,r,n){const a=t.geometry.coordinates,l=r.geometry.coordinates;if(a[1]>mc.LAT_RENDERED_MAX||a[1]<mc.LAT_RENDERED_MIN||l[1]>mc.LAT_RENDERED_MAX||l[1]<mc.LAT_RENDERED_MIN)return null;const f=n.project([a[0],a[1]]),u=n.project([l[0],l[1]]),E=n.unproject([(f.x+u.x)/2,(f.y+u.y)/2]);return{type:mc.geojsonTypes.FEATURE,properties:{meta:mc.meta.MIDPOINT,parent:e,lng:E.lng,lat:E.lat,coord_path:r.properties.coord_path},geometry:{type:mc.geojsonTypes.POINT,coordinates:[E.lng,E.lat]}}};const NE=rI,tU=eU,ah=eu;function nI(e,t={},r=null){const{type:n,coordinates:a}=e.geometry,l=e.properties&&e.properties.id;let f=[];n===ah.geojsonTypes.POINT?f.push(NE(l,a,r,E(r))):n===ah.geojsonTypes.POLYGON?a.forEach((S,M)=>{u(S,r!==null?`${r}.${M}`:String(M))}):n===ah.geojsonTypes.LINE_STRING?u(a,r):n.indexOf(ah.geojsonTypes.MULTI_PREFIX)===0&&m();function u(S,M){let z="",H=null;S.forEach((q,Y)=>{const ye=M!=null?`${M}.${Y}`:String(Y),Q=NE(l,q,ye,E(ye));if(t.midpoints&&H){const ne=tU(l,H,Q,t.map);ne&&f.push(ne)}H=Q;const te=JSON.stringify(q);z!==te&&f.push(Q),Y===0&&(z=te)})}function E(S){return t.selectedPaths?t.selectedPaths.indexOf(S)!==-1:!1}function m(){const S=n.replace(ah.geojsonTypes.MULTI_PREFIX,"");a.forEach((M,z)=>{const H={type:ah.geojsonTypes.FEATURE,properties:e.properties,geometry:{type:S,coordinates:M}};f=f.concat(nI(H,t,z))})}return f}var iI=nI,qg={exports:{}},rU=iU,nU={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function iU(e){if(!e||!e.type)return null;var t=nU[e.type];if(!t)return null;if(t==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]};if(t==="feature")return{type:"FeatureCollection",features:[e]};if(t==="featurecollection")return e}function am(e){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.reduce(function(t,r){return t.concat(am(r))},[]),e;case"Feature":return e.geometry?am(e.geometry).map(function(t){var r={type:"Feature",properties:JSON.parse(JSON.stringify(e.properties)),geometry:t};return e.id!==void 0&&(r.id=e.id),r}):[e];case"MultiPoint":return e.coordinates.map(function(t){return{type:"Point",coordinates:t}});case"MultiPolygon":return e.coordinates.map(function(t){return{type:"Polygon",coordinates:t}});case"MultiLineString":return e.coordinates.map(function(t){return{type:"LineString",coordinates:t}});case"GeometryCollection":return e.geometries.map(am).reduce(function(t,r){return t.concat(r)},[]);case"Point":case"Polygon":case"LineString":return[e]}}const oU=Object.freeze(Object.defineProperty({__proto__:null,default:am},Symbol.toStringTag,{value:"Module"})),sU=na(oU);var aU=function(t){return r(t);function r(n){return Array.isArray(n)&&n.length&&typeof n[0]=="number"?[n]:n.reduce(function(a,l){return Array.isArray(l)&&Array.isArray(l[0])?a.concat(r(l)):(a.push(l),a)},[])}},lU=rU,lm=sU,uU=aU;lm instanceof Function||(lm=lm.default);var cU=function(e){if(!e)return[];var t=lm(lU(e)),r=[];return t.features.forEach(function(n){n.geometry&&(r=r.concat(uU(n.geometry.coordinates)))}),r};function Xh(e){return Object.prototype.toString.call(e)}function hU(e){return Xh(e)==="[object Date]"}function dU(e){return Xh(e)==="[object RegExp]"}function fU(e){return Xh(e)==="[object Error]"}function pU(e){return Xh(e)==="[object Boolean]"}function mU(e){return Xh(e)==="[object Number]"}function gU(e){return Xh(e)==="[object String]"}var oI=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function Hg(e,t){if(e.forEach)return e.forEach(t);for(var r=0;r<e.length;r++)t(e[r],r,e)}var Zg=Object.keys||function(t){var r=[];for(var n in t)r.push(n);return r},Wg=Object.prototype.hasOwnProperty||function(e,t){return t in e};function sI(e){if(typeof e=="object"&&e!==null){var t;if(oI(e))t=[];else if(hU(e))t=new Date(e.getTime?e.getTime():e);else if(dU(e))t=new RegExp(e);else if(fU(e))t={message:e.message};else if(pU(e)||mU(e)||gU(e))t=Object(e);else if(Object.create&&Object.getPrototypeOf)t=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)t={};else{var r=e.constructor&&e.constructor.prototype||e.__proto__||{},n=function(){};n.prototype=r,t=new n}return Hg(Zg(e),function(a){t[a]=e[a]}),t}return e}function aI(e,t,r){var n=[],a=[],l=!0;return function f(u){var E=r?sI(u):u,m={},S=!0,M={node:E,node_:u,path:[].concat(n),parent:a[a.length-1],parents:a,key:n[n.length-1],isRoot:n.length===0,level:n.length,circular:null,update:function(q,Y){M.isRoot||(M.parent.node[M.key]=q),M.node=q,Y&&(S=!1)},delete:function(q){delete M.parent.node[M.key],q&&(S=!1)},remove:function(q){oI(M.parent.node)?M.parent.node.splice(M.key,1):delete M.parent.node[M.key],q&&(S=!1)},keys:null,before:function(q){m.before=q},after:function(q){m.after=q},pre:function(q){m.pre=q},post:function(q){m.post=q},stop:function(){l=!1},block:function(){S=!1}};if(!l)return M;function z(){if(typeof M.node=="object"&&M.node!==null){(!M.keys||M.node_!==M.node)&&(M.keys=Zg(M.node)),M.isLeaf=M.keys.length===0;for(var q=0;q<a.length;q++)if(a[q].node_===u){M.circular=a[q];break}}else M.isLeaf=!0,M.keys=null;M.notLeaf=!M.isLeaf,M.notRoot=!M.isRoot}z();var H=t.call(M,M.node);return H!==void 0&&M.update&&M.update(H),m.before&&m.before.call(M,M.node),S&&(typeof M.node=="object"&&M.node!==null&&!M.circular&&(a.push(M),z(),Hg(M.keys,function(q,Y){n.push(q),m.pre&&m.pre.call(M,M.node[q],q);var ye=f(M.node[q]);r&&Wg.call(M.node,q)&&(M.node[q]=ye.node),ye.isLast=Y===M.keys.length-1,ye.isFirst=Y===0,m.post&&m.post.call(M,ye),n.pop()}),a.pop()),m.after&&m.after.call(M,M.node)),M}(e).node}function Ra(e){this.value=e}Ra.prototype.get=function(e){for(var t=this.value,r=0;r<e.length;r++){var n=e[r];if(!t||!Wg.call(t,n))return;t=t[n]}return t};Ra.prototype.has=function(e){for(var t=this.value,r=0;r<e.length;r++){var n=e[r];if(!t||!Wg.call(t,n))return!1;t=t[n]}return!0};Ra.prototype.set=function(e,t){for(var r=this.value,n=0;n<e.length-1;n++){var a=e[n];Wg.call(r,a)||(r[a]={}),r=r[a]}return r[e[n]]=t,t};Ra.prototype.map=function(e){return aI(this.value,e,!0)};Ra.prototype.forEach=function(e){return this.value=aI(this.value,e,!1),this.value};Ra.prototype.reduce=function(e,t){var r=arguments.length===1,n=r?this.value:t;return this.forEach(function(a){(!this.isRoot||!r)&&(n=e.call(this,n,a))}),n};Ra.prototype.paths=function(){var e=[];return this.forEach(function(){e.push(this.path)}),e};Ra.prototype.nodes=function(){var e=[];return this.forEach(function(){e.push(this.node)}),e};Ra.prototype.clone=function(){var e=[],t=[];return function r(n){for(var a=0;a<e.length;a++)if(e[a]===n)return t[a];if(typeof n=="object"&&n!==null){var l=sI(n);return e.push(n),t.push(l),Hg(Zg(n),function(f){l[f]=r(n[f])}),e.pop(),t.pop(),l}return n}(this.value)};function lI(e){return new Ra(e)}Hg(Zg(Ra.prototype),function(e){lI[e]=function(t){var r=[].slice.call(arguments,1),n=new Ra(t);return n[e].apply(n,r)}});var yU=lI,vU=as;function as(e){if(!(this instanceof as))return new as(e);this._bbox=e||[1/0,1/0,-1/0,-1/0],this._valid=!!e}as.prototype.include=function(e){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[0]),this._bbox[3]=Math.max(this._bbox[3],e[1]),this};as.prototype.equals=function(e){var t;return e instanceof as?t=e.bbox():t=e,this._bbox[0]==t[0]&&this._bbox[1]==t[1]&&this._bbox[2]==t[2]&&this._bbox[3]==t[3]};as.prototype.center=function(e){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null};as.prototype.union=function(e){this._valid=!0;var t;return e instanceof as?t=e.bbox():t=e,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[2]),this._bbox[3]=Math.max(this._bbox[3],t[3]),this};as.prototype.bbox=function(){return this._valid?this._bbox:null};as.prototype.contains=function(e){if(!e)return this._fastContains();if(!this._valid)return null;var t=e[0],r=e[1];return this._bbox[0]<=t&&this._bbox[1]<=r&&this._bbox[2]>=t&&this._bbox[3]>=r};as.prototype.intersect=function(e){if(!this._valid)return null;var t;return e instanceof as?t=e.bbox():t=e,!(this._bbox[0]>t[2]||this._bbox[2]<t[0]||this._bbox[3]<t[1]||this._bbox[1]>t[3])};as.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var e="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",e)};as.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var _U=cU,xU=yU,bU=vU,uI={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},wU=Object.keys(uI);qg.exports=function(e){return kx(e).bbox()};qg.exports.polygon=function(e){return kx(e).polygon()};qg.exports.bboxify=function(e){return xU(e).map(function(t){if(t){var r=wU.some(function(n){return t[n]?uI[n].indexOf(t.type)!==-1:!1});r&&(t.bbox=kx(t).bbox(),this.update(t))}})};function kx(e){for(var t=bU(),r=_U(e),n=0;n<r.length;n++)t.include(r[n]);return t}var EU=qg.exports;const SU=EU,TU=eu,{LAT_MIN:qp,LAT_MAX:Hp,LAT_RENDERED_MIN:BE,LAT_RENDERED_MAX:UE,LNG_MIN:jE,LNG_MAX:$E}=TU;var cI=function(e,t){let r=qp,n=Hp,a=qp,l=Hp,f=$E,u=jE;e.forEach(m=>{const S=SU(m),M=S[1],z=S[3],H=S[0],q=S[2];M>r&&(r=M),z<n&&(n=z),z>a&&(a=z),M<l&&(l=M),H<f&&(f=H),q>u&&(u=q)});const E=t;return r+E.lat>UE&&(E.lat=UE-r),a+E.lat>Hp&&(E.lat=Hp-a),n+E.lat<BE&&(E.lat=BE-n),l+E.lat<qp&&(E.lat=qp-l),f+E.lng<=jE&&(E.lng+=Math.ceil(Math.abs(E.lng)/360)*360),u+E.lng>=$E&&(E.lng-=Math.ceil(Math.abs(E.lng)/360)*360),E};const CU=cI,lh=eu;var hI=function(e,t){const r=CU(e.map(n=>n.toGeoJSON()),t);e.forEach(n=>{const a=n.getCoordinates(),l=m=>{const S={lng:m[0]+r.lng,lat:m[1]+r.lat};return[S.lng,S.lat]},f=m=>m.map(S=>l(S)),u=m=>m.map(S=>f(S));let E;n.type===lh.geojsonTypes.POINT?E=l(a):n.type===lh.geojsonTypes.LINE_STRING||n.type===lh.geojsonTypes.MULTI_POINT?E=a.map(l):n.type===lh.geojsonTypes.POLYGON||n.type===lh.geojsonTypes.MULTI_LINE_STRING?E=a.map(f):n.type===lh.geojsonTypes.MULTI_POLYGON&&(E=a.map(u)),n.incomingCoords(E)})};const IU=rI;function PU(e){const{properties:t,geometry:r}=e;if(!t.user_isCircle)return null;const n=[],a=r.coordinates[0].slice(0,-1);for(let l=0;l<a.length;l+=Math.round(a.length/4))n.push(IU(t.id,a[l],`0.${l}`,!1));return n}var dI=PU;const AU=Gg,MU=iI,kU=hI,Jm=eu,LU=cI,RU=QC.default,VE=eI,OU=Mx.default,DU=dI,Lx=AU.modes.direct_select;Lx.dragFeature=function(e,t,r){kU(this.getSelected(),r),this.getSelected().filter(n=>n.properties.isCircle).map(n=>n.properties.center).forEach(n=>{n[0]+=r.lng,n[1]+=r.lat}),e.dragMoveLocation=t.lngLat};Lx.dragVertex=function(e,t,r){if(e.feature.properties.isCircle){const n=e.feature.properties.center,a=[t.lngLat.lng,t.lngLat.lat],l=RU(VE.point(n),VE.point(a),{units:"kilometers"}),f=OU(n,l);e.feature.incomingCoords(f.geometry.coordinates),e.feature.properties.radiusInKm=l}else{const n=e.selectedCoordPaths.map(f=>e.feature.getCoordinate(f)),a=n.map(f=>({type:Jm.geojsonTypes.FEATURE,properties:{},geometry:{type:Jm.geojsonTypes.POINT,coordinates:f}})),l=LU(a,r);for(let f=0;f<n.length;f++){const u=n[f];e.feature.updateCoordinate(e.selectedCoordPaths[f],u[0]+l.lng,u[1]+l.lat)}}};Lx.toDisplayFeatures=function(e,t,r){e.featureId===t.properties.id?(t.properties.active=Jm.activeStates.ACTIVE,r(t),(t.properties.user_isCircle?DU(t):MU(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths})).forEach(r)):(t.properties.active=Jm.activeStates.INACTIVE,r(t)),this.fireActionable(e)};const zU=Gg,FU=iI,NU=hI,Zp=eu,BU=dI,fI=zU.modes.simple_select;fI.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};NU(this.getSelected(),r),this.getSelected().filter(n=>n.properties.isCircle).map(n=>n.properties.center).forEach(n=>{n[0]+=r.lng,n[1]+=r.lat}),e.dragMoveLocation=t.lngLat};fI.toDisplayFeatures=function(e,t,r){if(t.properties.active=this.isSelected(t.properties.id)?Zp.activeStates.ACTIVE:Zp.activeStates.INACTIVE,r(t),this.fireActionable(),t.properties.active!==Zp.activeStates.ACTIVE||t.geometry.type===Zp.geojsonTypes.POINT)return;(t.properties.user_isCircle?BU(t):FU(t)).forEach(r)};globalThis&&globalThis.__awaiter;function UU(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,l;for(l=0;l<n.length;l++)a=n[l],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}var jU=["color"],$U=ro.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=UU(e,jU);return ro.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a,{ref:t}),ro.createElement("path",{d:"M12.8536 2.85355C13.0488 2.65829 13.0488 2.34171 12.8536 2.14645C12.6583 1.95118 12.3417 1.95118 12.1464 2.14645L7.5 6.79289L2.85355 2.14645C2.65829 1.95118 2.34171 1.95118 2.14645 2.14645C1.95118 2.34171 1.95118 2.65829 2.14645 2.85355L6.79289 7.5L2.14645 12.1464C1.95118 12.3417 1.95118 12.6583 2.14645 12.8536C2.34171 13.0488 2.65829 13.0488 2.85355 12.8536L7.5 8.20711L12.1464 12.8536C12.3417 13.0488 12.6583 13.0488 12.8536 12.8536C13.0488 12.6583 13.0488 12.3417 12.8536 12.1464L8.20711 7.5L12.8536 2.85355Z",fill:n,fillRule:"evenodd",clipRule:"evenodd"}))});let VU=()=>({emit(e,...t){let r=this.events[e]||[];for(let n=0,a=r.length;n<a;n++)r[n](...t)},events:{},on(e,t){var r;return(r=this.events[e])!=null&&r.push(t)||(this.events[e]=[t]),()=>{var n;this.events[e]=(n=this.events[e])==null?void 0:n.filter(a=>t!==a)}}});const pI=VU();function r0(e,t){return r0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},r0(e,t)}function jf(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r0(e,t)}var $f=function(){function e(){this.listeners=[]}var t=e.prototype;return t.subscribe=function(n){var a=this,l=n||function(){};return this.listeners.push(l),this.onSubscribe(),function(){a.listeners=a.listeners.filter(function(f){return f!==l}),a.onUnsubscribe()}},t.hasListeners=function(){return this.listeners.length>0},t.onSubscribe=function(){},t.onUnsubscribe=function(){},e}();function hn(){return hn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hn.apply(this,arguments)}var Ym=typeof window>"u";function Fo(){}function GU(e,t){return typeof e=="function"?e(t):e}function n0(e){return typeof e=="number"&&e>=0&&e!==1/0}function Qm(e){return Array.isArray(e)?e:[e]}function mI(e,t){return Math.max(e+(t||0)-Date.now(),0)}function um(e,t,r){return Kg(e)?typeof t=="function"?hn({},r,{queryKey:e,queryFn:t}):hn({},t,{queryKey:e}):e}function wu(e,t,r){return Kg(e)?[hn({},t,{queryKey:e}),r]:[e||{},t]}function qU(e,t){if(e===!0&&t===!0||e==null&&t==null)return"all";if(e===!1&&t===!1)return"none";var r=e??!t;return r?"active":"inactive"}function GE(e,t){var r=e.active,n=e.exact,a=e.fetching,l=e.inactive,f=e.predicate,u=e.queryKey,E=e.stale;if(Kg(u)){if(n){if(t.queryHash!==Rx(u,t.options))return!1}else if(!eg(t.queryKey,u))return!1}var m=qU(r,l);if(m==="none")return!1;if(m!=="all"){var S=t.isActive();if(m==="active"&&!S||m==="inactive"&&S)return!1}return!(typeof E=="boolean"&&t.isStale()!==E||typeof a=="boolean"&&t.isFetching()!==a||f&&!f(t))}function qE(e,t){var r=e.exact,n=e.fetching,a=e.predicate,l=e.mutationKey;if(Kg(l)){if(!t.options.mutationKey)return!1;if(r){if(Ic(t.options.mutationKey)!==Ic(l))return!1}else if(!eg(t.options.mutationKey,l))return!1}return!(typeof n=="boolean"&&t.state.status==="loading"!==n||a&&!a(t))}function Rx(e,t){var r=(t==null?void 0:t.queryKeyHashFn)||Ic;return r(e)}function Ic(e){var t=Qm(e);return HU(t)}function HU(e){return JSON.stringify(e,function(t,r){return i0(r)?Object.keys(r).sort().reduce(function(n,a){return n[a]=r[a],n},{}):r})}function eg(e,t){return gI(Qm(e),Qm(t))}function gI(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(function(r){return!gI(e[r],t[r])}):!1}function tg(e,t){if(e===t)return e;var r=Array.isArray(e)&&Array.isArray(t);if(r||i0(e)&&i0(t)){for(var n=r?e.length:Object.keys(e).length,a=r?t:Object.keys(t),l=a.length,f=r?[]:{},u=0,E=0;E<l;E++){var m=r?E:a[E];f[m]=tg(e[m],t[m]),f[m]===e[m]&&u++}return n===l&&u===n?e:f}return t}function ZU(e,t){if(e&&!t||t&&!e)return!1;for(var r in e)if(e[r]!==t[r])return!1;return!0}function i0(e){if(!HE(e))return!1;var t=e.constructor;if(typeof t>"u")return!0;var r=t.prototype;return!(!HE(r)||!r.hasOwnProperty("isPrototypeOf"))}function HE(e){return Object.prototype.toString.call(e)==="[object Object]"}function Kg(e){return typeof e=="string"||Array.isArray(e)}function WU(e){return new Promise(function(t){setTimeout(t,e)})}function ZE(e){Promise.resolve().then(e).catch(function(t){return setTimeout(function(){throw t})})}function yI(){if(typeof AbortController=="function")return new AbortController}var KU=function(e){jf(t,e);function t(){var n;return n=e.call(this)||this,n.setup=function(a){var l;if(!Ym&&((l=window)!=null&&l.addEventListener)){var f=function(){return a()};return window.addEventListener("visibilitychange",f,!1),window.addEventListener("focus",f,!1),function(){window.removeEventListener("visibilitychange",f),window.removeEventListener("focus",f)}}},n}var r=t.prototype;return r.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},r.onUnsubscribe=function(){if(!this.hasListeners()){var a;(a=this.cleanup)==null||a.call(this),this.cleanup=void 0}},r.setEventListener=function(a){var l,f=this;this.setup=a,(l=this.cleanup)==null||l.call(this),this.cleanup=a(function(u){typeof u=="boolean"?f.setFocused(u):f.onFocus()})},r.setFocused=function(a){this.focused=a,a&&this.onFocus()},r.onFocus=function(){this.listeners.forEach(function(a){a()})},r.isFocused=function(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)},t}($f),sf=new KU,XU=function(e){jf(t,e);function t(){var n;return n=e.call(this)||this,n.setup=function(a){var l;if(!Ym&&((l=window)!=null&&l.addEventListener)){var f=function(){return a()};return window.addEventListener("online",f,!1),window.addEventListener("offline",f,!1),function(){window.removeEventListener("online",f),window.removeEventListener("offline",f)}}},n}var r=t.prototype;return r.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},r.onUnsubscribe=function(){if(!this.hasListeners()){var a;(a=this.cleanup)==null||a.call(this),this.cleanup=void 0}},r.setEventListener=function(a){var l,f=this;this.setup=a,(l=this.cleanup)==null||l.call(this),this.cleanup=a(function(u){typeof u=="boolean"?f.setOnline(u):f.onOnline()})},r.setOnline=function(a){this.online=a,a&&this.onOnline()},r.onOnline=function(){this.listeners.forEach(function(a){a()})},r.isOnline=function(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine},t}($f),cm=new XU;function JU(e){return Math.min(1e3*Math.pow(2,e),3e4)}function rg(e){return typeof(e==null?void 0:e.cancel)=="function"}var vI=function(t){this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent};function hm(e){return e instanceof vI}var _I=function(t){var r=this,n=!1,a,l,f,u;this.abort=t.abort,this.cancel=function(z){return a==null?void 0:a(z)},this.cancelRetry=function(){n=!0},this.continueRetry=function(){n=!1},this.continue=function(){return l==null?void 0:l()},this.failureCount=0,this.isPaused=!1,this.isResolved=!1,this.isTransportCancelable=!1,this.promise=new Promise(function(z,H){f=z,u=H});var E=function(H){r.isResolved||(r.isResolved=!0,t.onSuccess==null||t.onSuccess(H),l==null||l(),f(H))},m=function(H){r.isResolved||(r.isResolved=!0,t.onError==null||t.onError(H),l==null||l(),u(H))},S=function(){return new Promise(function(H){l=H,r.isPaused=!0,t.onPause==null||t.onPause()}).then(function(){l=void 0,r.isPaused=!1,t.onContinue==null||t.onContinue()})},M=function z(){if(!r.isResolved){var H;try{H=t.fn()}catch(q){H=Promise.reject(q)}a=function(Y){if(!r.isResolved&&(m(new vI(Y)),r.abort==null||r.abort(),rg(H)))try{H.cancel()}catch{}},r.isTransportCancelable=rg(H),Promise.resolve(H).then(E).catch(function(q){var Y,ye;if(!r.isResolved){var Q=(Y=t.retry)!=null?Y:3,te=(ye=t.retryDelay)!=null?ye:JU,ne=typeof te=="function"?te(r.failureCount,q):te,Me=Q===!0||typeof Q=="number"&&r.failureCount<Q||typeof Q=="function"&&Q(r.failureCount,q);if(n||!Me){m(q);return}r.failureCount++,t.onFail==null||t.onFail(r.failureCount,q),WU(ne).then(function(){if(!sf.isFocused()||!cm.isOnline())return S()}).then(function(){n?m(q):z()})}})}};M()},YU=function(){function e(){this.queue=[],this.transactions=0,this.notifyFn=function(r){r()},this.batchNotifyFn=function(r){r()}}var t=e.prototype;return t.batch=function(n){var a;this.transactions++;try{a=n()}finally{this.transactions--,this.transactions||this.flush()}return a},t.schedule=function(n){var a=this;this.transactions?this.queue.push(n):ZE(function(){a.notifyFn(n)})},t.batchCalls=function(n){var a=this;return function(){for(var l=arguments.length,f=new Array(l),u=0;u<l;u++)f[u]=arguments[u];a.schedule(function(){n.apply(void 0,f)})}},t.flush=function(){var n=this,a=this.queue;this.queue=[],a.length&&ZE(function(){n.batchNotifyFn(function(){a.forEach(function(l){n.notifyFn(l)})})})},t.setNotifyFunction=function(n){this.notifyFn=n},t.setBatchNotifyFunction=function(n){this.batchNotifyFn=n},e}(),fi=new YU,xI=console;function ng(){return xI}function QU(e){xI=e}var e8=function(){function e(r){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=r.defaultOptions,this.setOptions(r.options),this.observers=[],this.cache=r.cache,this.queryKey=r.queryKey,this.queryHash=r.queryHash,this.initialState=r.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=r.meta,this.scheduleGc()}var t=e.prototype;return t.setOptions=function(n){var a;this.options=hn({},this.defaultOptions,n),this.meta=n==null?void 0:n.meta,this.cacheTime=Math.max(this.cacheTime||0,(a=this.options.cacheTime)!=null?a:5*60*1e3)},t.setDefaultOptions=function(n){this.defaultOptions=n},t.scheduleGc=function(){var n=this;this.clearGcTimeout(),n0(this.cacheTime)&&(this.gcTimeout=setTimeout(function(){n.optionalRemove()},this.cacheTime))},t.clearGcTimeout=function(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)},t.optionalRemove=function(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))},t.setData=function(n,a){var l,f,u=this.state.data,E=GU(n,u);return(l=(f=this.options).isDataEqual)!=null&&l.call(f,u,E)?E=u:this.options.structuralSharing!==!1&&(E=tg(u,E)),this.dispatch({data:E,type:"success",dataUpdatedAt:a==null?void 0:a.updatedAt}),E},t.setState=function(n,a){this.dispatch({type:"setState",state:n,setStateOptions:a})},t.cancel=function(n){var a,l=this.promise;return(a=this.retryer)==null||a.cancel(n),l?l.then(Fo).catch(Fo):Promise.resolve()},t.destroy=function(){this.clearGcTimeout(),this.cancel({silent:!0})},t.reset=function(){this.destroy(),this.setState(this.initialState)},t.isActive=function(){return this.observers.some(function(n){return n.options.enabled!==!1})},t.isFetching=function(){return this.state.isFetching},t.isStale=function(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(function(n){return n.getCurrentResult().isStale})},t.isStaleByTime=function(n){return n===void 0&&(n=0),this.state.isInvalidated||!this.state.dataUpdatedAt||!mI(this.state.dataUpdatedAt,n)},t.onFocus=function(){var n,a=this.observers.find(function(l){return l.shouldFetchOnWindowFocus()});a&&a.refetch(),(n=this.retryer)==null||n.continue()},t.onOnline=function(){var n,a=this.observers.find(function(l){return l.shouldFetchOnReconnect()});a&&a.refetch(),(n=this.retryer)==null||n.continue()},t.addObserver=function(n){this.observers.indexOf(n)===-1&&(this.observers.push(n),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:n}))},t.removeObserver=function(n){this.observers.indexOf(n)!==-1&&(this.observers=this.observers.filter(function(a){return a!==n}),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:n}))},t.getObserversCount=function(){return this.observers.length},t.invalidate=function(){this.state.isInvalidated||this.dispatch({type:"invalidate"})},t.fetch=function(n,a){var l=this,f,u,E;if(this.state.isFetching){if(this.state.dataUpdatedAt&&(a!=null&&a.cancelRefetch))this.cancel({silent:!0});else if(this.promise){var m;return(m=this.retryer)==null||m.continueRetry(),this.promise}}if(n&&this.setOptions(n),!this.options.queryFn){var S=this.observers.find(function(te){return te.options.queryFn});S&&this.setOptions(S.options)}var M=Qm(this.queryKey),z=yI(),H={queryKey:M,pageParam:void 0,meta:this.meta};Object.defineProperty(H,"signal",{enumerable:!0,get:function(){if(z)return l.abortSignalConsumed=!0,z.signal}});var q=function(){return l.options.queryFn?(l.abortSignalConsumed=!1,l.options.queryFn(H)):Promise.reject("Missing queryFn")},Y={fetchOptions:a,options:this.options,queryKey:M,state:this.state,fetchFn:q,meta:this.meta};if((f=this.options.behavior)!=null&&f.onFetch){var ye;(ye=this.options.behavior)==null||ye.onFetch(Y)}if(this.revertState=this.state,!this.state.isFetching||this.state.fetchMeta!==((u=Y.fetchOptions)==null?void 0:u.meta)){var Q;this.dispatch({type:"fetch",meta:(Q=Y.fetchOptions)==null?void 0:Q.meta})}return this.retryer=new _I({fn:Y.fetchFn,abort:z==null||(E=z.abort)==null?void 0:E.bind(z),onSuccess:function(ne){l.setData(ne),l.cache.config.onSuccess==null||l.cache.config.onSuccess(ne,l),l.cacheTime===0&&l.optionalRemove()},onError:function(ne){hm(ne)&&ne.silent||l.dispatch({type:"error",error:ne}),hm(ne)||(l.cache.config.onError==null||l.cache.config.onError(ne,l),ng().error(ne)),l.cacheTime===0&&l.optionalRemove()},onFail:function(){l.dispatch({type:"failed"})},onPause:function(){l.dispatch({type:"pause"})},onContinue:function(){l.dispatch({type:"continue"})},retry:Y.options.retry,retryDelay:Y.options.retryDelay}),this.promise=this.retryer.promise,this.promise},t.dispatch=function(n){var a=this;this.state=this.reducer(this.state,n),fi.batch(function(){a.observers.forEach(function(l){l.onQueryUpdate(n)}),a.cache.notify({query:a,type:"queryUpdated",action:n})})},t.getDefaultState=function(n){var a=typeof n.initialData=="function"?n.initialData():n.initialData,l=typeof n.initialData<"u",f=l?typeof n.initialDataUpdatedAt=="function"?n.initialDataUpdatedAt():n.initialDataUpdatedAt:0,u=typeof a<"u";return{data:a,dataUpdateCount:0,dataUpdatedAt:u?f??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:u?"success":"idle"}},t.reducer=function(n,a){var l,f;switch(a.type){case"failed":return hn({},n,{fetchFailureCount:n.fetchFailureCount+1});case"pause":return hn({},n,{isPaused:!0});case"continue":return hn({},n,{isPaused:!1});case"fetch":return hn({},n,{fetchFailureCount:0,fetchMeta:(l=a.meta)!=null?l:null,isFetching:!0,isPaused:!1},!n.dataUpdatedAt&&{error:null,status:"loading"});case"success":return hn({},n,{data:a.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:(f=a.dataUpdatedAt)!=null?f:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":var u=a.error;return hm(u)&&u.revert&&this.revertState?hn({},this.revertState):hn({},n,{error:u,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return hn({},n,{isInvalidated:!0});case"setState":return hn({},n,a.state);default:return n}},e}(),t8=function(e){jf(t,e);function t(n){var a;return a=e.call(this)||this,a.config=n||{},a.queries=[],a.queriesMap={},a}var r=t.prototype;return r.build=function(a,l,f){var u,E=l.queryKey,m=(u=l.queryHash)!=null?u:Rx(E,l),S=this.get(m);return S||(S=new e8({cache:this,queryKey:E,queryHash:m,options:a.defaultQueryOptions(l),state:f,defaultOptions:a.getQueryDefaults(E),meta:l.meta}),this.add(S)),S},r.add=function(a){this.queriesMap[a.queryHash]||(this.queriesMap[a.queryHash]=a,this.queries.push(a),this.notify({type:"queryAdded",query:a}))},r.remove=function(a){var l=this.queriesMap[a.queryHash];l&&(a.destroy(),this.queries=this.queries.filter(function(f){return f!==a}),l===a&&delete this.queriesMap[a.queryHash],this.notify({type:"queryRemoved",query:a}))},r.clear=function(){var a=this;fi.batch(function(){a.queries.forEach(function(l){a.remove(l)})})},r.get=function(a){return this.queriesMap[a]},r.getAll=function(){return this.queries},r.find=function(a,l){var f=wu(a,l),u=f[0];return typeof u.exact>"u"&&(u.exact=!0),this.queries.find(function(E){return GE(u,E)})},r.findAll=function(a,l){var f=wu(a,l),u=f[0];return Object.keys(u).length>0?this.queries.filter(function(E){return GE(u,E)}):this.queries},r.notify=function(a){var l=this;fi.batch(function(){l.listeners.forEach(function(f){f(a)})})},r.onFocus=function(){var a=this;fi.batch(function(){a.queries.forEach(function(l){l.onFocus()})})},r.onOnline=function(){var a=this;fi.batch(function(){a.queries.forEach(function(l){l.onOnline()})})},t}($f),r8=function(){function e(r){this.options=hn({},r.defaultOptions,r.options),this.mutationId=r.mutationId,this.mutationCache=r.mutationCache,this.observers=[],this.state=r.state||n8(),this.meta=r.meta}var t=e.prototype;return t.setState=function(n){this.dispatch({type:"setState",state:n})},t.addObserver=function(n){this.observers.indexOf(n)===-1&&this.observers.push(n)},t.removeObserver=function(n){this.observers=this.observers.filter(function(a){return a!==n})},t.cancel=function(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(Fo).catch(Fo)):Promise.resolve()},t.continue=function(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()},t.execute=function(){var n=this,a,l=this.state.status==="loading",f=Promise.resolve();return l||(this.dispatch({type:"loading",variables:this.options.variables}),f=f.then(function(){n.mutationCache.config.onMutate==null||n.mutationCache.config.onMutate(n.state.variables,n)}).then(function(){return n.options.onMutate==null?void 0:n.options.onMutate(n.state.variables)}).then(function(u){u!==n.state.context&&n.dispatch({type:"loading",context:u,variables:n.state.variables})})),f.then(function(){return n.executeMutation()}).then(function(u){a=u,n.mutationCache.config.onSuccess==null||n.mutationCache.config.onSuccess(a,n.state.variables,n.state.context,n)}).then(function(){return n.options.onSuccess==null?void 0:n.options.onSuccess(a,n.state.variables,n.state.context)}).then(function(){return n.options.onSettled==null?void 0:n.options.onSettled(a,null,n.state.variables,n.state.context)}).then(function(){return n.dispatch({type:"success",data:a}),a}).catch(function(u){return n.mutationCache.config.onError==null||n.mutationCache.config.onError(u,n.state.variables,n.state.context,n),ng().error(u),Promise.resolve().then(function(){return n.options.onError==null?void 0:n.options.onError(u,n.state.variables,n.state.context)}).then(function(){return n.options.onSettled==null?void 0:n.options.onSettled(void 0,u,n.state.variables,n.state.context)}).then(function(){throw n.dispatch({type:"error",error:u}),u})})},t.executeMutation=function(){var n=this,a;return this.retryer=new _I({fn:function(){return n.options.mutationFn?n.options.mutationFn(n.state.variables):Promise.reject("No mutationFn found")},onFail:function(){n.dispatch({type:"failed"})},onPause:function(){n.dispatch({type:"pause"})},onContinue:function(){n.dispatch({type:"continue"})},retry:(a=this.options.retry)!=null?a:0,retryDelay:this.options.retryDelay}),this.retryer.promise},t.dispatch=function(n){var a=this;this.state=i8(this.state,n),fi.batch(function(){a.observers.forEach(function(l){l.onMutationUpdate(n)}),a.mutationCache.notify(a)})},e}();function n8(){return{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0}}function i8(e,t){switch(t.type){case"failed":return hn({},e,{failureCount:e.failureCount+1});case"pause":return hn({},e,{isPaused:!0});case"continue":return hn({},e,{isPaused:!1});case"loading":return hn({},e,{context:t.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:t.variables});case"success":return hn({},e,{data:t.data,error:null,status:"success",isPaused:!1});case"error":return hn({},e,{data:void 0,error:t.error,failureCount:e.failureCount+1,isPaused:!1,status:"error"});case"setState":return hn({},e,t.state);default:return e}}var o8=function(e){jf(t,e);function t(n){var a;return a=e.call(this)||this,a.config=n||{},a.mutations=[],a.mutationId=0,a}var r=t.prototype;return r.build=function(a,l,f){var u=new r8({mutationCache:this,mutationId:++this.mutationId,options:a.defaultMutationOptions(l),state:f,defaultOptions:l.mutationKey?a.getMutationDefaults(l.mutationKey):void 0,meta:l.meta});return this.add(u),u},r.add=function(a){this.mutations.push(a),this.notify(a)},r.remove=function(a){this.mutations=this.mutations.filter(function(l){return l!==a}),a.cancel(),this.notify(a)},r.clear=function(){var a=this;fi.batch(function(){a.mutations.forEach(function(l){a.remove(l)})})},r.getAll=function(){return this.mutations},r.find=function(a){return typeof a.exact>"u"&&(a.exact=!0),this.mutations.find(function(l){return qE(a,l)})},r.findAll=function(a){return this.mutations.filter(function(l){return qE(a,l)})},r.notify=function(a){var l=this;fi.batch(function(){l.listeners.forEach(function(f){f(a)})})},r.onFocus=function(){this.resumePausedMutations()},r.onOnline=function(){this.resumePausedMutations()},r.resumePausedMutations=function(){var a=this.mutations.filter(function(l){return l.state.isPaused});return fi.batch(function(){return a.reduce(function(l,f){return l.then(function(){return f.continue().catch(Fo)})},Promise.resolve())})},t}($f);function s8(){return{onFetch:function(t){t.fetchFn=function(){var r,n,a,l,f,u,E=(r=t.fetchOptions)==null||(n=r.meta)==null?void 0:n.refetchPage,m=(a=t.fetchOptions)==null||(l=a.meta)==null?void 0:l.fetchMore,S=m==null?void 0:m.pageParam,M=(m==null?void 0:m.direction)==="forward",z=(m==null?void 0:m.direction)==="backward",H=((f=t.state.data)==null?void 0:f.pages)||[],q=((u=t.state.data)==null?void 0:u.pageParams)||[],Y=yI(),ye=Y==null?void 0:Y.signal,Q=q,te=!1,ne=t.options.queryFn||function(){return Promise.reject("Missing queryFn")},Me=function(Tr,sn,qr,Un){return Q=Un?[sn].concat(Q):[].concat(Q,[sn]),Un?[qr].concat(Tr):[].concat(Tr,[qr])},Ve=function(Tr,sn,qr,Un){if(te)return Promise.reject("Cancelled");if(typeof qr>"u"&&!sn&&Tr.length)return Promise.resolve(Tr);var pt={queryKey:t.queryKey,signal:ye,pageParam:qr,meta:t.meta},Nt=ne(pt),mt=Promise.resolve(Nt).then(function(Ar){return Me(Tr,qr,Ar,Un)});if(rg(Nt)){var gr=mt;gr.cancel=Nt.cancel}return mt},je;if(!H.length)je=Ve([]);else if(M){var Qe=typeof S<"u",ot=Qe?S:WE(t.options,H);je=Ve(H,Qe,ot)}else if(z){var Ut=typeof S<"u",st=Ut?S:a8(t.options,H);je=Ve(H,Ut,st,!0)}else(function(){Q=[];var Xr=typeof t.options.getNextPageParam>"u",Tr=E&&H[0]?E(H[0],0,H):!0;je=Tr?Ve([],Xr,q[0]):Promise.resolve(Me([],q[0],H[0]));for(var sn=function(pt){je=je.then(function(Nt){var mt=E&&H[pt]?E(H[pt],pt,H):!0;if(mt){var gr=Xr?q[pt]:WE(t.options,Nt);return Ve(Nt,Xr,gr)}return Promise.resolve(Me(Nt,q[pt],H[pt]))})},qr=1;qr<H.length;qr++)sn(qr)})();var Qt=je.then(function(Xr){return{pages:Xr,pageParams:Q}}),ar=Qt;return ar.cancel=function(){te=!0,Y==null||Y.abort(),rg(je)&&je.cancel()},Qt}}}}function WE(e,t){return e.getNextPageParam==null?void 0:e.getNextPageParam(t[t.length-1],t)}function a8(e,t){return e.getPreviousPageParam==null?void 0:e.getPreviousPageParam(t[0],t)}var l8=function(){function e(r){r===void 0&&(r={}),this.queryCache=r.queryCache||new t8,this.mutationCache=r.mutationCache||new o8,this.defaultOptions=r.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}var t=e.prototype;return t.mount=function(){var n=this;this.unsubscribeFocus=sf.subscribe(function(){sf.isFocused()&&cm.isOnline()&&(n.mutationCache.onFocus(),n.queryCache.onFocus())}),this.unsubscribeOnline=cm.subscribe(function(){sf.isFocused()&&cm.isOnline()&&(n.mutationCache.onOnline(),n.queryCache.onOnline())})},t.unmount=function(){var n,a;(n=this.unsubscribeFocus)==null||n.call(this),(a=this.unsubscribeOnline)==null||a.call(this)},t.isFetching=function(n,a){var l=wu(n,a),f=l[0];return f.fetching=!0,this.queryCache.findAll(f).length},t.isMutating=function(n){return this.mutationCache.findAll(hn({},n,{fetching:!0})).length},t.getQueryData=function(n,a){var l;return(l=this.queryCache.find(n,a))==null?void 0:l.state.data},t.getQueriesData=function(n){return this.getQueryCache().findAll(n).map(function(a){var l=a.queryKey,f=a.state,u=f.data;return[l,u]})},t.setQueryData=function(n,a,l){var f=um(n),u=this.defaultQueryOptions(f);return this.queryCache.build(this,u).setData(a,l)},t.setQueriesData=function(n,a,l){var f=this;return fi.batch(function(){return f.getQueryCache().findAll(n).map(function(u){var E=u.queryKey;return[E,f.setQueryData(E,a,l)]})})},t.getQueryState=function(n,a){var l;return(l=this.queryCache.find(n,a))==null?void 0:l.state},t.removeQueries=function(n,a){var l=wu(n,a),f=l[0],u=this.queryCache;fi.batch(function(){u.findAll(f).forEach(function(E){u.remove(E)})})},t.resetQueries=function(n,a,l){var f=this,u=wu(n,a,l),E=u[0],m=u[1],S=this.queryCache,M=hn({},E,{active:!0});return fi.batch(function(){return S.findAll(E).forEach(function(z){z.reset()}),f.refetchQueries(M,m)})},t.cancelQueries=function(n,a,l){var f=this,u=wu(n,a,l),E=u[0],m=u[1],S=m===void 0?{}:m;typeof S.revert>"u"&&(S.revert=!0);var M=fi.batch(function(){return f.queryCache.findAll(E).map(function(z){return z.cancel(S)})});return Promise.all(M).then(Fo).catch(Fo)},t.invalidateQueries=function(n,a,l){var f,u,E,m=this,S=wu(n,a,l),M=S[0],z=S[1],H=hn({},M,{active:(f=(u=M.refetchActive)!=null?u:M.active)!=null?f:!0,inactive:(E=M.refetchInactive)!=null?E:!1});return fi.batch(function(){return m.queryCache.findAll(M).forEach(function(q){q.invalidate()}),m.refetchQueries(H,z)})},t.refetchQueries=function(n,a,l){var f=this,u=wu(n,a,l),E=u[0],m=u[1],S=fi.batch(function(){return f.queryCache.findAll(E).map(function(z){return z.fetch(void 0,hn({},m,{meta:{refetchPage:E==null?void 0:E.refetchPage}}))})}),M=Promise.all(S).then(Fo);return m!=null&&m.throwOnError||(M=M.catch(Fo)),M},t.fetchQuery=function(n,a,l){var f=um(n,a,l),u=this.defaultQueryOptions(f);typeof u.retry>"u"&&(u.retry=!1);var E=this.queryCache.build(this,u);return E.isStaleByTime(u.staleTime)?E.fetch(u):Promise.resolve(E.state.data)},t.prefetchQuery=function(n,a,l){return this.fetchQuery(n,a,l).then(Fo).catch(Fo)},t.fetchInfiniteQuery=function(n,a,l){var f=um(n,a,l);return f.behavior=s8(),this.fetchQuery(f)},t.prefetchInfiniteQuery=function(n,a,l){return this.fetchInfiniteQuery(n,a,l).then(Fo).catch(Fo)},t.cancelMutations=function(){var n=this,a=fi.batch(function(){return n.mutationCache.getAll().map(function(l){return l.cancel()})});return Promise.all(a).then(Fo).catch(Fo)},t.resumePausedMutations=function(){return this.getMutationCache().resumePausedMutations()},t.executeMutation=function(n){return this.mutationCache.build(this,n).execute()},t.getQueryCache=function(){return this.queryCache},t.getMutationCache=function(){return this.mutationCache},t.getDefaultOptions=function(){return this.defaultOptions},t.setDefaultOptions=function(n){this.defaultOptions=n},t.setQueryDefaults=function(n,a){var l=this.queryDefaults.find(function(f){return Ic(n)===Ic(f.queryKey)});l?l.defaultOptions=a:this.queryDefaults.push({queryKey:n,defaultOptions:a})},t.getQueryDefaults=function(n){var a;return n?(a=this.queryDefaults.find(function(l){return eg(n,l.queryKey)}))==null?void 0:a.defaultOptions:void 0},t.setMutationDefaults=function(n,a){var l=this.mutationDefaults.find(function(f){return Ic(n)===Ic(f.mutationKey)});l?l.defaultOptions=a:this.mutationDefaults.push({mutationKey:n,defaultOptions:a})},t.getMutationDefaults=function(n){var a;return n?(a=this.mutationDefaults.find(function(l){return eg(n,l.mutationKey)}))==null?void 0:a.defaultOptions:void 0},t.defaultQueryOptions=function(n){if(n!=null&&n._defaulted)return n;var a=hn({},this.defaultOptions.queries,this.getQueryDefaults(n==null?void 0:n.queryKey),n,{_defaulted:!0});return!a.queryHash&&a.queryKey&&(a.queryHash=Rx(a.queryKey,a)),a},t.defaultQueryObserverOptions=function(n){return this.defaultQueryOptions(n)},t.defaultMutationOptions=function(n){return n!=null&&n._defaulted?n:hn({},this.defaultOptions.mutations,this.getMutationDefaults(n==null?void 0:n.mutationKey),n,{_defaulted:!0})},t.clear=function(){this.queryCache.clear(),this.mutationCache.clear()},e}(),u8=function(e){jf(t,e);function t(n,a){var l;return l=e.call(this)||this,l.client=n,l.options=a,l.trackedProps=[],l.selectError=null,l.bindMethods(),l.setOptions(a),l}var r=t.prototype;return r.bindMethods=function(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)},r.onSubscribe=function(){this.listeners.length===1&&(this.currentQuery.addObserver(this),KE(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())},r.onUnsubscribe=function(){this.listeners.length||this.destroy()},r.shouldFetchOnReconnect=function(){return o0(this.currentQuery,this.options,this.options.refetchOnReconnect)},r.shouldFetchOnWindowFocus=function(){return o0(this.currentQuery,this.options,this.options.refetchOnWindowFocus)},r.destroy=function(){this.listeners=[],this.clearTimers(),this.currentQuery.removeObserver(this)},r.setOptions=function(a,l){var f=this.options,u=this.currentQuery;if(this.options=this.client.defaultQueryObserverOptions(a),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=f.queryKey),this.updateQuery();var E=this.hasListeners();E&&XE(this.currentQuery,u,this.options,f)&&this.executeFetch(),this.updateResult(l),E&&(this.currentQuery!==u||this.options.enabled!==f.enabled||this.options.staleTime!==f.staleTime)&&this.updateStaleTimeout();var m=this.computeRefetchInterval();E&&(this.currentQuery!==u||this.options.enabled!==f.enabled||m!==this.currentRefetchInterval)&&this.updateRefetchInterval(m)},r.getOptimisticResult=function(a){var l=this.client.defaultQueryObserverOptions(a),f=this.client.getQueryCache().build(this.client,l);return this.createResult(f,l)},r.getCurrentResult=function(){return this.currentResult},r.trackResult=function(a,l){var f=this,u={},E=function(S){f.trackedProps.includes(S)||f.trackedProps.push(S)};return Object.keys(a).forEach(function(m){Object.defineProperty(u,m,{configurable:!1,enumerable:!0,get:function(){return E(m),a[m]}})}),(l.useErrorBoundary||l.suspense)&&E("error"),u},r.getNextResult=function(a){var l=this;return new Promise(function(f,u){var E=l.subscribe(function(m){m.isFetching||(E(),m.isError&&(a!=null&&a.throwOnError)?u(m.error):f(m))})})},r.getCurrentQuery=function(){return this.currentQuery},r.remove=function(){this.client.getQueryCache().remove(this.currentQuery)},r.refetch=function(a){return this.fetch(hn({},a,{meta:{refetchPage:a==null?void 0:a.refetchPage}}))},r.fetchOptimistic=function(a){var l=this,f=this.client.defaultQueryObserverOptions(a),u=this.client.getQueryCache().build(this.client,f);return u.fetch().then(function(){return l.createResult(u,f)})},r.fetch=function(a){var l=this;return this.executeFetch(a).then(function(){return l.updateResult(),l.currentResult})},r.executeFetch=function(a){this.updateQuery();var l=this.currentQuery.fetch(this.options,a);return a!=null&&a.throwOnError||(l=l.catch(Fo)),l},r.updateStaleTimeout=function(){var a=this;if(this.clearStaleTimeout(),!(Ym||this.currentResult.isStale||!n0(this.options.staleTime))){var l=mI(this.currentResult.dataUpdatedAt,this.options.staleTime),f=l+1;this.staleTimeoutId=setTimeout(function(){a.currentResult.isStale||a.updateResult()},f)}},r.computeRefetchInterval=function(){var a;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(a=this.options.refetchInterval)!=null?a:!1},r.updateRefetchInterval=function(a){var l=this;this.clearRefetchInterval(),this.currentRefetchInterval=a,!(Ym||this.options.enabled===!1||!n0(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(function(){(l.options.refetchIntervalInBackground||sf.isFocused())&&l.executeFetch()},this.currentRefetchInterval))},r.updateTimers=function(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())},r.clearTimers=function(){this.clearStaleTimeout(),this.clearRefetchInterval()},r.clearStaleTimeout=function(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)},r.clearRefetchInterval=function(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)},r.createResult=function(a,l){var f=this.currentQuery,u=this.options,E=this.currentResult,m=this.currentResultState,S=this.currentResultOptions,M=a!==f,z=M?a.state:this.currentQueryInitialState,H=M?this.currentResult:this.previousQueryResult,q=a.state,Y=q.dataUpdatedAt,ye=q.error,Q=q.errorUpdatedAt,te=q.isFetching,ne=q.status,Me=!1,Ve=!1,je;if(l.optimisticResults){var Qe=this.hasListeners(),ot=!Qe&&KE(a,l),Ut=Qe&&XE(a,f,l,u);(ot||Ut)&&(te=!0,Y||(ne="loading"))}if(l.keepPreviousData&&!q.dataUpdateCount&&(H!=null&&H.isSuccess)&&ne!=="error")je=H.data,Y=H.dataUpdatedAt,ne=H.status,Me=!0;else if(l.select&&typeof q.data<"u")if(E&&q.data===(m==null?void 0:m.data)&&l.select===this.selectFn)je=this.selectResult;else try{this.selectFn=l.select,je=l.select(q.data),l.structuralSharing!==!1&&(je=tg(E==null?void 0:E.data,je)),this.selectResult=je,this.selectError=null}catch(ar){ng().error(ar),this.selectError=ar}else je=q.data;if(typeof l.placeholderData<"u"&&typeof je>"u"&&(ne==="loading"||ne==="idle")){var st;if(E!=null&&E.isPlaceholderData&&l.placeholderData===(S==null?void 0:S.placeholderData))st=E.data;else if(st=typeof l.placeholderData=="function"?l.placeholderData():l.placeholderData,l.select&&typeof st<"u")try{st=l.select(st),l.structuralSharing!==!1&&(st=tg(E==null?void 0:E.data,st)),this.selectError=null}catch(ar){ng().error(ar),this.selectError=ar}typeof st<"u"&&(ne="success",je=st,Ve=!0)}this.selectError&&(ye=this.selectError,je=this.selectResult,Q=Date.now(),ne="error");var Qt={status:ne,isLoading:ne==="loading",isSuccess:ne==="success",isError:ne==="error",isIdle:ne==="idle",data:je,dataUpdatedAt:Y,error:ye,errorUpdatedAt:Q,failureCount:q.fetchFailureCount,errorUpdateCount:q.errorUpdateCount,isFetched:q.dataUpdateCount>0||q.errorUpdateCount>0,isFetchedAfterMount:q.dataUpdateCount>z.dataUpdateCount||q.errorUpdateCount>z.errorUpdateCount,isFetching:te,isRefetching:te&&ne!=="loading",isLoadingError:ne==="error"&&q.dataUpdatedAt===0,isPlaceholderData:Ve,isPreviousData:Me,isRefetchError:ne==="error"&&q.dataUpdatedAt!==0,isStale:Ox(a,l),refetch:this.refetch,remove:this.remove};return Qt},r.shouldNotifyListeners=function(a,l){if(!l)return!0;var f=this.options,u=f.notifyOnChangeProps,E=f.notifyOnChangePropsExclusions;if(!u&&!E||u==="tracked"&&!this.trackedProps.length)return!0;var m=u==="tracked"?this.trackedProps:u;return Object.keys(a).some(function(S){var M=S,z=a[M]!==l[M],H=m==null?void 0:m.some(function(Y){return Y===S}),q=E==null?void 0:E.some(function(Y){return Y===S});return z&&!q&&(!m||H)})},r.updateResult=function(a){var l=this.currentResult;if(this.currentResult=this.createResult(this.currentQuery,this.options),this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,!ZU(this.currentResult,l)){var f={cache:!0};(a==null?void 0:a.listeners)!==!1&&this.shouldNotifyListeners(this.currentResult,l)&&(f.listeners=!0),this.notify(hn({},f,a))}},r.updateQuery=function(){var a=this.client.getQueryCache().build(this.client,this.options);if(a!==this.currentQuery){var l=this.currentQuery;this.currentQuery=a,this.currentQueryInitialState=a.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(l==null||l.removeObserver(this),a.addObserver(this))}},r.onQueryUpdate=function(a){var l={};a.type==="success"?l.onSuccess=!0:a.type==="error"&&!hm(a.error)&&(l.onError=!0),this.updateResult(l),this.hasListeners()&&this.updateTimers()},r.notify=function(a){var l=this;fi.batch(function(){a.onSuccess?(l.options.onSuccess==null||l.options.onSuccess(l.currentResult.data),l.options.onSettled==null||l.options.onSettled(l.currentResult.data,null)):a.onError&&(l.options.onError==null||l.options.onError(l.currentResult.error),l.options.onSettled==null||l.options.onSettled(void 0,l.currentResult.error)),a.listeners&&l.listeners.forEach(function(f){f(l.currentResult)}),a.cache&&l.client.getQueryCache().notify({query:l.currentQuery,type:"observerResultsUpdated"})})},t}($f);function c8(e,t){return t.enabled!==!1&&!e.state.dataUpdatedAt&&!(e.state.status==="error"&&t.retryOnMount===!1)}function KE(e,t){return c8(e,t)||e.state.dataUpdatedAt>0&&o0(e,t,t.refetchOnMount)}function o0(e,t,r){if(t.enabled!==!1){var n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&Ox(e,t)}return!1}function XE(e,t,r,n){return r.enabled!==!1&&(e!==t||n.enabled===!1)&&(!r.suspense||e.state.status!=="error")&&Ox(e,r)}function Ox(e,t){return e.isStaleByTime(t.staleTime)}var h8=Fk.unstable_batchedUpdates;fi.setBatchNotifyFunction(h8);var d8=console;QU(d8);var JE=os.createContext(void 0),bI=os.createContext(!1);function wI(e){return e&&typeof window<"u"?(window.ReactQueryClientContext||(window.ReactQueryClientContext=JE),window.ReactQueryClientContext):JE}var f8=function(){var t=os.useContext(wI(os.useContext(bI)));if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},p8=function(t){var r=t.client,n=t.contextSharing,a=n===void 0?!1:n,l=t.children;os.useEffect(function(){return r.mount(),function(){r.unmount()}},[r]);var f=wI(a);return os.createElement(bI.Provider,{value:a},os.createElement(f.Provider,{value:r},l))};function m8(){var e=!1;return{clearReset:function(){e=!1},reset:function(){e=!0},isReset:function(){return e}}}var g8=os.createContext(m8()),y8=function(){return os.useContext(g8)};function v8(e,t,r){return typeof t=="function"?t.apply(void 0,r):typeof t=="boolean"?t:!!e}function _8(e,t){var r=os.useRef(!1),n=os.useState(0),a=n[1],l=f8(),f=y8(),u=l.defaultQueryObserverOptions(e);u.optimisticResults=!0,u.onError&&(u.onError=fi.batchCalls(u.onError)),u.onSuccess&&(u.onSuccess=fi.batchCalls(u.onSuccess)),u.onSettled&&(u.onSettled=fi.batchCalls(u.onSettled)),u.suspense&&(typeof u.staleTime!="number"&&(u.staleTime=1e3),u.cacheTime===0&&(u.cacheTime=1)),(u.suspense||u.useErrorBoundary)&&(f.isReset()||(u.retryOnMount=!1));var E=os.useState(function(){return new t(l,u)}),m=E[0],S=m.getOptimisticResult(u);if(os.useEffect(function(){r.current=!0,f.clearReset();var M=m.subscribe(fi.batchCalls(function(){r.current&&a(function(z){return z+1})}));return m.updateResult(),function(){r.current=!1,M()}},[f,m]),os.useEffect(function(){m.setOptions(u,{listeners:!1})},[u,m]),u.suspense&&S.isLoading)throw m.fetchOptimistic(u).then(function(M){var z=M.data;u.onSuccess==null||u.onSuccess(z),u.onSettled==null||u.onSettled(z,null)}).catch(function(M){f.clearReset(),u.onError==null||u.onError(M),u.onSettled==null||u.onSettled(void 0,M)});if(S.isError&&!f.isReset()&&!S.isFetching&&v8(u.suspense,u.useErrorBoundary,[S.error,m.getCurrentQuery()]))throw S.error;return u.notifyOnChangeProps==="tracked"&&(S=m.trackResult(S,u)),S}function x8(e,t,r){var n=um(e,t,r);return _8(n,u8)}const Dx=e=>x8(["points"],()=>fetch("http://roadwarrior-backend-lb-398197183.ap-southeast-1.elb.amazonaws.com/point",{referrerPolicy:"unsafe-url"}).then(t=>t.json()),{enabled:e});let YE=!1;async function b8(){const e=document.createElement("div");e.setAttribute("id","map");const t=await OB({container:"map",center:[101.38459258194803,3.372470579888785],zoom:9.9});return YE||(t.addControl(N6()),YE=!0),[e,t]}const w8=({isPanelVisible:e,hidePanel:t,panelData:r})=>Vt.jsx("div",{className:`h-full px-5 py-3 absolute left-0 top-0 z-50 pointer-events-none ${e?"w-80 opacity-100":"w-0 opacity-0"} duration-200`,children:Vt.jsxs("div",{className:"bg-gray-900 w-full rounded border border-gray-800 shadow pointer-events-auto",children:[Vt.jsxs("div",{className:"border-b border-gray-800 py-2 px-2 text-gray-50 text-sm font-semibold flex justify-between items-center",children:[Vt.jsx("span",{className:"pl-1",children:"Pothole View"}),Vt.jsx($U,{onClick:t,className:"cursor-pointer"})]}),Vt.jsx("div",{className:"p-2",children:Vt.jsx("img",{src:r==null?void 0:r.resourceUrl,className:"rounded-sm"})}),Vt.jsxs("div",{className:"p-2 flex flex-col text-gray-50 text-sm",children:[Vt.jsxs("div",{className:"font-light flex justify-between",children:[Vt.jsx("span",{children:"Coordinates: "}),Vt.jsxs("span",{children:[Number(r==null?void 0:r.coordinates[0]).toFixed(2),"°, ",Number(r==null?void 0:r.coordinates[1]).toFixed(2),"°"]})]}),Vt.jsxs("div",{className:"font-light flex justify-between",children:[Vt.jsx("span",{children:"Region: "}),Vt.jsx("span",{children:r==null?void 0:r.region})]}),Vt.jsxs("div",{className:"font-light flex justify-between",children:[Vt.jsx("span",{children:"Sub Region: "}),Vt.jsx("span",{children:r==null?void 0:r.subRegion})]}),Vt.jsxs("div",{className:"font-light flex justify-between",children:[Vt.jsx("span",{children:"No. Potholes: "}),Vt.jsx("span",{children:r==null?void 0:r.count})]})]})]})}),E8=()=>{const e=ro.useRef(null),t=ro.useRef(null),[r,n]=ro.useState(!1),[a,l]=ro.useState(),f=ro.useCallback(()=>n(!0),[]),u=ro.useCallback(()=>n(!1),[]),[E,m]=ro.useState(!1),{data:S}=Dx(E),M=ro.useCallback((z,H)=>{var q;return(q=t.current)==null?void 0:q.flyTo({center:[z,H]})},[]);return ro.useEffect(()=>{b8().then(([z,H])=>{e.current&&(e.current.appendChild(z),t.current=H,t.current.on("load",()=>m(!0)))})},[]),ro.useEffect(()=>{if(!(!S||!E))for(const z of S){const H=qB(z.sk,[{coordinates:z.coordinates.map(Number)}],t.current,{showCluster:!1,unclusteredOptions:{showMarkerPopup:!1},clusterOptions:{showCount:!0}});t.current.on("click",H.unclusteredLayerId,q=>{M(q.lngLat.lng,q.lngLat.lat),l(z),f()})}},[S,E]),ro.useEffect(()=>pI.on("viewPoint",z=>{M(Number(z.coordinates[0]),Number(z.coordinates[1])),l(z),f()}),[]),Vt.jsxs("div",{className:"w-full px-2 relative col-span-3",children:[Vt.jsx(w8,{isPanelVisible:r,panelData:a,hidePanel:u}),Vt.jsx("div",{ref:e,id:"map",className:"w-full h-[calc(100vh-73.5px)] rounded z-30"})]})},S8=()=>Vt.jsx("div",{className:"w-screen px-3 py-1.5 border-b border-gray-800 bg-gray-900 shadow",children:Vt.jsx("span",{className:"text-transparent font-bold bg-clip-text bg-gradient-to-r from-blue-500 to-blue-700 text-lg",children:"Road Warrior"})}),T8={aws_project_region:"ap-southeast-1",aws_content_delivery_bucket:"roadwarriordashboard-20230720141441-hostingbucket-dev",aws_content_delivery_bucket_region:"ap-southeast-1",aws_content_delivery_url:"https://d167wchb5k3sq8.cloudfront.net",aws_cognito_identity_pool_id:"ap-southeast-1:496cc280-a2c0-4ead-988a-f514d11f147d",aws_cognito_region:"ap-southeast-1",aws_user_pools_id:"ap-southeast-1_SRzoZfIjn",aws_user_pools_web_client_id:"7tmvdan939jfv1130l3deggflj",oauth:{},aws_cognito_username_attributes:[],aws_cognito_social_providers:[],aws_cognito_signup_attributes:["EMAIL"],aws_cognito_mfa_configuration:"OFF",aws_cognito_mfa_types:["SMS"],aws_cognito_password_protection_settings:{passwordPolicyMinLength:8,passwordPolicyCharacters:[]},aws_cognito_verification_mechanisms:["EMAIL"],geo:{amazon_location_service:{region:"ap-southeast-1",maps:{items:{"mape06d82f2-dev":{style:"VectorEsriStreets"}},default:"mape06d82f2-dev"},search_indices:{items:["placeindexfbc375f3-dev"],default:"placeindexfbc375f3-dev"}}}},C8=({point:e})=>{const t=()=>pI.emit("viewPoint",e);return Vt.jsxs("div",{className:"p-1.5 pt-2 border-b border-gray-700 grid grid-cols-5 shadow-sm gap-x-2 cursor-pointer",onClick:t,children:[Vt.jsx("img",{src:e.resourceUrl,className:"col-span-2 rounded-sm"}),Vt.jsxs("div",{className:"flex flex-col justify-between text-gray-50 text-sm col-span-3",children:[Vt.jsxs("div",{children:[Vt.jsxs("div",{className:"font-light flex justify-between text-xs",children:[Vt.jsx("span",{children:"Coordinates: "}),Vt.jsxs("span",{children:[Number(e==null?void 0:e.coordinates[0]).toFixed(2),"°, ",Number(e==null?void 0:e.coordinates[1]).toFixed(2),"°"]})]}),Vt.jsxs("div",{className:"font-light flex justify-between text-xs",children:[Vt.jsx("span",{children:"Region: "}),Vt.jsx("span",{children:e==null?void 0:e.region})]}),Vt.jsxs("div",{className:"font-light flex justify-between text-xs",children:[Vt.jsx("span",{children:"Sub Region: "}),Vt.jsx("span",{children:e==null?void 0:e.subRegion})]})]}),Vt.jsxs("div",{className:"font-light flex justify-between text-xs",children:[Vt.jsx("span",{children:"No. Potholes: "}),Vt.jsx("span",{children:e==null?void 0:e.count})]})]})]})},I8=()=>{const{data:e}=Dx(!0);return Vt.jsx("div",{className:"flex flex-col",children:e==null?void 0:e.map(t=>Vt.jsx(C8,{point:t},t.sk))})},P8=()=>{const{data:e}=Dx(!0),t=ro.useMemo(()=>Object.entries((e==null?void 0:e.reduce((r,n)=>(r[n.subRegion]===void 0&&(r[n.subRegion]=0),r[n.subRegion]=r[n.subRegion]+n.count,r),{}))||{}).map(([r,n])=>({location:r,count:n})),[e]);return Vt.jsxs("div",{className:"border bg-gray-800 border-gray-700 flex-auto mb-5 rounded flex flex-col h-full max-h-full",children:[Vt.jsxs("div",{className:"flex justify-between border-b border-gray-700 px-2 text-xs text-gray-300 font-medium py-1",children:[Vt.jsx("span",{children:"Location"}),Vt.jsx("span",{children:"No of Potholes"})]}),Vt.jsx("div",{className:"flex-table overflow-auto",children:t.map(r=>Vt.jsxs("div",{className:"flex justify-between px-2 text-xs text-gray-100 py-1",children:[Vt.jsx("span",{children:r.location}),Vt.jsx("span",{children:r.count})]},r.location))})]})};bg.configure(T8);const A8=new l8;function M8(){return Vt.jsx(p8,{client:A8,children:Vt.jsxs("div",{className:"min-h-screen min-w-screen bg-gray-900 flex flex-col",children:[Vt.jsx(S8,{}),Vt.jsxs("div",{className:"flex-1 grid grid-cols-4 mt-3",children:[Vt.jsx(E8,{}),Vt.jsxs("div",{className:"grid-cols-1 flex flex-col",children:[Vt.jsx("div",{className:"max-h-[60vh] overflow-auto h-[60vh] border border-gray-700 mr-2 rounded rounded-r-sm bg-gray-800 ",children:Vt.jsx(I8,{})}),Vt.jsx("div",{className:"flex-1 mb-5 mr-2 mt-2",children:Vt.jsx(P8,{})})]})]})]})})}Fv.createRoot(document.getElementById("root")).render(Vt.jsx(os.StrictMode,{children:Vt.jsx(M8,{})}));
